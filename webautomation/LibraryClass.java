/*---------------------------- Change History ------------------------------
/*
 * Date: 19 July 2017
 * By: Deepankar
 * Title: 
 * Mantis 	0000700	
 */
/* 
/*
 * Date: 17 July 2017
 * By: Deepankar
 * Title: 
 * Mantis 	0000695,0000694	
 */
/* 
/*
 * Date: 12 July 2017
 * By: Deepankar
 * Title: 
 * Mantis 	0000688		
 */
/* 
/*
 * Date: 11 July 2017
 * By: Deepankar
 * Title: Search elements by SPAN for Click useraction
 * Mantis 0000684		
 */
/* 
 * Date: 07 July 2017
 * By: Priti
 * Title: Undoing whatever done for the Mantis 0000460, as it was clearing the pre-set 3 digits
 * Mantis 0000679
 */
/*
 * Date: 07 July 2017
 * By: Priti
 * Title: Handled exception for Test_Case column does not exist
 * Mantis 0000677		
 */

/*---------------------------- Change History ------------------------------
	Date: 27th    January  2016
 * By: Deepankar Bandopadhya
 * Title: 
 * Changes: Mantis ID 0000522
 /*--
/*--
/*---------------------------- Change History ------------------------------
	Date: 18th    January  2016
 * By: Aboli Wakankar
 * Title: 
 * Changes: Mantis ID 0000518	
 /*--
/*---------------------------- Change History ------------------------------
	Date: 17th    December  2016
 * By: Aboli Wakankar
 * Title: 
 * Changes: Mantis ID 0000517	
 /*--
/*----/*---------------------------- Change History ------------------------------
	Date: 17th    December  2016
 * By: Aboli Wakankar
 * Title: 
 * Changes: Mantis ID 0000517	
 /*--
/*----
 * 
 * /*---------------------------- Change History ------------------------------
	Date: 1st    December  2016
 * By: Aboli Wakankar
 * Title: 
 * Changes: Mantis ID 0000505	
 /*--
/*----
 * 
 * /*---------------------------- Change History ------------------------------
	Date: 1st    December  2016
 * By: Aboli Wakankar
 * Title: 
 * Changes: Mantis ID 0000472
 /*--
/*----
 *
/*---------------------------- Change History ------------------------------
	Date: 10th    November  2016
 * By: Aboli Wakankar
 * Title: 
 * Changes: Mantis ID 0000478	
 /*--
/*----
 * 
 * /*---------------------------- Change History ------------------------------
	Date: 9th    November  2016
 * By: Aboli Wakankar
 * Title: 
 * Changes: Mantis ID 0000471
 /*--
/*----
 *
/*---------------------------- Change History ------------------------------
	Date: 7th    November  2016
 * By: Aboli Wakankar
 * Title: 
 * Changes: Mantis ID 0000470	
 /*--
/*----
/*---------------------------- Change History ------------------------------
	Date: 3rd    November  2016
 * By: Aboli Wakankar
 * Title: 
 * Changes: Mantis ID 0000466	
 /*--
/*----
 * 
 */
/*---------------------------- Change History ------------------------------
	Date: 28th    October  2016
 * By: Aboli Wakankar
 * Title: 
 * Changes: Mantis ID 0000461	
 /*--
/*----
/*---------------------------- Change History ------------------------------
	Date: 26th    October  2016
 * By: Deepankar Bandopadhya
 * Title: 
 * Changes: Mantis ID 0000459,0000460, 0000458		
 /*--
/*----
/*---------------------------- Change History ------------------------------
	Date: 17th   October  2016
 * By: Deepankar Bandopadhya
 * Title: 
 * Changes: Mantis ID 0000445,0000444,0000443,0000442,0000423		
 /*--
/*----
/*---------------------------- Change History ------------------------------
	Date: 4th   October  2016
 * By: Deepankar Bandopadhya
 * Title: 
 * Changes: Mantis ID 0000428,0000426,0000425,0000424,0000422,0000419,0000418,0000416		
 /*--
/*----
/*---------------------------- Change History ------------------------------
	Date: 27th  September  2016
 * By: Deepankar Bandopadhya
 * Title: 
 * Changes: Mantis ID 0000385	
 /*--
/*----
/*---------------------------- Change History ------------------------------
	Date: 20th  September  2016
 * By: Deepankar Bandopadhya
 * Title: 
 * Changes: Mantis ID 0000386	
 /*--
/*---------------------------- Change History ------------------------------
	Date: 19th  September  2016
 * By: Deepankar Bandopadhya
 * Title: 
 * Changes: Mantis ID 372, 336,337
 /*---------------------------- Change History ------------------------------
	Date: 16th  September  2016
 * By: Deepankar Bandopadhya
 * Title: 
 * Changes: 
 * 		    Functions Modified: 1. Fixed Manits ID 0000378,377,237
 * 							
/*---------------------------- Change History ------------------------------
	Date: 15th  September  2016
 * By: Deepankar Bandopadhya
 * Title: 
 * Changes: 
 * 		    Functions Modified: 1. getRowNumber() and ClickRowControl--> Fixed manits defect 0000374
 * 								2. Fixed Mantis 375
 /*---------------------------- Change History ------------------------------
	Date: 13th  September  2016
 * By: Deepankar Bandopadhya
 * Title: 
 * Changes: 
 * 		    Functions Modified: 1. getRowNumber() --> 
 * 			Added Feature in GetRownumber function to handle multiple columns and Index
 *			Added new useractions "Identify", "ClickLink", "ClickCheckBox"
 *			Added new function "ClickRowControl
  /*---------------------------- Change History ------------------------------
	Date: 3rd September 2016
 * By: Deepankar Bandopadhya
 * Title: Added fix for ensuring that getRowNumber functions works 
 * Changes: 
 * 		    Functions Modified: 1. getRowNumber() --> 
 * 			SetDriver Function was not called hence the count was incorrect when finding tables
 * 			Added trim while reading value
/*

/*
Date: 26 August 2016
 * By: Deepankar Bandopadhya
 * Title: Added fix for ensuring that getcellvalue functions works 
 * Changes: 
 * 		    Functions Modified: 1. getCellValue() --> 
 * 			SetDriver Function was not called hence the count was incorrect when finding tables

/*

/*
Date: 26 August 2016
 * By: Deepankar Bandopadhya
 * Title: Added fix for ensuring that getcellvalue functions works 
 * Changes: 
 * 		    Functions Modified: 1. getCellValue() --> 
 * 			SetDriver Function was not called hence the count was incorrect when finding tables

/*
 /*
 Date: 01 August 2016
 * By: Heramb Bedekar
 * Title: Added code for modifying description string if it is provided by user.
 * Changes: 
 * 		    Functions Modified: 1. executeTestCase() --> If sDescription is not null and not empty then sDescription = "User Comments:" + sDescription
 */

/*
 Date: 04 August 2016
 * By: Heramb Bedekar
 * Title: Added code for handling conditional statements (single statements/multiple statements) on if condition objects or condition property exists.
 * Changes: 
 * 		    Functions Modified: 1. executeTestCase() --> two new keywords added as following:
 * 									conditionalStart : Condition object or condition property exists or not. If no then sConditionalStart = false.
 * 									conditionalStop	: sConditionalStart = true
 * 			Variables Added : sConditionalStart 
 */

/*
 * Date: 22 July 2016
 * By: Heramb Bedekar
 * Title: Added code for creating description string if not provided by user.
 * Changes: 
 * 		    Functions Modified: 1. executeTestCase() --> If sUserAction = Click, sDescription = sUserAction + sIdentifierValue
 *                                                       else sDescription = sUserAction + sDataColumn/sUserAction + sDataColumn + sTestStepData
 */

/*
 * Date: 21 July 2016
 * By: Heramb Bedekar
 * Title: Added code for Default Case of Control Type in  "set" User Action
 * Changes: 
 * 			Functions Modified: 1. set() --> In case of default Control Type (other than WebEdit, WebList, WebCheckBox, WebRadioGroup) 
 * 								   perform regular set operation on object. 
 */

/*
 * Date: 27 July 2017
 * By: Manoj
 * Title: Fixed Mantis 0000704
 * 
 */

/*
 * Date: 11 August 2017
 * By: Manoj Bamnawat
 * Title:Runwebscript enhancement
 * Mantis ID: 0000703
 * 
 */
/*
 * Date: 15 August 2017
 * By: Deepankar
 *  Mantis ID: 0000712,0000713,0000715
 * 
 */
/*
 * Date: 24 August 2017
 * By: Deepankar
 *  Mantis ID: 0000728,0000727,0000726,0000724,0000723,0000721
 * 
 */
/*
 * Date: 24 August 2017
 * By: Deepankar
 *  Mantis ID: 729,730
 */
/*
 * Date: 13 Sept 2017
 * By: Deepankar 
 * Title: 
 * Mantis 0000735		
 */
/*
 * Date: 21 Sept 2017
 * By: Manoj Bamnawat
 * Changes: Comment out the code.
 * Mantis ID:0000741
 */
/*
 * Date: 21 Sept 2017
 * By: Manoj Bamnawat
 * Title: 
 * Mantis 0000742	
 */
/* Date: 23rd Nov 2017
 * By: Manoj Bamnawat
 * Title: 
 * Mantis 0000768	
 */
/* Date: 6 Dec 2017
 * By: Deepankar
 * Title: 
 * Mantis 0000779,0000778,0000777,0000776,0000775,0000774,0000773,0000772,0000771	
 */
/* Date: 11 Dec 2017
 * By: Deepankar
 * Title: 
 * Mantis 0000787,0000786,0000785,0000784,0000783,0000782,0000780
 */
/* Date: 14 Dec 2017
 * By: Manoj Bamnawat
 * Title: 
 * Mantis 0000789
/*	Date: 20th December 2017
 * By: Deepankar
 * Mantis ID: 0000790
 */

/*
 * Date: 26th December 2017
 * By: Manoj Bamnawat
 * Mantis ID: 0000788
 */

/*
 * Date: 16th January 2018
 * By:Sowmya TB
 * Mantis ID: 0000794
 */

/*
 * Date: 18th January 2018
 * By:Sowmya TB
 * Mantis ID: 0000795
 */

/*
 * Date: 19th January 2018
 * By:Sowmya TB
 * Mantis ID:0000762
 */

/*
 * Date: 19th Jan 2018
 * By: Manoj Bamnawat
 * Mantis ID: 0000796		
 */
/*
 * Date: 25th Jan 2018
 * By: Deepankar
 * Mantis ID: 0000801,0000800		
 */
/*
 * Date: 1st Feb 2018
 * By: Sowmya TB
 * Mantis ID: 0000792
 * 		
 */
/*
 * Date: 12th Feb 2018
 * By: Manoj Bamnawat
 * Mantis ID: 0000802,0000803,0000804
 */
/*
 * Date: 20 Feb 2018
 * By: Manoj Bamnawat
 * Mantis ID: 0000805,0000806,0000807
 */
/*
 * Date: 01 March 2018
 * By: Manoj Bamnawat
 * Mantis ID: 0000810, 0000811
 */
/*
 * Date: 26 March 2018
 * By: Deepankar
 * Mantis ID: 0000835
 */
/*
 * Date: 11th April 2018
 * By: Manoj Bamnawat
 * Mantis ID: 0000836
 */
/*
 * Date: 17th April 2018
 * By: Manoj Bamnawat
 * Mantis ID: 0000842
 */
/*
 * Date: 26th April 2018
 * By: Manoj Bamnawat
 * Mantis ID: 0000843,0000844,0000845
 */
/*
 * Date: 7th May 2018
 * By: Manoj Bamnawat
 * Mantis ID: 0000847, 0000848, 0000849, 0000850, 0000851
 */
/*
 * Date: 11th May 2018
 * By: Anum Shaikh
 * Mantis ID: 0000854,0000855
 */
/*
 * Date: 21th May 2018
 * By: Manoj Bamnawat
 * Mantis ID: Changes made in "Executejs" and created "clickjs" & "setFrame" useraction but not yet finalize the code.
 */
/*
 * Date: 30th May 2018
 * By: Anum Shaikh
 * Mantis ID: 0000863,0000864
 */
/*
 * Date: 15th June 2018
 * By: Anum Shaikh
 * Mantis ID: 0000871
 */

/*
 * Date: 15th June 2018
 * By: Deepankar Bandopadhya
 * Mantis ID: 0000877,0000874
 */
/*
 * Date: 18th June 2018
 * By: Anum Shaikh
 * Mantis ID: 0000875,0000873	
 */
/*
 * Date: 19th June 2018
 * By: Anum Shaikh
 * Mantis ID: 0000878		
 */
/*
 * Date: 20th June 2018
 * By: Manoj Bamnawat
 * Mantis ID: 0000879,0000881
 */
/*
 * Date: 21st June 2018
 * By: Anum Shaikh
 * Mantis ID: 0000883
 */
/*
 * Date: 22nd June 2018
 * By: Manoj Bamnawat
 * Mantis ID: 0000868, 0000885, 0000886
 */
/*
 * Date: 26th June 2018
 * By: Manoj Bamnawat
 * Mantis ID: 0000888
 */
/*
 * Date: 27th June 2018
 * By: Anum shaikh
 * Mantis ID: 0000884 ,0000889,0000890,0000891
 */
/*
 * Date: 29th June 2018
 * By: Manoj Bamnawat
 * Mantis ID: 0000896, 0000898, 0000899
 */
/*
 * Date: 4th  July 2018
 * By: Deepankar 
 * Mantis ID: 0000904,0000901
 * Mantis ID: 0000905
 */
/*
 * Date: 05th July 2018
 * By: Manoj Bamnawat
 * Mantis ID: 0000906, 0000907
 */
/*
 * Date: 17th July 2018
 * By: Anum Shaikh
 * Mantis ID: 0000910
 */
/*
 * Date: 23rd July 2018
 * By: Manoj Bamnawat
 * Mantis ID: 0000911,0000912,0000916,0000917,0000918,0000919,0000920,0000921,0000922
 */
/*
 * Date: 24th July 2018
 * By: Manoj Bamnawat
 * Mantis ID: 0000923,0000924
 */
/*
 * Date: 07th August 2018
 * By: Manoj Bamnawat
 * Mantis ID: 0000867,0000925,0000927,0000928,0000929,0000930 
 */
/*
 * Date: 04th Sept 2018
 * By: Manoj Bamnawat
 * Mantis ID: 0000938, 0000939, 0000940, 0000941, 0000942, 0000948, 0000954
 */
/*
 * Date: 18th Sept 2018
 * By: Manoj Bamnawat
 * Mantis ID: 0000958, 0000960, 0000961
 */
/*
 * Date: 03rd Oct 2018
 * By: Manoj Bamnawat
 * Mantis ID: 0000974
 */
/*
 * Date: 05 Nov 2018
 * By: Zoheb Fondu
 * Mantis ID: 0001012
 */
/*
 * Date: 12 Dec 2018
 * By: Manoj Bamnawat
 * Changes: Added Rootpath feature.
 */
/*
 * Date: 10 Jan 2019
 * By: Manoj Bamnawat
 * Mantis ID: 0001070, 0001073
 */
/*
 * Date: 16 Jan 2019
 * By: Anum Shaikh
 * Mantis ID: 0001077,0001078
 */
/*
 * Date: 18 Jan 2019
 * By: Anum Shaikh
 * Mantis ID: 0001079,0001080
 */
/*
 * Date: 29 Jan 2019
 * By: Anum Shaikh
 * Mantis ID: 0001092
 */
/*
 * Date: 04 Feb 2019
 * By: Manoj Bamnawat
 * Mantis ID: 0001097, 0001098, 0001099, 0001101
 */
/*
 * Date: 07 Feb 2019
 * By: Manoj Bamnawat
 * Mantis ID: 0001103
 */
/*
 * Date: 14 Feb 2019
 * By: Manoj Bamnawat
 * Mantis ID: 0001116, 0001117
 */
/*
 * Date: 11 March 2019
 * By: Anum Shaikh
 * Mantis ID: 0001131
 */
/*
 * Date: 15 March 2019
 * By: Anum Shaikh
 * Mantis ID: 0001132
 */
/*
 * Date: 21 March 2019
 * By: Zoheb Fondu
 * Mantis ID: 0001133
 */
/*
 * Date: 29 March 2019
 * By: Anum Shaikh
 * Mantis ID: 0001136
 */
/*
 * Date: 1 April 2019
 * By: Anum Shaikh
 * Mantis ID: 0001137
 */
/*
 * Date: 2 April 2019
 * By: Anum Shaikh
 * Mantis ID: 0001138,0001139
 */
/*
 * Date: 05 April 2019
 * By: Anum Shaikh
 * Mantis ID: 0001146,0001147
 */
/*
 * Date: 08 April 2019
 * By: Anum Shaikh
 * Mantis ID:0001148
 */
/*
 * Date: 15 April 2019
 * By: Anum Shaikh
 * Mantis ID:0001149
 */
/*
 * Date: 18 April 2019
 * By: Anum Shaikh
 * Mantis ID:0001151
 */
/*
 * Date: 19 April 2019
 * By: Anum Shaikh
 * Mantis ID:0001151 [Property Report]
 */
/*
 * Date: 28 June 2019
 * By: Zoheb Fondu
 * Mantis: 0001172	
 */
/*
 * Date: 09 July 2019
 * By: Zoheb Fondu
 * Mantis: 0001195
 */
/*
 * Date: 18 July 2019
 * By: Zoheb Fondu
 * Mantis: 0001169	
 */
/*
 * Date: 23 July 2019
 * By: Zoheb Fondu
 * Mantis: 0001211	
 */
/*
 * Date: 06 Aug 2019
 * By: Anum Shaikh
 * Mantis ID:0001219, 0001220,  0001221, 0001222
 */
/*
 * Date: 08 Aug 2019
 * By:  Zoheb Fondu
 * Mantis ID:0001227,0001229
 */
/*
 * Date: 22 Aug 2019
 * By: Zoheb Fondu
 * Mantis: 0001249
 */
/*
 * Date: 30 Sept 2019
 * By: Zoheb Fondu
 * Mantis: 0001351, 0001140
 */
/*
 * Date: 19 Nov 2019
 * By: Anum Shaikh
 * Mantis: 0001477
 */
/*
 * Date: 29 Nov 2019
 * By: Deepankar 
 * Mantis: 0001450
 */
/*
 * Date: 03 Dec 2019
 * By: Anum Shaikh
 * Mantis: 0001531
 */
/*
 * Date: 17 Dec 2019
 * By: Zoheb Fondu
 * Mantis: 0001573
 */
/*
 * Date: 13 April 2020
 * By: Anum Shaikh
 * Mantis: 1758
 */
/*
 * Date: 24 April 2020
 * By: Anum Shaikh
 * Mantis:  0001788
 */
/*
 * Date: 15 May 2020
 * By: Anum Shaikh
 * Mantis:  0001816,0001815
 */
/*
 * Date: 18 May 2020
 * By: Manoj Bamanwat
 * Mantis: 0001780
 */
/*
 * Date: 19 May 2020
 * By: Anum Shaikh
 * Mantis: 0001823
 */
/*
 * Date: 27 May 2020
 * By: Anum Shaikh
 * Mantis: 0001836
 */
/*
 * Date: 13 July 2020
 * By: Anum Shaikh
 * Mantis: 0001896,0001895,0001894
 */
/*
 * Date: 17 July 2020
 * By: Chetan Naik
 * Mantis: 0001882
 */
/*
 * Date: 19 August 2020
 * By: Anum Shaikh
 * Mantis: 0001911
 */
/*
 * Date: 20 August 2020
 * By: Anum Shaikh
 * Mantis: 0001913
 */
/*
 * Date: 24 August 2020
 * By: Anum Shaikh
 * Mantis: 0001917
 */
/*
 * Date: 08 Sept 2020
 * By: Anum Shaikh
 * Mantis: 0001924
 */
/*
 * Date: 23 Sept 2020
 * By: Anum Shaikh
 * Mantis: 0001928,0001943
 */
/*
 * Date: 15 Jan 2021
 * By: Anum Shaikh
 * Mantis: 0001951,0001950
 */
/*
 * Date: 13 Apr 2021
 * By: Anum Shaikh
 * Mantis: 0001948,0001949
 */
/*
 * Date: 15 Apr 2021
 * By: Zoheb Fondu
 * Mantis: 0002008, 0002007, 0002005
 */
/*
 * Date: 17 Apr 2021
 * By: Zoheb Fondu
 * Mantis: 0002014,2009
 */
/*
 * Date: 25 Mar 2021
 * By: Zoheb Fondu
 * Mantis: 0002019
 */
/*
 * Date: 06 June 2021
 * By: Zoheb Fondu
 * Mantis: 0002021
 */
/*
 * Date: 07 June 2021
 * By: Zoheb Fondu
 * Mantis: 0002022
 */
/*
 * Date: 17 June 2021
 * By: Zoheb Fondu
 * Mantis: 0002024
 */
/*
 * Date: 23 June 2021
 * By: Zoheb Fondu
 * Mantis: 0002025
 */
/*
 * Date: 28 June 2021
 * By: Zoheb Fondu
 * Mantis: 0002026
 */
/*
 * Date: 30 June 2021
 * By: Zoheb Fondu
 * Mantis: 0002027
 */
/*
 * Date: 08th July 2021
 * By: Chetan Naik
 * Mantis: 0002031
 */
/*
 * Date: 12th July 2021
 * By: Chetan Naik 
 * Mantis: 0002032,0002033,0002034
 */

/*
 * Date: 14th July 2021
 * By: Chetan Naik
 * Mantis: 0002035
 */


package com.nexops.auto.remediate.webautomation;

import java.awt.AWTException;
import java.awt.Robot;
import java.awt.Toolkit;
import java.awt.datatransfer.Clipboard;
import java.awt.datatransfer.DataFlavor;
import java.awt.datatransfer.StringSelection;
import java.awt.datatransfer.Transferable;
import java.awt.event.InputEvent;
import java.awt.event.KeyEvent;
import java.awt.image.BufferedImage;
import java.io.BufferedReader;
import java.io.BufferedWriter;
import java.io.File;
import java.io.FileNotFoundException;
import java.io.FileOutputStream;
import java.io.FileReader;
import java.io.FileWriter;
import java.io.IOException;
import java.io.InputStreamReader;
import java.io.OutputStreamWriter;
import java.io.UnsupportedEncodingException;
import java.io.Writer;
import java.math.BigInteger;
import java.nio.file.NoSuchFileException;
import java.security.InvalidKeyException;
import java.security.MessageDigest;
import java.security.NoSuchAlgorithmException;
import java.security.spec.InvalidKeySpecException;
import java.security.spec.KeySpec;
import java.sql.Connection;
import java.sql.ResultSet;
import java.sql.ResultSetMetaData;
import java.sql.SQLException;
import java.sql.Statement;
import java.text.DateFormat;
import java.text.NumberFormat;
import java.text.ParseException;
import java.text.SimpleDateFormat;
import java.util.ArrayList;
import java.util.Arrays;
import java.util.Calendar;
import java.util.Collections;
import java.util.Comparator;
import java.util.Date;
import java.util.HashMap;
import java.util.IllegalFormatException;
import java.util.Iterator;
import java.util.LinkedHashMap;
import java.util.LinkedHashSet;
import java.util.LinkedList;
import java.util.List;
import java.util.ListIterator;
import java.util.Locale;
import java.util.Map;
import java.util.Random;
import java.util.Set;
import java.util.Stack;
import java.util.UUID;
import java.util.Base64.Decoder;
import java.util.Map.Entry;

import java.util.concurrent.TimeUnit;
import java.util.regex.*;
import java.util.stream.Collectors;
import java.util.stream.Stream;

import javax.crypto.BadPaddingException;
import javax.crypto.Cipher;
import javax.crypto.IllegalBlockSizeException;
import javax.crypto.NoSuchPaddingException;
import javax.crypto.SecretKey;
import javax.crypto.SecretKeyFactory;
import javax.crypto.spec.DESedeKeySpec;
import javax.crypto.spec.IvParameterSpec;
import javax.crypto.spec.SecretKeySpec;
import javax.imageio.ImageIO;
import javax.naming.InvalidNameException;

import org.apache.commons.codec.binary.Base64;
import org.apache.commons.io.FileUtils;
import org.apache.commons.lang3.StringUtils;
import org.apache.commons.lang3.math.NumberUtils;
import org.apache.poi.ss.usermodel.Workbook;
import org.json.JSONArray;
import org.json.JSONException;
import org.json.JSONObject;
import org.json.simple.parser.JSONParser;
import org.openqa.selenium.Alert;
import org.openqa.selenium.By;
import org.openqa.selenium.JavascriptExecutor;
import org.openqa.selenium.Keys;
import org.openqa.selenium.NoSuchElementException;
import org.openqa.selenium.NoSuchFrameException;
import org.openqa.selenium.NoSuchWindowException;
import org.openqa.selenium.OutputType;
import org.openqa.selenium.Point;
import org.openqa.selenium.TakesScreenshot;
import org.openqa.selenium.TimeoutException;
import org.openqa.selenium.UnhandledAlertException;
import org.openqa.selenium.WebDriver;
import org.openqa.selenium.WebDriver.Timeouts;
import org.openqa.selenium.WebElement;
import org.openqa.selenium.chrome.ChromeDriver;
import org.openqa.selenium.chrome.ChromeOptions;
import org.openqa.selenium.edge.EdgeDriver;
import org.openqa.selenium.firefox.FirefoxDriver;
import org.openqa.selenium.ie.InternetExplorerDriver;
import org.openqa.selenium.interactions.Actions;
import org.openqa.selenium.remote.DesiredCapabilities;
import org.openqa.selenium.support.ui.ExpectedConditions;
import org.openqa.selenium.support.ui.FluentWait;
import org.openqa.selenium.support.ui.Select;
import org.openqa.selenium.support.ui.WebDriverWait;

import com.google.common.base.Function;
import com.nexops.auto.remediate.constants.AbbreviationColumnHeader;
import com.nexops.auto.remediate.constants.CustomizeDataColumnHeader;
import com.nexops.auto.remediate.constants.DataFormatColumnHeader;
import com.nexops.auto.remediate.constants.DatabaseConnectionsColumnHeader;
import com.nexops.auto.remediate.constants.DynamicDataColumnHeader;
import com.nexops.auto.remediate.constants.ExecutionDataColumnHeader;
import com.nexops.auto.remediate.constants.ImageVerificationJsonKeys;
import com.nexops.auto.remediate.constants.PageColumnHeader;
import com.nexops.auto.remediate.constants.TableColumnHeader;
import com.nexops.auto.remediate.exception.CustomDataBaseException;
import com.nexops.auto.remediate.exception.CustomException;
import com.nexops.auto.remediate.exception.InvalidTypeException;
import com.nexops.auto.remediate.exception.NoSuchTagException;
import com.nexops.auto.remediate.exception.NoTempDataPresent;
import com.nexops.auto.remediate.restapi.Apiservices;
import com.nexops.auto.remediate.util.ExcelConnection;
import com.nexops.auto.remediate.util.FunctionalLogging;
import com.nexops.auto.remediate.util.ImageVerificationFeature;
import com.nexops.auto.remediate.util.Pdfverifytext;

public class LibraryClass {
	public static String appiumProcess = null;// Mantis 0000703
	public static String sDebugLogFileName, sFunctionalLogFileName, sProcessDebugLogFileName;// Mantis 0000703(Global

	WebDriver oDriver;
	WebElement table_getRowNo;
	WebElement activeElement;
	String _sMainWindowHandle, _sBrowser;
	String sControlType, sNextRowControlType, sIdentifier, sIdentifierValue, sUserAction, sNextRowUserAction,
	sDataColumn, sTestStepData, sIndex, sTestCaseExcelPath, sTestCaseData, sVerifyProperty, sTakeScreenShot,
	sRunFlag, sActualValue, sStepStatus, sExpectedData, sComments, sAlertText, sStepDescription,
	sScreenShotFilePath, sDescription, sWebPagePath; // Mantis 0001221
	String sPreviousIdentifier, sPreviousIdentifierValue, sPreviousTestStepData = "";// Mantis 0000423
	String sRemoveWordsColumn = null; // Mantis 0000478
	String sPreviousUserAction; // Mantis 0000466
	int iPreviousInd = -1;// Mantis 0000423
	String savedGuid;// Mantis 0000458
	String sPresentString, sConcatenatedString, sProxyUsername, sProxyPassword;
	String sAlertKey;
	boolean sConditionalStart = true, sConditionalStop = false;
	boolean sConditionalFileExist = true, sConditionalFileStop = false; // Mantis 0001836
	String conditionFileName = ""; // Mantis 0001836
	Date dStartTimestamp;
	Boolean Previous_Step_GetRowNo = false;
	int iStepNo, iIndex, iSkippedElements, iObtained_RowNo, iCurrentContext, iStaleMaxCount = 500, iCountOfLabels;
	long lPageWaitTime, lFrameWaitTime, lPageLoadTime, lThinkTime, lWindowTimeout, lElementWait, OptionalElementWait; // Mantis
	// 0000879,0001896
	FunctionalLogging oFunctionLog;
	FluentWait<WebDriver> pageWait, frameWait;
	WebDriverWait wait;
	Timeouts pageLoadWait;
	Date date;
	boolean searchInFrameFlag = false, alertFlag = true;
	int sWhileCounter = 0, maxLimit = 2, sForLoopCounter = 0; // Mantis 0000930, 0001097
	List<String> sForLoopData = null; // Mantis 0001097
	String sForLoopVariable = "", sForLoopDataColumn; // Mantis 0001097
	boolean sForLoopStatus = false; // Mantis 0001097
	WebElement currElement = null;
	DesiredCapabilities capabilities;
	String dateFormat = ""; // Mantis 0000713, 0001073
	// Region currentRegion=null; //Mantis 0000772,1758
	int imageTimeout = 5; // Mantis 0000780
	int regionTimeout = 20;// Mantis 0000780
	private boolean allowSysOuts;
	// String rootPath=""; //Mantis 0001045
	Map<String, String> sSetData = null; // Mantis 0001097
	String sPropertyReportFileName = "", sPropertyReportSheetName = "", sAvailabilityReportFileName = "",
			sAvailabilityReportSheetName = "", sCustomPropertyFileName = "", sCustomePropertySheetName = ""; // Mantis
	// 0001073,
	// 0001097,
	// 0001098
	String sPropertyDetailFileName = "", sPropertyDetailsheetName = "", nullapi = "Data not found in API"; // Mantis
	// 0001149
	boolean sPropertyReportStatus = false, sPropertyTransFormStaus = false, sAeroPropertyFlag,
			sUIPropertyReportStatus = false, sAvailabilityReportStatus = false, sAvailabilityTransFormStaus = false; // Mantis
	// 0001073,
	// 0001097,
	// 0001098
	boolean sPropertyDetailTransformStatus = false; // Mantis 0001149
	WebElement startElement = null; // deepankar
	WebElement endElement = null; // deepankar
	List<WebElement> listOfSuit; // Mantis 0001136
	// sPageWaitTime and sFrameWaitTime are added for waiting at Page and Frame
	// level respectively
	private int jsonfieldindex = -1; // Mantis 0001136,0001138
	String apiparam, testdataparam; // Mantis 0001149
	// Mantis 0001816
	String customReportFilename = "";
	ArrayList<ArrayList<String>> customReportData = new ArrayList<ArrayList<String>>();
	Map<Integer, String> customReportDataHeader = new HashMap<Integer, String>();
	ArrayList<String> rowdata = new ArrayList<String>();
	Boolean customReport = false;
	int customReportCounter = 0;
	List<WebElement> sForLoopElements = null;
	WebElement sForLoopVariableElement = null;
	// Mantis 0001816
	String filelocation = ""; // Mantis 0001836
	String[] fileextension; // Mantis 0001836
	// Mantis 0001911
	Boolean isImageVerificationAdded = false;
	List<HashMap<String, String>> imageCollection = new ArrayList<HashMap<String, String>>();
	String baselineImageFolder = "", baselineScriptTestCaseFolder = "", baseBrowserScriptTestCaseFolder = ""; // Mantis
	// 0001951,0001950
	List<HashMap<String, String>> scriptTestCase = new ArrayList<HashMap<String, String>>();
	String Webserver = ""; // Mantis 0001917
	// Mantis 0001911
	// Mantis 0000925

	public void setSysouts(boolean sysout) {
		allowSysOuts = sysout;
	}

	public LibraryClass(String sBrowserName, String sDriverPath, String sPageWaitTime, String sFrameWaitTime,
			String sLoadTimeout, String sWindowTimeout, String sElementWait) throws Exception {
		systemouts("Inside library class");
		this.sTestCaseExcelPath = "";
		_sBrowser = sBrowserName;

		lPageWaitTime = Long.parseLong(Integer.toString((int) (Float.parseFloat(sPageWaitTime) * 1000))); // Mantis
		// 0000921
		lFrameWaitTime = Long.parseLong(Integer.toString((int) (Float.parseFloat(sFrameWaitTime) * 1000))); // Mantis
		// 0000921
		lPageLoadTime = Long.parseLong(sLoadTimeout);
		lWindowTimeout = Long.parseLong(Integer.toString((int) (Float.parseFloat(sWindowTimeout)))); // Mantis
		// 0000854,0000921
		lElementWait = Long.parseLong(sElementWait); // Mantis 0000879
		// rootPath=KeywordDrivenFramework.sRootPath; //Mantis 0001045
		switch (sBrowserName.toLowerCase()) {
		case "firefox": // Mantis 0001142
			systemouts("Inside firefox case");
			System.setProperty("webdriver.gecko.driver",
					System.getProperty("user.dir").concat("/SeleniumDrivers/geckodriver.exe"));
			oDriver = new FirefoxDriver();
			break;

		case "edge": // Mantis 0001142
			systemouts("Inside Edge case");
			System.setProperty("webdriver.edge.driver",
					System.getProperty("user.dir").concat("/SeleniumDrivers/MicrosoftWebDriver.exe"));
			oDriver = new EdgeDriver();
			break;

		case "chrome":
			systemouts("Inside chrome case");
			ChromeOptions options = new ChromeOptions(); // Mantis 0000845
			if ((KeywordDrivenFramework.sDownloadFolder.trim().length() != 0)
					&& new File(KeywordDrivenFramework.sDownloadFolder).exists()) // Mantis 0001816
			{
				HashMap<String, Object> chromePrefs = new HashMap<String, Object>();
				chromePrefs.put("download.default_directory", KeywordDrivenFramework.sDownloadFolder);
				options.setExperimentalOption("prefs", chromePrefs);
			} else {
				HashMap<String, Object> chromePrefs = new HashMap<String, Object>();
				chromePrefs.put("download.default_directory", "");
				options.setExperimentalOption("prefs", chromePrefs);
			}
			options.setExperimentalOption("excludeSwitches", new String[] { "enable-automation" });
			options.addArguments("disable-infobars"); // Mantis 0000845
			options.addArguments("--start-maximized"); // Mantis 0000847
			String OS = System.getProperty("os.name");
			System.out.println("Operating System:"+OS);
			if(OS.startsWith("Windows")) {
				System.setProperty("webdriver.chrome.driver",
						System.getProperty("user.dir").concat("/SeleniumDrivers/chromedriver.exe"));
			}
			else if(OS.toLowerCase().contains("linux")) {
				System.setProperty("webdriver.chrome.driver",
						System.getProperty("user.dir").concat("/SeleniumDrivers/chromedriver"));
			}
			String chromeProfile = System.getProperty("user.dir").concat("/chrome-profile"); // MAntis 0001788
			if (new File(chromeProfile).exists())
				options.addArguments("user-data-dir=" + chromeProfile);

			// options.addArguments("headless");
			oDriver = new ChromeDriver(options); // Mantis 0000845
			break;

		case "ie":
			systemouts("Inside IE case");
			capabilities = DesiredCapabilities.internetExplorer();
			capabilities.setCapability("ignoreZoomSetting", true);
			capabilities.setCapability("ignoreProtectedModeSettings", true);
			capabilities.setCapability("REQUIRE_WINDOW_FOCUS", true); // Mantis 0000723
			capabilities.setCapability("LOG_LEVEL", "FATAL"); // Mantis 0000723
			System.setProperty("webdriver.ie.driver",
					System.getProperty("user.dir").concat("/SeleniumDrivers/IEDriverServer.exe")); // Mantis 0000796
			oDriver = new InternetExplorerDriver(capabilities);
			systemouts("IE Launched");
		}
		ExcelConnection.getChromePIDs(); // Mantis: 0001573

		pageWait = new FluentWait<WebDriver>(oDriver).withTimeout(lPageWaitTime, TimeUnit.MILLISECONDS) // Mantis
				// 0000845
				.pollingEvery(100, TimeUnit.MILLISECONDS).ignoring(NoSuchElementException.class);

		frameWait = new FluentWait<WebDriver>(oDriver).withTimeout(lFrameWaitTime, TimeUnit.MILLISECONDS) // Mantis
				// 0000845
				.pollingEvery(100, TimeUnit.MILLISECONDS).ignoring(NoSuchElementException.class);

		oDriver.manage().timeouts().pageLoadTimeout(lPageLoadTime, TimeUnit.SECONDS);
		oDriver.manage().timeouts().setScriptTimeout(300, TimeUnit.SECONDS); // Mantis 0000742

		// wait=new WebDriverWait(driver, timeOutInSeconds)
		// oDriver.manage().timeouts().implicitlyWait(lPageWaitTime, TimeUnit.SECONDS);
		oFunctionLog = new FunctionalLogging("", KeywordDrivenFramework.getCurrentScenario());

		
		//MyScreenRecorder.startRecording("Test");
		
		KeywordDrivenFramework.recorder.startRecording("Test");
	}

	/*
	 * --------------------------------------- START :
	 * finalize---------------------------------------------- Function Name:
	 * finalize Objective: A function to close and End the Scenario gets called
	 * Automatically Date Created: Input: NA Output: NA Revision History: Modified
	 * on: Comments: Browser is closed and scenario is been ended.
	 * -----------------------------------------------------------------------------
	 * -------------------------
	 */

	public void finalize() throws Throwable {
		oDriver.close();
		oDriver.quit();
		systemouts("Ending Scenario");
	}

	/*
	 * ----------------------------------------START:
	 * zoomIn---------------------------------------------- Function Name: zoomIn
	 * Objective: A generic Function for browser zoomIn Date Created: 29/01/2016
	 * Created By : Heramb Input: Output: revision by: Revision History: Modified
	 * on: Comments:
	 * -----------------------------------------------------------------------------
	 * --------------------------
	 */

	public void zoomIn() {
		WebElement html = oDriver.findElement(By.tagName("html"));
		html.sendKeys(Keys.chord(Keys.CONTROL, Keys.ADD));
	}

	/*
	 * ----------------------------------------START:
	 * zoomOut---------------------------------------------- Function Name: zoomOut
	 * Objective: A generic Function for browser zoomOut Date Created: 04/02/2016
	 * Created By : Heramb Input: Output: revision by: Revision History: Modified
	 * on: Comments:
	 * -----------------------------------------------------------------------------
	 * ----------------------------
	 */

	public void zoomOut() {
		WebElement html = oDriver.findElement(By.tagName("html"));
		html.sendKeys(Keys.chord(Keys.CONTROL, Keys.SUBTRACT));
	}

	/*
	 * ----------------------------------------START:
	 * zoomReset---------------------------------------------- Function Name:
	 * zoomReset Objective: A generic Function for resetting browser zoom. Date
	 * Created: 09/02/2016 Created By : Heramb Input: Output: revision by: Revision
	 * History: Modified on: Comments:
	 * -----------------------------------------------------------------------------
	 * ----------------------------
	 */

	public void zoomReset() {
		WebElement html = oDriver.findElement(By.tagName("html"));
		systemouts("Browser Element is:" + html);
		html.sendKeys(Keys.chord(Keys.CONTROL, "0"));
	}

	/*
	 * ----------------------------------------START:
	 * Maximize---------------------------------------------- Function Name:
	 * maximize Objective: A generic Function for maximizing the window. Date
	 * Created: 18/06/2018 Created By : Anum Input: Null Output: Null revision by:
	 * Revision History: Modified on: Comments:
	 * -----------------------------------------------------------------------------
	 * ----------------------------
	 */
	public void maximize() throws Exception { // Mantis 0000875
		oDriver.manage().window().maximize();
	}

	/*
	 * ----------------------------------------START: Object
	 * Exist---------------------------------------------- Function Name:
	 * objectexist Objective: A generic Function to check if the current object is
	 * present on screen or not. Date Created: 18/06/2018 Created By : Anum Input:
	 * Null Output: Null revision by: Revision History: Modified on: Comments: If
	 * object exist, status will be pass else fail.
	 * -----------------------------------------------------------------------------
	 * ----------------------------
	 */
	public String objectexist(String sControlType, String sSearchCriteria, String sSearchText, String sData, int iInd)
			throws Exception { // Mantis 0000873
		WebElement oCurrentElement = null;
		String sStatus = "";
		if (waitForElement(sSearchCriteria, sSearchText, iInd)) // Mantis 0000879
		{
			oCurrentElement = getElement(sControlType, sSearchCriteria, sSearchText, iInd);
			int i = 0;
			while (oCurrentElement == null && i < iStaleMaxCount) // Mantis 0000855
			{
				// systemouts("inside stale get "+i);
				oCurrentElement = getElement(sControlType, sSearchCriteria, sSearchText, iInd);
				i++;
			}
		}
		if ((oCurrentElement == null && sData.equalsIgnoreCase("false"))
				|| (!(oCurrentElement == null) && sData.equalsIgnoreCase("true"))) // Mantis 0000883 0000890, 0000896
			sStatus = "Pass";
		else if ((oCurrentElement == null && sData.equalsIgnoreCase("true"))
				|| (!(oCurrentElement == null) && sData.equalsIgnoreCase("false"))) // Mantis 0000883 0000890, 0000896
			sStatus = "Fail";

		sActualValue = sData; // Mantis 0000890 //Check this line

		return sStatus;

	}

	/*--------------------------------------- START : getKey ----------------------------------------------*/
	public String getKey(String line) throws IOException {
		/*
		 * BufferedReader br = new BufferedReader(new
		 * FileReader(System.getProperty("user.dir").concat(
		 * "\\QWeb_Automation_lib\\selenium_java_srcs.jar"))); String line =
		 * br.readLine();
		 */
		String keyString = line.substring(32, line.length());
		// br.close();
		return keyString;
	}

	/*--------------------------------------- START : gethsah ----------------------------------------------*/
	public String getHsah(String line) throws IOException {
		/*
		 * BufferedReader br = new BufferedReader(new
		 * FileReader(System.getProperty("user.dir").concat(
		 * "\\QWeb_Automation_lib\\selenium_java_srcs.jar"))); String line =
		 * br.readLine();
		 */
		String keyString = line.substring(0, 32);
		// br.close();
		return keyString;
	}

	/*--------------------------------------- START : Decryption ----------------------------------------------*/

	public String decrypt(String key, String initVector, String encrypted) {
		try {
			IvParameterSpec iv = new IvParameterSpec(initVector.getBytes("UTF-8"));
			SecretKeySpec skeySpec = new SecretKeySpec(key.getBytes("UTF-8"), "AES");
			Cipher cipher = Cipher.getInstance("AES/CBC/PKCS5PADDING");
			cipher.init(Cipher.DECRYPT_MODE, skeySpec, iv);
			byte[] original = cipher.doFinal(Base64.decodeBase64(encrypted));
			return new String(original);
		} catch (Exception ex) {
			ex.printStackTrace();
		}
		return null;
	}

	/*--------------------------------------- START : hsah ---------------------------------------------- */
	String hsah(String testString) throws NoSuchAlgorithmException {
		MessageDigest md = MessageDigest.getInstance("MD5");
		byte[] messageDigest = md.digest(testString.getBytes());
		BigInteger number = new BigInteger(1, messageDigest);
		String hashtext = number.toString(16);
		while (hashtext.length() < 32) {
			hashtext = "0" + hashtext;
		}
		return hashtext;
	}

	/*
	 * --------------------------------------- START :
	 * openURL---------------------------------------------- Function Name: openURL
	 * Objective: A generic function to launch / open any application Date Created:
	 * Input: URL = An URL or a path to an application to be opened Output: Revision
	 * History: Modified on: Comments: URL of the application is passed to the
	 * Function as string and with Get property of Selenium webdriver, the
	 * application is opened.
	 * -----------------------------------------------------------------------------
	 * ----------------------------
	 */

	public void openURL(String URL)
			throws IOException, NoSuchAlgorithmException, NoSuchFieldException, CustomException, ParseException {

		/*-------------- Multilicense Check Start----------------*/

		boolean licenseFlag = false;
		String key = "Bar12345Bar12345";
		String initVector = "RandomInitVector";
		File file = new File(System.getProperty("user.dir").concat("/QWeb_Automation_lib/selenium_java_srcs.jar")); // Mantis
		// 0000796
		if (file.exists()) {
			BufferedReader br = new BufferedReader(new FileReader(
					System.getProperty("user.dir").concat("/QWeb_Automation_lib/selenium_java_srcs.jar"))); // Mantis
			// 0000796
			String line = br.readLine();
			while (line != null && licenseFlag == false) {
				if (line.length() > 100) // Manoj 0001038
				{
					String LicenseStartDateKey, LicStartDate, LicenseEndDateKey, LicEndDate;
					Date currentDate, startDate, endDate;
					SimpleDateFormat sdf = new SimpleDateFormat("dd-MM-yyyy");
					LicenseStartDateKey = line.substring(32, 56);
					LicStartDate = decrypt(key, initVector, LicenseStartDateKey);

					LicenseEndDateKey = line.substring(56, 100);
					LicEndDate = decrypt(key, initVector, LicenseEndDateKey);

					startDate = sdf.parse(LicStartDate);
					currentDate = new Date();
					endDate = new SimpleDateFormat("dd-MM-yyyy HH:mm:ss").parse(LicEndDate);

					int diffInDays = (int) ((endDate.getTime() - currentDate.getTime()) / (1000 * 60 * 60 * 24));

					String fileKeyVal = line.substring(100, line.length());
					String finalKeyVal = decrypt(key, initVector, fileKeyVal);
					String ultimateKeyVal = hsah(URL + finalKeyVal);
					String hsahVal = getHsah(line);

					if (ultimateKeyVal.equals(hsahVal)) {
						if (currentDate.equals(startDate) || currentDate.after(startDate)) {
							if (currentDate.equals(endDate) || currentDate.before(endDate)) {
								if (diffInDays <= 10) {
									String sExecutionDetails = "Your License for URL " + URL + " will expire in "
											+ diffInDays + " days...!!!";
									oFunctionLog.setTestStepDetails(sTestCaseData, "", "", "", "Pass", sUserAction,
											sExecutionDetails, "", ""); // Mantis 0001221
								}
								systemouts("URL:" + URL);
								oDriver.get(URL);
								sComments = "Browser opened with URL :" + URL;
								licenseFlag = true;
								break;
							} else {
								sStepStatus = "Fail";
								NoSuchFieldException e = new NoSuchFieldException("Your License has expired.....!!!!!");
								throw e;
							}
						} else {
							sStepStatus = "Fail";
							NoSuchFieldException e = new NoSuchFieldException(
									"Your License has not been activated yet.....!!!!!");
							throw e;
						}
					}
				}

				line = br.readLine();
			}
			br.close();
			if (licenseFlag == false) {
				sStepStatus = "Fail";
				NoSuchFieldException e = new NoSuchFieldException("Error Code 2:Can Not Proceed Further");
				throw e;
			}
		} else {
			sStepStatus = "Fail";
			NoSuchFieldException e = new NoSuchFieldException("Error Code 1:Can Not Proceed Further");
			throw e;
		}

		/*-------------- Multilicense Check End----------------*/

		// Maximize the browser
		// oDriver.manage().window().maximize(); //Mantis 0000741
		// .get(String) method is used to open a website in Webdriver
		// oDriver.get(URL); //Mantis 0000741
	}

	/*
	 * --------------------------------------- START :
	 * refreshPage---------------------------------------------- Function Name:
	 * refreshPage Objective: A generic function to refresh page. Date Created:
	 * Input: URL = An URL or a path to an application to be opened Output: Revision
	 * History: Modified on: Comments: URL of the application is passed to the
	 * Function.
	 * -----------------------------------------------------------------------------
	 * ----------------------------
	 */

	public void refreshPage() throws IOException, NoSuchAlgorithmException {
		oDriver.navigate().refresh();
	}

	/*
	 * --------------------------------------- START :
	 * getDriver---------------------------------------------- Function Name:
	 * getDriver(Development Purpose only) Objective: A generic function to get the
	 * Driver object Date Created: Input: Output: Revision History: Modified on:
	 * Comments: Returns the driver Object
	 * -----------------------------------------------------------------------------
	 * ----------------------------
	 */
	public WebDriver getDriver() {
		return oDriver;
	}

	/*
	 * --------------------------------------- START :
	 * waitForElement---------------------------------------------- Function Name:
	 * waitForElement Objective: A generic function to get the Driver object Date
	 * Created: Input: Output: Revision History: Created by: Manoj Bamnawat Mantis
	 * ID: 0000879 Modified on: Comments: Wait for the element
	 * -----------------------------------------------------------------------------
	 * ----------------------------
	 */
	public boolean waitForElement(String sSearchCriteria, String sSearchText, int iInd) {
		long StartTime, EndTime, tillWaitTime;
		boolean flag = false;

		StartTime = System.nanoTime() / 1000000000;
		systemouts("Start Time :" + StartTime);

		tillWaitTime = StartTime + lElementWait;
		try // Mantis 0001222
		{
			while ((System.nanoTime() / 1000000000) < tillWaitTime) {
				if (setDriver(sSearchCriteria, sSearchText, iInd)) {
					flag = true;
					break;
				} else
					systemouts("Continue");
			}
		} catch (Exception e) // Mantis 0001222
		{
			System.out.println("Inside waitforElement exeption...!!!");
			e.printStackTrace();
			flag = false;
		}
		EndTime = System.nanoTime() / 1000000000;
		systemouts("End Time :" + EndTime);
		systemouts("Elapsed Time in Seconds:" + Math.round(EndTime - StartTime));

		return flag;
	}

	/*
	 * --------------------------------------- START :
	 * setDriver---------------------------------------------- Function Name:
	 * setDriver Objective: A generic function to set the driver to the frame which
	 * contains the element specified by the parametrs Date Created: Input:
	 * sSearchCriteria = Identifier that uniquely identifies an object on
	 * application; e.g xpath, id etc sSearchText = Value of an Identifier iIndex =
	 * Index of the object in case multiple objects have same text or id Output:
	 * Revision History: Modified by: Heramb Modified on:01,02,03/12/2015 Comments:
	 * Function set the driver by searching an identifier (e.g. xpath) by its value
	 * using property findElement.[findElement(By.xpath(value)] if object is enabled
	 * return true else list the object as webElement and check if it is enabled
	 * return true else return false.
	 * 
	 * Modification comments:'FluentWait' functionality added for waiting to
	 * identify an object or collection of Objects. Added separate wait definitions
	 * for 'pageWait' and 'frameWait'.(Refer Wait Definition on Top) iInd parameter
	 * is no more used but maintained for the sake of function signature.
	 * -----------------------------------------------------------------------------
	 * ----------------------------
	 */
	// Mantis 0000517
	public boolean setDriver(String sSearchCriteria, final String sSearchText, int iInd) throws Exception // Mantis
	// 0001222
	{
		boolean flag = false;
		List<WebElement> lElement;
		// List<WebElement> tagElements;
		FluentWait<WebDriver> wait;

		if (iCurrentContext == 0) {
			wait = pageWait;
		} else {
			wait = frameWait;
		}

		if (Previous_Step_GetRowNo == true) {
			flag = true;
		} else {

			switch (sSearchCriteria.toLowerCase()) {

			case "xpath":
				try {
					if (iIndex == -1) {

						// currElement=wait.until(ExpectedConditions.visibilityOf(oDriver.findElement(By.xpath(sSearchText))));
						wait.until(new Function<WebDriver, WebElement>() {

							public WebElement apply(WebDriver oDriver) {
								return oDriver.findElement(By.xpath(sSearchText));
							}
						});
						// oDriver.findElement(By.xpath(sSearchText)).isEnabled();
						flag = true;
						// debugLog("Object Sync","Object Found");
						return true;
					} else {
						lElement = wait.until(new Function<WebDriver, List<WebElement>>() {
							public List<WebElement> apply(WebDriver oDriver) {
								return oDriver.findElements(By.xpath(sSearchText));
							}
						});
						// lElement = oDriver.findElements(By.xpath(sSearchText));
						if (lElement.size() - 1 >= iIndex) {
							lElement.get(iIndex);
							// lElement.get(iIndex).isEnabled();
							flag = true;
							// debugLog("Object Sync","Object Found");
							return true;
						} else {
							iSkippedElements = iSkippedElements + lElement.size();
							iIndex = iIndex - lElement.size();
							flag = false;
						}
					}
				} catch (NoSuchElementException e) {
					flag = false;
				} catch (TimeoutException t) {
					systemouts("Inside TimeOut Exception"); // Mantis 0001222
					flag = false;
				}
				break;

			case "id":
				try {
					if (iIndex == -1) {

						wait.until(new Function<WebDriver, WebElement>() {
							public WebElement apply(WebDriver oDriver) {
								return oDriver.findElement(By.id(sSearchText));
							}
						});
						// oDriver.findElement(By.id(sSearchText)).isEnabled();
						flag = true;
						return true;
					} else {
						lElement = wait.until(new Function<WebDriver, List<WebElement>>() {
							public List<WebElement> apply(WebDriver oDriver) {
								return oDriver.findElements(By.id(sSearchText));
							}
						});
						// lElement = oDriver.findElements(By.id(sSearchText));
						if (lElement.size() - 1 >= iIndex) {
							lElement.get(iIndex);
							// lElement.get(iIndex).isEnabled();
							flag = true;
							return true;
						} else {
							iSkippedElements = iSkippedElements + lElement.size();
							iIndex = iIndex - lElement.size();
							flag = false;
						}
					}
				} catch (NoSuchElementException e) {
					flag = false;
				} catch (TimeoutException t) {
					systemouts("Inside TimeOut Exception");
					flag = false;
				}
				break;

			case "class":
				try {
					if (iIndex == -1) {
						// currElement=wait.until(ExpectedConditions.visibilityOf(oDriver.findElement(By.className(sSearchText))));
						wait.until(new Function<WebDriver, WebElement>() {
							public WebElement apply(WebDriver oDriver) {
								return oDriver.findElement(By.className(sSearchText));
							}
						});
						// oDriver.findElement(By.className(sSearchText)).isEnabled();
						flag = true;
						// debugLog("Object Sync","Object Found");
						return true;
					} else {
						lElement = wait.until(new Function<WebDriver, List<WebElement>>() {
							public List<WebElement> apply(WebDriver oDriver) {
								return oDriver.findElements(By.className(sSearchText));
							}
						});

						if (lElement.size() - 1 >= iIndex) {
							lElement.get(iIndex);
							flag = true;
							return true;
						} else {
							iSkippedElements = iSkippedElements + lElement.size();
							iIndex = iIndex - lElement.size();
							flag = false;
						}
					}
				} catch (NoSuchElementException e) {
					flag = false;
				} catch (TimeoutException t) {
					flag = false;
				}
				break;

			case "linktext":
				try {
					if (iIndex == -1) {
						wait.until(new Function<WebDriver, WebElement>() {
							public WebElement apply(WebDriver oDriver) {
								return oDriver.findElement(By.linkText(sSearchText));
							}
						});
						flag = true;
						return true;
					} else {
						lElement = wait.until(new Function<WebDriver, List<WebElement>>() {
							public List<WebElement> apply(WebDriver oDriver) {
								return oDriver.findElements(By.linkText(sSearchText));
							}
						});
						// lElement = oDriver.findElements(By.linkText(sSearchText));
						if (lElement.size() - 1 >= iIndex) {
							lElement.get(iIndex);
							// lElement.get(iIndex).isEnabled();
							flag = true;
							// debugLog("Object Sync","Collection of Objects Found");
							return true;
						} else {
							iSkippedElements = iSkippedElements + lElement.size();
							iIndex = iIndex - lElement.size();
							flag = false;
						}
					}
				} catch (NoSuchElementException e) {
					systemouts("Element not found after waiting");
					flag = false;
				} catch (TimeoutException t) {
					systemouts("Timed out waiting");
					flag = false;
				}
				break;

			case "partiallink":

				try {
					if (iIndex == -1) {
						// currElement=wait.until(ExpectedConditions.visibilityOf(oDriver.findElement(By.partialLinkText(sSearchText))));
						wait.until(new Function<WebDriver, WebElement>() {
							public WebElement apply(WebDriver oDriver) {
								return oDriver.findElement(By.partialLinkText(sSearchText));
							}
						});
						// oDriver.findElement(By.partialLinkText(sSearchText)).isEnabled();
						flag = true;
						// debugLog("Object Sync","Object Found");
						return true;
					} else {
						lElement = wait.until(new Function<WebDriver, List<WebElement>>() {
							public List<WebElement> apply(WebDriver oDriver) {
								return oDriver.findElements(By.partialLinkText(sSearchText));
							}
						});
						// lElement = oDriver.findElements(By.partialLinkText(sSearchText));
						if (lElement.size() - 1 >= iIndex) {
							lElement.get(iIndex);
							// lElement.get(iIndex).isEnabled();
							flag = true;
							// debugLog("Object Sync","Object Found");
							return true;
						} else {
							iSkippedElements = iSkippedElements + lElement.size();
							iIndex = iIndex - lElement.size();
							flag = false;
						}
					}
				} catch (NoSuchElementException e) {
					flag = false;
				} catch (TimeoutException t) {
					flag = false;
				}
				break;

			case "name":
				try {
					if (iIndex == -1) {
						// currElement=wait.until(ExpectedConditions.visibilityOf(oDriver.findElement(By.name(sSearchText))));
						wait.until(new Function<WebDriver, WebElement>() {
							public WebElement apply(WebDriver oDriver) {
								return oDriver.findElement(By.name(sSearchText));
							}
						});
						// oDriver.findElement(By.name(sSearchText)).isEnabled();
						flag = true;
						// debugLog("Object Sync","Object Found");
						return true;
					} else {
						lElement = wait.until(new Function<WebDriver, List<WebElement>>() {

							public List<WebElement> apply(WebDriver oDriver) {
								return oDriver.findElements(By.name(sSearchText));
							}
						});
						if (lElement.size() - 1 >= iIndex) {
							lElement.get(iIndex);
							flag = true;
							// debugLog("Object Sync","Object Found");
							return true;
						} else {
							iSkippedElements = iSkippedElements + lElement.size();
							iIndex = iIndex - lElement.size();
							flag = false;
						}
					}
				} catch (NoSuchElementException e) {
					flag = false;
				} catch (TimeoutException t) {
					flag = false;
				}
				break;
			case "css":
				try {
					if (iIndex == -1) {
						wait.until(new Function<WebDriver, WebElement>() {
							public WebElement apply(WebDriver oDriver) {
								return oDriver.findElement(By.cssSelector(sSearchText));
							}
						});
						// oDriver.findElement(By.cssSelector(sSearchText)).isEnabled();
						flag = true;
						// debugLog("Object Sync","Object Found");
						return true;
					} else {
						lElement = wait.until(new Function<WebDriver, List<WebElement>>() {
							public List<WebElement> apply(WebDriver oDriver) {
								return oDriver.findElements(By.cssSelector(sSearchText));
							}
						});
						// lElement = oDriver.findElements(By.cssSelector(sSearchText));
						if (lElement.size() - 1 >= iIndex) {
							lElement.get(iIndex);
							// lElement.get(iIndex).isEnabled();
							flag = true;
							// debugLog("Object Sync","Object Found");
							return true;
						} else {
							iSkippedElements = iSkippedElements + lElement.size();
							iIndex = iIndex - lElement.size();
							flag = false;
						}
					}
				} catch (NoSuchElementException e) {
					flag = false;
				} catch (TimeoutException t) {
					flag = false;
				}
				break;

			case "tag":
				try {
					if (iIndex == -1) {
						// currElement=wait.until(ExpectedConditions.visibilityOf(oDriver.findElement(By.tagName(sSearchText))));
						wait.until(new Function<WebDriver, WebElement>() {
							public WebElement apply(WebDriver oDriver) {
								return oDriver.findElement(By.tagName(sSearchText));
							}
						});
						flag = true;
						// debugLog("Object Sync","Object Found");
						return true;
					} else {
						lElement = wait.until(new Function<WebDriver, List<WebElement>>() {
							public List<WebElement> apply(WebDriver oDriver) {
								return oDriver.findElements(By.tagName(sSearchText));
							}
						});
						if (lElement.size() - 1 >= iIndex) {
							lElement.get(iIndex);
							// lElement.get(iIndex).isEnabled();
							flag = true;
							// debugLog("Object Sync","Object Found");
							return true;
						} else {
							iSkippedElements = iSkippedElements + lElement.size();
							iIndex = iIndex - lElement.size();
							flag = false;
						}
					}
				} catch (NoSuchElementException e) {
					flag = false;
				} catch (TimeoutException t) {
					flag = false;
				}
				break;

			case "span": // Mantis 0000684
				try {
					lElement = wait.until(new Function<WebDriver, List<WebElement>>() {
						public List<WebElement> apply(WebDriver oDriver) {
							return oDriver.findElements(By.tagName("span"));
						}
					});

					if (lElement.size() - 1 >= iIndex) {
						for (int k = 0; k < lElement.size(); k++) {
							if (lElement.get(k).getText().equals(sSearchText)) {
								lElement.get(k);
								flag = true;
								break;
							}
						}

						if (flag == true) {
							return true;
						}
					}

					else {
						iSkippedElements = iSkippedElements + lElement.size();
						iIndex = iIndex - lElement.size();
						flag = false;
					}
				} catch (NoSuchElementException e) {
					flag = false;
				} catch (TimeoutException t) {
					flag = false;
				}
				break;

			case "label":
				try {
					lElement = wait.until(new Function<WebDriver, List<WebElement>>() {
						public List<WebElement> apply(WebDriver oDriver) {
							return oDriver.findElements(By.tagName("label"));
						}
					});
					for (int i = 0; i < lElement.size(); i++) {
						String sTextOnLabel = lElement.get(i).getText();
						if (sTextOnLabel.equals(sSearchText)) {
							iCountOfLabels++;

						}
					}
					if (iIndex == -1) {
						if (iCountOfLabels == 1) {
							flag = true;
							return true;
						} else {
							flag = false;
						}
					} else {
						if (iCountOfLabels - 1 >= iIndex) {
							flag = true;
							return true;
						} else {
							iSkippedElements = iSkippedElements + iCountOfLabels;
							iIndex = iIndex - iCountOfLabels;
							flag = false;
						}
					}

				} catch (NoSuchElementException e) {
					flag = false;
				} catch (TimeoutException t) {
					flag = false;
				}
				break;

				// Throw a user defined exception
			default:
				NoSuchTagException e = new NoSuchTagException(sSearchCriteria);
				throw e;
			}
			iCurrentContext++;

			/*
			 * if(flag==true) { searchInFrameFlag=false;
			 * systemouts("Element Found..."+searchInFrameFlag); }
			 */
			if (flag == false) {
				// searchInFrameFlag=true;
				try {

					if (iCurrentContext == 1) {
						setDefaultContent();
						iIndex = iInd;
						iSkippedElements = 0;
						flag = setDriver(sSearchCriteria, sSearchText, iInd);
					} else {
						int frameSize = oDriver.findElements(By.tagName("frame")).size();
						int iframeSize = oDriver.findElements(By.tagName("iframe")).size();
						int totalframes = frameSize + iframeSize;
						systemouts("Total Frames: " + totalframes); // Need to remove this sysout.
						for (int i = 0; i < totalframes; i++) {
							oDriver.switchTo().frame(i);
							flag = setDriver(sSearchCriteria, sSearchText, iIndex);
							if (flag == true) {
								break;
							} else {
								oDriver.switchTo().parentFrame();
							}
						}
						// searchInFrameFlag=false;
					}
				} catch (NoSuchFrameException e) {
					oDriver.switchTo().parentFrame();
					return false;
				}
			}
		}
		if (flag == false) {
			return false;
		} else
			return true;

	}

	/*-----Manoj xxx-----*/
	public boolean setFrame(String sSearchCriteria, final String sSearchText, int iInd, String sFrameName)
			throws NoSuchTagException, InterruptedException {

		boolean flag = false, status = false;

		List<WebElement> lElement;
		FluentWait<WebDriver> wait = null;

		if (iCurrentContext == 0) {
			wait = pageWait; // Mantis 0000864

			try {
				setDefaultContent();
				wait.until(new Function<WebDriver, WebElement>() {

					public WebElement apply(WebDriver oDriver) {
						return oDriver.findElement(By.name(sFrameName));
					}
				});

				status = true;

			} catch (Exception e) {
				status = false;
			}
			if (status == true) {
				oDriver.switchTo().frame(sFrameName);
				systemouts("Switched to frame");
			}

		}
		wait = frameWait; // Mantis 0000864

		switch (sSearchCriteria.toLowerCase()) {

		case "xpath":
			try {
				if (iIndex == -1) {
					
					WebElement element = wait.until(new Function<WebDriver, WebElement>() {

						public WebElement apply(WebDriver oDriver) {
							return oDriver.findElement(By.xpath(sSearchText));
						}
					});
					flag = true;
					
					oDriver.switchTo().frame(element);
					
					return true;
				} else {
					lElement = wait.until(new Function<WebDriver, List<WebElement>>() {
						public List<WebElement> apply(WebDriver oDriver) {
							return oDriver.findElements(By.xpath(sSearchText));
						}
					});

					if (lElement.size() - 1 >= iIndex) {
						lElement.get(iIndex);
						flag = true;
						return true;
					} else {
						iSkippedElements = iSkippedElements + lElement.size();
						iIndex = iIndex - lElement.size();
						flag = false;
					}
				}
			} catch (NoSuchElementException e) {
				flag = false;
			} catch (TimeoutException t) {
				flag = false;
			}
			break;

		case "id":
			try {
				if (iIndex == -1) {

					wait.until(new Function<WebDriver, WebElement>() {
						public WebElement apply(WebDriver oDriver) {
							return oDriver.findElement(By.id(sSearchText));
						}
					});
					flag = true;
					return true;
				} else {
					lElement = wait.until(new Function<WebDriver, List<WebElement>>() {
						public List<WebElement> apply(WebDriver oDriver) {
							return oDriver.findElements(By.id(sSearchText));
						}
					});

					if (lElement.size() - 1 >= iIndex) {
						lElement.get(iIndex);
						flag = true;
						return true;
					} else {
						iSkippedElements = iSkippedElements + lElement.size();
						iIndex = iIndex - lElement.size();
						flag = false;
					}
				}
			} catch (NoSuchElementException e) {
				flag = false;
			} catch (TimeoutException t) {
				systemouts("Inside TimeOut Exception");
				flag = false;
			}
			break;

		case "class":
			try {
				if (iIndex == -1) {
					wait.until(new Function<WebDriver, WebElement>() {
						public WebElement apply(WebDriver oDriver) {
							return oDriver.findElement(By.className(sSearchText));
						}
					});
					flag = true;
					return true;
				} else {
					lElement = wait.until(new Function<WebDriver, List<WebElement>>() {
						public List<WebElement> apply(WebDriver oDriver) {
							return oDriver.findElements(By.className(sSearchText));
						}
					});

					if (lElement.size() - 1 >= iIndex) {
						lElement.get(iIndex);
						flag = true;
						return true;
					} else {
						iSkippedElements = iSkippedElements + lElement.size();
						iIndex = iIndex - lElement.size();
						flag = false;
					}
				}
			} catch (NoSuchElementException e) {
				flag = false;
			} catch (TimeoutException t) {
				flag = false;
			}
			break;

		case "linktext":
			try {
				if (iIndex == -1) {
					wait.until(new Function<WebDriver, WebElement>() {
						public WebElement apply(WebDriver oDriver) {
							return oDriver.findElement(By.linkText(sSearchText));
						}
					});
					flag = true;
					return true;
				} else {
					lElement = wait.until(new Function<WebDriver, List<WebElement>>() {
						public List<WebElement> apply(WebDriver oDriver) {
							return oDriver.findElements(By.linkText(sSearchText));
						}
					});
					if (lElement.size() - 1 >= iIndex) {
						lElement.get(iIndex);
						flag = true;
						return true;
					} else {
						iSkippedElements = iSkippedElements + lElement.size();
						iIndex = iIndex - lElement.size();
						flag = false;
					}
				}
			} catch (NoSuchElementException e) {
				systemouts("Element not found after waiting");
				flag = false;
			} catch (TimeoutException t) {
				systemouts("Timed out waiting");
				flag = false;
			}
			break;

		case "partiallink":

			try {
				if (iIndex == -1) {
					// currElement=wait.until(ExpectedConditions.visibilityOf(oDriver.findElement(By.partialLinkText(sSearchText))));
					wait.until(new Function<WebDriver, WebElement>() {
						public WebElement apply(WebDriver oDriver) {
							return oDriver.findElement(By.partialLinkText(sSearchText));
						}
					});
					// oDriver.findElement(By.partialLinkText(sSearchText)).isEnabled();
					flag = true;
					// debugLog("Object Sync","Object Found");
					return true;
				} else {
					lElement = wait.until(new Function<WebDriver, List<WebElement>>() {
						public List<WebElement> apply(WebDriver oDriver) {
							return oDriver.findElements(By.partialLinkText(sSearchText));
						}
					});
					// lElement = oDriver.findElements(By.partialLinkText(sSearchText));
					if (lElement.size() - 1 >= iIndex) {
						lElement.get(iIndex);
						// lElement.get(iIndex).isEnabled();
						flag = true;
						// debugLog("Object Sync","Object Found");
						return true;
					} else {
						iSkippedElements = iSkippedElements + lElement.size();
						iIndex = iIndex - lElement.size();
						flag = false;
					}
				}
			} catch (NoSuchElementException e) {
				flag = false;
			} catch (TimeoutException t) {
				flag = false;
			}
			break;

		case "name":
			try {
				if (iIndex == -1) {
					// currElement=wait.until(ExpectedConditions.visibilityOf(oDriver.findElement(By.name(sSearchText))));
					wait.until(new Function<WebDriver, WebElement>() {
						public WebElement apply(WebDriver oDriver) {
							return oDriver.findElement(By.name(sSearchText));
						}
					});
					// oDriver.findElement(By.name(sSearchText)).isEnabled();
					flag = true;
					// debugLog("Object Sync","Object Found");
					return true;
				} else {
					lElement = wait.until(new Function<WebDriver, List<WebElement>>() {

						public List<WebElement> apply(WebDriver oDriver) {
							return oDriver.findElements(By.name(sSearchText));
						}
					});
					if (lElement.size() - 1 >= iIndex) {
						lElement.get(iIndex);
						flag = true;
						// debugLog("Object Sync","Object Found");
						return true;
					} else {
						iSkippedElements = iSkippedElements + lElement.size();
						iIndex = iIndex - lElement.size();
						flag = false;
					}
				}
			} catch (NoSuchElementException e) {
				flag = false;
			} catch (TimeoutException t) {
				flag = false;
			}
			break;
		case "css":
			try {
				if (iIndex == -1) {
					wait.until(new Function<WebDriver, WebElement>() {
						public WebElement apply(WebDriver oDriver) {
							return oDriver.findElement(By.cssSelector(sSearchText));
						}
					});
					// oDriver.findElement(By.cssSelector(sSearchText)).isEnabled();
					flag = true;
					// debugLog("Object Sync","Object Found");
					return true;
				} else {
					lElement = wait.until(new Function<WebDriver, List<WebElement>>() {
						public List<WebElement> apply(WebDriver oDriver) {
							return oDriver.findElements(By.cssSelector(sSearchText));
						}
					});
					// lElement = oDriver.findElements(By.cssSelector(sSearchText));
					if (lElement.size() - 1 >= iIndex) {
						lElement.get(iIndex);
						// lElement.get(iIndex).isEnabled();
						flag = true;
						// debugLog("Object Sync","Object Found");
						return true;
					} else {
						iSkippedElements = iSkippedElements + lElement.size();
						iIndex = iIndex - lElement.size();
						flag = false;
					}
				}
			} catch (NoSuchElementException e) {
				flag = false;
			} catch (TimeoutException t) {
				flag = false;
			}
			break;

		case "tag":
			try {
				if (iIndex == -1) {
					// currElement=wait.until(ExpectedConditions.visibilityOf(oDriver.findElement(By.tagName(sSearchText))));
					wait.until(new Function<WebDriver, WebElement>() {
						public WebElement apply(WebDriver oDriver) {
							return oDriver.findElement(By.tagName(sSearchText));
						}
					});
					flag = true;
					// debugLog("Object Sync","Object Found");
					return true;
				} else {
					lElement = wait.until(new Function<WebDriver, List<WebElement>>() {
						public List<WebElement> apply(WebDriver oDriver) {
							return oDriver.findElements(By.tagName(sSearchText));
						}
					});
					if (lElement.size() - 1 >= iIndex) {
						lElement.get(iIndex);
						// lElement.get(iIndex).isEnabled();
						flag = true;
						// debugLog("Object Sync","Object Found");
						return true;
					} else {
						iSkippedElements = iSkippedElements + lElement.size();
						iIndex = iIndex - lElement.size();
						flag = false;
					}
				}
			} catch (NoSuchElementException e) {
				flag = false;
			} catch (TimeoutException t) {
				flag = false;
			}
			break;

		case "span": // Mantis 0000684
			try {
				lElement = wait.until(new Function<WebDriver, List<WebElement>>() {
					public List<WebElement> apply(WebDriver oDriver) {
						return oDriver.findElements(By.tagName("span"));
					}
				});

				if (lElement.size() - 1 >= iIndex) {
					for (int k = 0; k < lElement.size(); k++) {
						if (lElement.get(k).getText().equals(sSearchText)) {
							lElement.get(k);
							flag = true;
							break;
						}
					}

					if (flag == true) {
						return true;
					}
				}

				else {
					iSkippedElements = iSkippedElements + lElement.size();
					iIndex = iIndex - lElement.size();
					flag = false;
				}
			} catch (NoSuchElementException e) {
				flag = false;
			} catch (TimeoutException t) {
				flag = false;
			}
			break;

		case "label":
			try {
				lElement = wait.until(new Function<WebDriver, List<WebElement>>() {
					public List<WebElement> apply(WebDriver oDriver) {
						return oDriver.findElements(By.tagName("label"));
					}
				});
				for (int i = 0; i < lElement.size(); i++) {
					String sTextOnLabel = lElement.get(i).getText();
					if (sTextOnLabel.equals(sSearchText)) {
						iCountOfLabels++;

					}
				}
				if (iIndex == -1) {
					if (iCountOfLabels == 1) {
						flag = true;
						return true;
					} else {
						flag = false;
					}
				} else {
					if (iCountOfLabels - 1 >= iIndex) {
						flag = true;
						return true;
					} else {
						iSkippedElements = iSkippedElements + iCountOfLabels;
						iIndex = iIndex - iCountOfLabels;
						flag = false;
					}
				}

			} catch (NoSuchElementException e) {
				flag = false;
			} catch (TimeoutException t) {
				flag = false;
			}
			break;

			// Throw a user defined exception
		default:
			NoSuchTagException e = new NoSuchTagException(sSearchCriteria);
			throw e;
		}
		iCurrentContext++;

		if (flag == false) {
			try {

				if (iCurrentContext != 0) {
					List<WebElement> frameElement = oDriver.findElements(By.tagName("frame"));
					int frameSize = frameElement.size();
					List<WebElement> iFrameElement = oDriver.findElements(By.tagName("iframe"));
					int iframeSize = iFrameElement.size();
					frameElement.addAll(iFrameElement);
					systemouts("Total Frames : " + frameElement.size());
					int totalframes = frameSize + iframeSize;
					systemouts("totalframes : " + totalframes);
					for (int i = 0; i < totalframes; i++) {
						String FrameName = frameElement.get(i).getAttribute("name");
						systemouts("iFrame Name : " + FrameName);
						// wait1.until(ExpectedConditions.frameToBeAvailableAndSwitchToIt(frameElement.get(i)));
						oDriver.switchTo().frame(frameElement.get(i));
						flag = setFrame(sSearchCriteria, sSearchText, iIndex, FrameName);
						if (flag == true) {
							break;
						} else {
							oDriver.switchTo().parentFrame();
						}
					}

				}
			} catch (NoSuchFrameException e) {
				oDriver.switchTo().parentFrame();
				return false;
			}
		}

		if (flag == false) {
			return false;
		} else
			return true;

	}

	/*-----Manoj xxx-----*/

	/*
	 * --------------------------------------- START :
	 * getActiveElement---------------------------------------------- Function Name:
	 * getActiveElement Objective: A generic function to get the instance of element
	 * on the webpage which is active or which has the focus Date Created: 27/8/2015
	 * Input:
	 * 
	 * Output: modified by: devang Revision History:31/7/2015 Modified on: comments:
	 * -----------------------------------------------------------------------------
	 * ----------------------------
	 */

	WebElement getActiveElement() {
		WebElement cur = oDriver.switchTo().activeElement();
		if (cur.getTagName().equalsIgnoreCase("frame") || cur.getTagName().equalsIgnoreCase("iframe")
				|| cur.getTagName().equalsIgnoreCase("body")) {
			// not the element
			List<WebElement> lFrames = oDriver.findElements(By.tagName("iframe"));
			if (lFrames.size() == 0) {
				lFrames = oDriver.findElements(By.tagName("frame"));
				if (lFrames.size() == 0) {
					oDriver.switchTo().parentFrame();
					cur = oDriver.switchTo().activeElement();
					return cur;
				}
			}
			int i;
			for (i = 0; i < lFrames.size(); i++) {
				oDriver.switchTo().frame(i);
				cur = getActiveElement();
				if (cur.getTagName().equalsIgnoreCase("frame") || cur.getTagName().equalsIgnoreCase("iframe")
						|| cur.getTagName().equalsIgnoreCase("body")) {

				} else {
					return cur;
				}
			}
			if (i == lFrames.size()) {
				oDriver.switchTo().parentFrame();
				cur = oDriver.switchTo().activeElement();
			}

		} else {
			// got the element
			return cur;
		}
		// }
		/*
		 * catch(NoSuchFrameException e) { oDriver.switchTo().parentFrame();
		 * cur=oDriver.switchTo().activeElement(); systemouts("Out in catch"); return
		 * cur; }
		 */
		return cur;
	}

	/*
	 * --------------------------------------- START :
	 * click---------------------------------------------- Function Name: click
	 * Objective: A generic function to click on an object on application Date
	 * Created: Input: sSearchCriteria = Identifier that uniquely identifies an
	 * object on application; e.g xpath, id etc sSearchText = Value of an Identifier
	 * iInd = Index of the object in case multiple objects have same text or id
	 * Output: modified by: Heramb Revision History:31/7/2015, 06/01/2016 Modified
	 * on: sikuli code added Comments: Search object with function SetDriver ,
	 * if(objectFound) get the object by calling getElement function and perform the
	 * action Click on it else exception element search failed. - Stale element
	 * issue is handled by using repeated calls to identify the object under
	 * consideration
	 * -----------------------------------------------------------------------------
	 * ----------------------------
	 */
	// Mantis 0000517
	public void click(String sControlType, String sSearchCriteria, String sSearchText, int iInd) throws Exception {
		WebElement oCurrentElement = null;
		int i = 0;
		// Mantis 1758
		/*
		 * if(sSearchCriteria.toLowerCase().equals("image")){ //Mantis 0000772 Region r=
		 * findImage(sSearchText); if(r!=null) r.click();
		 * 
		 * }
		 * 
		 * else
		 */
		// Mantis 1758
		if (waitForElement(sSearchCriteria, sSearchText, iInd)) // Mantis 0000772,0000879
		{
			while (oCurrentElement == null && i < iStaleMaxCount) {
				oCurrentElement = funStaleClick(sSearchCriteria, sSearchText, iInd);
				i++;
			}
			if (i == iStaleMaxCount) {
				NoSuchElementException e = new NoSuchElementException("Element search failed with method: \""
						+ sSearchCriteria + "\"  and search Criteria: \"" + sSearchText + "\"");
				throw e;
			}
		} else {
			NoSuchElementException e = new NoSuchElementException("Element search failed with method: \""
					+ sSearchCriteria + "\"  and search Criteria: \"" + sSearchText + "\"");
			throw e;
		}

		try {
			/*
			 * getExcelNextRow(sTestCaseExcelPath);
			 * if(sNextRowControlType.toLowerCase().equalsIgnoreCase("alert") ||
			 * sNextRowUserAction.toLowerCase().equalsIgnoreCase("accept") ||
			 * sNextRowUserAction.toLowerCase().equalsIgnoreCase("decline") ||
			 * sNextRowUserAction.toLowerCase().equalsIgnoreCase("alerttext") ||
			 * sNextRowUserAction.toLowerCase().equalsIgnoreCase("optionalalert")) {
			 * 
			 * } else { //setDefaultContent(); }
			 */
		} catch (NoSuchWindowException e) {

		}

	}

	// Mantis 0000700
	public void optionalClick(String sControlType, String sSearchCriteria, String sSearchText, int iInd)
			throws Exception // Mantis 0000879
	{

		WebElement oCurrentElement = null;
		int i = 0;
		if (waitForElement(sSearchCriteria, sSearchText, iInd)) // Mantis 0000879
		{
			while (oCurrentElement == null && i < iStaleMaxCount) {
				oCurrentElement = funStaleClick(sSearchCriteria, sSearchText, iInd);
				i++;
			}
			if (i == iStaleMaxCount) {
				NoSuchElementException e = new NoSuchElementException("Element search failed with method: \""
						+ sSearchCriteria + "\"  and search Criteria: \"" + sSearchText + "\"");
				throw e;
			}
		} else {
			debugLog("Optional Click",
					"Object not found ignoring:" + sSearchCriteria + ":" + sSearchText + ":" + "Index:" + iInd);
		}

	}

	/*
	 * --------------------------------------- START :
	 * clear---------------------------------------------- Function Name: clear
	 * Objective: A generic function to clear text on an object on application Date
	 * Created: 01/13/2016 Created By:Heramb Input: sSearchCriteria = Identifier
	 * that uniquely identifies an object on application; e.g xpath, id etc
	 * sSearchText = Value of an Identifier iInd = Index of the object in case
	 * multiple objects have same text or id Output: modified by: Revision History:
	 * Modified on: Comments: Search object with function SetDriver ,
	 * if(objectFound) get the object by calling getElement function and perform the
	 * action Clear on it else exception element search failed.
	 * -----------------------------------------------------------------------------
	 * ----------------------------
	 */

	public void clear(String sControlType, String sSearchCriteria, String sSearchText, int iInd) throws Exception // Mantis
	// 0000879
	{
		WebElement oCurrentElement = null;
		int i = 0;
		if (waitForElement(sSearchCriteria, sSearchText, iInd)) // Mantis 0000879
		{
			while (oCurrentElement == null && i < iStaleMaxCount) {
				oCurrentElement = funStaleClear(sSearchCriteria, sSearchText, iInd);
				i++;
			}
			debugLog("Object Sync", "Clear Operation Complete");
		} else {
			NoSuchElementException e = new NoSuchElementException("Element search failed with method: \""
					+ sSearchCriteria + "\"  and search Criteria: \"" + sSearchText + "\"");
			throw e;
		}

		try {
			/*
			 * getExcelNextRow(sTestCaseExcelPath);
			 * if(sNextRowControlType.toLowerCase().equalsIgnoreCase("alert") ||
			 * sNextRowUserAction.toLowerCase().equalsIgnoreCase("accept") ||
			 * sNextRowUserAction.toLowerCase().equalsIgnoreCase("decline") ||
			 * sNextRowUserAction.toLowerCase().equalsIgnoreCase("alerttext") ||
			 * sNextRowUserAction.toLowerCase().equalsIgnoreCase("optionalalert")) {
			 * 
			 * } else { //setDefaultContent(); }
			 */
		} catch (NoSuchWindowException e) {

		}
	}

	/*
	 * --------------------------------------- START
	 * :searchUsingLabel---------------------------------------------- Function
	 * Name: searchUsingLabel Objective: To search form filling control (EditBox,
	 * ListBox etc.) using corresponding Label Name and send the test data to it.
	 * Date Created: 29/02/2016 Created By: Heramb Input: sSearchCriteria =
	 * Identifier that uniquely identifies an object on application; e.g xpath, id
	 * etc sSearchText = Value of an Identifier iInd = Index of the object in case
	 * multiple objects have same text or id sData=Test data Output: Modified by:
	 * Revision History: Modified on: Comments:
	 * -----------------------------------------------------------------------------
	 * ----------------------------
	 */
	public void searchUsingLabel(String sControlType, String sSearchCriteria, String sSearchText, int iInd,
			String sData) throws Exception {
		List<WebElement> listLabels = null;

		if (waitForElement(sSearchCriteria, sSearchText, iInd)) // Mantis 0000879
		{
			iInd = iInd - iSkippedElements;

			listLabels = oDriver.findElements(By.tagName(sSearchCriteria));
			for (int i = 0; i < listLabels.size(); i++) {
				debugLog("Identifcation using Label", "Searching Labels");
				String sTextOnLabel = listLabels.get(i).getText();
				if (sTextOnLabel.equals(sSearchText)) {
					if (iInd == -1 || iInd == 0) {
						debugLog("Identifcation using Label", "Label Found");
						String forProperty = listLabels.get(i).getAttribute("for");
						set(sControlType, "id", forProperty, sData, 0);
						debugLog("Identifcation using Label", "Data sent to the corresponding control");
					} else
						iInd--;
				}
			}

		} else {
			NoSuchElementException e = new NoSuchElementException("Element search failed with method: \""
					+ sSearchCriteria + "\"  and search Criteria: \"" + sSearchText + "\"");
			throw e;
		}
	}

	/*
	 * --------------------------------------- START :
	 * rightclick---------------------------------------------- Function Name: click
	 * Objective: A generic function to right click on an object on application Date
	 * Created: 17/12/2015 Created By: Heramb Input: sSearchCriteria = Identifier
	 * that uniquely identifies an object on application; e.g xpath, id etc
	 * sSearchText = Value of an Identifier iInd = Index of the object in case
	 * multiple objects have same text or id Output: Modified by: Revision History:
	 * Modified on: Comments: Search object with function SetDriver ,
	 * if(objectFound) get the object by calling getElement function and perform the
	 * action Right Click on it else exception element search failed.
	 * -----------------------------------------------------------------------------
	 * ----------------------------
	 */
	public void rightclick(String sControlType, String sSearchCriteria, String sSearchText, int iInd) throws Exception // Mantis
	// 0000879
	{
		if (waitForElement(sSearchCriteria, sSearchText, iInd)) // Mantis 0000879
		{
			WebElement oCurrentElement = getElement(sControlType, sSearchCriteria, sSearchText, iInd);
			Actions action = new Actions(oDriver);
			action.contextClick(oCurrentElement);
			action.build().perform();
			try {
				Thread.sleep(3000);
			} catch (InterruptedException e) {
				e.printStackTrace();
			}

		} else {
			NoSuchElementException e = new NoSuchElementException("Element search failed with method: \""
					+ sSearchCriteria + "\"  and search Criteria: \"" + sSearchText + "\"");
			throw e;
		}
		// setDefaultContent();
	}

	/*
	 * --------------------------------------- START :
	 * doubleClick---------------------------------------------- Function Name:
	 * doubleClick Objective: A generic function to doubleClick on an object on
	 * application Date Created: Input: sSearchCriteria = Identifier that uniquely
	 * identifies an object on application; e.g xpath, id etc sSearchText = Value of
	 * an Identifier iInd = Index of the object in case multiple objects have same
	 * text or id Output: modified by: devang Revision History:31/7/2015 Modified
	 * on: sikuli code added Comments: Search object with function SetDriver ,
	 * if(objectFound) get the object by calling getElement function and perform the
	 * action Click on it else exception element search failed.
	 * -----------------------------------------------------------------------------
	 * ----------------------------
	 */
	public void doubleClick(String sControlType, String sSearchCriteria, String sSearchText, int iInd) throws Exception // Mantis
	// 0000879
	{
		if (waitForElement(sSearchCriteria, sSearchText, iInd)) // Mantis 0000879
		{
			WebElement oCurrentElement = getElement(sControlType, sSearchCriteria, sSearchText, iInd);
			oCurrentElement.click();

			Actions action = new Actions(oDriver);
			action.doubleClick(oCurrentElement).perform();
		} else {
			NoSuchElementException e = new NoSuchElementException("Element search failed with method: \""
					+ sSearchCriteria + "\"  and search Criteria: \"" + sSearchText + "\"");
			throw e;
		}
		try {
			// setDefaultContent();
		} catch (NoSuchWindowException e) {

		}
	}

	/*
	 * --------------------------------------- START :
	 * setDefaultContent---------------------------------------------- Function
	 * Name: setDefaultContent Objective: A generic function to switch back to the
	 * HTM document by coming out from the frames Date Created: 15-jul-2015 Input:
	 * Output: Revision History: Modified on: Comments:
	 * -----------------------------------------------------------------------------
	 * ----------------------------
	 */

	void setDefaultContent() {
		try {
			oDriver.switchTo().defaultContent();
		} catch (NoSuchWindowException e) {

		} catch (UnhandledAlertException e) {
		}
	}
	/*
	 * --------------------------------------- START :
	 * getElement---------------------------------------------- Function Name:
	 * getElement Objective: A generic function to get an object of element required
	 * Date Created: Input: sSearchCriteria = Identifier that uniquely identifies an
	 * object on application; e.g xpath, id etc sSearchText = Value of an Identifier
	 * iInd = Index of the object in case multiple objects have same text or id
	 * Output: Revision History: Modified on: Comments: Element is searched by
	 * identifier at index = -1 if found element is the current element else the
	 * current element is searched for the specified index. Also a debug log is
	 * maintained depicting object sync, object Found.
	 * -----------------------------------------------------------------------------
	 * ----------------------------
	 */

	// Mantis 0000517
	public WebElement getElement(String sControlType, String sSearchCriteria, String sSearchText, int iInd)
			throws NoSuchTagException {
		WebElement oCurrentElement;
		iInd = iInd - iSkippedElements;
		List<WebElement> oCurrentElements = null;
		// oCurrentElement=null;
		oCurrentElement = null;

		switch (sSearchCriteria.toLowerCase()) {
		case "xpath":
			if (iInd == -1) {
				oCurrentElement = oDriver.findElement(By.xpath(sSearchText));
			} else {
				oCurrentElements = oDriver.findElements(By.xpath(sSearchText));
				oCurrentElement = oCurrentElements.get((iInd));
			}
			break;
		case "id":

			if (iInd == -1) {
				oCurrentElement = oDriver.findElement(By.id(sSearchText));
			} else {
				oCurrentElements = oDriver.findElements(By.id(sSearchText));
				oCurrentElement = oCurrentElements.get((iInd));
			}
			break;
		case "class":
			if (iInd == -1) {
				oCurrentElement = oDriver.findElement(By.className(sSearchText));

			} else {
				oCurrentElements = oDriver.findElements(By.className(sSearchText));

				oCurrentElement = oCurrentElements.get((iInd));

			}
			break;
		case "linktext":
			if (iInd == -1) {

				oCurrentElement = oDriver.findElement(By.linkText(sSearchText));
			} else {
				oCurrentElements = oDriver.findElements(By.linkText(sSearchText));
				oCurrentElement = oCurrentElements.get((iInd));
			}
			break;
		case "partiallink":

			if (iInd == -1) {
				oCurrentElement = oDriver.findElement(By.partialLinkText(sSearchText));
			} else {
				oCurrentElements = oDriver.findElements(By.partialLinkText(sSearchText));
				oCurrentElement = oCurrentElements.get((iInd));
			}
			break;
		case "name":
			if (iInd == -1) {
				oCurrentElement = oDriver.findElement(By.name(sSearchText));
			} else {
				oCurrentElements = oDriver.findElements(By.name(sSearchText));
				oCurrentElement = oCurrentElements.get((iInd));
			}
			break;
		case "css":

			if (iInd == -1) {
				oCurrentElement = oDriver.findElement(By.cssSelector(sSearchText));
			} else {
				oCurrentElements = oDriver.findElements(By.cssSelector(sSearchText));
				oCurrentElement = oCurrentElements.get((iInd));
			}
			break;
		case "tag":

			if (iInd == -1) {
				oCurrentElement = oDriver.findElement(By.tagName(sSearchText));
			} else {
				oCurrentElements = oDriver.findElements(By.tagName(sSearchText));
				oCurrentElement = oCurrentElements.get((iInd));
			}
			break;

			// Mantis 0000684
		case "span":

			oCurrentElements = oDriver.findElements(By.tagName("SPAN"));
			for (int k = 0; k < oCurrentElements.size(); k++) {
				if (oCurrentElements.get(k).getText().equals(sSearchText)) {
					oCurrentElement = oCurrentElements.get(k);
					break;
				}
			}

			break;

			// Throw a user defined exception
		default:
			NoSuchTagException e = new NoSuchTagException(sSearchCriteria);
			throw e;
			// }
		}
		// debugLog("Object Sync","Object Found"); //Mantis 0000422
		return oCurrentElement;
	}

	/*
	 * --------------------------------------- START :
	 * set---------------------------------------------- Function Name: set
	 * Objective: A generic Function to set a value in an object on application Date
	 * Created: Input: sControlType = Type of Control; e.g webEdit, webList etc.
	 * sSearchCriteria = Identifier that uniquely identifies an object on
	 * application; e.g xpath, id etc sSearchText = Value of an Identifier iInd =
	 * Index of the object in case multiple objects have same text or id sData =
	 * Data to be set Output: revision by: Heramb Revision History:Added code for
	 * sikuli Added code to handle Stale Elements Modified on:31/7/2015, 12/01/2016,
	 * 06/01/2016 Comments: Search object with function SetDriver , if(objectFound)
	 * get the object by calling getElement function , if (element is not null) get
	 * the case for the control type(e.g. webEdit, webCheckbox , etc.) and perform
	 * the required action and set the data Else exception Element search failed. -
	 * Stale element issue is handled by using repeated calls to identify the object
	 * under consideration
	 * -----------------------------------------------------------------------------
	 * ----------------------------
	 */
	// Mantis 0000517
	public void set(String sControlType, String sSearchCriteria, String sSearchText, String sData, int iInd)
			throws Exception {
		// Mantis 1758
		/*
		 * if(sSearchCriteria.toLowerCase().equals("image")) //Mantis 0000772 {
		 * currentRegion= findImage(sSearchText);
		 * 
		 * } else
		 */
		if (waitForElement(sSearchCriteria, sSearchText, iInd)) // Mantis 0000772,0000879
		{
			int i = 0;
			WebElement oCurrentElement = null;

			switch (sControlType.toLowerCase().trim()) {
			case "webedit":
				oCurrentElement = null;
				while (oCurrentElement == null && i < iStaleMaxCount) {
					oCurrentElement = funStaleSendKeys(sSearchCriteria, sSearchText, iInd, sData);
					i++; // Mantis 0000842
				}
				debugLog("ObjectSync", "Edit Operation Complete");
				break;

			case "webcheckbox":
				while (oCurrentElement == null && i < iStaleMaxCount) {
					oCurrentElement = funStaleClick(sSearchCriteria, sSearchText, iInd);
					i++;
				}
				debugLog("ObjectSync", "Checkbox Option Set");
				break;
			case "webcheckboxGroup":
				if (waitForElement(sSearchCriteria, sSearchText, iInd)) // Mantis 0000879
				{
					oCurrentElement = getElement(sControlType, sSearchCriteria, sSearchText, iInd);
					oCurrentElement.click();
					List<WebElement> lCheckBoxGroup = oDriver.findElements(By.name(sSearchText));
					for (WebElement oCurOption : lCheckBoxGroup) {
						if (sData.equalsIgnoreCase(oCurOption.getAttribute("value").trim())) {
							oCurOption.click();
						}
					}
				}
				break;

			case "webradiogroup":
				if (waitForElement(sSearchCriteria, sSearchText, iInd)) // Mantis 0000879
				{
					oCurrentElement = getElement(sControlType, sSearchCriteria, sSearchText, iInd);
					oCurrentElement.click();
				}
				break;

			case "weblist":
				while (oCurrentElement == null && i < iStaleMaxCount) {
					oCurrentElement = funStaleClick(sSearchCriteria, sSearchText, iInd);
					i++;
				}
				debugLog("ObjectSync", "After Clicking List");
				Thread.sleep(1000);
				i = 0;
				oCurrentElement = null;
				while (oCurrentElement == null && i < iStaleMaxCount) {
					oCurrentElement = funStaleSendKeysOnly(sSearchCriteria, sSearchText, iInd, sData);// mantis 0000470
					i++; // Mantis 0000842
				}
				debugLog("ObjectSync", "Data sent");
				Thread.sleep(1000);
				i = 0;
				oCurrentElement = null;
				while (oCurrentElement == null && i < iStaleMaxCount) {
					oCurrentElement = funStaleClick(sSearchCriteria, sSearchText, iInd);
					i++;
				}
				debugLog("ObjectSync", "List Operation Complete");

				break;

			default:
				while (oCurrentElement == null && i < iStaleMaxCount) {
					//oCurrentElement = funStaleClick(sSearchCriteria, sSearchText, iInd);
					
					oCurrentElement = getElement(sControlType, sSearchCriteria, sSearchText, iInd);
					String js = "arguments[0].style.visibility='visible';";
					JavascriptExecutor jes = (JavascriptExecutor) oDriver;
					jes.executeScript(js, oCurrentElement);
					jes.executeScript("arguments[0].click();", oCurrentElement);
					
					i++;
				}
				debugLog("ObjectSync", "Default Click Applied");
				i = 0;
				oCurrentElement = null;
				while (oCurrentElement == null && i < iStaleMaxCount) {
					oCurrentElement = funStaleSendKeys(sSearchCriteria, sSearchText, iInd, sData);
					i++; // Mantis 0000842
				}
				debugLog("ObjectSync", "Default Edit Operation Complete");
				break;
			}

			if (i == iStaleMaxCount) {
				NoSuchElementException e = new NoSuchElementException("Element search failed with method: \""
						+ sSearchCriteria + "\"  and search Criteria: \"" + sSearchText + "\"");
				throw e;
			}
		} else {
			NoSuchElementException e = new NoSuchElementException("Element search failed with method: \""
					+ sSearchCriteria + "\"  and search Criteria: \"" + sSearchText + "\"");
			throw e;
		}
		// setDefaultContent();
	}

	/*
	 * --------------------------------------- START :
	 * setifempty---------------------------------------------- Function Name:
	 * setifempty Objective: Date Created: Created By: Input: sControlType = Type of
	 * Control; e.g webEdit, webList etc. sSearchCriteria = Identifier that uniquely
	 * identifies an object on application; e.g xpath, id etc sSearchText = Value of
	 * an Identifier iInd = Index of the object in case multiple objects have same
	 * text or id sData = Data Output: revision by: Revision History: Modified on:
	 * Comments:
	 * -----------------------------------------------------------------------------
	 * ----------------------------
	 */

	/*
	 * public void setifempty(String sControlType,String sSearchCriteria,String
	 * sSearchText,String sData,int iInd) throws NoSuchTagException,
	 * InterruptedException, AWTException { if
	 * (setDriver(sSearchCriteria,sSearchText,iInd)) { int i=0; WebElement
	 * oCurrentElement=null; //oCurrentElement.click(); //Thread.sleep(1000); //if
	 * (oCurrentElement != null) { switch (sControlType.toLowerCase().trim()) { case
	 * "webedit": while(oCurrentElement==null && i<iStaleMaxCount) {
	 * //oCurrentElement=funStaleClick(sSearchCriteria, sSearchText, iInd); Mantis
	 * 0000418 oCurrentElement=funStaleSet(sSearchCriteria, sSearchText, iInd); i++;
	 * }
	 * 
	 * if((oCurrentElement.getAttribute("value").equals(null) ||
	 * oCurrentElement.getAttribute("value").isEmpty() ||
	 * oCurrentElement.getAttribute("value") == "")) {
	 * systemouts("inside if condition for setifempty text box"); i=0;
	 * oCurrentElement=null; while(oCurrentElement==null && i<iStaleMaxCount) {
	 * oCurrentElement=funStaleSendKeys(sSearchCriteria, sSearchText, iInd, sData);
	 * } debugLog("ObjectSync", "Edit Operation Complete"); } break;
	 * 
	 * case "weblist":
	 * 
	 * oCurrentElement= getElement(sControlType,sSearchCriteria,sSearchText,iInd);
	 * 
	 * Select comboBox = new Select(oCurrentElement);
	 * systemouts("check status: "+comboBox.getFirstSelectedOption().isSelected());
	 * 
	 * if(oCurrentElement.isSelected()) {
	 * systemouts("inside if condition for setifempty web list");
	 * 
	 * while(oCurrentElement==null && i<iStaleMaxCount) {
	 * oCurrentElement=funStaleClick(sSearchCriteria, sSearchText, iInd); i++; }
	 * debugLog("ObjectSync", "After Clicking List"); Thread.sleep(1000); i=0;
	 * oCurrentElement=null; while(oCurrentElement==null && i<iStaleMaxCount) {
	 * oCurrentElement=funStaleSendKeysOnly(sSearchCriteria, sSearchText, iInd,
	 * sData);//mantis 0000470 } debugLog("ObjectSync", "Data sent");
	 * Thread.sleep(1000);
	 * 
	 * i=0; oCurrentElement=null; while(oCurrentElement==null && i<iStaleMaxCount) {
	 * oCurrentElement=funStaleClick(sSearchCriteria, sSearchText, iInd); i++; }
	 * debugLog("ObjectSync", "List Operation Complete"); } break; } } }
	 */

	/*
	 * --------------------------------------- START :
	 * selectList---------------------------------------------- Function Name:
	 * textValue Objective: Date Created: Created By: Input: sControlType = Type of
	 * Control; e.g webEdit, webList etc. sSearchCriteria = Identifier that uniquely
	 * identifies an object on application; e.g xpath, id etc sSearchText = Value of
	 * an Identifier iInd = Index of the object in case multiple objects have same
	 * text or id sData = Data Output: revision by: Revision History: Modified on:
	 * Comments:
	 * -----------------------------------------------------------------------------
	 * ----------------------------
	 */

	public void selectList(String sControlType, String sSearchCriteria, String sSearchText, String sData, int iInd)
			throws Exception // Mantis 0000879
	{
		WebElement oCurrentElement = null;
		if (waitForElement(sSearchCriteria, sSearchText, iInd)) // Mantis 0000879
		{
			oCurrentElement = getElement(sControlType, sSearchCriteria, sSearchText, iInd);
			Select clickThis = new Select(oCurrentElement);
			debugLog("ObjectSync", "Options found");
			// Thread.sleep(5);
			List<WebElement> options = clickThis.getOptions();

			debugLog("ObjectSync", "Options found" + options.size());
			for (WebElement optionText : options) {
				if (optionText.getText().equals(sData)) {

					debugLog("ObjectSync", "Option Selected" + optionText.getText());
					// optionText.click();
					break;
				}
			}
		} else {
			NoSuchElementException e = new NoSuchElementException("Element search failed with method: \""
					+ sSearchCriteria + "\"  and search Criteria: \"" + sSearchText + "\"");
			throw e;
		}
	}

	/*
	 * --------------------------------------- START :
	 * modifyDynamicValue---------------------------------------------- Function
	 * Name: modifyDynamicValue Objective: Generic function to generate string at
	 * run time using execution data as well as user data and store the same
	 * generated string in execution data excel. Date Created: 29/06/2018 Created
	 * By: Manoj Bamnawat Input: TestCase = Test case name which is mentioned in
	 * Driver excel file data = Data to be appended. Output: Mantis ID: 0000898
	 * revision by: Revision History: Modified on: Comments:
	 * -----------------------------------------------------------------------------
	 * ----------------------------
	 */
	public String modifyDynamicValue(String TestCase, String data) throws Exception {
		String sData = "";

		String sDataParts[] = data.split("\\+");

		for (int i = 0; i < sDataParts.length; i++) {
			if (!sDataParts[i].contains("\"")) {
				if (sDataParts[i].startsWith("~")) // 0001079
				{
					sData = sData + GenerateRandom(sDataParts[i]);
				} else {
					sData = sData + dynamicSet(TestCase, sDataParts[i].trim());
				}
			} else {
				sDataParts[i] = sDataParts[i].trim().substring(1, sDataParts[i].length() - 1);
				sData = sData + sDataParts[i];
			}
		}
		return sData;

	}

	/*
	 * --------------------------------------- START :
	 * modifyTestDataValue---------------------------------------------- Function
	 * Name: modifyTestDataValue Objective: Generic function to generate string at
	 * run time using Test data as well as user data. Date Created: 04/02/2019
	 * Created By: Manoj Bamnawat Input: sTestCaseExcelPath = Test script which is
	 * to be refer for getting TestData from Data sheet. sTestData = Data to be
	 * appended. Output: Mantis ID: 0001097 revision by: Revision History: Modified
	 * on: Comments:
	 * -----------------------------------------------------------------------------
	 * ----------------------------
	 */

	public String modifyTestDataValue(String sTestData, String sTestCaseExcelPath) throws Exception // Mantis 0001097
	{
		String sData = "";

		String sDataParts[] = sTestData.split("\\+");

		for (int i = 0; i < sDataParts.length; i++) {
			if (!sDataParts[i].contains("\"")) {
				sData = sData.concat(getDataFromTestSheet(sDataParts[i].trim(), sTestCaseExcelPath));
			} else {
				if (sDataParts[i].contains("\"\\n"))
					sDataParts[i] = "\n";
				else
					sDataParts[i] = sDataParts[i].trim().substring(1, sDataParts[i].length() - 1);

				sData = sData + sDataParts[i];
			}
		}
		return sData;

	}

	/*
	 * --------------------------------------- START :
	 * textValue---------------------------------------------- Function Name:
	 * textValue Objective: A generic Function to get a text value in an object on
	 * application Date Created: 01/14/2016 Created By: Heramb Input: sControlType =
	 * Type of Control; e.g webEdit, webList etc. sSearchCriteria = Identifier that
	 * uniquely identifies an object on application; e.g xpath, id etc sSearchText =
	 * Value of an Identifier iInd = Index of the object in case multiple objects
	 * have same text or id sData = Data to be appended Output: revision by:
	 * Revision History: Modified on: Comments: Search object with function
	 * SetDriver , if(objectFound) get the object by calling getElement function ,
	 * get text present on Present Else exception Element search failed.
	 * -----------------------------------------------------------------------------
	 * ----------------------------
	 */
	public String textValue(String sControlType, String sSearchCriteria, String sSearchText, String sData, int iInd)
			throws Exception // Mantis 0000879
	{
		String text = null;
		int i = 0;
		if (waitForElement(sSearchCriteria, sSearchText, iInd)) // Mantis 0000879
		{
			while (text == null && i < iStaleMaxCount) {
				text = funStaleRead(sSearchCriteria, sSearchText, iInd);
				i++;
			}
			if (i > iStaleMaxCount) {
				NoSuchElementException e = new NoSuchElementException("Element search failed with method: \""
						+ sSearchCriteria + "\"  and search Criteria: \"" + sSearchText + "\"");
				throw e;
			}
			debugLog("Object Sync", "Text present is:" + text);
			return text;
		} else {
			NoSuchElementException e = new NoSuchElementException("Element search failed with method: \""
					+ sSearchCriteria + "\"  and search Criteria: \"" + sSearchText + "\"");
			throw e;
		}
	}

	/*
	 * ----------------------------------------START:
	 * funStaleClick---------------------------------------------- Function Name:
	 * funStaleClick Objective: A generic Function to click an object having stale
	 * element reference Date Created: 12/01/2016 Created By : Heramb Input:
	 * sSearchCriteria = Identifier that uniquely identifies an object on
	 * application; e.g xpath, id etc sSearchText = Value of an Identifier iInd =
	 * Index of the object in case multiple objects have same text or id Output:
	 * revision by: Revision History: Modified on: Comments: Try to click an object
	 * having stale element reference
	 * -----------------------------------------------------------------------------
	 * ----------------------------
	 */

	public WebElement funStaleClick(String sSearchCriteria, String sSearchText, int iInd) throws NoSuchTagException {
		WebElement oCurrentElement = null;
		try {

			oCurrentElement = getElement(sControlType, sSearchCriteria, sSearchText, iInd);

			if (oCurrentElement != null) // Mantis:0000375
			{
				// Mantis 0000779
				if (oCurrentElement.getAttribute("type") != null
						&& oCurrentElement.getAttribute("type").toLowerCase().equals("checkbox")) {
					if (oCurrentElement.getAttribute("checked") == null) {
						Actions actions = new Actions(oDriver);
						actions.moveToElement(oCurrentElement).build().perform(); // Mantis 0000784
						oCurrentElement.click();
					}

				} else {
					Actions actions = new Actions(oDriver);
					actions.moveToElement(oCurrentElement).build().perform();//// Mantis 0000784
					oCurrentElement.click();
				} // Mantis 0000771

			}

			return oCurrentElement;
		} catch (Exception e) {
			systemouts("Could not click the element");
			return null;
		}
	}

	public WebElement funStaleSet(String sSearchCriteria, String sSearchText, int iInd) throws NoSuchTagException {
		WebElement oCurrentElement = null;
		try {
			oCurrentElement = getElement(sControlType, sSearchCriteria, sSearchText, iInd);

			if (oCurrentElement != null) // Mantis:0000375
			{
				// oCurrentElement.click();

			}

			return oCurrentElement;
		} catch (Exception e) {
			return null;
		}
	}
	/*
	 * ----------------------------------------START:
	 * funStaleSendKeys---------------------------------------------- Function Name:
	 * funStaleSendKeysOnly Objective: A generic Function to send character string
	 * to an object having stale element reference Date Created: 07/Nov/2016 Created
	 * By : Deepankar Input: sSearchCriteria = Identifier that uniquely identifies
	 * an object on application; e.g xpath, id etc sSearchText = Value of an
	 * Identifier iInd = Index of the object in case multiple objects have same text
	 * or id sData = Data to be set Output: revision by: Revision History: Modified
	 * on: Comments: Try to send character string to an object having stale element
	 * reference without clearing the data
	 * -----------------------------------------------------------------------------
	 * ----------------------------
	 */

	public WebElement funStaleSendKeysOnly(String sSearchCriteria, String sSearchText, int iInd, String sData) {
		// 0000470
		WebElement oCurrentElement = null;
		try {
			oCurrentElement = getElement(sControlType, sSearchCriteria, sSearchText, iInd);
			oCurrentElement.sendKeys(sData);

		} catch (Exception e) {
			systemouts("Stale Element Send Keys");
			return null;
		}
		return oCurrentElement;
	}

	/*
	 * /* ----------------------------------------START:
	 * funStaleSendKeys---------------------------------------------- Function Name:
	 * funStaleSendKeys Objective: A generic Function to send character string to an
	 * object having stale element reference Date Created: 12/01/2016 Created By :
	 * Heramb Input: sSearchCriteria = Identifier that uniquely identifies an object
	 * on application; e.g xpath, id etc sSearchText = Value of an Identifier iInd =
	 * Index of the object in case multiple objects have same text or id sData =
	 * Data to be set Output: revision by: Revision History: Modified on: Comments:
	 * Try to send character string to an object having stale element reference
	 * -----------------------------------------------------------------------------
	 * ----------------------------
	 */

	public WebElement funStaleSendKeys(String sSearchCriteria, String sSearchText, int iInd, String sData) {
		WebElement oCurrentElement = null;
		try {
			oCurrentElement = getElement(sControlType, sSearchCriteria, sSearchText, iInd);
			// oCurrentElement.clear();//Mantis 0000460 //Mantis 0000679
			oCurrentElement.sendKeys(sData);
			// systemouts("Inside stale function... Data written"); //Mantis 0000774
		} catch (Exception e) {
			systemouts("Could not set data"); // Mantis 0000776
			return null;
		}
		return oCurrentElement;
	}

	/*
	 * ----------------------------------------START:
	 * funStaleClear---------------------------------------------- Function Name:
	 * funStaleClear Objective: A generic Function to clear an object having stale
	 * element reference Date Created: 12/01/2016 Created By : Heramb Input:
	 * sSearchCriteria = Identifier that uniquely identifies an object on
	 * application; e.g xpath, id etc sSearchText = Value of an Identifier iInd =
	 * Index of the object in case multiple objects have same text or id Output:
	 * revision by: Revision History: Modified on: Comments: Try to click an object
	 * having stale element reference
	 * -----------------------------------------------------------------------------
	 * ----------------------------
	 */

	public WebElement funStaleClear(String sSearchCriteria, String sSearchText, int iInd) {
		WebElement oCurrentElement = null;
		try {
			oCurrentElement = getElement(sControlType, sSearchCriteria, sSearchText, iInd);
			oCurrentElement.clear();
		} catch (Exception e) {
			systemouts("Stale Element Clear");
			return null;
		}
		return oCurrentElement;
	}

	/*
	 * ----------------------------------------START:
	 * funStaleRead---------------------------------------------- Function Name:
	 * funStaleRead Objective: A generic Function to Read value present on an object
	 * having stale element reference Date Created: 14/01/2016 Created By : Heramb
	 * Input: sSearchCriteria = Identifier that uniquely identifies an object on
	 * application; e.g xpath, id etc sSearchText = Value of an Identifier iInd =
	 * Index of the object in case multiple objects have same text or id Output:
	 * revision by: Revision History: Modified on: Comments: Try to Read value
	 * present on an object having stale element reference
	 * -----------------------------------------------------------------------------
	 * ----------------------------
	 */

	public String funStaleRead(String sSearchCriteria, String sSearchText, int iInd) {
		WebElement oCurrentElement = null;
		String text = null;
		try {
			oCurrentElement = getElement(sControlType, sSearchCriteria, sSearchText, iInd);
			text = oCurrentElement.getAttribute("value");
		} catch (Exception e) {
			return null;
		}
		return text;
	}

	/*
	 * --------------------------------------- START :
	 * autoComplete---------------------------------------------- Function Name: set
	 * Objective: A generic Function to set value from the list automatically Date
	 * Created: 22/12/2015 Created By: Rohidas and Heramb Input: sControlType = Type
	 * of Control i.e WebElement sSearchCriteria = Identifier that uniquely
	 * identifies a list object on application; e.g xpath, id etc sSearchText =
	 * Value of an Identifier iInd = Index of the object in case multiple objects
	 * have same text or id sData = Data to be set Output: revision by: Revision
	 * History: Modified on: Comments:
	 * -----------------------------------------------------------------------------
	 * ----------------------------
	 */
	public void autoComplete(String sControlType, String sSearchCriteria, String sSearchText, String sData, int iInd)
			throws Exception // Mantis 0000879
	{
		long autoCompleteWait = 20;
		WebElement autoOptions = null;
		List<WebElement> optionToSelect = null;
		boolean autoCompleteFlag = false;
		WebDriverWait wait = new WebDriverWait(oDriver, autoCompleteWait);
		if (waitForElement(sSearchCriteria, sSearchText, iInd)) // Mantis 0000879
		{
			autoOptions = getElement(sControlType, sSearchCriteria, sSearchText, iInd);

			wait.until(ExpectedConditions.visibilityOf(autoOptions));
			Thread.sleep(2000);
			optionToSelect = autoOptions.findElements(By.tagName("li"));
			// optionToSelect = autoOptions.findElements(By.tagName("span"));

			for (int i = 0; i < optionToSelect.size(); i++) {

				if (optionToSelect.get(i).getAttribute("textContent").contains(sData)) {
					/*
					 * systemouts("Trying to select " + sData); Actions builder = new
					 * Actions(oDriver); builder.moveToElement(optionToSelect.get(i)).perform();
					 * sendKeys("ENTER"); autoCompleteFlag = true; break;
					 */

					optionToSelect.get(i).click(); // Mantis 0000525
					autoCompleteFlag = true;
					break;
				}
			}
			if (autoCompleteFlag == true) {
				sStepStatus = "Pass";
				sComments = "AutoComplete Successful";

			} else {
				NoSuchElementException e = new NoSuchElementException("Option" + sData + " is not found in the list");
				throw e;
			}
		} else {
			NoSuchElementException e = new NoSuchElementException("Element search failed with method: \""
					+ sSearchCriteria + "\"  and search Criteria: \"" + sSearchText + "\"");
			throw e;
		}
		// setDefaultContent();
	}

	/*
	 * --------------------------------------- START :
	 * get---------------------------------------------- Function Name: get
	 * Objective: A generic Function to get a value of an object on application Date
	 * Created: Input: sControlType = Type of Control; e.g webEdit, webList etc.
	 * sSearchCriteria = Identifier that uniquely identifies an object on
	 * application; e.g xpath, id etc sSearchText = Value of an Identifier iInd =
	 * Index of the object in case multiple objects have same text or id Output:
	 * Revision History: Modified on: Comments: Search object with function
	 * SetDriver , if(objectFound) get the object by calling getElement function ,
	 * if (element is not null) get the case for the control type(e.g. webEdit,
	 * webCheckbox , etc.) and get the data Else exception Element search failed.
	 * 
	 * -----------------------------------------------------------------------------
	 * ----------------------------
	 */

	public String get(String sControlType, String sSearchCriteria, String sSearchText, int iInd) throws Exception {
		String sData = new String();
		if (waitForElement(sSearchCriteria, sSearchText, iInd)) // Mantis 0000879
		{
			WebElement oCurrentElement = getElement(sControlType, sSearchCriteria, sSearchText, iInd);

			int i = 0;
			while (oCurrentElement == null && i < iStaleMaxCount) // Mantis 0000855
			{
				// systemouts("inside stale get "+i);
				oCurrentElement = getElement(sControlType, sSearchCriteria, sSearchText, iInd);
				i++;
			}

			String CntlType = getControlType(oCurrentElement, sControlType); // Mantis 0000788
			// oCurrentElement.click();
			if (oCurrentElement != null) {
				switch (CntlType.toLowerCase().trim()) // Mantis 0000788
				{
				case "webedit":
					sData = oCurrentElement.getAttribute("value");
					break;
				case "webradiogroup":
					if (oCurrentElement.isSelected())
						sData = "true";
					else
						sData = "false";
					break;
				case "weblist":
					Select clickThis = new Select(oCurrentElement);
					sData = clickThis.getFirstSelectedOption().getText();
					break;

				case "webbutton":
					sData = oCurrentElement.getText();
					if (sData == null) {
						sData = oCurrentElement.getAttribute("value");
					}
					break;

				case "webcheckbox":
					if (oCurrentElement.isSelected()) {
						sData = "True";
					} else {
						sData = "False";
					}
					break;

				default:
					systemouts("in default get function");
					sData = oCurrentElement.getText();
					break;
				}
			}
			// setDefaultContent();
			return sData;
		} else {
			return null;
			/*
			 * NoSuchElementException e = new
			 * NoSuchElementException("Element search failed with method: \"" +
			 * sSearchCriteria + "\"  and search Criteria: \"" + sSearchText + "\""); throw
			 * e;
			 */
		}
	}

	/*
	 * --------------------------------------- START :
	 * getControlType---------------------------------------------- Function Name:
	 * getControlType Objective: A generic Function to get controlType Date Created:
	 * 26/12/2017 Input: oCurrentElement = Web element sControlType = User's control
	 * type Output: Function give Correct control type based on html TYPE attribute
	 * & tagName Revision History: Modified on: Mantis: 0000788
	 * 
	 * -----------------------------------------------------------------------------
	 * ----------------------------
	 */
	private String getControlType(WebElement oCurrentElement, String sControlType) throws Exception {
		String tagName, typeValue, ControlType = null;
		tagName = oCurrentElement.getTagName();
		typeValue = oCurrentElement.getAttribute("type");

		if (typeValue == null) {
			ControlType = "webelement";
		} else {

			if (tagName.trim().equalsIgnoreCase("select")) {
				ControlType = "weblist";
			} else if (typeValue.trim().equalsIgnoreCase("radio")) {
				ControlType = "webradiogroup";
			} else if (typeValue.trim().equalsIgnoreCase("checkbox")) {
				ControlType = "webcheckbox";
			} else if (typeValue.trim().equalsIgnoreCase("button") || typeValue.trim().equalsIgnoreCase("submit")) {
				ControlType = "webbutton";
			} else if (typeValue.toLowerCase().trim().startsWith("text") || typeValue.trim().equalsIgnoreCase("email")
					|| typeValue.trim().equalsIgnoreCase("password")) {
				ControlType = "webedit";
			} else {
				ControlType = "webelement";
			}
		}

		return ControlType;
	}

	/*
	 * --------------------------------------- START :
	 * getURL---------------------------------------------- Function Name: getURL
	 * Objective: A generic Function to get URL Date Created: Input: sSearchCriteria
	 * = Identifier that uniquely identifies an object on application; e.g xpath, id
	 * etc sSearchText = Value of an Identifier iInd = Index of the object in case
	 * multiple objects have same text or id Output: Revision History: Modified on:
	 * Comments: Search object with function SetDriver , if(objectFound) get the
	 * object by calling getElement function , get the href value and store to the
	 * variable and return same.
	 * 
	 * -----------------------------------------------------------------------------
	 * ----------------------------
	 */
	public String getURL(String sSearchCriteria, String sSearchText, int iInd) throws Exception // Mantis 0000879
	{
		String sData = new String();
		if (waitForElement(sSearchCriteria, sSearchText, iInd)) // Mantis 0000879
		{
			WebElement oCurrentElement = getElement(sControlType, sSearchCriteria, sSearchText, iInd);
			oCurrentElement.click();
			sData = oCurrentElement.getAttribute("href");
		}
		// setDefaultContent();
		return sData;
	}

	/*
	 * --------------------------------------- START :
	 * isEnabled---------------------------------------------- Function Name:
	 * isEnabled Objective: A generic Function to check whether the object is
	 * Enabled Date Created: Input: sSearchCriteria = Identifier that uniquely
	 * identifies an object on application; e.g xpath, id etc sSearchText = Value of
	 * an Identifier iInd = Index of the object in case multiple objects have same
	 * text or id Output: Revision History: Modified on: Comments: Search object
	 * with function SetDriver , if(objectFound) get the object by calling
	 * getElement function, capture the value(true or false) of the currentElement
	 * from isEnabled property and return the same else exception element search
	 * failed.
	 * -----------------------------------------------------------------------------
	 * ----------------------------
	 */

	public boolean isEnabled(String sSearchCriteria, String sSearchText, int iInd) throws Exception // Mantis 0000879
	{
		if (waitForElement(sSearchCriteria, sSearchText, iInd)) // Mantis 0000879
		{
			WebElement oCurrentElement = getElement(sControlType, sSearchCriteria, sSearchText, iInd);
			boolean sData = false;
			sData = oCurrentElement.isEnabled();
			// setDefaultContent();
			return sData;
		} else {
			NoSuchElementException e = new NoSuchElementException("Element search failed with method: \""
					+ sSearchCriteria + "\"  and search Criteria: \"" + sSearchText + "\"");
			throw e;
		}
	}

	/*
	 * --------------------------------------- START :
	 * isVisible---------------------------------------------- Function Name:
	 * isVisible Objective: A generic Function to check whether the object is
	 * Visible Date Created: Input: sSearchCriteria = Identifier that uniquely
	 * identifies an object on application; e.g xpath, id etc sSearchText = Value of
	 * an Identifier iInd = Index of the object in case multiple objects have same
	 * text or id Output: Revision History: Modified on: Comments: Search object
	 * with function SetDriver , if(objectFound) get the object by calling
	 * getElement function, capture the value(true or false) of the currentElement
	 * from isDisplayed property and return the same else exception element search
	 * failed. .
	 * -----------------------------------------------------------------------------
	 * ----------------------------
	 */

	public boolean isVisible(String sSearchCriteria, String sSearchText, int iInd) throws Exception // Mantis 0000879
	{
		if (waitForElement(sSearchCriteria, sSearchText, iInd)) // Mantis 0000879
		{
			WebElement oCurrentElement = getElement(sControlType, sSearchCriteria, sSearchText, iInd);
			boolean sData = false;
			sData = oCurrentElement.isDisplayed();
			// setDefaultContent();
			return sData;
		} else {
			NoSuchElementException e = new NoSuchElementException("Element search failed with method: \""
					+ sSearchCriteria + "\"  and search Criteria: \"" + sSearchText + "\"");
			throw e;
		}
	}

	/*
	 * --------------------------------------- START :
	 * hover---------------------------------------------- Function Name: hover
	 * Objective: A generic function to hover on an object on application Date
	 * Created: Input: sSearchCriteria = Identifier that uniquely identifies an
	 * object on application; e.g xpath, id etc sSearchText = Value of an Identifier
	 * iInd = Index of the object in case multiple objects have same text or id
	 * Output: Revision History: Modified on: Comments:
	 * -----------------------------------------------------------------------------
	 * ----------------------------
	 */
	public void hover(String sSearchCriteria, String sSearchText, int iInd) throws Exception // Mantis 0000879
	{
		if (waitForElement(sSearchCriteria, sSearchText, iInd)) // Mantis 0000879
		{
			WebElement oCurrentElement = getElement(sControlType, sSearchCriteria, sSearchText, iInd);
			Actions action = new Actions(oDriver);
			action.moveToElement(oCurrentElement).build().perform();
			Thread.sleep(500); // Mantis 0000848
		}
	}

	/*
	 * --------------------------------------- START :
	 * checkAlert---------------------------------------------- Function Name:
	 * checkAlert Objective: A generic function to check any alert is appearing or
	 * not in the application Date Created: Input: Output: Revision History:
	 * Modified on: Comments:
	 * -----------------------------------------------------------------------------
	 * ----------------------------
	 */
	public boolean checkAlert() {
		WebDriverWait wait = new WebDriverWait(getDriver(), 10);
		try {
			Thread.sleep(1000);
		} catch (InterruptedException e1) {
			e1.printStackTrace();
		}
		try {
			wait.until(ExpectedConditions.alertIsPresent());
		} catch (TimeoutException e) {
			return false;
		}
		return true;
	}

	/*
	 * --------------------------------------- START :
	 * handleAlert---------------------------------------------- Function Name:
	 * handleAlert Objective: A generic function to handle(accept/decline) any alert
	 * that appears in the application Date Created: Input: sOperation = Operation
	 * to be performed on alert is passed,i.e., accept or decline. Output: Revision
	 * History: Modified on: Comments:
	 * -----------------------------------------------------------------------------
	 * ----------------------------
	 */
	public void handleAlert(String sOperation) {
		Alert oAlertWindow = oDriver.switchTo().alert();

		switch (sOperation.trim().toLowerCase()) {
		case "accept":
			sStepDescription = "Alert OK";
			oAlertWindow.accept();
			// setDefaultContent();
			break;

		case "decline":
			sStepDescription = "Alert Cancel";
			oAlertWindow.dismiss();
			// setDefaultContent();
			break;

		case "alerttext":
		case "alertcontains": // Mantis 0000919
			sStepDescription = "Get Alert Text";
			sAlertText = oAlertWindow.getText();
			break;

		default:
		}
		// setDefaultContent();
	}

	/*
	 * --------------------------------------- START : verifyAlertText
	 * ---------------------------------------------- Function Name:
	 * alertPartialText Objective: A generic function to check whether given
	 * testString is same as Alert Text or not. Date Created: Input: sTestData =
	 * testString Output: Revision History: Modified on: Comments:
	 * -----------------------------------------------------------------------------
	 * ----------------------------
	 */
	public boolean verifyAlertText(String sTestData) {
		Alert oAlertWindow = oDriver.switchTo().alert();
		String alertText = oAlertWindow.getText();
		sActualValue = alertText;
		sStepDescription = "Alert Text Verification";
		boolean localFlag = true;
		String[] testAlertText = sTestData.split(" ");
		if (testAlertText.length == 0)
			testAlertText[0] = sTestData;
		String[] splitAlertText = alertText.split(" ");
		if (splitAlertText.length == 0)
			splitAlertText[0] = alertText;
		if (testAlertText.length == splitAlertText.length) {
			for (int i = 0; i < testAlertText.length; i++) {
				if (!testAlertText[i].equals(splitAlertText[i])) {
					localFlag = false;
					break;
				}
			}
		} else {
			localFlag = false;
		}
		return localFlag;
		// setDefaultContent();
	}

	/*
	 * --------------------------------------- START : verifyAlertTextContains
	 * ---------------------------------------------- Function Name:
	 * verifyAlertTextContains Objective: A generic function to check whether given
	 * testString is available in Alert Text or not. Date Created: Input: sTestData
	 * = testString Output: Revision History: Modified on: Comments: Added as part
	 * of Mantis ID 0000919
	 * -----------------------------------------------------------------------------
	 * ----------------------------
	 */

	public boolean verifyAlertTextContains(String sTestData) {
		Alert oAlertWindow = oDriver.switchTo().alert();
		String alertText = oAlertWindow.getText();
		sActualValue = alertText;
		sStepDescription = "Alert Text contains Verification";
		boolean localFlag = true;

		if (alertText.contains(sTestData)) {
			localFlag = true;
		} else {
			localFlag = false;
		}
		return localFlag;
		// setDefaultContent();
	}

	/*
	 * --------------------------------------- START : getAlertKey
	 * ---------------------------------------------- Function Name: getAlertKey
	 * Objective: A generic function to get dynamic part of alert text when static
	 * part is provided. Date Created: Input: sTestData = Static part of Alert Text
	 * Output: Dyanmic part of Alert Text Revision History: Modified on: Comments:
	 * -----------------------------------------------------------------------------
	 * ----------------------------
	 */
	public String getAlertKey(String sTestData) {
		Alert oAlertWindow = oDriver.switchTo().alert();
		String alertText = oAlertWindow.getText();
		sStepDescription = "Get Alert Key";
		String sKey = "";
		String[] testAlertText = sTestData.split(" ");
		if (testAlertText.length == 0)
			testAlertText[0] = sTestData;
		String[] splitAlertText = alertText.split(" ");
		if (splitAlertText.length == 0)
			splitAlertText[0] = alertText;
		if (testAlertText.length == splitAlertText.length) {
			for (int i = 0; i < testAlertText.length; i++) {
				if (testAlertText[i].equals("~")) {
					sKey = sKey + splitAlertText[i] + " ";
				} else if (!testAlertText[i].equals(splitAlertText[i])) {
					sKey = null;
					break;
				}
			}
		} else {
			sKey = null;
		}
		return sKey;
	}

	/*
	 * --------------------------------------- START :
	 * wait---------------------------------------------- Function Name: wait
	 * Objective: A generic function to wait for locating the presence of a
	 * particular object in the application Date Created: Input: sSearchCriteria =
	 * Identifier that uniquely identifies an object on application; e.g xpath, id
	 * etc sSearchText = Value of an Identifier iInd = Index of the object in case
	 * multiple objects have same text or id. sTime = Time in seconds for which the
	 * execution will wait for locating the presence of the object. Output: Revision
	 * History:removed the switch case dor xpath and all and casted the current
	 * object to (By) object Modified on:21/8/2015 Comments: modified by devang
	 * -----------------------------------------------------------------------------
	 * ----------------------------
	 */
	public void wait(String sSearchCriteria, String sSearchText, String sTime, int iInd) throws Exception // Mantis
	// 0000879
	{

		int iTime = (int) Float.parseFloat(sTime);
		if (sSearchCriteria != null && (!sSearchCriteria.isEmpty())) {
			if (waitForElement(sSearchCriteria, sSearchText, iInd)) // Mantis 0000879
			{
				WebElement oCurrentElement = getElement(sControlType, sSearchCriteria, sSearchText, iInd);
				(new WebDriverWait(oDriver, iTime)).until(ExpectedConditions.elementToBeClickable(oCurrentElement));
			} else {
				NoSuchElementException e = new NoSuchElementException("Element search failed with method: \""
						+ sSearchCriteria + "\"  and search Criteria: \"" + sSearchText + "\"");
				throw e;
			}
		} else {
			Thread.sleep((Integer.parseInt(sTime) * 1000));
		}
	}

	/*
	 * ----------------------------------------START:
	 * getLength---------------------------------------------- Function Name:
	 * getLength Objective: A generic Function for finding length of string. Date
	 * Created: 23/07/2018 Created By : Manoj Bamnawat Input: testCase = Test case
	 * name which is mentioned in Driver excel file. sTestData = Set of data.
	 * Output: revision by: Revision History: Modified on: Comments: Added as part
	 * of Mantis ID 0000917
	 * -----------------------------------------------------------------------------
	 * ----------------------------
	 */

	public String getLength(String testCase, String sTestData) throws Exception {
		String sData = null;

		if (sTestData.trim().length() == 0) {
			debugLog("getLength", "Data has not been provided");
			return null;
		}

		// Reading data from ExecutionData file
		// Workbook workBookExecutionData =
		// ExcelConnection.funExcelConnection("ExecutionData.xlsx");
		// List<List<String>> data=
		// ExcelConnection.funGetSheetData(workBookExecutionData, "TempStorage");
		// Map<String, Integer>
		// columData=ExcelConnection.funGetSheetColumns(workBookExecutionData,"TempStorage");

		Object JsonData = ExcelConnection.getExecutionDatafromDb(); // Mantis: 0001169
		List<List<String>> data = ExcelConnection.getSheetDataFromJSON(JsonData, "TempStorage");
		Map<String, Integer> columData = ExcelConnection.getColumnNamesFromJson(JsonData, "TempStorage");

		int fieldColumnIndex = ExcelConnection.funGetColumnIndex(ExecutionDataColumnHeader.FIELD_NAME.toString(),
				columData);
		int testCaseColumnIndex = ExcelConnection.funGetColumnIndex(ExecutionDataColumnHeader.TEST_CASE.toString(),
				columData);
		int fieldValueIndex = ExcelConnection.funGetColumnIndex(ExecutionDataColumnHeader.FIELD_VALUE.toString(),
				columData);
		int targetRow;

		targetRow = ExcelConnection.funGetExecutionDataRecordNumber(testCaseColumnIndex, fieldColumnIndex, testCase,
				sTestData.trim(), data);

		if (targetRow == -1) {
			debugLog("getLength", "Could not find data for testcase :" + testCase + " Column:" + sDataColumn
					+ ", and data:" + sTestData);
			return null;
		}

		if (data.get(targetRow).get(fieldValueIndex) == null
				|| data.get(targetRow).get(fieldValueIndex).length() == 0) {
			sData = "0";
		} else {
			sData = Integer.toString(data.get(targetRow).get(fieldValueIndex).length());
		}

		return sData;
	}

	/*
	 * ----------------------------------------START:
	 * compare---------------------------------------------- Function Name: compare
	 * Objective: A generic Function for comparing two values from execution data.
	 * Date Created: 23/07/2018 Created By : Manoj Bamnawat Input: testCase = Test
	 * case name which is mentioned in Driver excel file. sTestData = Set of data.
	 * Output: revision by: Revision History: Modified on: Comments: Added as part
	 * of Mantis ID 0000918
	 * -----------------------------------------------------------------------------
	 * ----------------------------
	 */

	public String compare(String testCase, String sTestData) throws Exception {
		String status = "Fail";
		List<String> value = new ArrayList<String>();
		String[] fieldName = sTestData.split("\\|");

		if (sTestData.trim().length() == 0) {
			debugLog("compare", "Data has not been provided");
			return null;
		}
		if (fieldName.length < 2) {
			debugLog("compare", "Sufficient number of Data has not been provided");
			return null;
		}

		for (int i = 0; i < fieldName.length; i++) {
			value.add(dynamicSet(testCase, fieldName[i]));
		}

		for (int i = 0; i < value.size(); i++) {
			if (value.get(i).startsWith("[{")) {
				List<List<String>> executionData = funGetDataFromJSON(value.get(i));
				if (!executionData.isEmpty() && executionData.size() <= 1)
					if (executionData.get(0).size() <= 1) {
						value.remove(i);
						value.add(i, executionData.get(0).get(0));
					} else
						debugLog("compare",
								"Value fetched from database should contain single value only for comparison");
				else
					debugLog("compare",
							"Value fetched from database should not be empty or should contain single row only for comparison");
			}
		}

		sExpectedData = value.get(0);
		sActualValue = value.get(1);
		sComments = "Expected value :" + sExpectedData + " Actual value :" + sActualValue;

		if (value.get(0).equals(value.get(1))) {
			status = "pass";
		} else {
			status = "Fail";
		}

		return status;
	}

	/*
	 * ----------------------------------------START:
	 * getMax---------------------------------------------- Function Name: getMax
	 * Objective: A generic Function for finding maximum value from set of data.
	 * Date Created: 01/March/2018 Created By : Manoj Bamnawat Input: testCase =
	 * Test case name which is mentioned in Driver excel file. sTestData = Set of
	 * data. Output: revision by: Revision History: Modified on: Comments: Added as
	 * part of Mantis ID 0000810
	 * -----------------------------------------------------------------------------
	 * ----------------------------
	 */

	public String getMax(String testCase, String sTestData) throws Exception {
		String[] fieldName = sTestData.split("\\|");
		Double[] sData = new Double[fieldName.length];

		if (sTestData.trim().length() == 0) {
			debugLog("ReturnMax", "Data has not been provided");
			return null;
		}

		// Reading data from ExecutionData file
		// Workbook workBookExecutionData =
		// ExcelConnection.funExcelConnection("ExecutionData.xlsx");
		// List<List<String>> data=
		// ExcelConnection.funGetSheetData(workBookExecutionData, "TempStorage");
		// Map<String, Integer>
		// columData=ExcelConnection.funGetSheetColumns(workBookExecutionData,"TempStorage");

		Object JsonData = ExcelConnection.getExecutionDatafromDb(); // Mantis: 0001169
		List<List<String>> data = ExcelConnection.getSheetDataFromJSON(JsonData, "TempStorage");
		Map<String, Integer> columData = ExcelConnection.getColumnNamesFromJson(JsonData, "TempStorage");

		int fieldColumnIndex = ExcelConnection.funGetColumnIndex(ExecutionDataColumnHeader.FIELD_NAME.toString(),
				columData);
		int testCaseColumnIndex = ExcelConnection.funGetColumnIndex(ExecutionDataColumnHeader.TEST_CASE.toString(),
				columData);
		int fieldValueIndex = ExcelConnection.funGetColumnIndex(ExecutionDataColumnHeader.FIELD_VALUE.toString(),
				columData);

		int targetRow;
		for (int i = 0; i < fieldName.length; i++) {
			targetRow = ExcelConnection.funGetExecutionDataRecordNumber(testCaseColumnIndex, fieldColumnIndex, testCase,
					fieldName[i].trim(), data);
			if (targetRow == -1) {
				debugLog("ReturnMax", "Could not find data for testcase :" + testCase + " Column:" + sDataColumn
						+ ", and data:" + fieldName[i]);
				return null;
			}
			sData[i] = Double.parseDouble(data.get(targetRow).get(fieldValueIndex));
		}

		if (sData.length > 1) {
			for (int i = 0; i < sData.length; i++) {
				for (int j = i + 1; j < sData.length; j++) {
					if (sData[i] < sData[j]) {
						Double temp = sData[i];
						sData[i] = sData[j];
						sData[j] = temp;
					}
				}
			}
		}

		return sData[0].toString();

	}

	/*
	 * ----------------------------------------START:
	 * verifyMaxDate---------------------------------------------- Function Name:
	 * verifyMaxDate Objective: A generic Function for finding maximum date from set
	 * of data. Date Created: 30/08/2018 Created By : Manoj Bamnawat Input: testCase
	 * = Test case name which is mentioned in Driver excel file. sTestData = Set of
	 * date data. Output: revision by: Revision History: Modified on: Comments:
	 * Added as part of Mantis ID 0000948
	 * -----------------------------------------------------------------------------
	 * ----------------------------
	 */

	public String verifyMaxDate(String testCase, String sTestData) // Mantis 0000948
	{
		String status = "Fail";
		try {
			if (dateFormat.trim().length() == 0) {
				debugLog("verifyMaxDate", "Date format is not set by setdateformat keyword");
				sStepDescription = "Date format is not set by setdateformat keyword";
				return "Fail";
			}
			if (sTestData.trim().length() == 0) {
				debugLog("verifyMaxDate", "TestData has not been provided");
				sStepDescription = "TestData has not been provided";
				return "Fail";
			}

			List<String> fieldName = new ArrayList<String>(Arrays.asList(sTestData.split("\\|")));
			List<Date> dates = new ArrayList<Date>();
			Date maxDate = new Date();
			SimpleDateFormat format = new SimpleDateFormat(dateFormat);

			// Reading data from ExecutionData file
			// Workbook workBookExecutionData =
			// ExcelConnection.funExcelConnection("ExecutionData.xlsx");
			// List<List<String>> data=
			// ExcelConnection.funGetSheetData(workBookExecutionData, "TempStorage");
			// Map<String, Integer>
			// columData=ExcelConnection.funGetSheetColumns(workBookExecutionData,"TempStorage");

			Object JsonData = ExcelConnection.getExecutionDatafromDb(); // Mantis: 0001169
			List<List<String>> data = ExcelConnection.getSheetDataFromJSON(JsonData, "TempStorage");
			Map<String, Integer> columData = ExcelConnection.getColumnNamesFromJson(JsonData, "TempStorage");

			int fieldColumnIndex = ExcelConnection.funGetColumnIndex(ExecutionDataColumnHeader.FIELD_NAME.toString(),
					columData);
			int testCaseColumnIndex = ExcelConnection.funGetColumnIndex(ExecutionDataColumnHeader.TEST_CASE.toString(),
					columData);
			int fieldValueIndex = ExcelConnection.funGetColumnIndex(ExecutionDataColumnHeader.FIELD_VALUE.toString(),
					columData);

			int targetRow;
			for (int i = 0; i < fieldName.size(); i++) {
				targetRow = ExcelConnection.funGetExecutionDataRecordNumber(testCaseColumnIndex, fieldColumnIndex,
						testCase, fieldName.get(i).trim(), data);
				if (targetRow == -1) {
					debugLog("verifyMaxDate", "Could not find data for testcase :" + testCase + " Column:" + sDataColumn
							+ ", and data:" + fieldName.get(i));
					return "Fail";
				}
				dates.add(format.parse(data.get(targetRow).get(fieldValueIndex)));
			}

			if (dates.size() > 1) {
				for (int i = 0; i < dates.size(); i++) {
					if (dates.get(i).compareTo(maxDate) > 0) {
						maxDate = dates.get(i);
					}
				}
			} else
				maxDate = dates.get(0);

			sActualValue = format.format(maxDate);
			sExpectedData = format.format(dates.get(0));

			if (maxDate.equals(dates.get(0))) {
				status = "Pass";
			}

		} catch (Exception e) {
			debugLog("verifyMaxDate", e.getMessage());
			status = "Fail";
		}

		return status;
	}

	/*
	 * ----------------------------------------START:
	 * ArithmeticOperation---------------------------------------------- Function
	 * Name: ArithmeticOperation Objective: A generic Function for performing
	 * arithmetic operation on set of data by using arithmetic expression. Example:
	 * Arithmetic expression = Principal * RateOfIntrest% * Time Date Created:
	 * 01/March/2018 Created By : Manoj Bamnawat Input: testCase = Test case name
	 * which is mentioned in Driver excel file. sTestData = Set of data. Output:
	 * revision by: Revision History: Modified on: Comments: Added as part of Mantis
	 * ID 0000811
	 * -----------------------------------------------------------------------------
	 * ----------------------------
	 */

	public String ArithmeticOperation(String testCase, String sTestData) throws Exception {
		if (sTestData.trim().length() == 0) {
			debugLog("ReturnProduct", "Data has not been provided");
			return null;
		}

		// Reading data from ExecutionData file
		// Workbook workBookExecutionData =
		// ExcelConnection.funExcelConnection("ExecutionData.xlsx");
		// List<List<String>> data=
		// ExcelConnection.funGetSheetData(workBookExecutionData, "TempStorage");
		// Map<String, Integer>
		// columData=ExcelConnection.funGetSheetColumns(workBookExecutionData,"TempStorage");

		Object JsonData = ExcelConnection.getExecutionDatafromDb(); // Mantis: 0001169
		List<List<String>> data = ExcelConnection.getSheetDataFromJSON(JsonData, "TempStorage");
		Map<String, Integer> columData = ExcelConnection.getColumnNamesFromJson(JsonData, "TempStorage");

		int fieldColumnIndex = ExcelConnection.funGetColumnIndex(ExecutionDataColumnHeader.FIELD_NAME.toString(),
				columData);
		int testCaseColumnIndex = ExcelConnection.funGetColumnIndex(ExecutionDataColumnHeader.TEST_CASE.toString(),
				columData);
		int fieldValueIndex = ExcelConnection.funGetColumnIndex(ExecutionDataColumnHeader.FIELD_VALUE.toString(),
				columData);

		String sFinalOutput = null;
		String testData = sTestData.replaceAll("\\s", "");
		List<String> sTestDataParts = new ArrayList<>();

		String operatorSplit = "+-*/^%()";
		List<String> operators = new ArrayList<>();

		for (char ch : operatorSplit.toCharArray()) {
			operators.add(String.valueOf(ch));
		}

		int k = 0, i = 0;
		String temp;

		if (operators.contains(String.valueOf(testData.charAt(0)))) {
			temp = testData.substring(k, ++i);
			systemouts("temp 1: " + temp);
			sTestDataParts.add(temp);
			k = i;
		}

		while (i < testData.length()) {
			if (operators.contains(String.valueOf(testData.charAt(i)))) {
				temp = testData.substring(k, i);

				if (!operators.contains(temp)) {
					sTestDataParts
					.add(getData(testCaseColumnIndex, fieldColumnIndex, fieldValueIndex, testCase, temp, data));
				} else
					sTestDataParts.add(temp);

				k = i;

				if ((i + 1) < testData.length()) {
					if (!operators.contains(String.valueOf(testData.charAt(i + 1)))) {
						temp = testData.substring(k, i + 1);

						if (!operators.contains(temp)) {
							sTestDataParts.add(getData(testCaseColumnIndex, fieldColumnIndex, fieldValueIndex, testCase,
									temp, data));
						} else
							sTestDataParts.add(temp);
						k = i + 1;
					}
				} else if (i == testData.length() - 1) {
					temp = testData.substring(k, testData.length());

					if (!operators.contains(temp)) {
						sTestDataParts.add(
								getData(testCaseColumnIndex, fieldColumnIndex, fieldValueIndex, testCase, temp, data));
					} else
						sTestDataParts.add(temp);
					k = 0;
				}

			} else if (i == testData.length() - 1) {
				temp = testData.substring(k, testData.length());

				if (!operators.contains(temp)) {
					sTestDataParts
					.add(getData(testCaseColumnIndex, fieldColumnIndex, fieldValueIndex, testCase, temp, data));
				} else
					sTestDataParts.add(temp);
				k = 0;
			}

			i++;
		}

		sFinalOutput = String.valueOf(evaluate(sTestDataParts));

		return sFinalOutput;
	}

	private String getData(int testCaseColumnIndex, int fieldColumnIndex, int fieldValueIndex, String testCase,
			String temp, List<List<String>> data) {
		int targetRow = ExcelConnection.funGetExecutionDataRecordNumber(testCaseColumnIndex, fieldColumnIndex, testCase,
				temp, data);
		if (targetRow == -1) {
			debugLog("ArithmeticOperation",
					"Could not find data for testcase :" + testCase + " Column:" + sDataColumn + ", and data:" + temp);
			return null;
		}
		return (data.get(targetRow).get(fieldValueIndex));
	}

	// Performing Arithmetic operation
	private Double evaluate(List<String> partsOfExpression) {
		Stack<Double> values = new Stack<Double>();
		Stack<String> operators = new Stack<String>();

		for (int i = 0; i < partsOfExpression.size(); i++) {
			if ((!partsOfExpression.get(i).equalsIgnoreCase("+")) && (!partsOfExpression.get(i).equalsIgnoreCase("-"))
					&& (!partsOfExpression.get(i).equalsIgnoreCase("*"))
					&& (!partsOfExpression.get(i).equalsIgnoreCase("/"))
					&& (!partsOfExpression.get(i).equalsIgnoreCase("^"))
					&& (!partsOfExpression.get(i).equalsIgnoreCase("%"))
					&& (!partsOfExpression.get(i).equalsIgnoreCase("("))
					&& (!partsOfExpression.get(i).equalsIgnoreCase(")"))) {
				values.push(Double.valueOf(partsOfExpression.get(i)));
			} else if (partsOfExpression.get(i).equalsIgnoreCase("(")) {
				operators.push(partsOfExpression.get(i));
			} else if (partsOfExpression.get(i).equalsIgnoreCase(")")) {
				while (!operators.peek().equalsIgnoreCase("("))
					values.push(performOperation(operators.pop(), values.pop(), values.pop()));
				operators.pop();
			} else if ((partsOfExpression.get(i).equalsIgnoreCase("+"))
					|| (partsOfExpression.get(i).equalsIgnoreCase("-"))
					|| (partsOfExpression.get(i).equalsIgnoreCase("*"))
					|| (partsOfExpression.get(i).equalsIgnoreCase("/"))
					|| (partsOfExpression.get(i).equalsIgnoreCase("^"))) {
				if (!operators.isEmpty() && precedence(partsOfExpression.get(i), operators.peek())) {
					values.push(performOperation(operators.pop(), values.pop(), values.pop()));
				}

				operators.push(partsOfExpression.get(i));

			} else if ((partsOfExpression.get(i).equalsIgnoreCase("%"))) {
				double operand = 100;
				values.push(performOperation(partsOfExpression.get(i), operand, values.pop()));
			}

		}

		while (!operators.isEmpty()) {
			values.push(performOperation(operators.pop(), values.pop(), values.pop()));
		}

		return values.pop();

	}

	// Evaluating order of arithmetic operators
	public static boolean precedence(String operator1, String operator2) {
		if (operator2.equalsIgnoreCase("(") || operator2.equalsIgnoreCase(")"))
			return false;
		else if (((operator2.equalsIgnoreCase("*")) || (operator2.equalsIgnoreCase("/"))
				|| (operator2.equalsIgnoreCase("^")))
				&& ((operator1.equalsIgnoreCase("+")) || (operator1.equalsIgnoreCase("-")))) {
			return true;
		} else
			return false;

	}

	public double performOperation(String operator, double op1, double op2) {
		double output = 0;
		switch (operator.trim()) {
		case "+":
			output = op1 + op2;
			break;

		case "-":
			output = op1 - op2;
			break;

		case "*":
			output = op1 * op2;
			break;

		case "/":
		case "%":
			output = op2 / op1;
			break;

		case "^":
			output = 1;
			for (int i = 0; i < (int) op1; i++) {
				output = output * op2;
			}
			break;

		default:
			systemouts("Invalid operators");
			break;
		}

		return output;

	}

	/*
	 * ----------------------------------------START:
	 * RemoveWords---------------------------------------------- Function Name:
	 * RemoveWords Objective: A generic Function for removing characters from a
	 * given string This will be used in situations when get function gets a string
	 * that has additional data besides the one required Example:
	 * "The new transaction ID is 36363" here everything apart from 36363 is
	 * unwanted and needs to be removed Date Created: 19/Sep/2016 Created By :
	 * Deepankar Input: Output: revision by: Revision History: Modified on:
	 * Comments: Added as part of 0000372
	 * -----------------------------------------------------------------------------
	 * ----------------------------
	 */

	public boolean RemoveWords(String testCase, String dataForRemoval, String columnName) {
		try {
			if (columnName.trim().length() == 0) {
				debugLog("Removewords", "Columname has not been provided");
				return false;
			} else if (dataForRemoval.trim().length() == 0) {
				debugLog("Removewords", "Data has not been provided");
				return false;
			}

			// Reading data from ExecutionData file
			// Workbook workBookExecutionData =
			// ExcelConnection.funExcelConnection("ExecutionData.xlsx");
			// List<List<String>> data=
			// ExcelConnection.funGetSheetData(workBookExecutionData, "TempStorage");
			// Map<String, Integer>
			// columData=ExcelConnection.funGetSheetColumns(workBookExecutionData,"TempStorage");

			Object JsonData = ExcelConnection.getExecutionDatafromDb(); // Mantis: 0001169
			List<List<String>> data = ExcelConnection.getSheetDataFromJSON(JsonData, "TempStorage");
			Map<String, Integer> columData = ExcelConnection.getColumnNamesFromJson(JsonData, "TempStorage");

			int fieldColumnIndex = ExcelConnection.funGetColumnIndex(ExecutionDataColumnHeader.FIELD_NAME.toString(),
					columData);
			int testCaseColumnIndex = ExcelConnection.funGetColumnIndex(ExecutionDataColumnHeader.TEST_CASE.toString(),
					columData);
			int fieldValueIndex = ExcelConnection.funGetColumnIndex(ExecutionDataColumnHeader.FIELD_VALUE.toString(),
					columData);
			int targetRow = ExcelConnection.funGetExecutionDataRecordNumber(testCaseColumnIndex, fieldColumnIndex,
					testCase, columnName, data);
			if (targetRow == -1) {
				debugLog("Removewords", "Could not find data for testcase :" + testCase + " Column:" + sDataColumn
						+ ", and data:" + dataForRemoval);
				return false;
			}
			String cellValue = data.get(targetRow).get(fieldValueIndex);

			String[] parts = dataForRemoval.split(" ");
			for (int i = 0; i < parts.length; i++) {
				cellValue = cellValue.replaceAll(parts[i], "");
			}

			// ExcelConnection.funPutExecutionDataRecord(workBookExecutionData,
			// "TempStorage", targetRow, testCaseColumnIndex, fieldColumnIndex,
			// fieldValueIndex, testCase, columnName, cellValue.trim(),
			// "ExecutionData.xlsx");
			// Mantis 0000713
			// ExcelConnection.funPutExecutionDataRecord(workBookExecutionData,
			// "TempStorage", targetRow, testCaseColumnIndex, fieldColumnIndex,
			// fieldValueIndex, testCase, columnName, cellValue.trim(),
			// "ExecutionData.xlsx",-1,"");
			ExcelConnection.putExecutionDataJson(columData, data, testCaseColumnIndex, fieldColumnIndex,
					fieldValueIndex, testCase, columnName, cellValue, targetRow, ""); // Mantis: 0001169
			return true;
		} catch (Exception e) {
			return false;
		}
	}

	/*
	 * ----------------------------------------START:
	 * ExtractWords---------------------------------------------- Function Name:
	 * ExtractWords Objective: A generic Function for extracting specific characters
	 * from a given string. This will be used in situations when get function gets a
	 * string that has additional data besides the one required Example:
	 * "The new transaction ID is 36363 for order" here everything is dynamic data
	 * and to extract specific data like 36363 we have used substring method. Date
	 * Created: 23/Nov/2016 Created By : Manoj Input: Output: revision by: Revision
	 * History: Modified on: Comments: Added as part of mantis ID 0000768
	 * -----------------------------------------------------------------------------
	 * ----------------------------
	 */

	public boolean ExtractWords(String testCase, String indexes, String columnName) {
		try {
			if (columnName.trim().length() == 0) {
				debugLog("Extractwords", "Columname has not been provided");
				return false;
			} else if (indexes.trim().length() == 0) {
				debugLog("Extractwords", "Data has not been provided");
				return false;
			}

			// Reading data from ExecutionData file
			// Workbook workBookExecutionData =
			// ExcelConnection.funExcelConnection("ExecutionData.xlsx");
			// List<List<String>> data=
			// ExcelConnection.funGetSheetData(workBookExecutionData, "TempStorage");
			// Map<String, Integer>
			// columData=ExcelConnection.funGetSheetColumns(workBookExecutionData,"TempStorage");

			Object JsonData = ExcelConnection.getExecutionDatafromDb(); // Mantis: 0001169
			List<List<String>> data = ExcelConnection.getSheetDataFromJSON(JsonData, "TempStorage");
			Map<String, Integer> columData = ExcelConnection.getColumnNamesFromJson(JsonData, "TempStorage");

			int fieldColumnIndex = ExcelConnection.funGetColumnIndex(ExecutionDataColumnHeader.FIELD_NAME.toString(),
					columData);
			int testCaseColumnIndex = ExcelConnection.funGetColumnIndex(ExecutionDataColumnHeader.TEST_CASE.toString(),
					columData);
			int fieldValueIndex = ExcelConnection.funGetColumnIndex(ExecutionDataColumnHeader.FIELD_VALUE.toString(),
					columData);
			int targetRow = ExcelConnection.funGetExecutionDataRecordNumber(testCaseColumnIndex, fieldColumnIndex,
					testCase, columnName, data);

			if (targetRow == -1) {
				debugLog("Extractwords", "Could not find data for testcase :" + testCase + " Column:" + sDataColumn
						+ ", and data:" + indexes);
				return false;
			}
			String cellValue = data.get(targetRow).get(fieldValueIndex);

			String[] parts = indexes.split("\\|");
			int beginingIndex = Integer.parseInt(parts[0].trim());
			int endindex = Integer.parseInt(parts[1].trim());

			cellValue = cellValue.substring(beginingIndex, endindex);

			// ExcelConnection.funPutExecutionDataRecord(workBookExecutionData,
			// "TempStorage", targetRow, testCaseColumnIndex, fieldColumnIndex,
			// fieldValueIndex, testCase, columnName, cellValue.trim(),
			// "ExecutionData.xlsx");
			// Mantis 0000713
			// ExcelConnection.funPutExecutionDataRecord(workBookExecutionData,
			// "TempStorage", targetRow, testCaseColumnIndex, fieldColumnIndex,
			// fieldValueIndex, testCase, columnName, cellValue.trim(),
			// "ExecutionData.xlsx",-1,"");
			ExcelConnection.putExecutionDataJson(columData, data, testCaseColumnIndex, fieldColumnIndex,
					fieldValueIndex, testCase, columnName, cellValue, targetRow, ""); // Mantis: 0001169
			return true;
		} catch (Exception e) {
			return false;
		}
	}

	// Mantis 0000735
	public boolean ToUpper(String testCase, String columnName) {
		try {
			if (columnName.trim().length() == 0) {
				debugLog("To Upper", "Columname has not been provided");
				return false;
			}

			// Reading data from ExecutionData file
			// Workbook workBookExecutionData =
			// ExcelConnection.funExcelConnection("ExecutionData.xlsx");
			// List<List<String>> data=
			// ExcelConnection.funGetSheetData(workBookExecutionData, "TempStorage");
			// Map<String, Integer>
			// columData=ExcelConnection.funGetSheetColumns(workBookExecutionData,"TempStorage");

			Object JsonData = ExcelConnection.getExecutionDatafromDb(); // Mantis: 0001169
			List<List<String>> data = ExcelConnection.getSheetDataFromJSON(JsonData, "TempStorage");
			Map<String, Integer> columData = ExcelConnection.getColumnNamesFromJson(JsonData, "TempStorage");

			int fieldColumnIndex = ExcelConnection.funGetColumnIndex(ExecutionDataColumnHeader.FIELD_NAME.toString(),
					columData);
			int testCaseColumnIndex = ExcelConnection.funGetColumnIndex(ExecutionDataColumnHeader.TEST_CASE.toString(),
					columData);
			int fieldValueIndex = ExcelConnection.funGetColumnIndex(ExecutionDataColumnHeader.FIELD_VALUE.toString(),
					columData);
			int targetRow = ExcelConnection.funGetExecutionDataRecordNumber(testCaseColumnIndex, fieldColumnIndex,
					testCase, columnName, data);
			if (targetRow == -1) {
				debugLog("To Upper", "Could not find data for testcase :" + testCase + " Column:" + sDataColumn);
				return false;
			}
			String cellValue = data.get(targetRow).get(fieldValueIndex);
			if (cellValue != null) {
				// ExcelConnection.funPutExecutionDataRecord(workBookExecutionData,
				// "TempStorage", targetRow, testCaseColumnIndex, fieldColumnIndex,
				// fieldValueIndex, testCase, columnName, cellValue.trim(),
				// "ExecutionData.xlsx");
				// Mantis 0000713
				// ExcelConnection.funPutExecutionDataRecord(workBookExecutionData,
				// "TempStorage", targetRow, testCaseColumnIndex, fieldColumnIndex,
				// fieldValueIndex, testCase, columnName, cellValue.trim().toUpperCase(),
				// "ExecutionData.xlsx",-1,"");
				ExcelConnection.putExecutionDataJson(columData, data, testCaseColumnIndex, fieldColumnIndex,
						fieldValueIndex, testCase, columnName, cellValue, targetRow, ""); // Mantis: 0001169
				return true;
			} else {
				systemouts("Value was blank hence not converting to uppercase");
				return true;
			}
		} catch (Exception e) {
			return false;
		}
	}

	public boolean changeDateFormat(String testCase, String columnName) throws Exception // Mantis 0000773
	{
		try {
			if (dateFormat.trim().length() == 0) { // Mantis 0000785

				throw new Exception("Date format is not set by setdateformat keyword");

			}

			if (columnName.trim().length() == 0) {
				debugLog("changeDateFormat", "Columname has not been provided");
				return false;
			}

			// Reading data from ExecutionData file
			// Workbook workBookExecutionData =
			// ExcelConnection.funExcelConnection("ExecutionData.xlsx");
			// List<List<String>> data=
			// ExcelConnection.funGetSheetData(workBookExecutionData, "TempStorage");
			// Map<String, Integer>
			// columData=ExcelConnection.funGetSheetColumns(workBookExecutionData,"TempStorage");

			Object JsonData = ExcelConnection.getExecutionDatafromDb(); // Mantis: 0001169
			List<List<String>> data = ExcelConnection.getSheetDataFromJSON(JsonData, "TempStorage");
			Map<String, Integer> columData = ExcelConnection.getColumnNamesFromJson(JsonData, "TempStorage");

			int fieldColumnIndex = ExcelConnection.funGetColumnIndex(ExecutionDataColumnHeader.FIELD_NAME.toString(),
					columData);
			int testCaseColumnIndex = ExcelConnection.funGetColumnIndex(ExecutionDataColumnHeader.TEST_CASE.toString(),
					columData);
			int fieldValueIndex = ExcelConnection.funGetColumnIndex(ExecutionDataColumnHeader.FIELD_VALUE.toString(),
					columData);
			int commentsColumnIndex = ExcelConnection.funGetColumnIndex(ExecutionDataColumnHeader.COMMENTS.toString(),
					columData);
			int targetRow = ExcelConnection.funGetExecutionDataRecordNumber(testCaseColumnIndex, fieldColumnIndex,
					testCase, columnName, data);
			if (targetRow == -1) {
				debugLog("changeDateFormat",
						"Could not find data for testcase :" + testCase + " Column:" + sDataColumn);
				return false;
			}
			String cellValue = data.get(targetRow).get(fieldValueIndex);
			String oldDateFormat = data.get(targetRow).get(commentsColumnIndex);

			DateFormat formatter;
			formatter = new SimpleDateFormat(oldDateFormat);
			Date dt = (Date) formatter.parse(cellValue);
			SimpleDateFormat sdf = new SimpleDateFormat(dateFormat);
			cellValue = sdf.format(dt);

			if (cellValue != null) {
				systemouts("New value after replacing is :" + cellValue);
				// ExcelConnection.funPutExecutionDataRecord(workBookExecutionData,
				// "TempStorage", targetRow, testCaseColumnIndex, fieldColumnIndex,
				// fieldValueIndex, testCase, columnName, cellValue,
				// "ExecutionData.xlsx",-1,"");
				ExcelConnection.putExecutionDataJson(columData, data, testCaseColumnIndex, fieldColumnIndex,
						fieldValueIndex, testCase, columnName, cellValue, targetRow, ""); // Mantis: 0001169
				return true;
			} else {
				systemouts("Value was blank hence not changing the date format");
				return true;
			}
		} catch (Exception e) {
			throw new Exception(e.getMessage()); // Mantis 0000785
		}
	}

	/*
	 * --------------------------------------- START :
	 * writeFunctionalLog---------------------------------------------- Function
	 * Name: writeFunctionalLog Objective: A Function to call functional log Date
	 * Created: Input: Output: Revision History: Modified on: Comments:
	 * -----------------------------------------------------------------------------
	 * ----------------------------
	 */
	/*
	 * void writeFunctionalLog() { oFunctionLog.writeFunctionalLog(); } /*
	 * --------------------------------------- START :
	 * executeTestCase---------------------------------------------- Function Name:
	 * executeTestCase Objective: A generic Function to execute given test case on
	 * application Date Created: Input: sTestCaseExcelPath = Entire path of the
	 * excel file where test cases sequence / order is defined sTestCaseData = Data
	 * for the test case Output: Revision History: Modified by: Heramb Modified
	 * on:19/11/2015,07/12/2015,10/12/2015,18/12/2015, 22/12/2015, 26/12/2015,
	 * 11/01/2016, 22/07/2016 Comments: Get the excel connection, read all the data
	 * from the page sheet(e.g. identifier, identifierValue, userAction, DataColumn
	 * etc.) . Check for Datacolumn data if( not null) execute the query to get the
	 * data from data worksheet. If (data not null and userAction not null ) apply
	 * the switch case for different userActions (e.g. click, set, get etc. ) and
	 * call the required function(e.g. set, click, hover etc. ) with required
	 * parameters. Log the steps. Else Step not performed. Finally Close the
	 * connection Modification comments: - ignore useractions containing Dynamic in
	 * the text to get data from data sheet - Implemented the call to function -
	 * Implemented FileExists keyword - Merged existing dynamicClick functionality
	 * into Click functionality - New DynamicClick functionality added as per which
	 * the data to be dynamically clicked is saved in Execution_Data.xlsx by using
	 * "Get" keyword and "DynamicClick" keyword is used when the link needs to be
	 * clicked. - Change in Alert functionality 1) "Accept" Keyword to Accept Alert,
	 * Provided Yes or No value is present in DataSheet corresponding DataColumn in
	 * PageSheet 2) "Decline" Keyword to Dismiss Alert, Provided Yes or No value is
	 * present in DataSheet corresponding DataColumn in PageSheet 3) "AlertText"
	 * Keyword to fetch Text present on Alert Box. Verification of Alert Text with
	 * value provided in DataSheet 4) "OptionalAlert" Keyword to Suppress unexpected
	 * alerts coming in the execution. - Added Right Click and Dynamic Right
	 * Click(dynamicclickr) functionality - Added AutoComplete Functionality - Added
	 * Append and DynamicAppend Functionality - Added ThinkTime Functionality -
	 * Added code for creating description string if not provided by user. If
	 * sUserAction = Click, sDescription = sUserAction + sIdentifierValue else
	 * sDescription = sUserAction + sDataColumn/sUserAction + sDataColumn +
	 * sTestStepData
	 * 
	 * -----------------------------------------------------------------------------
	 * ----------------------------
	 */

	@SuppressWarnings("unused")
	void executeTestCase(String sTestCaseExcelPath, String sTestCaseData, String sntlm, String username,
			String password, String Driver) throws Exception // Mantis 0001131
	{
		Workbook pageWorkboook = null;
		List<List<String>> resultSetPage;
		Map<String, Integer> columnsPage;
		List<String> recordPage;
		ListIterator<List<String>> iteratorPage;

		Connection con = null;
		HashMap<String, String> FileData = null; // Mantis 0001097
		HashMap<String, String> PropertyDetailFileData = null; // Mantis 0001149
		sForLoopCounter = 0; // Mantis 0001097
		sAeroPropertyFlag = false; // Mantis 0001097
		String sReportFile = "", sSheetName = "", sPropertyDetailfile, sPDSheetName; // Mantis 0001149
		con = null;
		sComments = "";
		String sData = "",dynamicField = "",dynamicValue = "";
		// float fIndex;
		String sDescription = "";
		sExpectedData = "";
		String[] Elements = new String[10];
		String Element1, Element2;
		int actualRowNumber, lastRow;
		this.sTestCaseData = sTestCaseData;
		iStepNo = 0;
		// Mantis 0001911
		HashMap<String, String> script_testcase = new HashMap<String, String>();
		int scriptindex = sTestCaseExcelPath.lastIndexOf("/") >= sTestCaseExcelPath.lastIndexOf("\\")
				? sTestCaseExcelPath.lastIndexOf("/")
						: sTestCaseExcelPath.lastIndexOf("\\");
				if (scriptindex == -1)
					script_testcase.put(ImageVerificationJsonKeys.SCRIPT.toString(), sTestCaseExcelPath);
				else
					script_testcase.put(ImageVerificationJsonKeys.SCRIPT.toString(),
							sTestCaseExcelPath.substring(scriptindex + 1));
				script_testcase.put(ImageVerificationJsonKeys.TEST_CASE.toString(), sTestCaseData);
				scriptTestCase.add(script_testcase);
				Webserver	="/10.20.3.10/Shared/Bizmatics/FrameworkRoot/QWebServer/";
				//Webserver = ExcelConnection.getPollerConfiguration("WebServer").replaceAll("\\\\", "/"); // Mantis 0001917
				// Mantis 0001911

				try {

					this.sTestCaseExcelPath = sTestCaseExcelPath;
					File f = new File(sTestCaseExcelPath);
					if ((f.exists()) || (Driver.startsWith("{"))) // Zoheb XXX
					{
						sActualValue = "";
						if (Driver.startsWith("{")) {

							Object JsonData = ExcelConnection.getScriptJsonfromDB(sTestCaseExcelPath);
							columnsPage = ExcelConnection.getColumnNamesFromJson(JsonData, "Page");
							resultSetPage = ExcelConnection.getSheetDataFromJSON(JsonData, "Page");
							iteratorPage = resultSetPage.listIterator();
						} else {
							pageWorkboook = ExcelConnection.funExcelConnection(sTestCaseExcelPath);
							columnsPage = ExcelConnection.funGetSheetColumns(pageWorkboook, "Page");
							resultSetPage = ExcelConnection.funGetSheetData(pageWorkboook, "Page");
							iteratorPage = resultSetPage.listIterator();
							pageWorkboook.close();
						}

						while (iteratorPage.hasNext()) {
							sComments = "";
							recordPage = iteratorPage.next();
							iSkippedElements = 0;
							iCountOfLabels = 0;
							currElement = null;
							iCurrentContext = 0;
							sScreenShotFilePath = "";

							Apiservices apiserviceObj = new Apiservices();

							// Thread.sleep(lThinkTime*1000);

							iStepNo = iStepNo + 1;

							if (columnsPage.containsKey(PageColumnHeader.CONTROL_TYPE.toString())) {
								sControlType = recordPage.get(columnsPage.get(PageColumnHeader.CONTROL_TYPE.toString()));
								if (sControlType != null)
									sControlType = sControlType.trim();
								else // Mantis 0001035
									sControlType = "webelement";
							} else {
								sControlType = "webelement"; // Mantis 0001035
								/*
								 * NoSuchFieldException e = new
								 * NoSuchFieldException("Control_Type Column Does Not Exist in Test Case Excel"
								 * ); throw e;
								 */
							}

							if (columnsPage.containsKey(PageColumnHeader.IDENTIFIER.toString())) {
								sIdentifier = recordPage.get(columnsPage.get(PageColumnHeader.IDENTIFIER.toString()));
								if (sIdentifier.length() == 0)
									sIdentifier = null;

								if (sIdentifier != null)
									sIdentifier = sIdentifier.trim();
							} else {
								NoSuchFieldException e = new NoSuchFieldException(
										"Identifier Column Does Not Exist in Test Case Excel");
								throw e;
							}

							if (columnsPage.containsKey(PageColumnHeader.IDENTIFIER_VALUE.toString())) {
								sIdentifierValue = recordPage
										.get(columnsPage.get(PageColumnHeader.IDENTIFIER_VALUE.toString()));
								if (sIdentifierValue.trim().isEmpty())
									sIdentifierValue = null;

								if (sIdentifierValue != null)
									sIdentifierValue = sIdentifierValue.trim();
							} else {
								NoSuchFieldException e = new NoSuchFieldException(
										"Identifier_Value Column Does Not Exist in Test Case Excel"); // Mantis 0000789
								throw e;
							}

							if (columnsPage.containsKey(PageColumnHeader.INDEX.toString())) {
								sIndex = recordPage.get(columnsPage.get(PageColumnHeader.INDEX.toString()));
								if (sIndex != null)
									sIndex = sIndex.trim();
								if (sIndex == null || sIndex.equalsIgnoreCase("")) {
									iIndex = -1;
								} else {
									iIndex = Integer.parseInt(sIndex);
								}
							} else {
								NoSuchFieldException e = new NoSuchFieldException(
										"Index Column Does Not Exist in Test Case Excel"); // Mantis 0000789
								throw e;
							}

							if (columnsPage.containsKey(PageColumnHeader.USER_ACTION.toString())) {
								sUserAction = recordPage.get(columnsPage.get(PageColumnHeader.USER_ACTION.toString()));
								if (sUserAction.trim().isEmpty())
									sUserAction = null;

								if (sUserAction != null)
									sUserAction = sUserAction.trim();
							} else {
								NoSuchFieldException e = new NoSuchFieldException(
										"User_Action Column Does Not Exist in Test Case Excel");
								throw e;
							}

							if (columnsPage.containsKey(PageColumnHeader.DATA_COLUMN.toString())) {
								sDataColumn = recordPage.get(columnsPage.get(PageColumnHeader.DATA_COLUMN.toString())); // Mantis:
								// 1491

								if (sDataColumn.trim().isEmpty())
									sDataColumn = null;

								if (sDataColumn != null) {
									// Mantis 0000478
									if (sDataColumn.contains(";") == true) {
										String[] partsOfDataColumn = new String[50];
										partsOfDataColumn = sDataColumn.split(";");
										sDataColumn = partsOfDataColumn[0];
										sRemoveWordsColumn = partsOfDataColumn[1];
									}
									sDataColumn = sDataColumn.trim();
								}
							} else {
								NoSuchFieldException e = new NoSuchFieldException(
										"Data_Column Does Not Exist in Test Case Excel");
								throw e;
							}

							if (columnsPage.containsKey(PageColumnHeader.PROPERTY.toString())) {
								sVerifyProperty = recordPage.get(columnsPage.get(PageColumnHeader.PROPERTY.toString()));
								if (sVerifyProperty.trim().isEmpty()) // Mantis: 0001195
									sVerifyProperty = null;

								if (sVerifyProperty != null)
									sVerifyProperty = sVerifyProperty.trim();
							} else {
								NoSuchFieldException e = new NoSuchFieldException("Property Column Does Not Exist");
								throw e;
							}

							if (columnsPage.containsKey(PageColumnHeader.SCREENSHOTS.toString())) {
								sTakeScreenShot = recordPage.get(columnsPage.get(PageColumnHeader.SCREENSHOTS.toString()));
								if (sTakeScreenShot.trim().isEmpty())
									sTakeScreenShot = null;

								if (sTakeScreenShot != null)
									sTakeScreenShot = sTakeScreenShot.trim();
							} else {
								NoSuchFieldException e = new NoSuchFieldException("Screenshots Column Does Not Exist");
								throw e;
							}

							sTestStepData = "";
							/// 0000458 Added GetGuid action
							if (sDataColumn != null && (!sDataColumn.isEmpty())
									&& ((sUserAction.equalsIgnoreCase("get") && sControlType.equalsIgnoreCase("alert"))
											|| !(sUserAction.equalsIgnoreCase("get")))
									&& !(sUserAction.equalsIgnoreCase("dynamicset"))
									&& !(sUserAction.equalsIgnoreCase("dynamicappend"))
									&& !(sUserAction.equalsIgnoreCase("dynamicclick"))
									&& !(sUserAction.equalsIgnoreCase("dynamicdoubleclick")) // Mantis 0000889
									&& !(sUserAction.equalsIgnoreCase("dynamicclickr"))
									&& !(sUserAction.equalsIgnoreCase("getguid"))
									&& !(sUserAction.equalsIgnoreCase("dynamicverify")) // Mantis 0000688
									&& !(sUserAction.equalsIgnoreCase("dynamicstartswith")) // Mantis 0000916
									&& !(sUserAction.equalsIgnoreCase("dynamicendswith")) // Mantis 0000916
									&& !(sUserAction.equalsIgnoreCase("dynamiccontains")) // Mantis 0000916
									// && !(sUserAction.equalsIgnoreCase("getdate")) //Mantis 0000713 Deepankar
									&& !(sUserAction.equalsIgnoreCase("toupper")) // Mantis 0000735
									&& !(sUserAction.equalsIgnoreCase("setframe")) // Manoj xxx
									&& !(sUserAction.equalsIgnoreCase("isblank")) // Mantis 0000901
									&& !(sUserAction.equalsIgnoreCase("hasvalue")) // Mantis 0000941
									&& !(sUserAction.equalsIgnoreCase("scrollto")) // Mantis 0000954
									&& !(sUserAction.equalsIgnoreCase("dynamicverifyapi")) // Mantis 0001146
									&& !(sUserAction.equalsIgnoreCase("getelements")) // Mantis 0001136
									&& !(sUserAction.equalsIgnoreCase("addelements")) // Mantis 0001139
									&& !(sUserAction.equalsIgnoreCase("verifypropertydetails")) // Mantis 0001149
									&& !(sUserAction.equalsIgnoreCase("dynamicautoupload")) // Mantis 0001084
									&& !(sUserAction.equalsIgnoreCase("gettrim")) // Mantis 0001130,0001229
									&& !(sUserAction.equalsIgnoreCase("tointeger")) // Mantis 0001477
									&& !(sUserAction.equalsIgnoreCase("dynamicclickjs")) // Mantis 0001531
									&& !(sUserAction.equalsIgnoreCase("dynamicoptionalclick")) // Mantis 0001816
									&& !(sUserAction.equalsIgnoreCase("getelementcount")) // Mantis 0001816
									&& !(sUserAction.equalsIgnoreCase("storecoordinate")) // Mantis 0001816
									&& !(sUserAction.equalsIgnoreCase("dynamiccontainsattach")) // Mantis 0001816
									&& !(sUserAction.equalsIgnoreCase("storedataforreport")) // Mantis 0001816
									&& !(sUserAction.equalsIgnoreCase("iffilenotexist")) // Mantis 0001836
									&& !(sUserAction.equalsIgnoreCase("dynamicstoredataforreport")) // Mantis 0001895
									&& !(sUserAction.equalsIgnoreCase("ifexistsetfilename")) // Mantis 0001895
									&& !(sUserAction.equalsIgnoreCase("captureimage")) // Mantis 0001911
									&& !(sUserAction.equalsIgnoreCase("ignoreregion")) // Mantis 0001911
									&& !(sUserAction.equalsIgnoreCase("emailnotify"))
									&& !(sUserAction.equalsIgnoreCase("getapidata")) // Mantis 2009
									&& !(sUserAction.equalsIgnoreCase("getapi"))
									&& !(sUserAction.equalsIgnoreCase("getAPI404"))
									&& !(sUserAction.equalsIgnoreCase("extractjson"))
									&& !(sUserAction.equalsIgnoreCase("extractjsonvalue"))
									&& !(sUserAction.equalsIgnoreCase("delete")) 
									) {
								sTestStepData = getValueFromDataSheet(Driver, sTestCaseExcelPath, sTestCaseData, sDataColumn); // Mantis
								// 0001911
							}

							if (columnsPage.containsKey(PageColumnHeader.DESCRIPTION.toString())) {
								sDescription = recordPage.get(columnsPage.get(PageColumnHeader.DESCRIPTION.toString()));
								if (sDescription == null || sDescription.trim().isEmpty()) {
									// if(sUserAction.equalsIgnoreCase("click") ||
									// sUserAction.equalsIgnoreCase("highlight") ||
									// sUserAction.equalsIgnoreCase("attach") ) //Mantis 0000472, 0000505
									if (sUserAction.equalsIgnoreCase("click") || sUserAction.equalsIgnoreCase("highlight")
											|| sUserAction.equalsIgnoreCase("attach")
											|| sUserAction.equalsIgnoreCase("scrollto")
											|| sUserAction.equalsIgnoreCase("objectexist")) // Mantis 0000786
									{
										if (sIdentifierValue != null)
											sDescription = sUserAction + " " + sIdentifierValue;
										else if (sTestStepData != null)
											sDescription = sUserAction + " " + sTestStepData;
										// systemouts(sDescription); //Mantis 0000774
									} else {
										sDescription = sUserAction;
										if (sDataColumn != null && !sDataColumn.trim().isEmpty()) {
											if (sTestStepData == null || sTestStepData.isEmpty())
												sDescription = sDescription + " " + sDataColumn;
											else
												sDescription = sDescription + " " + sDataColumn + "=>" + sTestStepData;
										}
									}
								}

								sStepDescription = recordPage.get(columnsPage.get(PageColumnHeader.DESCRIPTION.toString()));
								if (sStepDescription == null || sStepDescription.trim().isEmpty()) {
									sStepDescription = sDescription;
									// systemouts("Constructing Final Description:"+sStepDescription); //Mantis
									// 0000774
								} else {
									sStepDescription = "User Comments:" + sStepDescription;
									// systemouts("Constructing Final Description:"+sStepDescription); //Mantis
									// 0000783
								}
							} else {
								NoSuchFieldException e = new NoSuchFieldException("Description Column Does Not Exist");
								throw e;
							}
							if (sForLoopStatus == true) // Mantis 0001816
								iIndex = sForLoopCounter;

							sStepStatus = "Pass";
							String stepParts[]; // Mantis 0001092
							String filepath = ""; // Mantis 0001092
							String Searchtext = ""; // Mantis 0001092
							int found = 0; // Mantis 0001092

							if (sTestStepData != null && sUserAction != null
									&& (sConditionalStart == true || sUserAction.equalsIgnoreCase("conditionalstop"))
									&& (sConditionalFileExist == true || sUserAction.equalsIgnoreCase("endiffilenotexist"))) // Mantis
								// 0001836
							{
								sStepStatus = "Pass";
								switch (sUserAction.trim().toLowerCase()) {
								case "conditionalstart":
									// Mantis 0000911
									sConditionalStart = false; // Mantis 0000929
									if (sIdentifierValue != null && !sIdentifierValue.isEmpty()) // Mantis 0000923
									{
										if (sIdentifierValue.contains("##")) {
											sData = dynamicSet(sTestCaseData, sDataColumn);
											sIdentifierValue = sIdentifierValue.replace("##", "'".concat(sData).concat("'"));
										}
									}

									if (sTestStepData != null && !sTestStepData.isEmpty()) {
										systemouts("Test Data for conditional execution:" + sTestStepData);

										if ((sIdentifier != null && !sIdentifier.isEmpty())
												&& (sIdentifierValue != null && !sIdentifierValue.isEmpty())) {
											sExpectedData = sTestStepData;
											if (sVerifyProperty == null) {
												sVerifyProperty = "text";
												debugLog("Object Sync",
														"Property Not Provided in Page Sheet Default Property : Text");
											}
											sStepStatus = verifyProperty(sControlType, sIdentifier, sIdentifierValue,
													sVerifyProperty, iIndex, sExpectedData);
										} else // Mantis 0000923
										{
											sStepStatus = executeSQL(sTestStepData, sIdentifier, sTestCaseData);
										}

										if (sStepStatus.equalsIgnoreCase("pass"))
											sConditionalStart = true;
										else
											sStepStatus = "Pass"; // Mantis 0000877
									} else {
										sConditionalStart = waitForElement(sIdentifier, sIdentifierValue, iIndex); // Mantis
										// 0000879
									}
									systemouts("Conditional Start:" + sConditionalStart);
									if (!sConditionalStart)
										sDescription = "Condition Object does not exist";
									sStepDescription = sDescription;
									break;

								case "conditionalstop":
									sConditionalStart = true;
									systemouts("Conditional Stop:" + sConditionalStop);
									break;
								case "setfilelocation": // Mantis 0001836
									if (sTestStepData.startsWith("~")) // Mantis: 0001301
									{
										sTestStepData = sTestStepData.replaceFirst("~", "");
										sTestStepData = GenerateRandom(sTestStepData);
									}
									if (!sTestStepData.isEmpty()) {
										filelocation = sTestStepData;
										dynamicGet(sTestCaseData, sDataColumn, filelocation, ""); // Mantis 0001895
									} else
										sStepStatus = "Fail";
									sActualValue = filelocation;
									sComments = "File location set to " + filelocation;

									break;
								case "setfileextension": // Mantis 0001836
									if (sTestStepData.startsWith("~")) // Mantis: 0001301
									{
										sTestStepData = sTestStepData.replaceFirst("~", "");
										sTestStepData = GenerateRandom(sTestStepData);
									}
									if (!sTestStepData.isEmpty()) {
										fileextension = sTestStepData.split(",");
										dynamicGet(sTestCaseData, sDataColumn, sTestStepData, ""); // Mantis 0001895
									} else
										sStepStatus = "Fail";
									sComments = "Allowed File Extension set to " + fileextension.toString();

									break;

								case "iffilenotexist": // Mantis 0001836
									sConditionalFileExist = false;

									if (sDataColumn != null && !sDataColumn.isEmpty()) {
										if (filelocation.isEmpty() || fileextension.length == 0) {
											sComments = "Please use useraction 'setfilelocation' & 'setfileextenion' before using 'iffilenotexist'";
											throw new Exception(sComments);
										}
										sStepStatus = checkcustomfile(dynamicSet(sTestCaseData, sDataColumn));
										systemouts("Test Data for conditional 'iffilenotexist' execution:" + sTestStepData);

										if (sStepStatus.equalsIgnoreCase("fail")) {
											// sConditionalStart=true;
											// change will
											sConditionalFileExist = true;
											sStepStatus = "Pass";
											sDescription = "Condition File does not exist ";
										} else {
											// sConditionalStart=false;
											sConditionalFileExist = false;
											sDescription = "Condition File  exist " + sStepStatus;
											conditionFileName = sStepStatus;
											sStepStatus = "Pass"; // Mantis 0000877

										}
									}
									systemouts("Conditional Start:" + sConditionalFileExist);
									sStepDescription = sDescription;
									break;
								case "endiffilenotexist": // Mantis 0001836
									// sConditionalStart=true;
									sConditionalFileExist = true;
									conditionFileName = "";
									systemouts("Conditional Stop:" + sConditionalStop);
									break;

								case "do": // Mantis 0000930
									systemouts("Start Performing do-while Operation");
									maxLimit = Integer.parseInt(sTestStepData);
									break;
								case "while": // Mantis 0000930
									boolean sWhileCondition = true, sActionFound = false;
									if (sWhileCounter < maxLimit) {
										if (sIdentifierValue != null && !sIdentifierValue.isEmpty()) {
											if (sIdentifierValue.contains("##")) {
												sData = dynamicSet(sTestCaseData, sDataColumn);
												sIdentifierValue = sIdentifierValue.replace("##",
														"'".concat(sData).concat("'"));
											}
										}

										if (sTestStepData != null && !sTestStepData.isEmpty()) {
											systemouts("Test Data for conditional execution:" + sTestStepData);

											if ((sIdentifier != null && !sIdentifier.isEmpty())
													&& (sIdentifierValue != null && !sIdentifierValue.isEmpty())) {
												sExpectedData = sTestStepData;
												if (sVerifyProperty == null) {
													sVerifyProperty = "text";
													debugLog("Object Sync",
															"Property Not Provided in Page Sheet Default Property : Text");
												}
												sStepStatus = verifyProperty(sControlType, sIdentifier, sIdentifierValue,
														sVerifyProperty, iIndex, sExpectedData);
											}
											if (sStepStatus.equalsIgnoreCase("fail")) {
												sWhileCondition = false;
												sStepStatus = "Pass"; // Mantis 0000877
											}
										} else {
											sWhileCondition = waitForElement(sIdentifier, sIdentifierValue, iIndex); // Mantis
											// 0000879
										}
										systemouts("While Condition:" + sWhileCondition);
										if (!sWhileCondition) {
											systemouts(
													"Expected Object does not exist, so start executing previous steps again");
											iteratorPage.previous();
											while (iteratorPage.hasPrevious()) {
												recordPage = iteratorPage.previous();
												iStepNo = iStepNo - 1;
												if (columnsPage.containsKey(PageColumnHeader.USER_ACTION.toString())) {
													sUserAction = recordPage
															.get(columnsPage.get(PageColumnHeader.USER_ACTION.toString()));
													if (sUserAction != null)
														sUserAction = sUserAction.trim();
												} else {
													NoSuchFieldException e = new NoSuchFieldException(
															"User_Action Column Does Not Exist in Test Case Excel");
													throw e;
												}
												if (sUserAction.equalsIgnoreCase("do")) {
													iteratorPage.next();
													sActionFound = true;
													break;
												}
											}
											if (!sActionFound)
												sDescription = "do useraction does not exist in given page sheet";
											else
												sDescription = "Found do useration and Reexecuting steps from do useraction";

											sWhileCounter++;
										} else {
											sWhileCounter = 0;
										}
									} else {
										sWhileCounter = 0;
										throw new CustomException("While loop exceeds max limit of re-execution counter");
									}

									sStepDescription = sDescription;
									break;

									// Mantis 0001097
								case "foreach":
									sForLoopData = new ArrayList<String>(Arrays.asList(sTestStepData.split("\\|")));

									if (sForLoopCounter < sForLoopData.size()) {
										if (sForLoopCounter == 0)
											sAeroPropertyFlag = true;
										sForLoopStatus = true;
										sForLoopDataColumn = sDataColumn;
										sForLoopVariable = sForLoopData.get(sForLoopCounter);
										sForLoopCounter++;
									}

									sStepDescription = sDescription;

									break;

									// Mantis 0001097
								case "endforeach":
									boolean sForActionFound = false;
									if (sForLoopCounter < sForLoopData.size()) {
										systemouts("Re-executing the for loop");

										iteratorPage.previous();
										while (iteratorPage.hasPrevious()) {
											recordPage = iteratorPage.previous();
											iStepNo = iStepNo - 1;
											if (columnsPage.containsKey(PageColumnHeader.USER_ACTION.toString())) {
												sUserAction = recordPage
														.get(columnsPage.get(PageColumnHeader.USER_ACTION.toString()));
												if (sUserAction != null)
													sUserAction = sUserAction.trim();
											} else {
												NoSuchFieldException e = new NoSuchFieldException(
														"User_Action Column Does Not Exist in Test Case Excel");
												throw e;
											}
											if (sUserAction.equalsIgnoreCase("foreach")) {
												sForActionFound = true;
												break;
											}
										}
										if (!sForActionFound)
											sDescription = "forEach useraction does not exist in given page sheet";
										else
											sDescription = "Found foreach useration and Reexecuting steps from forEach useraction";

									} else {
										sForLoopCounter = 0;
										sForLoopVariable = "";
										sForLoopStatus = false;

										systemouts("For Loop exceeds the counter");
										sDescription = "ForLoop completed...!!!";
									}

									sStepDescription = sDescription;
									break;
								case "repeatsteps": // Mantis 0001136,0001816
									if (waitForElements(lElementWait, sIdentifier, sIdentifierValue)) // Mantis 1758
									{
										sForLoopElements = getElements(sControlType, sIdentifier, sIdentifierValue);
									} else {
										sForLoopElements = null;
									}
									// sForLoopData=getElements(sControlType, sIdentifier, sIdentifierValue);
									if (sForLoopCounter < sForLoopElements.size()) {
										/*
										 * if(sForLoopCounter==0) sAeroPropertyFlag=true;
										 */
										sForLoopStatus = true;
										sForLoopDataColumn = sDataColumn;
										sForLoopVariableElement = sForLoopElements.get(sForLoopCounter);
										rowdata = new ArrayList<String>(); // storedatainreport
										rowdata.add(sTestCaseData);
									}
									sStepDescription = sDescription;
									break;

								case "endrepeatsteps": // Mantis 0001136,0001816
									sForLoopCounter++;
									sForActionFound = false;
									if (sForLoopCounter < sForLoopElements.size()) {
										systemouts("Re-executing the for loop");
										iteratorPage.previous();
										while (iteratorPage.hasPrevious()) {
											recordPage = iteratorPage.previous();
											iStepNo = iStepNo - 1;
											if (columnsPage.containsKey(PageColumnHeader.USER_ACTION.toString())) {
												sUserAction = recordPage
														.get(columnsPage.get(PageColumnHeader.USER_ACTION.toString()));
												if (sUserAction != null)
													sUserAction = sUserAction.trim();
											} else {
												NoSuchFieldException e = new NoSuchFieldException(
														"User_Action Column Does Not Exist in Test Case Excel");
												throw e;
											}
											if (sUserAction.equalsIgnoreCase("repeatsteps")) {
												sForActionFound = true;
												break;
											}
										}
										if (!sForActionFound)
											sDescription = "repeatsteps useraction does not exist in given page sheet";
										else
											sDescription = "Found repeatsteps useration and Reexecuting steps from forEach useraction";
									} else {
										sForLoopCounter = 0;
										sForLoopVariableElement = null;
										sForLoopStatus = false;

										systemouts("For Loop exceeds the counter");
										sDescription = "ForLoop completed...!!!";
									}
									if (rowdata != null) // storedatainreport
									{
										if (rowdata.size() > 2)
											customReportData.add(rowdata);
									}
									sStepDescription = sDescription;
									break;
								case "storedataforreport": // Mantis 0001816
									if (sIdentifierValue.contains("##")) {
										sData = dynamicSet(sTestCaseData, sDataColumn);
										sIdentifierValue = sIdentifierValue.replace("##", "'".concat(sData).concat("'"));
									}
									customReport = true;
									sData = get(sControlType, sIdentifier, sIdentifierValue, iIndex);
									systemouts("Data : " + sData);
									if (customReportDataHeader.size() == 0) {
										customReportDataHeader.put(customReportDataHeader.size(), "Sr.No.");
										customReportDataHeader.put(customReportDataHeader.size(), "Test_Case");
									}
									if (!customReportDataHeader.containsValue(sDataColumn))
										customReportDataHeader.put(customReportDataHeader.size(), sDataColumn);
									if (sData == null || sData.trim().length() == 0)
										sData = "-";
									rowdata.add(sData); // storedatainreport
									// dynamicGet(sTestCaseData, sDataColumn, sData, ""); // Mantis 0000713
									sComments = "The Operation Returned Value :" + sData;
									sActualValue = sData; // 0000518
									break;
								case "dynamicstoredataforreport": // Mantis 0001895
									if (sDataColumn != null || sDataColumn.length() > 0)
										sData = dynamicSet(sTestCaseData, sDataColumn);
									else
										sData = "";
									System.out.println("Data returned from dynamic store ... " + sData);
									customReport = true;
									if (customReportDataHeader.size() == 0) {
										customReportDataHeader.put(customReportDataHeader.size(), "Sr.No.");
										customReportDataHeader.put(customReportDataHeader.size(), "Test_Case");
									}
									if (!customReportDataHeader.containsValue(sDataColumn))
										customReportDataHeader.put(customReportDataHeader.size(), sDataColumn);
									if (sData == null || sData.trim().length() == 0)
										sData = "-";
									rowdata.add(sData); // storedatainreport
									sComments = "The Operation Returned Value :" + sData;
									sActualValue = sData; // 0000518
									break;
								case "setoptionalwait": // Mantis 0001896
									if (sTestStepData != null && sTestStepData.length() > 0)
										OptionalElementWait = Long.parseLong(sTestStepData);
									else
										OptionalElementWait = 0;
									break;
								case "ifexistsetfilename": // Mantis 0001895
									if (filelocation != null && filelocation.length() > 0 && fileextension != null
									&& fileextension.length > 0) {
										String fileName = dynamicSet(sTestCaseData, sDataColumn);
										String fullpath = "";
										if (fileName == null || fileName.length() == 0) {
											fullpath = "";
											dynamicGet(sTestCaseData, sDataColumn, fullpath, "");
											break;
										}
										fullpath = checkcustomfile(fileName);
										System.out.println("File Name returned from check customfile " + fullpath);
										if (fullpath.equalsIgnoreCase("fail"))
											fullpath = "";
										dynamicGet(sTestCaseData, sDataColumn, fullpath, "");
										sActualValue = fullpath;
									} else {
										sComments = "Please use useraction 'setfilelocation' & 'setfileextenion' before using 'iffilenotexist'";
										throw new Exception(sComments);
									}
									break;

									/*-----Manoj xxx-----*/
								case "setframe":
									Boolean status = setFrame(sIdentifier, sIdentifierValue, iIndex, sDataColumn);
									break;
									/*-----Manoj xxx-----*/
								case "get":
									if (sIdentifierValue.contains("##")) // Mantis 0000960
									{
										sIdentifierValue = sIdentifierValue.replace("##",
												"'".concat(dynamicSet(sTestCaseData, sDataColumn)).concat("'"));
									}
									sData = get(sControlType, sIdentifier, sIdentifierValue, iIndex);

									systemouts("Data : " + sData);
									dynamicGet(sTestCaseData, sDataColumn, sData, ""); // Mantis 0000713
									sComments = "The Operation Returned Value :" + sData;
									sActualValue = sData; // 0000518
									break;

								case "paste": // Mantis 0000939
									Robot robo = new Robot();
									StringSelection data = new StringSelection(sTestStepData);
									Clipboard cb = Toolkit.getDefaultToolkit().getSystemClipboard();
									cb.setContents(data, data);
									click(sControlType, sIdentifier, sIdentifierValue, iIndex);
									try {
										Transferable t = cb.getContents(null);

										if (t.isDataFlavorSupported(DataFlavor.stringFlavor))
											t.getTransferData(DataFlavor.stringFlavor);

										robo.keyPress(KeyEvent.VK_CONTROL);
										robo.keyPress(KeyEvent.VK_V);
										robo.keyRelease(KeyEvent.VK_V);
										robo.keyRelease(KeyEvent.VK_CONTROL);
										System.out.println("DAta:" + t.getTransferData(DataFlavor.stringFlavor));
									} catch (Exception ex) // Mantis 0000958
									{
										throw new Exception(ex.getMessage());
									}
									break; // Mantis 0000958

								case "getdate": // Mantis 0000713
									sData = get(sControlType, sIdentifier, sIdentifierValue, iIndex);
									// dynamicGet(sTestCaseData, sDataColumn, sData,dateFormat); //Mantis 0000777
									dynamicGet(sTestCaseData, sDataColumn, sData, sTestStepData); // Mantis 0000777
									sComments = "The Operation Returned Value :" + sData;
									break;
								case "changedateformat": // Mantis 0000773
									if (changeDateFormat(sTestCaseData, sDataColumn) == true) {
										sComments = "changedateformat" + dateFormat;
										sDescription = "Date format changed to " + dateFormat;
										sStepDescription = sDescription;
									}
									break;
								case "getguid": /// Mantis 0000458
									// dynamicGet(sTestCaseData, sDataColumn, savedGuid);
									dynamicGet(sTestCaseData, sDataColumn, savedGuid, "");// Mantis 0000713
									sComments = "The Operation Returned Value :" + sData;
									break;
									/*
									 * case "setimage": ////Mantis 0000778 ,1758 case "setregion": currentRegion=
									 * findImage(sIdentifierValue); if(currentRegion!=null) { sComments=
									 * "Baseimage is set from files in folder:" + sIdentifierValue; } else {
									 * sComments= "Baseimage could not be identified "; sStepStatus="Fail"; throw
									 * new Exception ("Baseimage could not be identified"); } break;
									 */
								case "setimagetimeout": // mantis 0000780
									imageTimeout = Integer.parseInt(sTestStepData);
									sComments = "Image timeout is set to:" + sTestStepData;
									break;
								case "setregiontimeout": // mantis 0000780
									regionTimeout = Integer.parseInt(sTestStepData);
									sComments = "Region timeout is set to:" + sTestStepData;
									break;
									/*
									 * case "resetregion": ////0000778,791,1758 currentRegion= null; sComments=
									 * "Base image has been reset"; break;
									 */
								case "setpassword": // Mantis 0001155
									if (sForLoopStatus == true && sDataColumn.equalsIgnoreCase(sForLoopDataColumn)) // Mantis
										// 0001097
									{
										sTestStepData = sForLoopVariable;
										sDescription = sUserAction + " " + sDataColumn + "=>" + sTestStepData;
									}
									if (sTestStepData.contains("~")) {
										if (sTestStepData.startsWith("~")) {
											sTestStepData = GenerateRandom(sTestStepData);
										} else {
											Elements = sTestStepData.split("\\~");
											Element1 = Elements[0];
											Element2 = Elements[1];
											Element2 = "~" + Element2;
											Element2 = GenerateRandom(Element2);
											sTestStepData = Element1 + Element2;
										}
									}
									if (sIdentifier.equalsIgnoreCase("label")) {
										if (sDataColumn == null) {
											NoSuchFieldException e = new NoSuchFieldException("Data_Column cannot be empty");
											throw e;
										} else {

											searchUsingLabel(sControlType, sIdentifier, sIdentifierValue, iIndex,
													decryptpasssword(sTestStepData));
										}
									} else {
										if (sDataColumn == null) {
											NoSuchFieldException e = new NoSuchFieldException("Data_Column cannot be empty");
											throw e;
										} else {
											set(sControlType, sIdentifier, sIdentifierValue, decryptpasssword(sTestStepData),
													iIndex);
										}
									}

									sComments = "Used Data :" + sTestStepData;
									break;
								case "set":
									if (sForLoopStatus == true && sDataColumn.equalsIgnoreCase(sForLoopDataColumn)) // Mantis
										// 0001097
									{
										sTestStepData = sForLoopVariable;

										sDescription = sUserAction + " " + sDataColumn + "=>" + sTestStepData;
									}

									if (sTestStepData.contains("~")) {
										if (sTestStepData.startsWith("~")) {
											sTestStepData = GenerateRandom(sTestStepData);
										} else {
											Elements = sTestStepData.split("\\~");
											Element1 = Elements[0];
											Element2 = Elements[1];
											Element2 = "~" + Element2;
											Element2 = GenerateRandom(Element2);
											sTestStepData = Element1 + Element2;
										}
									}
									if (sIdentifier.equalsIgnoreCase("label")) {
										if (sDataColumn == null) {
											NoSuchFieldException e = new NoSuchFieldException("Data_Column cannot be empty");
											throw e;
										} else
											searchUsingLabel(sControlType, sIdentifier, sIdentifierValue, iIndex,
													sTestStepData);
									} else {
										if (sDataColumn == null) {
											NoSuchFieldException e = new NoSuchFieldException("Data_Column cannot be empty");
											throw e;
										} else
											set(sControlType, sIdentifier, sIdentifierValue, sTestStepData, iIndex);
									}
									sComments = "Used Data :" + sTestStepData;
									break;

								case "generatedata": // 0001882
									if (sForLoopStatus == true && sDataColumn.equalsIgnoreCase(sForLoopDataColumn)) // Mantis
										// 0001097
									{
										sTestStepData = sForLoopVariable;

										sDescription = sUserAction + " " + sDataColumn + "=>" + sTestStepData;
									}

									if (sDataColumn == null) {
										NoSuchFieldException e = new NoSuchFieldException("Data_Column cannot be empty");
										throw e;
									} else {
										sTestStepData = GenerateRandom(sTestStepData);
										set(sControlType, sIdentifier, sIdentifierValue, sTestStepData, iIndex);
									}

									sComments = "Used Data :" + sTestStepData;
									break;

									// Mantis 0000542
								case "setifempty":
									systemouts("inside setifempty");
									if (sTestStepData.contains("~")) {
										if (sTestStepData.startsWith("~")) {
											sTestStepData = GenerateRandom(sTestStepData);
										} else {
											Elements = sTestStepData.split("\\~");
											Element1 = Elements[0];
											Element2 = Elements[1];
											Element2 = "~" + Element2;
											Element2 = GenerateRandom(Element2);
											sTestStepData = Element1 + Element2;
										}
									}
									if (sIdentifier.equalsIgnoreCase("label")) {
										if (sDataColumn == null) {
											NoSuchFieldException e = new NoSuchFieldException("Data_Column cannot be empty");
											throw e;
										} else
											searchUsingLabel(sControlType, sIdentifier, sIdentifierValue, iIndex,
													sTestStepData);
									} else {
										String obtainedValueFromGet = get(sControlType, sIdentifier, sIdentifierValue, iIndex)
												.trim(); // Mantis 0000543
										if (sDataColumn == null) {
											NoSuchFieldException e = new NoSuchFieldException("Data_Column cannot be empty");
											throw e;
										}

										// Mantis 0000543
										else if (obtainedValueFromGet.length() == 0 || obtainedValueFromGet.contains("Select")
												|| obtainedValueFromGet.contains("select")) {
											systemouts("Setting value as control is empty");
											set(sControlType, sIdentifier, sIdentifierValue, sTestStepData, iIndex);
										} else {
											// systemouts("obtained value:
											// "+get(sControlType,sIdentifier,sIdentifierValue,iIndex));
											systemouts("Skipping as control has value");
										}
									}
									sComments = "Used Data :" + sTestStepData;
									break;

								case "selectlist":
									systemouts("Inside SelectList");
									if (sDataColumn == null) {
										NoSuchFieldException e = new NoSuchFieldException("Data_Column cannot be empty");
										throw e;
									} else
										selectList(sControlType, sIdentifier, sIdentifierValue, sTestStepData, iIndex);
									sComments = "Used Data :" + sTestStepData;
									break;
								case "append":
									sPresentString = textValue(sControlType, sIdentifier, sIdentifierValue, sTestStepData,
											iIndex);
									systemouts("Present String" + sPresentString);
									sConcatenatedString = sPresentString.concat(sTestStepData);
									systemouts("String after Concatenation:" + sConcatenatedString);
									debugLog("Object Sync", "Concatenated Data:" + sConcatenatedString);
									set(sControlType, sIdentifier, sIdentifierValue, sConcatenatedString, iIndex);
									sComments = "Used Data :" + sTestStepData;
									break;
								case "dynamicappend":
									sPresentString = textValue(sControlType, sIdentifier, sIdentifierValue, sTestStepData,
											iIndex);
									sData = dynamicSet(sTestCaseData, sDataColumn);
									sConcatenatedString = sPresentString.concat(sData);
									set(sControlType, sIdentifier, sIdentifierValue, sConcatenatedString, iIndex);
									debugLog("Object Sync", "Concatenated Data:" + sConcatenatedString);
									sComments = "Used Data :" + sConcatenatedString;
									break;

									// Mantis 0000898
								case "modifydynamicvalue":
									sData = modifyDynamicValue(sTestCaseData, sTestStepData);
									dynamicGet(sTestCaseData, sDataColumn, sData, "");
									debugLog("Object Sync", "Modified dynamic Data:" + sData);
									sActualValue = sData;
									sComments = "Used Data :" + sData;
									break;

								case "emailnotify":
									KeywordDrivenFramework.emailNotify = true;
									//							sData=modifyDynamicValue(sTestCaseData,sTestStepData);
									//							dynamicGet(sTestCaseData, sDataColumn, sData,"");
									//							debugLog("Object Sync", "Modified dynamic Data:"+sData);
									//							sActualValue=sData;
									//							sComments= "Used Data :" + sData;						
									break;

								case "setdateformat": // Mantis 0000713
									dateFormat = sTestStepData;
									// debugLog("Set Date format", dateFormat);
									sComments = "Set Date format :" + dateFormat;
									break;
								case "clear":
									if (sIdentifierValue == null) {
										sIdentifierValue = sTestStepData;
										systemouts("Identifier Value:" + sIdentifierValue);
									}
									clear(sControlType, sIdentifier, sIdentifierValue, iIndex);
									break;

								case "autocomplete":
									if (sDataColumn == null) {
										NoSuchFieldException e = new NoSuchFieldException("Data_Column cannot be empty");
										throw e;
									} else {
										autoComplete(sControlType, sIdentifier, sIdentifierValue, sTestStepData, iIndex);
										sComments = "Used Data :" + sTestStepData;
									}
									break;

								case "dynamicclick":
									systemouts("Inside Dynamic Click");
									sData = dynamicSet(sTestCaseData, sDataColumn);
									systemouts("Dynamic Click Data..." + sData);
									if (sIdentifierValue.isEmpty()) // Mantis 0000849
									{
										sIdentifierValue = sData;
									} else if (sIdentifierValue.contains("##")) {
										sIdentifierValue = sIdentifierValue.replace("##", "'".concat(sData).concat("'"));
									}
									click(sControlType, sIdentifier, sIdentifierValue, iIndex); // Mantis 0000849
									sComments = "Used Data :" + sData;
									break;

								case "dynamicdoubleclick": // Mantis 0000889
									systemouts("In Dynamic Double click");
									sData = dynamicSet(sTestCaseData, sDataColumn);
									systemouts("Dynamic double Click Data..." + sData);
									if (sIdentifierValue.isEmpty()) // Mantis 0000849
									{
										sIdentifierValue = sData;
									} else if (sIdentifierValue.contains("##")) {
										sIdentifierValue = sIdentifierValue.replace("##", "'".concat(sData).concat("'"));
									}
									doubleClick(sControlType, sIdentifier, sIdentifierValue, iIndex); // Mantis 0000849
									sComments = "Used Data :" + sData;
									break;

									// If IdentifierValue is Empty get the Data from TestStepData i.e Data from
									// DataSheet otherwise pass IdentifierValue as SearchCriteria.
								case "click":
									if (sIdentifierValue == null) {
										sIdentifierValue = sTestStepData;
									}
									if (sIdentifierValue.contains("##")) // Mantis 0000835
									{
										sIdentifierValue = sIdentifierValue.replace("##",
												"'".concat(sTestStepData).concat("'"));
									}
									click(sControlType, sIdentifier, sIdentifierValue, iIndex);
									sComments = "";
									break;
								case "scrollto":
									if (sIdentifierValue.contains("##")) // Mantis 0000954
									{
										sData = dynamicSet(sTestCaseData, sDataColumn);
										sIdentifierValue = sIdentifierValue.replace("##", "'".concat(sData).concat("'"));
									}
									scrollTo(sControlType, sIdentifier, sIdentifierValue, iIndex);
									sComments = sControlType + ":" + sIdentifier + ":" + sIdentifierValue;
									break;
								case "optionalclick": // Mantis 0000700
									long oldElementWait = lElementWait; // Mantis 0001896
									if (OptionalElementWait > 0)
										lElementWait = OptionalElementWait;
									if (sIdentifierValue == null) {
										sIdentifierValue = sTestStepData;
									}
									optionalClick(sControlType, sIdentifier, sIdentifierValue, iIndex);
									lElementWait = oldElementWait; // Mantis 0001896
									sComments = "";
									break;
								case "rightclick":
									systemouts("In Right Click");
									if (sIdentifierValue == null) {
										sIdentifierValue = sTestStepData;
									}
									rightclick(sControlType, sIdentifier, sIdentifierValue, iIndex);
									sComments = "";
									break;

								case "dynamicclickr":
									sData = dynamicSet(sTestCaseData, sDataColumn);
									rightclick(sControlType, sIdentifier, sData, iIndex);
									sComments = "Used Data :" + sData;
									break;

								case "clickcoordinates":
									String[] sCoordinates;
									try {
										sCoordinates = sTestStepData.split(",");
										if (sCoordinates.length != 2) {
											throw new CustomException(
													"Co-ordinates provided are incorrect \":" + sTestStepData + "\"");
										}
									} catch (PatternSyntaxException e) {
										throw new CustomException(
												"Co-ordinates provided are incorrect \":" + sTestStepData + "\"");
									}
									Robot robot = new Robot();
									robot.mouseMove(Integer.parseInt(sCoordinates[0]), Integer.parseInt(sCoordinates[1]));
									robot.mousePress(InputEvent.BUTTON1_DOWN_MASK);
									robot.mouseRelease(InputEvent.BUTTON1_DOWN_MASK);
									break;

								case "doubleclick":
									doubleClick(sControlType, sIdentifier, sIdentifierValue, iIndex);
									sComments = "";
									break;

								case "isenable":

									if (isEnabled(sIdentifier, sIdentifierValue, iIndex)) {
										sComments = "Control is enabled";
									} else {
										sComments = "Control is not enabled";
									}
									break;

								case "isvisible":
									if (isVisible(sIdentifier, sIdentifierValue, iIndex)) {
										sComments = "Control is Visible";
									} else {
										sComments = "Control is not Visible";
									}
									break;

								case "geturl":
									sComments = getURL(sIdentifier, sIdentifierValue, iIndex);
									break;

								case "launch":
									if (sTestStepData.contains("~")) // Mantis 0001235,0001815
									{
										if (sTestStepData.startsWith("~")) {
											sTestStepData = GenerateRandom(sTestStepData);
										} else {
											Elements = sTestStepData.split("\\~");
											Element1 = Elements[0];
											Element2 = Elements[1];
											Element2 = "~" + Element2;
											Element2 = GenerateRandom(Element2);
											sTestStepData = Element1 + Element2;
										}
									}
									if (sDataColumn == null) {
										NoSuchFieldException e = new NoSuchFieldException("Data_Column cannot be empty");
										throw e;
									}
									System.out.println("NTLM Value : " + sntlm);
									if (sntlm.trim().equalsIgnoreCase("y")) // Mantis 0001131
									{
										System.out.println("Executing Auto It NTLM.exe");
										if (username.length() != 0 && password.length() != 0) {
											Runtime.getRuntime().exec(System.getProperty("user.dir") + "\\AutoIt\\NTLM.exe "
													+ username + " " + password);
										} else {
											throw new Exception("Username and Password for NTLM cannot be empty");
										}
									}
									openURL(sTestStepData);
									break;

								case "refresh":
									refreshPage();
									sComments = "Page Refreshed";
									break;

								case "attach": // Mantis 0000863
									if (sTestStepData.trim().length() == 0) {

										if (NumberUtils.isDigits(sIdentifierValue)) {
											attach(Integer.parseInt(sIdentifierValue));
											sComments = "Switched to Window with index :" + sIdentifierValue;
										} else {
											attach(sIdentifierValue, "equals"); // Mantis 0001816
											sComments = "Switched to Window with title :" + sIdentifierValue;

										}
									} else {
										if (NumberUtils.isDigits(sTestStepData)) {
											attach(Integer.parseInt(sTestStepData));
											sComments = "Switched to Window with index :" + sTestStepData;
										} else {
											attach(sTestStepData, "equals"); // Mantis 0001816
											sComments = "Switched to Window with title :" + sTestStepData;

										}

									}
									break;

								case "closewindow":
									// mantis 0000514
									closeWindow();
									break;

								case "hover":
									hover(sIdentifier, sIdentifierValue, iIndex);
									sComments = "";
									break;

								case "accept":
								case "ok":
									if (checkAlert()) {
										handleAlert("accept");
										sComments = "Alert Accepted";
									} else {
										sStepStatus = "Fail";
										sComments = "Alert Not Present";
									}
									break;

								case "decline":
								case "cancel":
									if (checkAlert()) {
										handleAlert("decline");
										sComments = "Alert Declined";
									} else {
										sStepStatus = "Fail";
										sComments = "Alert Not Present";
									}
									break;

								case "optionalalert":
									if (checkAlert()) {
										handleAlert("alerttext");
										handleAlert("accept");
										sComments = "Alert appeared and suppressed";
										sExpectedData = "Alert Text is : " + sAlertText;
									}

									else {
										sComments = "Alert Not Appeared";
									}
									break;

								case "alerttext":
									if (checkAlert()) {
										if (sDataColumn == null) {
											systemouts("printing alert text");
											sExpectedData = "Text Present on Alert";
											handleAlert(sUserAction);
											sActualValue = sAlertText;
											sComments = "Alert Text is:" + sAlertText;
										} else if (sTestStepData.contains("~")) {
											sExpectedData = "Alert Key";
											sAlertKey = getAlertKey(sTestStepData);
											sActualValue = sAlertKey;
											debugLog("Alert Verification:", "Key is:" + sAlertKey);
											if (sAlertKey != null) {
												sComments = "Expected value :" + sExpectedData + " Actual Value :"
														+ sActualValue;
											} else {
												sStepStatus = "Fail";
												sComments = "Alert Text Mismatching";
											}
										} else {
											sExpectedData = sTestStepData;
											alertFlag = verifyAlertText(sTestStepData);
											debugLog("Alert Verification", "Flag is:" + alertFlag);
											if (alertFlag == true) {
												sComments = "Expected value :" + sExpectedData + " Actual Value :"
														+ sActualValue;
											} else {
												sStepStatus = "Fail";
												sComments = "Alert Text Mismatching";
											}
										}
									} else {
										sStepStatus = "Fail";
										sComments = "Alert Not Present";
									}
									break;

									// Mantis 0000919
								case "alertcontains":
									if (checkAlert()) {
										if (sDataColumn == null) {
											systemouts("printing alert text");
											sExpectedData = "Text Present on Alert";
											handleAlert(sUserAction);
											sActualValue = sAlertText;
											sComments = "Alert Text is:" + sAlertText;
										} else if (sTestStepData.contains("~")) {
											sExpectedData = "Alert Key";
											sAlertKey = getAlertKey(sTestStepData);
											sActualValue = sAlertKey;
											debugLog("Alert Verification:", "Key is:" + sAlertKey);
											if (sAlertKey != null) {
												sComments = "Expected value :" + sExpectedData + " Actual Value :"
														+ sActualValue;
											} else {
												sStepStatus = "Fail";
												sComments = "Alert Text Mismatching";
											}
										} else {
											sExpectedData = sTestStepData;
											alertFlag = verifyAlertTextContains(sTestStepData);
											debugLog("Alert Verification", "Flag is:" + alertFlag);
											if (alertFlag == true) {
												sComments = "Expected value :" + sExpectedData + " Actual Value :"
														+ sActualValue;
											} else {
												sStepStatus = "Fail";
												sComments = "Alert Text Mismatching";
											}
										}
									} else {
										sStepStatus = "Fail";
										sComments = "Alert Not Present";
									}
									break;

								case "wait":
									if (sTestStepData.startsWith("~")) // Mantis: 0001351
									{
										sTestStepData = sTestStepData.replaceFirst("~", "");
										sTestStepData = GenerateRandom(sTestStepData);
										wait(sIdentifier, sIdentifierValue, sTestStepData, iIndex);
										sComments = "Wait applied for " + sTestStepData + " Seconds ";
									} else {
										wait(sIdentifier, sIdentifierValue, sTestStepData, iIndex);
										sComments = "Wait applied for " + sTestStepData + " Seconds ";
									}
									break;

								case "timeout":
									timeout(sTestStepData);
									sComments = "Default Timeout set to " + sTestStepData + " Seconds ";
									break;

									// Mantis 0000948
								case "verifymaxdate":
									sStepStatus = verifyMaxDate(sTestCaseData, sTestStepData);
									sComments = "Expected value :" + sTestStepData + " Actual value :" + sActualValue;
									break;

								case "verify":
									sExpectedData = sTestStepData;
									if (sVerifyProperty == null) {
										sVerifyProperty = "text";
										debugLog("Object Sync", "Property Not Provided in Page Sheet Default Property : Text");
									}

									// Mantis 0000911
									if (sIdentifierValue.contains("##")) {
										sData = dynamicSet(sTestCaseData, sDataColumn);
										sIdentifierValue = sIdentifierValue.replace("##", "'".concat(sData).concat("'"));
									}

									if (!sExpectedData.startsWith("~")) // Mantis 0000874
									{
										sStepStatus = verifyProperty(sControlType, sIdentifier, sIdentifierValue,
												sVerifyProperty, iIndex, sExpectedData);
									} else {
										sExpectedData = GenerateRandom(sExpectedData); // Mantis 0000874
										sStepStatus = verifyProperty(sControlType, sIdentifier, sIdentifierValue,
												sVerifyProperty, iIndex, sExpectedData);
									}

									sComments = "Expected value :" + sTestStepData + " Actual value :" + sActualValue;
									processDebugLog(KeywordDrivenFramework.blnError, sComments, sStepStatus);// Mantis 0000703
									break;

								case "dynamicverify": // Mantis 0000688

									if (sVerifyProperty == null) {
										sVerifyProperty = "text";
										debugLog("Object Sync", "Property Not Provided in Page Sheet Default Property : Text");
									}

									sExpectedData = dynamicSet(sTestCaseData, sDataColumn);
									if (sIdentifierValue.isEmpty()) // Mantis 0000891
									{
										sIdentifierValue = sExpectedData;
									} else if (sIdentifierValue.contains("##")) {
										sIdentifierValue = sIdentifierValue.replace("##",
												"'".concat(sExpectedData).concat("'"));
									}

									sStepStatus = verifyProperty(sControlType, sIdentifier, sIdentifierValue, sVerifyProperty,
											iIndex, sExpectedData);
									sComments = "Expected value :" + sExpectedData + " Actual value :" + sActualValue; // Mantis
									// 0000704
									processDebugLog(KeywordDrivenFramework.blnError, sComments, sStepStatus);// Mantis 0000703
									break;
								case "verifycss": // Mantis 0000871
									sExpectedData = sTestStepData;
									if (sVerifyProperty == null) {
										sStepStatus = "Fail";
										sStepDescription = "Property column in Page sheet is empty.";
										debugLog("Object Sync", "Property Not Provided in Page Sheet Default Property");
									} else {
										// Mantis 0000899
										if (sIdentifierValue.contains("##")) {
											sData = dynamicSet(sTestCaseData, sDataColumn);
											sIdentifierValue = sIdentifierValue.replace("##", "'".concat(sData).concat("'"));
										}

										sStepDescription = "Verify CSS";
										sStepStatus = getcss(sControlType, sIdentifier, sIdentifierValue, sVerifyProperty,
												iIndex, sExpectedData);
										sComments = "Expected value :" + sTestStepData + " Actual value :" + sActualValue;

										// processDebugLog(KeywordDrivenFramework.blnError, sComments,sStepStatus);
									}
									break;

								case "highlight":
									highlight(sIdentifier, sIdentifierValue, iIndex);
									sComments = "";
									break;

								case "fileexist":
									if (!new File(sTestStepData).exists()) // Mantis 0000938
									{
										sStepStatus = "Fail";
										sStepDescription = "File: " + sTestStepData + " not found";
										debugLog("fileexist", "File not found");
									}
									break;

								case "fileupload":
									fileUpload(sTestStepData);
									sComments = "File :" + sTestStepData + " is Uploaded";
									break;

								case "filesave":
									fileUpload(sTestStepData);
									sComments = "File :" + sTestStepData + " is Saved";
									break;

								case "verifywebtable":
									verifyWebTable(sIdentifier, sIdentifierValue, sTestCaseExcelPath, iIndex, sTestCaseData); // Mantis
									// 522
									// processDebugLog(KeywordDrivenFramework.blnError, sComments,sStepStatus);//
									// Mantis 0000703
									break;
								case "getdata":
									getData(sIdentifier, sIdentifierValue, iIndex, sDataColumn);
									break;
								case "getscrollabledata": // Mantis 0000802
									getScrollableData(sIdentifier, sIdentifierValue, iIndex, sTestStepData);
									break;
								case "dynamicset":
									sData = dynamicSet(sTestCaseData, sDataColumn);
									if (sData.startsWith("[{")) {
										List<List<String>> executionData = funGetDataFromJSON(sData);
										if (!executionData.isEmpty() && executionData.size() <= 1) {
											if (executionData.get(0).size() <= 1) {
												sData = executionData.get(0).get(0);
											} else {
												debugLog("dynamicset",
														"Value fetched from database should contain single value only");
												throw new Exception(
														"Exception in DynamicSet:- Value fetched from database should contain single value only");
											}
										} else {
											debugLog("dynamicset",
													"Value fetched from database should not be empty or should contain single row only for comparison");
											throw new Exception(
													"Exception in DynamicSet:- Value fetched from database should not be empty or should contain single row only for comparison");
										}
									}
									set(sControlType, sIdentifier, sIdentifierValue, sData, iIndex);
									sComments = "Used Data :" + sData;
									break;
								case "verifydb": // Mantis 0000922
									// executeSQL(sTestCaseExcelPath,sIdentifier,sTestCaseData);
									sStepStatus = executeSQL(sTestStepData, sIdentifier, sTestCaseData); // Mantis 0000843,
									// 0000888
									debugLog("Database Operation", "After ExecuteSQL");
									break;

									// Mantis 0000885, 0000922
								case "getdb":
									sData = getSQLData(sTestStepData, sIdentifier, sTestCaseData, sDataColumn);
									systemouts(sData);
									dynamicGet(sTestCaseData, sDataColumn, sData, "");
									sComments = "The Operation Returned Value :" + sData;
									break;

									// Mantis 0000886, 0000922
								case "dynamicverifydb":
									sData = dynamicSet(sTestCaseData, sDataColumn);
									// sStepStatus=verifyProperty(sControlType,sIdentifier,sIdentifierValue,sVerifyProperty,iIndex,sExpectedData);
									sStepStatus = verifySQLData(sIdentifier, sTestStepData, sTestCaseData, sData);
									// sComments="Expected value :"+ sExpectedData + " Actual value :"
									// +sActualValue;
									break;

								case "close":
									oDriver.close();
									oDriver.quit();
									break;

								case "sendkeys":
									sendKeys(sTestStepData);
									sComments = "Used Data :" + sTestStepData;
									break;

								case "getcellvalue":
									String sCellValue = getCellValue(sTestCaseData, sIdentifier, sIdentifierValue,
											sTestStepData, iIndex, sDataColumn, sRemoveWordsColumn);
									if (sCellValue != null && sDataColumn != null) {
										sTestStepData = sTestStepData.replace(",", "-");
										sComments = "Used Data : " + sTestStepData;
										sActualValue = sCellValue;

									} else if (sCellValue == null && sDataColumn != null) {
										sTestStepData = sTestStepData.replace(",", "-");
										sComments = "Used Data : " + sTestStepData;
									} else if (sCellValue != null) {
										sTestStepData = sIdentifierValue;
										sComments = "Used Data : " + sTestStepData;
										sActualValue = sCellValue;
									} else {
										sTestStepData = sIdentifierValue;
										sComments = "Used Data : " + sTestStepData;
									}
									break;

								case "getrownumber":
								case "getrownumberbycolumnname": // Mantis 0000425
									// Identify(sTestCaseData,sIdentifier,sIdentifierValue,sTestStepData,iIndex);//Mantis
									// 0000794
									// Mantis 0000800
									actualRowNumber = getRowNumber(sTestStepData, iIndex, -1); // Mantis 0000424
									if (actualRowNumber >= 0) {
										sComments = "Used Data : " + sTestStepData;
										sDescription = "Row Number : " + actualRowNumber;
										debugLog("GetRowNumber", "Target Row was found  at :" + actualRowNumber);

									} else {
										sComments = "Used Data : " + sTestStepData;
										sDescription = "Row Number not found with given values";
										sStepStatus = "Fail";
										NoSuchElementException e = new NoSuchElementException(
												"Element search failed with method: \"" + sIdentifier
												+ "\"  and search Criteria: \"" + sIdentifierValue + "\"");
										throw e;
									}
									// Previous_Step_GetRowNo=true; Deepankar not needed now as we have a new
									// useraction for this
									break;

								case "clickrownumberbyscroll": // Mantis 0000836

									clickrownumberbyscroll(sIdentifier, sIdentifierValue, iIndex, "image", sTestStepData);

									break;

								case "getrownumberbycolumnnumber": // Mantis 0000424
									// Identify(sTestCaseData,sIdentifier,sIdentifierValue,sTestStepData,iIndex);//Mantis
									// 0000795
									//// Mantis 0000800
									actualRowNumber = getRowNumber(sTestStepData, iIndex, 0); // Mantis 0000424
									if (actualRowNumber >= 0) {
										sComments = "Used Data : " + sTestStepData;
										sDescription = "Row Number : " + actualRowNumber;
										debugLog("GetRowNumberbycolumnnumber", "Target Row was found  at :" + actualRowNumber);
									} else {
										sComments = "Used Data : " + sTestStepData;
										sDescription = "Row Number not found with given values";
										sStepStatus = "Fail";
										NoSuchElementException e = new NoSuchElementException(
												"Element search failed with method: \"" + sIdentifier
												+ "\"  and search Criteria: \"" + sIdentifierValue + "\"");
										throw e;
									}
									// Previous_Step_GetRowNo=true; Deepankar not needed now as we have a new
									// useraction for this
									break;

								case "getdynamicrownumber": // Mantis 0000461
									actualRowNumber = GetDynamicRowNumber(sTestStepData, sTestCaseData, sDataColumn, iIndex);

									if (actualRowNumber >= 0) {
										sComments = "Used Data : " + sTestStepData;
										sDescription = "Row Number : " + actualRowNumber;
										debugLog("GetDynamicRowNumber", "Target Row was found  at :" + actualRowNumber);
									} else {
										sComments = "Used Data : " + sTestStepData;
										sDescription = "Row Number not found with given values";
										sStepStatus = "Fail";
										NoSuchElementException e = new NoSuchElementException(
												"Element search failed with method: \"" + sIdentifier
												+ "\"  and search Criteria: \"" + sIdentifierValue + "\"");
										throw e;
									}
									// Previous_Step_GetRowNo=true; Deepankar not needed now as we have a new
									// useraction for this
									break;

								case "imagerownumber":
									actualRowNumber = getImageRowNumber(sTestCaseData, sIdentifier, sIdentifierValue,
											sTestStepData, iIndex);
									sComments = "Used Data : " + sTestStepData;
									debugLog("ImageRowOperation", "Out of Image Identification");
									if (actualRowNumber != 0) {
										sComments = "Used Data : " + sTestStepData;
										sStepDescription = "Finding Row Number containing Unique Image";
										sActualValue = "Row Number : " + actualRowNumber;
									} else {
										sComments = "Used Data : " + sTestStepData;
										sStepDescription = "Finding Row Number containing Unique Image";
										sActualValue = "Row not found for given criteria";
										sStepStatus = "Fail";
									}
									// Previous_Step_GetRowNo=true;
									break;

									// Mantis 0000466
								case "getlastrow":
									lastRow = getLastRow();
									if (lastRow >= 0) {
										sComments = "Used Data : " + sTestStepData;
										sDescription = "Getting last row number";
										sActualValue = "Last Row Number : " + lastRow;
									} else {
										sComments = "Used Data : " + sTestStepData;
										sStepDescription = "Finding last Row";
										sActualValue = "Row not found for given criteria";
										sStepStatus = "Fail";
									}
									break;

								case "removewords": // Mantis 0000372
									if (RemoveWords(sTestCaseData, sTestStepData, sDataColumn) == true) {
										sComments = "Removewords";
										sDescription = "Removewords";
									} else {
										sComments = "Used Data : " + sTestStepData;
										sStepDescription = "Removing words";
										sActualValue = "Error encountered";
										sStepStatus = "Fail";
									}
									break;

								case "tointeger": // Mantis 0001477
									if (toInteger(sTestCaseData, sDataColumn) == true) {
										sComments = "ToInteger";
										sDescription = "ToInteger";
									} else {
										sComments = "Used Data : " + sTestStepData;
										sStepDescription = "To Integer";
										sActualValue = "Error encountered";
										sStepStatus = "Fail";
									}
									break;
								case "extractwords": // Mantis 0000768
									if (ExtractWords(sTestCaseData, sTestStepData, sDataColumn) == true) {
										sComments = "ExtractWords";
										sDescription = "ExtractWords";
									} else {
										sComments = "Used Data : " + sTestStepData;
										sStepDescription = "Extracting words";
										sActualValue = "Error encountered";
										sStepStatus = "Fail";
									}
									break;
								case "toupper": // Mantis 0000735
									if (ToUpper(sTestCaseData, sDataColumn) == true) {
										sComments = "ToUpper";
										sDescription = "ToUpper";
									} else {
										sComments = "Used Data : " + sTestStepData;
										sStepDescription = "ToUpper words";
										sActualValue = "Error encountered";
										sStepStatus = "Fail";
									}
									break;

									// Mantis 0000810
								case "returnmax":
									sData = getMax(sTestCaseData, sTestStepData);
									dynamicGet(sTestCaseData, sDataColumn, sData, "");
									sComments = "The Operation Returned Value :" + sData;
									break;

									// Mantis 0000917
								case "getlength":
									sData = getLength(sTestCaseData, sTestStepData);
									dynamicGet(sTestCaseData, sDataColumn, sData, "");
									sComments = "The Operation Returned Value :" + sData;
									sActualValue = sData;
									break;

									// Mantis 0000918
								case "compare":
									sStepStatus = compare(sTestCaseData, sTestStepData);
									break;

									// Mantis 0000811
								case "calculate":
									sData = ArithmeticOperation(sTestCaseData, sTestStepData);
									dynamicGet(sTestCaseData, sDataColumn, sData, "");
									sActualValue = sData;
									sComments = "The Operation Returned Value :" + sData;
									break;
								case "isblank": // 0000901
									sExpectedData = "";
									if (sVerifyProperty == null) {
										sVerifyProperty = "text";
									}

									sStepStatus = verifyProperty(sControlType, sIdentifier, sIdentifierValue, sVerifyProperty,
											iIndex, "");
									sComments = "Expected value :" + sTestStepData + " Actual value :" + sActualValue;
									sStepDescription = "Expected length of data is 0 " + " Actual length  of data is: "
											+ sActualValue.length();
									processDebugLog(KeywordDrivenFramework.blnError, sComments, sStepStatus);// Mantis 0000703
									break;

								case "hasvalue": // Mantis 0000941
									sExpectedData = "";
									if (sIdentifierValue.contains("##")) // Mantis 0000884
									{
										sData = dynamicSet(sTestCaseData, sDataColumn);
										sIdentifierValue = sIdentifierValue.replace("##", "'".concat(sData).concat("'"));
									}
									if (sVerifyProperty == null) {
										sVerifyProperty = "text";
									}

									sStepStatus = verifyProperty(sControlType, sIdentifier, sIdentifierValue, sVerifyProperty,
											iIndex, "");

									if (sStepStatus.equalsIgnoreCase("fail"))
										sStepStatus = "Pass";
									else
										sStepStatus = "Fail";

									sComments = "Expected value :" + sTestStepData + " Actual value :" + sActualValue;
									processDebugLog(KeywordDrivenFramework.blnError, sComments, sStepStatus);// Mantis 0000703
									break;

								case "zoomin":
									zoomIn();
									sComments = "Browser ZoomIn";
									sDescription = "Browser ZoomIn";
									break;

								case "zoomout":
									zoomOut();
									sComments = "Browser ZoomOut";
									sDescription = "Browser ZoomOut";
									break;

								case "zoomreset":
									zoomReset();
									sComments = "Browser ZoomReset";
									sDescription = "Browser ZoomReset";
									break;
								case "identify":

									if (sTestStepData.trim().length() == 0) {
										Identify(sTestCaseData, sIdentifier, sIdentifierValue, sTestStepData, iIndex);
									} else {
										Identify(sTestCaseData, sIdentifier, sIdentifierValue, sTestStepData, iIndex);
									}

									sComments = "";
									Identify(sTestCaseData, sIdentifier, sIdentifierValue, sTestStepData, iIndex);
									sComments = "Identified control with " + sIdentifierValue;
									break;
								case "clicklink": // Deepankar 12-September adding for click done after GetRowNumber
									if (!sTestStepData.isEmpty()) // Mantis 0000805
										ClickRowControl(sIdentifier, sIdentifierValue, iIndex, "link", sTestStepData);
									else
										ClickRowControl(sIdentifier, sIdentifierValue, iIndex, "link", "Y");
									sComments = "Clicking Link for a particular row";
									sDescription = "clickrowlink";
									break;
								case "clickradio": // Mantis:0000386
									if (!sTestStepData.isEmpty()) // Mantis 0000805
										ClickRowControl(sIdentifier, sIdentifierValue, iIndex, "radio", sTestStepData);
									else
										ClickRowControl(sIdentifier, sIdentifierValue, iIndex, "radio", "Y");
									sComments = "Clicking Radio button for a particular row";
									sDescription = "clickradio";
									break;
								case "clickcheckbox": // Deepankar 12-September adding for click done after GetRowNumber
									if (!sTestStepData.isEmpty()) // Mantis 0000805
										ClickRowControl(sIdentifier, sIdentifierValue, iIndex, "checkbox", sTestStepData);
									else
										ClickRowControl(sIdentifier, sIdentifierValue, iIndex, "checkbox", "Y");
									sComments = "Clicking Checkbox for a particular row";
									sDescription = "clickrowlink";
									break;
								case "clickdiv": // Mantis 0000416
									if (!sTestStepData.isEmpty()) // Mantis 0000805
										ClickRowControl(sIdentifier, sIdentifierValue, iIndex, "div", sTestStepData);
									else
										ClickRowControl(sIdentifier, sIdentifierValue, iIndex, "div", "Y");
									sComments = "Clicking DIV for a particular row";
									sDescription = "Click Div";
									break;
								case "doubleclickspan": // Mantis 0000724
									if (!sTestStepData.isEmpty()) // Mantis 0000805
										ClickRowControl(sIdentifier, sIdentifierValue, iIndex, "doublespan", sTestStepData);
									else
										ClickRowControl(sIdentifier, sIdentifierValue, iIndex, "doublespan", "Y");
									sComments = "Double Clicking Span for a particular row";
									sDescription = "Double Click Span";
									break;
								case "clickspan": // Mantis 0000726
									if (!sTestStepData.isEmpty()) // Mantis 0000805
										ClickRowControl(sIdentifier, sIdentifierValue, iIndex, "span", sTestStepData);
									else
										ClickRowControl(sIdentifier, sIdentifierValue, iIndex, "span", "Y");
									sComments = "Clicking span for a particular row";
									sDescription = "Click Span";
									break;
									// case "verifytextbox": // Mantis 0000721
								case "clickimage": // Mantis 0000801
									if (!sTestStepData.isEmpty()) // Mantis 0000805
										ClickRowControl(sIdentifier, sIdentifierValue, iIndex, "image", sTestStepData);
									else
										ClickRowControl(sIdentifier, sIdentifierValue, iIndex, "image", "Y");
									sComments = "Clicking image for a particular row";
									sDescription = "clickimage";
									break;
								case "verifycell": // Mantis 729
									sExpectedData = sTestStepData;
									ClickRowControl(sIdentifier, sIdentifierValue, iIndex, "verifycell", "Y"); // Mantis 0000805
									sComments = "Verifying data in a cell for a particular row";
									sDescription = "verifycell";
									sComments = "Expected value :" + sExpectedData + " Actual value :" + sActualValue;
									processDebugLog(KeywordDrivenFramework.blnError, sComments, sStepStatus);
									break;

									// Mantis 0000844
								case "executejs":
								case "clickjs": // Mantis 0000920
									if ((!sTestStepData.isEmpty() && sIdentifier == null) && sIdentifierValue == null) // Manoj
										// xxx
										// Make
										// identifier
										// and
										// identifiervalue
										// as
										// Null
										executeJSAction(sTestStepData);
									else if ((sTestStepData.isEmpty() && !sIdentifier.isEmpty()) && !sIdentifierValue.isEmpty())
										executeJSAction(sControlType, sIdentifier, sIdentifierValue, iIndex, sTestStepData);
									else
										executeJSAction(sControlType, sIdentifier, sIdentifierValue, iIndex, sTestStepData); // Mantis
									// 0000850
									sComments = "Performing javascript event";
									sDescription = "executeJS";
									break;
								case "dynamicclickjs": // Mantis 0001531
									sData = dynamicSet(sTestCaseData, sDataColumn);
									if (sIdentifierValue.contains("##")) {
										sIdentifierValue = sIdentifierValue.replace("##", "'".concat(sData).concat("'"));
									}
									executeJSAction(sControlType, sIdentifier, sIdentifierValue, iIndex, ""); // Mantis 0000850
									sComments = "Performing javascript event";
									sDescription = "executeJS";
									break;
									/*
									 * case "clickjs": //Anum
									 * clickJS(sControlType,sIdentifier,sIdentifierValue,iIndex); sComments=
									 * "Performing javascript click operation"; sDescription="clickJS"; break;
									 */
								case "maximize": // Mantis 0000875
									maximize();
									sComments = "Maximize the current window";
									sDescription = "Maximize";
									break;
								case "startswith": // Mantis 0000910
									sExpectedData = sTestStepData;
									if (sVerifyProperty == null) {
										sVerifyProperty = "text";
										debugLog("Object Sync", "Property Not Provided in Page Sheet Default Property : Text");
									}

									if (!sExpectedData.startsWith("~")) // Mantis 0000874
									{
										sStepStatus = startswith(sControlType, sIdentifier, sIdentifierValue, sVerifyProperty,
												iIndex, sExpectedData);
									} else {
										sExpectedData = GenerateRandom(sExpectedData); // Mantis 0000874
										sStepStatus = startswith(sControlType, sIdentifier, sIdentifierValue, sVerifyProperty,
												iIndex, sExpectedData);
									}

									sComments = "Expected value :" + sTestStepData + " Actual value :" + sActualValue;
									processDebugLog(KeywordDrivenFramework.blnError, sComments, sStepStatus);// Mantis 0000703
									break;

									// Mantis 0000916
								case "dynamicstartswith":

									if (sVerifyProperty == null) {
										sVerifyProperty = "text";
										debugLog("Object Sync", "Property Not Provided in Page Sheet Default Property : Text");
									}

									sData = dynamicSet(sTestCaseData, sDataColumn);

									if (sData.startsWith("[{")) {
										List<List<String>> executionData = funGetDataFromJSON(sData);
										if (!executionData.isEmpty() && executionData.size() <= 1)
											if (executionData.get(0).size() <= 1)
												sExpectedData = executionData.get(0).get(0);
											else
												debugLog("Object Sync",
														"Value fetched from database should contain single value only for verification");
										else
											debugLog("Object Sync",
													"Value fetched from database should not be empty or should contain single row only for verification");
									} else {
										sExpectedData = sData;
									}

									if (sIdentifierValue.isEmpty()) // Mantis 0000891
									{
										sIdentifierValue = sExpectedData;
									} else if (sIdentifierValue.contains("##")) {
										sIdentifierValue = sIdentifierValue.replace("##",
												"'".concat(sExpectedData).concat("'"));
									}

									sStepStatus = startswith(sControlType, sIdentifier, sIdentifierValue, sVerifyProperty,
											iIndex, sExpectedData);
									sComments = "Expected value :" + sExpectedData + " Actual value :" + sActualValue; // Mantis
									// 0000704
									processDebugLog(KeywordDrivenFramework.blnError, sComments, sStepStatus);// Mantis 0000703
									break;

								case "endswith": // Mantis 0000910
									sExpectedData = sTestStepData;
									if (sVerifyProperty == null) {
										sVerifyProperty = "text";
										debugLog("Object Sync", "Property Not Provided in Page Sheet Default Property : Text");
									}

									if (!sExpectedData.startsWith("~")) // Mantis 0000874
									{
										sStepStatus = endswith(sControlType, sIdentifier, sIdentifierValue, sVerifyProperty,
												iIndex, sExpectedData);
									} else {
										sExpectedData = GenerateRandom(sExpectedData); // Mantis 0000874
										sStepStatus = endswith(sControlType, sIdentifier, sIdentifierValue, sVerifyProperty,
												iIndex, sExpectedData);
									}

									sComments = "Expected value :" + sTestStepData + " Actual value :" + sActualValue;
									processDebugLog(KeywordDrivenFramework.blnError, sComments, sStepStatus);// Mantis 0000703
									break;

									// Mantis 0000916
								case "dynamicendswith":

									if (sVerifyProperty == null) {
										sVerifyProperty = "text";
										debugLog("Object Sync", "Property Not Provided in Page Sheet Default Property : Text");
									}

									sData = dynamicSet(sTestCaseData, sDataColumn);

									if (sData.startsWith("[{")) {
										List<List<String>> executionData = funGetDataFromJSON(sData);
										if (!executionData.isEmpty() && executionData.size() <= 1)
											if (executionData.get(0).size() <= 1)
												sExpectedData = executionData.get(0).get(0);
											else
												debugLog("Object Sync",
														"Value fetched from database should contain single value only for verification");
										else
											debugLog("Object Sync",
													"Value fetched from database should not be empty or should contain single row only for verification");
									} else {
										sExpectedData = sData;
									}

									if (sIdentifierValue.isEmpty()) // Mantis 0000891
									{
										sIdentifierValue = sExpectedData;
									} else if (sIdentifierValue.contains("##")) {
										sIdentifierValue = sIdentifierValue.replace("##",
												"'".concat(sExpectedData).concat("'"));
									}

									sStepStatus = endswith(sControlType, sIdentifier, sIdentifierValue, sVerifyProperty, iIndex,
											sExpectedData);
									sComments = "Expected value :" + sExpectedData + " Actual value :" + sActualValue; // Mantis
									// 0000704
									processDebugLog(KeywordDrivenFramework.blnError, sComments, sStepStatus);// Mantis 0000703
									break;

								case "contains": // Mantis 0000910
									sExpectedData = sTestStepData;
									if (sVerifyProperty == null) {
										sVerifyProperty = "text";
										debugLog("Object Sync", "Property Not Provided in Page Sheet Default Property : Text");
									}

									if (sIdentifierValue.contains("##")) // Mantis 0000961
									{
										sData = dynamicSet(sTestCaseData, sDataColumn);
										sIdentifierValue = sIdentifierValue.replace("##", "'".concat(sData).concat("'"));
									}

									if (sExpectedData.startsWith("~")) {
										sExpectedData = GenerateRandom(sExpectedData); // Mantis 0000874
										sStepStatus = contains(sControlType, sIdentifier, sIdentifierValue, sVerifyProperty,
												iIndex, sExpectedData);
									} else if (sExpectedData.startsWith("##")) // Mantis 0000961
									{
										sExpectedData = sExpectedData.replaceFirst("##", "");
										sExpectedData = dynamicSet(sTestCaseData, sExpectedData);
										System.out.println("Expected Output:- " + sExpectedData);
										sStepStatus = contains(sControlType, sIdentifier, sIdentifierValue, sVerifyProperty,
												iIndex, sExpectedData);
									} else {
										sStepStatus = contains(sControlType, sIdentifier, sIdentifierValue, sVerifyProperty,
												iIndex, sExpectedData);
									}

									sComments = "Expected value :" + sTestStepData + " Actual value :" + sActualValue;
									processDebugLog(KeywordDrivenFramework.blnError, sComments, sStepStatus);// Mantis 0000703
									break;

									// Mantis 0000916
								case "dynamiccontains":

									if (sVerifyProperty == null) {
										sVerifyProperty = "text";
										debugLog("Object Sync", "Property Not Provided in Page Sheet Default Property : Text");
									}

									sData = dynamicSet(sTestCaseData, sDataColumn);

									if (sData.startsWith("[{")) {
										List<List<String>> executionData = funGetDataFromJSON(sData);
										if (!executionData.isEmpty() && executionData.size() <= 1)
											if (executionData.get(0).size() <= 1)
												sExpectedData = executionData.get(0).get(0);
											else
												debugLog("Object Sync",
														"Value fetched from database should contain single value only for verification");
										else
											debugLog("Object Sync",
													"Value fetched from database should not be empty or should contain single row only for verification");
									} else {
										sExpectedData = sData;
									}

									if (sIdentifierValue.isEmpty()) // Mantis 0000891
									{
										sIdentifierValue = sExpectedData;
									} else if (sIdentifierValue.contains("##")) {
										sIdentifierValue = sIdentifierValue.replace("##",
												"'".concat(sExpectedData).concat("'"));
									}

									sStepStatus = contains(sControlType, sIdentifier, sIdentifierValue, sVerifyProperty, iIndex,
											sExpectedData);
									sComments = "Expected value :" + sExpectedData + " Actual value :" + sActualValue; // Mantis
									// 0000704
									processDebugLog(KeywordDrivenFramework.blnError, sComments, sStepStatus);// Mantis 0000703
									break;

								case "gettrim": // Mantis 0001130,0001229
									if (sIdentifierValue.contains("##")) {
										sIdentifierValue = sIdentifierValue.replace("##",
												"'".concat(dynamicSet(sTestCaseData, sDataColumn)).concat("'"));
									}
									sData = get(sControlType, sIdentifier, sIdentifierValue, iIndex).trim(); // Mantis 0001130

									systemouts("Data : " + sData);
									dynamicGet(sTestCaseData, sDataColumn, sData, ""); // Mantis 0000713
									sComments = "The Operation Returned Value :" + sData;
									sActualValue = sData; // 0000518
									break;

								case "objectexist": // Mantis 0000873
									if (sIdentifierValue.contains("##")) // Mantis 0000884
									{
										sData = dynamicSet(sTestCaseData, sDataColumn);
										sIdentifierValue = sIdentifierValue.replace("##", "'".concat(sData).concat("'"));
									}
									sExpectedData = sTestStepData; // Mantis 0000890
									sStepStatus = objectexist(sControlType, sIdentifier, sIdentifierValue, sTestStepData,
											iIndex);
									sComments = "check if object/control exist or not";
									sDescription = "objectexist";
									/*-----Mantis 0000906-----*/
									if (sStepStatus.toLowerCase().equals("pass") && sExpectedData.toLowerCase().equals("true")) // Mantis
										// 0000905
									{
										sActualValue = "True";
									} else if (sStepStatus.toLowerCase().equals("pass")
											&& sExpectedData.toLowerCase().equals("false")) // Mantis 0000905
									{
										sActualValue = "False";
									} else if (sStepStatus.toLowerCase().equals("fail")
											&& sExpectedData.toLowerCase().equals("true")) // Mantis 0000905
									{
										sActualValue = "False";
									} else {
										sActualValue = "True";
									}
									/*-----Mantis 0000906-----*/
									sComments = "Expected value :" + sTestStepData + " Actual value :" + sActualValue; // Mantis
									// 0000890
									processDebugLog(KeywordDrivenFramework.blnError, sComments, sStepStatus);// Mantis 0000904
									break;

								case "clickproperty": // Mantis 0001073
								case "clickjll":

									if (sIdentifierValue == null) {
										sIdentifierValue = sTestStepData;
									}
									if (sIdentifierValue.contains("##")) {
										int count = 0;
										String testdata[] = null;
										java.util.regex.Pattern pat = java.util.regex.Pattern.compile("##");
										Matcher mat = pat.matcher(sIdentifierValue);
										while (mat.find()) {
											count++;
										}
										System.out.println("Number of Occurences of ## in IdentifierValue : " + count);

										if (count > 1) {
											if (sTestStepData.contains("|")) {
												testdata = sTestStepData.split("\\|");
											} else {
												throw new Exception(
														"Number of occurences of ## and number of testdata should be equal");
											}

											if (testdata.length == count) {
												for (int i = 0; i < count; i++) {
													sIdentifierValue = sIdentifierValue.replaceFirst("##",
															"\"".concat(testdata[i]).concat("\""));
												}
											} else
												throw new Exception("Number of occurences of ## and number of testdata should be equal");
										} else {
											sIdentifierValue = sIdentifierValue.replace("##","'".concat(sTestStepData).concat("'"));
										}
										System.out.println("IdentifierValue : " + sIdentifierValue);
									}
									optionalClick(sControlType, sIdentifier, sIdentifierValue, iIndex);
									sComments = "";
									break;

								case "dynamicclickproperty": // Mantis 0001070

									if (sIdentifierValue == null) {
										sIdentifierValue = sTestStepData;
									}

									if (sIdentifierValue.contains("##")) {
										int count = 0;
										String testdata[] = null;
										java.util.regex.Pattern pat = java.util.regex.Pattern.compile("##");
										Matcher mat = pat.matcher(sIdentifierValue);
										while (mat.find()) {
											count++;
										}
										System.out.println("Number of Occurences of ## in IdentifierValue : " + count);

										if (count > 1) {
											if (sTestStepData.contains("|")) {
												testdata = sTestStepData.split("\\|");
											} else {
												throw new Exception(
														"Number of occurences of ## and number of testdata should be equal");
											}

											if (testdata.length == count) {
												for (int i = 0; i < count; i++) {
													sIdentifierValue = sIdentifierValue.replaceFirst("##",
															"\"".concat(dynamicSet(sTestCaseData, testdata[i])).concat("\""));
												}
											} else
												throw new Exception(
														"Number of occurences of ## and number of testdata should be equal");
										} else {
											sIdentifierValue = sIdentifierValue.replace("##",
													"'".concat(sTestStepData).concat("'"));
										}
										System.out.println("IdentifierValue : " + sIdentifierValue);
									}
									optionalClick(sControlType, sIdentifier, sIdentifierValue, iIndex);
									sComments = "";
									break;

									/*
									 * case "getapi": // Mantis 0001073 apiparam = ""; testdataparam = ""; // Mantis
									 * 0001149 sData = getApiData(sTestCaseData, sIdentifier, sTestStepData); if
									 * (sData == null || sData == "") { sData = ""; sStepDescription =
									 * sStepDescription + "=> No data found in API"; } systemouts("Data returned " +
									 * sData); sData = writeJSON(sData); dynamicGet(sTestCaseData, sIdentifierValue,
									 * sData, ""); sComments = "The Operation Returned Value :" + sData; //
									 * sActualValue = sData; break;
									 */

								case "getapidata":
								case "getapi": // Mantis 0001073
									List<String> apiDetails = (List<String>) ExcelConnection.getApiTestingData(sIdentifier);
									String apiURL=apiDetails.get(2); //0002035
									if (!sIdentifierValue.startsWith("/")) // Mantis 0002007
									{
										sIdentifierValue = "/" + sIdentifierValue;
									}

									if(sIdentifierValue.contains("{"))
									{
										dynamicField = sIdentifierValue.substring(sIdentifierValue.indexOf("{")+1, sIdentifierValue.indexOf("}"));
										dynamicValue = dynamicSet(sTestCaseData, dynamicField);
										sIdentifierValue = sIdentifierValue.replace("{"+dynamicField+"}", dynamicValue);
									}


									if (apiDetails != null) {
										Map<String, Object> getApiResponse=null;
										try
										{
											getApiResponse = apiserviceObj.makeApiCall("GET", apiDetails.get(2),
													sIdentifierValue, sTestCaseData, apiDetails.get(1), apiDetails.get(3),
													apiDetails.get(4), apiDetails.get(6), apiDetails.get(5), apiDetails.get(9),
													apiDetails.get(7), apiDetails.get(8), apiDetails.get(10), apiDetails.get(11));		// Mantis: 2025
										}
										catch(Throwable e)
										{
											e.printStackTrace();
										}

										if(getApiResponse==null) //0002033
										{
											sStepStatus="Fail";
											sComments="API End point not reachable "+apiURL+sIdentifierValue;
											throw new Exception(sComments);
										}

										if(getApiResponse!=null)
										{
											System.err.println(getApiResponse.get("status").toString());
											sData = getApiResponse.get("status").toString();
											if (sData == null || !sData.equals("200")) 
											{
												sStepStatus = "Fail";
												sStepDescription = sStepDescription + "=> No data found in API";
												dynamicGet(sTestCaseData, sDataColumn, "", "");
												sActualValue = getApiResponse.get("status_text").toString();
											} else {
												dynamicGet(sTestCaseData, sDataColumn, (String) getApiResponse.get("body"), "");// Mantis 0002008, 2014
												sActualValue = "The Status Code = " + sData;
											}
										}
										else
										{
											sStepStatus = "Fail";
											sStepDescription="API End point not reachable";
										}
									} else // Mantis 0002005
									{
										sStepStatus = "Fail";
										sStepDescription = "Could not find an Api with " + sIdentifier + " connection name.";
									}
									break;

								case "getapi404":   //0002032
									List<String> apiDetails404 = (List<String>) ExcelConnection.getApiTestingData(sIdentifier);
									String api404URL=apiDetails404.get(2); //0002035
									if (!sIdentifierValue.startsWith("/")) // Mantis 0002007
									{
										sIdentifierValue = "/" + sIdentifierValue;
									}

									if(sIdentifierValue.contains("{"))
									{
										dynamicField = sIdentifierValue.substring(sIdentifierValue.indexOf("{")+1, sIdentifierValue.indexOf("}"));
										dynamicValue = dynamicSet(sTestCaseData, dynamicField);
										sIdentifierValue = sIdentifierValue.replace("{"+dynamicField+"}", dynamicValue);
									}


									if (apiDetails404 != null) {
										Map<String, Object> getApiResponse=null;
										try
										{
											getApiResponse = apiserviceObj.makeApiCall("GET", apiDetails404.get(2),
													sIdentifierValue, sTestCaseData, apiDetails404.get(1), apiDetails404.get(3),
													apiDetails404.get(4), apiDetails404.get(6), apiDetails404.get(5), apiDetails404.get(9),
													apiDetails404.get(7), apiDetails404.get(8), apiDetails404.get(10), apiDetails404.get(11));		// Mantis: 2025
										}
										catch(Throwable e)
										{

											e.printStackTrace();
										}

										if(getApiResponse==null)  //0002033
										{
											sStepStatus="Fail";
											sComments="API End point not reachable "+api404URL+sIdentifierValue;
											throw new Exception(sComments);
										}
										if(getApiResponse !=null)
										{
											System.err.println(getApiResponse.get("status").toString());
											sData = getApiResponse.get("status").toString();
											if (sData == null || !sData.equals("404")) 
											{
												sStepStatus = "Fail";
												sStepDescription = sStepDescription + "=> No data found in API";
												dynamicGet(sTestCaseData, sDataColumn, "", "");
												sActualValue = getApiResponse.get("status_text").toString();
											} else {
												dynamicGet(sTestCaseData, sDataColumn, (String) getApiResponse.get("body"), "");// Mantis 0002008, 2014
												sActualValue = "The Status Code = " + sData;
											}
										}
										else
										{
											sStepStatus = "Fail";
											sStepDescription="API End Point not reachable";
										}
									} else // Mantis 0002005
									{
										sStepStatus = "Fail";
										sStepDescription = "Could not find an Api with " + sIdentifier + " connection name.";
									}
									break;

								case "post": // Mantis 0001073

									List<String> postApiDetails = (List<String>) ExcelConnection.getApiTestingData(sIdentifier);
									if(postApiDetails==null)
									{
										sStepStatus = "Fail";
										sComments="Invalid API connection name "+sIdentifier+", please check API connection name in API connections";
										throw new Exception(sComments);
									}
									String postApiURL=postApiDetails.get(2);
									//System.err.println(apiURL);
									if (!sIdentifierValue.startsWith("/")) // Mantis 0002007
									{
										sIdentifierValue = "/" + sIdentifierValue;
									}

									if(sIdentifierValue.contains("{"))
									{
										dynamicField = sIdentifierValue.substring(sIdentifierValue.indexOf("{")+1, sIdentifierValue.indexOf("}"));
										dynamicValue = dynamicSet(sTestCaseData, dynamicField);
										sIdentifierValue = sIdentifierValue.replace("{"+dynamicField+"}", dynamicValue);
									}

									if(sTestStepData.contains("##"))
									{
										sTestStepData = sTestStepData.replace("##", dynamicValue);
									}

									if (postApiDetails != null) 
									{
										Map<String, Object> postApiResponse =null;

										try {
											postApiResponse = apiserviceObj.makeApiCall("POST",
													postApiDetails.get(2), sIdentifierValue, sTestStepData, postApiDetails.get(1),
													postApiDetails.get(3), postApiDetails.get(4), postApiDetails.get(6),
													postApiDetails.get(5), postApiDetails.get(9), postApiDetails.get(7),
													postApiDetails.get(8), postApiDetails.get(10), postApiDetails.get(11));
										} catch (Throwable e1) {

											e1.printStackTrace();
										}		// Mantis: 2025


										if(postApiResponse==null) //0002033
										{
											sStepStatus = "Fail";
											sComments="API End point not reachable "+postApiURL+sIdentifierValue; //0002035
											throw new Exception(sComments);
										}

										if(postApiResponse!=null)
										{
											System.err.println(postApiResponse.get("status").toString());
											sData = postApiResponse.get("status").toString();
											if (sData == null || (!sData.equals("200") && !sData.equals("201"))) 		//Mantis: 0002022
											{
												sData = "";
												sStepStatus = "Fail";
												sStepDescription = sStepDescription	+ "=>Error Occured while posting the data in the Api";
												dynamicGet(sTestCaseData, sDataColumn, "", "");
												sActualValue = postApiResponse.get("status_text").toString();
											} 
											else 
											{
												// sComments = "The Operation Returned Value :"+sData;
												dynamicGet(sTestCaseData, sDataColumn, (String)postApiResponse.get("body"),""); //Mantis 0002008, 2014
												sStepDescription = sUserAction + " " + sIdentifierValue; //0002031
												sActualValue = "The Status Code = " + sData;
											}
										}
										else
										{
											sStepStatus = "Fail";
											sStepDescription="API End point not reachable";	

										}
									} 
									else 
									{
										sStepStatus = "Fail";
										sStepDescription = "Could not find an Api with " + sIdentifier + " connection name.";
									}
									break;

								case "put": // Mantis 0001073

									List<String> putApiDetails = (List<String>) ExcelConnection.getApiTestingData(sIdentifier);
									String putApiURL=putApiDetails.get(2); //0002035
									if (!sIdentifierValue.startsWith("/")) // Mantis 0002007
									{
										sIdentifierValue = "/" + sIdentifierValue;
									}

									if(sIdentifierValue.contains("{"))
									{
										dynamicField = sIdentifierValue.substring(sIdentifierValue.indexOf("{")+1, sIdentifierValue.indexOf("}"));
										dynamicValue = dynamicSet(sTestCaseData, dynamicField);
										sIdentifierValue = sIdentifierValue.replace("{"+dynamicField+"}", dynamicValue);
									}

									if(sTestStepData.contains("##"))	// Mantis: 0002024
									{
										sTestStepData = sTestStepData.replace("##", dynamicValue);
									}

									if (putApiDetails != null) 
									{
										Map<String, Object> putApiResponse=null;
										try
										{

											putApiResponse = apiserviceObj.makeApiCall("PUT",
													putApiDetails.get(2), sIdentifierValue, sTestStepData, putApiDetails.get(1),
													putApiDetails.get(3), putApiDetails.get(4), putApiDetails.get(6),
													putApiDetails.get(5), putApiDetails.get(9), putApiDetails.get(7),
													putApiDetails.get(8), putApiDetails.get(10), putApiDetails.get(11));		// Mantis: 2025
										}
										catch(Throwable e)
										{
											e.printStackTrace();
										}

										if(putApiResponse==null) //0002033
										{
											sStepStatus="Fail";
											sComments="API End point not reachable "+putApiURL+sIdentifierValue;
											throw new Exception(sComments);

										}

										if(putApiResponse!=null)
										{
											System.err.println(putApiResponse.get("status").toString());
											sData = putApiResponse.get("status").toString();
											if (sData == null || (!sData.equals("200") && !sData.equals("201"))) 
											{		//Mantis: 0002022
												sData = "";
												sStepStatus = "Fail";
												sStepDescription = sStepDescription	+ "=>Error Occured while updating the data in the Api";
												dynamicGet(sTestCaseData, sDataColumn, "", "");
												sActualValue = putApiResponse.get("status_text").toString();
											} 
											else 
											{
												// sComments = "The Operation Returned Value :"+sData;
												dynamicGet(sTestCaseData, sDataColumn, (String)putApiResponse.get("body"),""); //Mantis 0002008, 2014
												sStepDescription = sUserAction + " " + sIdentifierValue; //0002031
												sActualValue = "The Status Code = " + sData;
											}
										}
										else
										{
											sStepStatus = "Fail";
											sStepDescription="API End points not reachable";
										}
									} 
									else 
									{
										sStepStatus = "Fail";
										sStepDescription = "Could not find an Api with " + sIdentifier + " connection name.";
									}
									break;

								case "delete": // Mantis 0001073

									List<String> deleteApiDetails = (List<String>) ExcelConnection.getApiTestingData(sIdentifier);
									String deleteApiURL=deleteApiDetails.get(2); //0002035
									if (!sIdentifierValue.startsWith("/")) // Mantis 0002007
									{
										sIdentifierValue = "/" + sIdentifierValue;
									}

									if(sIdentifierValue.contains("{"))
									{
										dynamicField = sIdentifierValue.substring(sIdentifierValue.indexOf("{")+1, sIdentifierValue.indexOf("}"));
										dynamicValue = dynamicSet(sTestCaseData, dynamicField);
										sIdentifierValue = sIdentifierValue.replace("{"+dynamicField+"}", dynamicValue);
									}

									if (deleteApiDetails != null) 
									{
										Map<String, Object> deleteApiResponse=null;	
										try
										{
											deleteApiResponse = apiserviceObj.makeApiCall("DELETE",
													deleteApiDetails.get(2), sIdentifierValue, sTestStepData, deleteApiDetails.get(1),
													deleteApiDetails.get(3), deleteApiDetails.get(4), deleteApiDetails.get(6),
													deleteApiDetails.get(5), deleteApiDetails.get(9), deleteApiDetails.get(7),
													deleteApiDetails.get(8), deleteApiDetails.get(10), deleteApiDetails.get(11));
										}
										catch(Throwable e)
										{
											e.printStackTrace();
										}

										if(deleteApiResponse==null) //0002033
										{
											sStepStatus="Fail";
											sComments="API End point not reachable "+deleteApiURL+sIdentifierValue; //0002035
											throw new Exception(sComments);

										}

										if(deleteApiResponse!=null)
										{
											System.err.println(deleteApiResponse.get("status").toString());
											sData = deleteApiResponse.get("status").toString();
											if (sData == null || (!sData.equals("200") && !sData.equals("201"))) 
											{		//Mantis: 0002022
												sData = "";
												sStepStatus = "Fail";
												sStepDescription = sStepDescription	+ "=>Error Occured while deleting the data in the Api";
												dynamicGet(sTestCaseData, sDataColumn, "", "");
												sActualValue = deleteApiResponse.get("status_text").toString();
											} 
											else 
											{
												// sComments = "The Operation Returned Value :"+sData;
												dynamicGet(sTestCaseData, sDataColumn, (String)deleteApiResponse.get("body"),""); //Mantis 0002008, 2014
												sStepDescription = sUserAction +" "+sIdentifierValue; //0002031
												sActualValue = "The Status Code = " + sData;
											}
										}
										else
										{
											sStepStatus = "Fail";
											sStepDescription="API End points not reachable";
										}
									} 
									else 
									{
										sStepStatus = "Fail";
										sStepDescription = "Could not find an Api with " + sIdentifier + " connection name.";
									}
									break;

								case "storeapifield": // Mantis 0001149
									sData = storeapifieldvalue(sTestCaseData, sDataColumn, sTestStepData, sIdentifier,
											sTestCaseExcelPath);
									dynamicGet(sTestCaseData, sIdentifierValue, sData, "");
									sActualValue = sData;
									break;

								case "setwait": // Mantis 0001012
									lElementWait = Long.parseLong(sTestStepData);
									System.out.println("Element wait Time changed to " + lElementWait + "secs");
									break;

								case "transformdata": // Mantis 0001073
									sData = dynamicSet(sTestCaseData, sDataColumn);
									sData = readJSON(sData);
									sData = transformData(sData, sTestStepData);
									System.out.println(sData);
									sData = writeJSON(sData);
									dynamicGet(sTestCaseData, sIdentifierValue, sData, "");
									sComments = "The Operation Returned Value :" + sData;
									break;

								case "transformavilabilitydata": // Mantis 0001073
									sData = dynamicSet(sTestCaseData, sDataColumn);
									sData = readJSON(sData);
									sData = transformAvilabilityData(sData, sTestStepData);
									System.out.println(sData);
									sData = writeJSON(sData);
									dynamicGet(sTestCaseData, sIdentifierValue, sData, "");
									sComments = "The Operation Returned Value :" + sData;
									break;

									// Mantis 0001097
								case "verifyproperty":

									sExpectedData = modifyTestDataValue(sTestStepData, sTestCaseExcelPath);
									if (sVerifyProperty == null) {
										sVerifyProperty = "text";
										debugLog("Object Sync", "Property Not Provided in Page Sheet Default Property : Text");
									}

									FileData = SetReportExcelFileName("Aero_PropertyReport_");

									sReportFile = FileData.get("FileName");
									sSheetName = FileData.get("SheetName");

									sStepStatus = verifyProperties(sControlType, sIdentifier, sIdentifierValue, sVerifyProperty,
											iIndex, sExpectedData, sReportFile, sSheetName);

									sComments = "Expected value :" + sTestStepData + " Actual value :" + sActualValue;
									processDebugLog(KeywordDrivenFramework.blnError, sComments, sStepStatus);// Mantis 0000703

									break;

								case "dynamicverifyapi": // Mantis 0001073 ,0001098

									sData = dynamicSet(sTestCaseData, sDataColumn);
									sData = readJSON(sData);

									if (sVerifyProperty == null) {
										sVerifyProperty = "text";
										debugLog("Object Sync", "Property Not Provided in Page Sheet Default Property : Text");
									}

									if (sAvailabilityTransFormStaus) // Mantis 0001098
										FileData = SetReportExcelFileName("Report_AvailabilityVerification_");
									else if (sPropertyTransFormStaus)
										FileData = SetReportExcelFileName("Report_PropertyVerification_");

									sReportFile = FileData.get("FileName");
									sSheetName = FileData.get("SheetName");

									sStepStatus = verifyAPIData(sTestCaseData, sControlType, sIdentifier, sIdentifierValue,
											iIndex, sVerifyProperty, sData, sTestStepData, sSheetName, sReportFile);
									sStepDescription = sStepDescription + "UserAction=>" + sUserAction
											+ " Status=>Overall Status of Api verifcation with UI data";
									// sComments="Expected value :"+ sExpectedData + " Actual value :"
									// +sActualValue; //Mantis 0000704
									break;
								case "verifypropertydetails": // Mantis 0001149
									Boolean oldavailstatus = false, oldpropstatus = false;

									if (sAvailabilityTransFormStaus) {
										oldavailstatus = sAvailabilityTransFormStaus;
										sAvailabilityTransFormStaus = false;
										sPropertyDetailTransformStatus = true;
									}
									if (sPropertyTransFormStaus) {
										oldpropstatus = sPropertyReportStatus;
										sPropertyReportStatus = false;
									}
									sData = dynamicSet(sTestCaseData, sDataColumn);
									sData = readJSON(sData);
									if (sVerifyProperty == null) {
										sVerifyProperty = "text";
										debugLog("Object Sync", "Property Not Provided in Page Sheet Default Property : Text");
									}

									PropertyDetailFileData = SetReportExcelFileName("Report_PropertyDetails_Verification_");
									sPropertyDetailfile = PropertyDetailFileData.get("FileName");
									sPDSheetName = PropertyDetailFileData.get("SheetName");
									sStepStatus = checkPropertyDetails(sTestCaseData, sControlType, sIdentifier,
											sIdentifierValue, iIndex, sVerifyProperty, sData, sTestStepData, sPDSheetName,
											sPropertyDetailfile);
									sStepDescription = sStepDescription + "UserAction=>" + sUserAction
											+ " Status=>Overall Status of Api verifcation with UI data";
									sAvailabilityTransFormStaus = oldavailstatus;
									sPropertyTransFormStaus = oldpropstatus;
									break;

									/*
									 * case "dynamicverifyapiavailability": //Manoj xxx
									 * 
									 * sData = dynamicSet(sTestCaseData, sDataColumn); sData = readJSON(sData);
									 * 
									 * if(sVerifyProperty==null) { sVerifyProperty="text"; debugLog("Object Sync",
									 * "Property Not Provided in Page Sheet Default Property : Text"); }
									 * 
									 * sStepStatus =
									 * verifyAPIData(sTestCaseData,sControlType,sIdentifier,sIdentifierValue,iIndex,
									 * sVerifyProperty,sData,sTestStepData); sStepDescription = sStepDescription
									 * +"UserAction=>"+
									 * sUserAction+" Status=>Overall Status of Api verifcation with UI data";
									 * //sComments="Expected value :"+ sExpectedData + " Actual value :"
									 * +sActualValue; //Mantis 0000704 break;
									 */

								case "setvariable": // Mantis 0001073, 0001098

									sSetData = getVariables(sTestStepData, sTestCaseExcelPath);

									sComments = "Set Data : " + sSetData;
									break;

								case "checkcountmorethan": // Mantis 0001077
									sExpectedData = sTestStepData;
									if (sVerifyProperty == null) {
										sVerifyProperty = "text";
										debugLog("Object Sync", "Property Not Provided in Page Sheet Default Property : Text");
									}
									if (sIdentifierValue.contains("##")) {
										sData = dynamicSet(sTestCaseData, sDataColumn);
										sIdentifierValue = sIdentifierValue.replace("##", "'".concat(sData).concat("'"));
									}
									sStepStatus = checkCountMoreThan(sControlType, sIdentifier, sIdentifierValue,
											sVerifyProperty, iIndex, sExpectedData);
									sComments = "Expected value :" + sTestStepData + " Actual value :" + sActualValue;
									processDebugLog(KeywordDrivenFramework.blnError, sComments, sStepStatus);// Mantis 0000703
									break;

								case "dynamicfileexist": // Mantis 0001078
									sData = dynamicSet(sTestCaseData, sDataColumn);
									if (!filewait(sData, KeywordDrivenFramework.sFileWait)) // Mantis 0001079
									{
										sStepStatus = "Fail";
										sStepDescription = "File: " + sData + " not found";
										debugLog("fileexist", "File not found");
									}
									break;

								case "dynamicfiledelete": // Mantis 0001078
									sData = dynamicSet(sData, sDataColumn);
									if (new File(sData).exists()) {
										FileUtils.forceDelete(new File(sData));
										sStepStatus = "Pass";
										sStepDescription = "File: " + sData + " deleted";
										debugLog("dynamicfiledelete", "File deleted sucessfully");
									} else {
										sStepStatus = "Fail";
										sStepDescription = "File: " + sData + " not found";
										debugLog("dynamicfiledelete", "File not found");
									}
									break;

								case "filedelete": // Mantis 0001078
									if (new File(sTestStepData).exists()) {
										FileUtils.forceDelete(new File(sTestStepData));
										sStepStatus = "Pass";
										sStepDescription = "File: " + sTestStepData + " deleted";
										debugLog("dynamicfiledelete", "File deleted sucessfully");
									} else {
										sStepStatus = "Fail";
										sStepDescription = "File: " + sTestStepData + " not found";
										debugLog("dynamicfiledelete", "File not found");
									}
									break;
								case "pdfverify": // Mantis 0001092
									stepParts = sTestStepData.split("\\|");
									filepath = stepParts[0];
									Searchtext = stepParts[1];
									if (!new File(filepath).exists())
										throw new Exception("File Not Found " + filepath);

									Pdfverifytext.FindTextCompletePdf(filepath, Searchtext);
									if (found > 0)
										sStepStatus = "PASS";
									else
										sStepStatus = "FAIL";
									debugLog("pdfverify",
											" File " + filepath + " Found " + Searchtext + " " + found + " times");

									sComments = "Expected value :" + sTestStepData + " Actual value :" + sActualValue;
									processDebugLog(KeywordDrivenFramework.blnError, sComments, sStepStatus);// Mantis 0000703
									break;

								case "dynamicpdfverify": // Mantis 0001092
									stepParts = sTestStepData.split("\\|");
									filepath = dynamicSet(sTestCaseData, stepParts[0]);
									Searchtext = dynamicSet(sTestCaseData, stepParts[1]);
									if (!new File(filepath).exists())
										throw new Exception("File Not Found " + filepath);

									found = Pdfverifytext.FindTextCompletePdf(filepath, Searchtext);
									System.err.println(" found " + found);
									if (found > 0)
										sStepStatus = "PASS";
									else
										sStepStatus = "FAIL";
									debugLog("dynamicpdfverify",
											"File " + filepath + " Found " + Searchtext + " " + found + " times");
									sComments = "Expected value :" + sTestStepData + " Actual value :" + sActualValue;
									processDebugLog(KeywordDrivenFramework.blnError, sComments, sStepStatus);// Mantis 0000703
									break;

								case "dragfrom": // Mantis 0001087
									if (sIdentifierValue == null) {
										sIdentifierValue = sTestStepData;
									}
									if (sIdentifierValue.contains("##")) // Mantis 0000835
									{
										sIdentifierValue = sIdentifierValue.replace("##",
												"'".concat(sTestStepData).concat("'"));
									}
									sourceElement(sControlType, sIdentifier, sIdentifierValue, iIndex);
									sComments = "";
									break;

								case "dragto": // Mantis 0001087
									if (sIdentifierValue == null) {
										sIdentifierValue = sTestStepData;
									}
									if (sIdentifierValue.contains("##")) // Mantis 0000835
									{
										sIdentifierValue = sIdentifierValue.replace("##",
												"'".concat(sTestStepData).concat("'"));
									}
									targetElement(sControlType, sIdentifier, sIdentifierValue, iIndex);
									System.err.println("Start element" + startElement.getText() + "\n" + "End Element "
											+ endElement.getText());
									org.openqa.selenium.Point p = endElement.getLocation();
									System.err.println(p.getX() + " poiny " + p.getY() + "");
									Actions builder = new Actions(oDriver);
									builder.moveToElement(startElement).dragAndDrop(startElement, endElement)
									.moveToElement(endElement).release(endElement).build().perform();
									// builder.dragAndDrop(startElement, endElement).build().perform();
									// builder.clickAndHold(startElement).moveToElement(endElement).release().build().perform();
									// builder.clickAndHold(startElement).moveToElement(endElement).release().build().perform();
									// builder.doubleClick().clickAndHold(startElement).moveToElement(endElement).release(endElement).build().perform();
									// builder.moveToElement(startElement).dragAndDrop(startElement,endElement).build().perform();
									// builder.dragAndDropBy(startElement, p.getX()/2,p.getY()/2).build().perform();
									sComments = "";
									break;

								case "checksortascending": // Mantis 0001132
									if (sVerifyProperty == null) {
										sVerifyProperty = "text";
										debugLog("Object Sync", "Property Not Provided in Page Sheet Default Property : Text");
									}
									checkSortingOrder(sControlType, sIdentifier, sIdentifierValue, sVerifyProperty, iIndex,
											sExpectedData, "asc");
									break;

								case "checksortdescending": // Mantis 0001132
									if (sVerifyProperty == null) {
										sVerifyProperty = "text";
										debugLog("Object Sync", "Property Not Provided in Page Sheet Default Property : Text");
									}
									checkSortingOrder(sControlType, sIdentifier, sIdentifierValue, sVerifyProperty, iIndex,
											sExpectedData, "desc");
									break;
								case "clickelements":

									if (sIdentifierValue == null) {
										sIdentifierValue = sTestStepData;
									}
									if (sIdentifierValue.contains("##")) // Mantis 0000835
									{
										sIdentifierValue = sIdentifierValue.replace("##",
												"'".concat(sTestStepData).concat("'"));
									}
									checkallavailability(sControlType, sIdentifier, sIdentifierValue);
									sComments = "";
									break;
								case "addelements": // Mantis 0001139
									if (sIdentifierValue == null) {
										sIdentifierValue = sTestStepData;
									}
									if (sIdentifierValue.contains("##")) // Mantis 0000835
									{
										sIdentifierValue = sIdentifierValue.replace("##",
												"'".concat(sTestStepData).concat("'"));
									}
									addAllElements(sControlType, sIdentifier, sIdentifierValue);
									sComments = "";
									break;
								case "checkascendingordernumeric": // Mantis 0001133
									if (sVerifyProperty == null) {
										sVerifyProperty = "text";
										debugLog("Object Sync", "Property Not Provided in Page Sheet Default Property : Text");
									}
									checkSortingOrderNumeric(sControlType, sIdentifier, sIdentifierValue, sVerifyProperty,
											iIndex, sExpectedData, "asc");
									break;

								case "checkdescendingordernumeric": // Mantis 0001133
									if (sVerifyProperty == null) {
										sVerifyProperty = "text";
										debugLog("Object Sync", "Property Not Provided in Page Sheet Default Property : Text");
									}
									checkSortingOrderNumeric(sControlType, sIdentifier, sIdentifierValue, sVerifyProperty,
											iIndex, sExpectedData, "desc");
									break;

								case "getelements": // Mantis 0001136

									if (sIdentifierValue == null) {
										sIdentifierValue = sTestStepData;
									}
									if (sIdentifierValue.contains("##")) // Mantis 0000835
									{
										sIdentifierValue = sIdentifierValue.replace("##",
												"'".concat(sTestStepData).concat("'"));
									}
									getallavailability(sControlType, sIdentifier, sIdentifierValue);
									sComments = "";
									break;

								case "verifyapifield": // Mantis 0001136
									verifyApiFieldData(sTestStepData, sDataColumn);
									if (sVerifyProperty == null) {
										sVerifyProperty = "text";
										debugLog("Object Sync", "Property Not Provided in Page Sheet Default Property : Text");
									}
									if (sIdentifierValue.contains("##")) {
										sData = dynamicSet(sTestCaseData, sDataColumn);
										sIdentifierValue = sIdentifierValue.replace("##", "'".concat(sData).concat("'"));
									}
									sStepStatus = verifyProperty(sControlType, sIdentifier, sIdentifierValue, sVerifyProperty,
											sForLoopCounter, sExpectedData);
									sComments = "Expected value :" + sExpectedData + " Actual value :" + sActualValue;
									processDebugLog(KeywordDrivenFramework.blnError, sComments, sStepStatus);
									break;
								case "cleariecache": // Mantis 0001219
									if (_sBrowser.equalsIgnoreCase("ie")) // Mantis 0001220
										cleariecachevbs();
									else
										sActualValue = "Skipping this step as execution is not on IE browser";
									break;

									/*
									 * case "extractjsonvalue": //Mantis 0001331,0001815 sData =
									 * getJSONValue(sTestCaseData, sDataColumn); sComments =
									 * "The Operation Returned Value :" + sData; sActualValue = sData;
									 * 
									 * break;
									 */

								case "extractjsonvalue":
								case "extractjson":		// Mantis 0002019, 2026

									//sData = extricateJson(sTestCaseData, sDataColumn, sIdentifierValue);
									sComments = "The Operation Returned Value :" + sData;
									//sStepDescription = sStepDescription + sTestStepData;
									sStepDescription=sUserAction+" "+ sVerifyProperty; //0002031
									sActualValue = sData;

									break;

								case "ignoreregion": // Mantis 0001911
								case "storecoordinate": // Mantis 0001812,0001816
									if (sIdentifierValue.contains("##")) // Mantis 0000960
									{
										sIdentifierValue = sIdentifierValue.replace("##",
												"'".concat(dynamicSet(sTestCaseData, sDataColumn)).concat("'"));
									}
									sData = storeCoordinateValue(sControlType, sIdentifier, sIdentifierValue, iIndex);

									systemouts("******* Co-Ordinate Data for " + sIdentifierValue + " : " + sData);
									dynamicGet(sTestCaseData, sDataColumn, sData, ""); // Mantis 0000713
									sComments = "The Operation Returned Value :" + sData;
									sActualValue = sData; // 0000518
									break;
								case "ignoreregionbypixels": // Mantis 0001943
									sData = sTestStepData;
									dynamicGet(sTestCaseData, sDataColumn, sData, ""); // Mantis 0000713
									sComments = "The Operation Returned Value :" + sData;
									sActualValue = sData; // 0000518
									break;

								case "dynamicoptionalclick": // Mantis 0001816
									systemouts("Inside Dynamic Optional Click");
									sData = dynamicSet(sTestCaseData, sDataColumn);
									systemouts("Dynamic Optional Click Data..." + sData);
									if (sIdentifierValue.isEmpty()) // Mantis 0000849
									{
										sIdentifierValue = sData;
									} else if (sIdentifierValue.contains("##")) {
										sIdentifierValue = sIdentifierValue.replace("##", "'".concat(sData).concat("'"));
									}
									optionalClick(sControlType, sIdentifier, sIdentifierValue, iIndex); // Mantis 0000849
									sComments = "Used Data :" + sData;
									break;

								case "getelementcount":
									int elementcount = 0;
									if (waitForElements(lElementWait, sIdentifier, sIdentifierValue)) // Mantis 1758
									{
										List<WebElement> elements = getElements(sControlType, sIdentifier, sIdentifierValue);
										elementcount = elements.size();
									} else {
										elementcount = 0;
									}
									systemouts("Data : " + elementcount);
									dynamicGet(sTestCaseData, sDataColumn, elementcount + "", ""); // Mantis 0000713
									sComments = "The Operation Returned Value :" + elementcount;
									sActualValue = elementcount + "";
									break;
								case "dynamiccontainsattach": // Mantis 0001816
									attach(dynamicSet(sTestCaseData, sDataColumn), "contains");
									break;
								case "captureimage": // Mantis 0001911
									try {
										sTestStepData = getValueFromDataSheet(Driver, sTestCaseExcelPath, sTestCaseData,
												sDataColumn);
									} catch (NoSuchFieldException e) {
										sComments = "Dynamic Region is not specified in Data sheet";
									}
									try {
										captureImage("ImageVerification", sDataColumn, sTestStepData, Driver,
												sTestCaseExcelPath, sTestCaseData, sIdentifier, sIdentifierValue, iIndex); // Mantis
										// 0001924
									} catch (ArithmeticException e) { // Mantis id 0001948

										sStepStatus = "FAIL";
										sActualValue = e.getMessage();
									}
									isImageVerificationAdded = true;
									break;

								default:
									InvalidNameException e = new InvalidNameException(
											"Invalid user action '" + sUserAction + "' entered");
									throw e;

								}
								if (sTakeScreenShot != null && sTakeScreenShot.equalsIgnoreCase("Y")
										&& KeywordDrivenFramework.gScreenshot.equalsIgnoreCase("Y")) // Mantis 0001249
								{
									takeScreenShot();
								}
								if (!sUserAction.equalsIgnoreCase("verifywebtable"))
									oFunctionLog.setTestStepDetails(sTestCaseData, Integer.toString(iStepNo), sExpectedData,
											sActualValue, sStepStatus, sDescription, sStepDescription, sScreenShotFilePath,
											sWebPagePath);// Mantis 0001221
								sExpectedData = "";
								sActualValue = "";
							} // if closes
							else {

								if (sStepStatus.equalsIgnoreCase("fail")) {
									sComments = "Space present in Column Name inside Page or Data sheet/Column name is missing in Data sheet";
								} else {
									sComments = "Step Not Performed because ";
									sStepStatus = "Pass";
									if (sTestStepData == null) {
										sComments = sComments + "Data Sheet has Empty Data Column ";
									}
									if (sUserAction == null)
										sComments = sComments + "Data Sheet has Empty UserAction";
									if (!sConditionalStart)
										sComments = sComments
										+ "Condition object does not exist dependent steps will be skipped "; // 0000877
									if (!sConditionalFileExist) // Mantis 0001836
										sComments = sComments + " file exists  " + conditionFileName;

								}
								if (sTakeScreenShot != null && sTakeScreenShot.equalsIgnoreCase("Y")
										&& KeywordDrivenFramework.gScreenshot.equalsIgnoreCase("Y")) // Mantis 0001249
								{
									takeScreenShot();
								}
								sStepDescription = sDescription + ", " + sComments;
								oFunctionLog.setTestStepDetails(sTestCaseData, Integer.toString(iStepNo), "", "", sStepStatus,
										sDescription, sStepDescription, sScreenShotFilePath, sWebPagePath); // Mantis 0001221
							}
							debugLog(sUserAction, sComments);
						} // while ends
					} // if closes
					else {
						NoSuchFileException e = new NoSuchFileException("File " + sTestCaseExcelPath + " does not exist");
						throw e;
					}
				} // try closes
				catch (SQLException e) {
					e.printStackTrace();
				} 

				finally {
					try {
						if (con != null) // Mantis 0001222
							con.close();
						if (pageWorkboook != null) // Mantis 0001222
							pageWorkboook.close();
					} catch (Exception e) {
						e.printStackTrace();
					}
				}
	}

	private String storeapifieldvalue(String sTestCase, String sDatacolumn, String sTestStepData, String sIdentifier,
			String sTestCaseExcelPath) throws Exception // Mantis 0001149
	{
		String jsondata = dynamicSet(sTestCase, sDatacolumn);
		jsondata = readJSON(jsondata);

		String propertyid = "";
		List<String> rowdata = new ArrayList<String>();
		String apiuicomparison[];
		Boolean found = true;
		String fieldvalue, uivalue;
		String apiparamlist[], testdatalist[];

		if (jsondata.length() != 0) {
			apiparamlist = apiparam.split("\\|"); // read key values
			apiparamlist = apiparamlist[1].split(",");
			testdatalist = testdataparam.split(","); // Read testdata values

			List<List<String>> sJSONData = getDataFromAPI(jsondata, apiparam);
			for (int k = 0; k < sJSONData.size(); k++) {
				found = true;
				rowdata = sJSONData.get(k);
				HashMap<String, String> apikeyvalue = new HashMap<String, String>();
				for (int i = 0; i < rowdata.size(); i++) {
					apikeyvalue.put(apiparamlist[i].trim(), rowdata.get(i).toString().trim());
				}

				for (int j = 0; j < testdatalist.length; j++) {
					apiuicomparison = testdatalist[j].split("=");
					fieldvalue = apikeyvalue.get(apiuicomparison[0].trim()); // apicolumn
					uivalue = getDataFromTestSheet(apiuicomparison[1].trim(), sTestCaseExcelPath);

					if (!fieldvalue.equals(uivalue)) {
						found = false;
						break;
					}
				}
				if (found == true) {
					propertyid = apikeyvalue.get(sTestStepData);
					break;
				}
			}
		}
		if (propertyid.length() == 0)
			propertyid = "Property Id Not Found";
		return propertyid;
	}
	/*
	 * --------------------------------------- START : getcss
	 * ---------------------------------------------- Function Name: getcss
	 * Objective: A generic function to obtain css value of element Date Created:
	 * 14/06/2018 Created By :Anum Input: sControlType = Control Type of the object
	 * whose property has to be verified. sSearchCriteria = Identifier that uniquely
	 * identifies an object on application; e.g xpath, id etc sSearchText = Value of
	 * an Identifier sVerifyProperty = Property of the object which has to be
	 * verified. iInd = Index of the object in case multiple objects have same text
	 * or id. sData= Expected value to compare with actual value. Output: modified
	 * by: Revision History: Modified on: Comments: Search object with function
	 * SetDriver , if(objectFound) get the object by calling getElement function and
	 * finds css value of element and compare with the expected value.
	 * -----------------------------------------------------------------------------
	 * ----------------------------
	 */

	private String getcss(String sControlType, String sIdentifier, String sIdentifierValue, String sVerifyProperty,
			int iInd, String sData) throws Exception // Mantis 0000879
	{
		String sIdenVal = null;
		WebElement oCurrentElement;
		String sStatus = "Fail";
		if (waitForElement(sIdentifier, sIdentifierValue, iInd)) // Mantis 0000879
		{
			oCurrentElement = getElement(sControlType, sIdentifier, sIdentifierValue, iInd);
			sIdenVal = oCurrentElement.getCssValue(sVerifyProperty);
			if (sVerifyProperty.contains("color")) {
				if (sIdenVal.contains("rgb")) {
					// rgbtohex
					sIdenVal = rgbToHex(sIdenVal);
				}
			}
			systemouts("Actual Property Value:" + sIdenVal);
			if (sIdenVal.trim().equalsIgnoreCase(sData)) {
				sStatus = "Pass";
			}
			sActualValue = sIdenVal;
		} else {
			sStatus = "Fail";
		}

		return sStatus;
	}

	private String rgbToHex(String rgbcolor) {
		int r = 0, g = 0, b = 0, a = 0;
		try {
			String[] numbers = rgbcolor.replace("rgba(", "").replace(")", "").split(",");
			r = Integer.parseInt(numbers[0].trim());
			g = Integer.parseInt(numbers[1].trim());
			b = Integer.parseInt(numbers[2].trim());
			a = Integer.parseInt(numbers[4].trim());
		} catch (Exception e) {
			e.printStackTrace();
		}

		String hex = String.format("#%02X%02X%02X", r, g, b, a); // Mantis 0000881
		return hex;
	}

	/*
	 * --------------------------------------- START :
	 * modalLogin---------------------------------------------- Function Name:
	 * modalLogin Objective: A generic Function to handle modal authentication Date
	 * Created: 14/12/2015 Input: sTestStepData= Username | Password for
	 * authentication
	 * 
	 * Output: Login with given credentials. Revision History: Modified by: Modified
	 * on: Comments:
	 * -----------------------------------------------------------------------------
	 * ----------------------------
	 */

	/*
	 * --------------------------------------- START :
	 * jvmBitVersion---------------------------------------------- Function Name:
	 * checkjvmversion Objective: A generic Function to handle modal authentication
	 * Date Created: 14/12/2015 Input: sTestStepData= Username | Password for
	 * authentication
	 * 
	 * Output: Login with given credentials. Revision History: Modified by: Modified
	 * on: Comments:
	 * -----------------------------------------------------------------------------
	 * ----------------------------
	 */

	public String jvmBitVersion() {
		return System.getProperty("sun.arch.data.model");
	}

	/*
	 * --------------------------------------- START :
	 * getExcelNextRow---------------------------------------------- Function Name:
	 * getExcelNextRow Objective: A generic Function to fetch test contents for next
	 * step. Date Created: 14/12/2015 Input: sTestCaseExcelPath : Path of Test Excel
	 * Sheet
	 * 
	 * Output: sContrlType and sUserAction : ContrlType and UserAction for Next Test
	 * Step Revision History: Modified by: Modified on: Comments:
	 * -----------------------------------------------------------------------------
	 * ----------------------------
	 */

	void getExcelNextRow(String sTestCaseExcelPath) throws IllegalFormatException, IOException {
		this.sTestCaseExcelPath = sTestCaseExcelPath;
		File f = new File(sTestCaseExcelPath);
		if (f.exists()) {
			sActualValue = "";
			Workbook alertWorkbook = ExcelConnection.funExcelConnection(sTestCaseExcelPath);
			Map<String, Integer> alertColumns = ExcelConnection.funGetSheetColumns(alertWorkbook, "Page");
			List<List<String>> alertRS = ExcelConnection.funGetSheetData(alertWorkbook, "Page");
			if (alertRS.size() > iStepNo) {
				int nextRecordNumber = iStepNo;
				try {
					sNextRowControlType = alertRS.get(nextRecordNumber)
							.get(alertColumns.get(PageColumnHeader.CONTROL_TYPE.toString())); // Mantis 0001035
				} catch (NullPointerException e) // Mantis 0001035
				{

				}
				sNextRowUserAction = alertRS.get(nextRecordNumber)
						.get(alertColumns.get(PageColumnHeader.USER_ACTION.toString()));
				if (sNextRowControlType == null)
					sNextRowControlType = "";
				if (sNextRowUserAction == null)
					sNextRowUserAction = "";
			} else {
				sNextRowControlType = "";
				sNextRowUserAction = "";
			}
		}
	}

	/*
	 * --------------------------------------- START :
	 * GenerateRandom---------------------------------------------- Function Name:
	 * GenerateRandom Objective: A generic Function to dynamically generate a set of
	 * alphabets/numbers/date. Date Created: 15/7/15 Input: sTestStepData=Data which
	 * has to be checked in the DynamicData.xlsx prefixed with "~" Output: Returns a
	 * dynamically generated set to be used at runtime. Revision History: Modified
	 * by: Aboli Modified on: 24/7/15 Comments:
	 * -----------------------------------------------------------------------------
	 * ----------------------------
	 */

	String GenerateRandom(String sTestStepData) throws Exception {
		sTestStepData = sTestStepData.replaceFirst("~", "");
		String sType = null, sLength = null, sComment = null; // Mantis 0000942
		int iLength = 0, iDays = 0;
		String[] parts = new String[10];
		String sDays;
		String sRandomGenerated = null;
		String sDateFormat = null;
		Map<String, Integer> columnsDynData;
		List<List<String>> resultSetDynData;
		if (sTestStepData.contains("+") || sTestStepData.contains("-")) // Mantis 0000878
		{
			if (sTestStepData.contains("+")) {
				parts = sTestStepData.split("\\+");
				sTestStepData = parts[0];
				sDays = parts[1];
				iDays = Integer.parseInt(sDays);

			}
			if (sTestStepData.contains("-")) {
				parts = sTestStepData.split("\\-");
				sTestStepData = parts[0];
				sDays = parts[1];
				iDays = Integer.parseInt(sDays);
				iDays = (iDays) * -1;
			}
		}

		columnsDynData = ExcelConnection.getMasterDataFileColumns("DynamicData");
		resultSetDynData = ExcelConnection.readDynamicData();
		int nameIndex = ExcelConnection.funGetColumnIndex(DynamicDataColumnHeader.NAME.toString(), columnsDynData);
		int recordNumberDynData = ExcelConnection.funGetDynamicDataRecordNumber(nameIndex, sTestStepData,
				resultSetDynData);

		if (recordNumberDynData != -1) {
			if (columnsDynData.containsKey(DynamicDataColumnHeader.TYPE.toString())) {
				sType = resultSetDynData.get(recordNumberDynData)
						.get(columnsDynData.get(DynamicDataColumnHeader.TYPE.toString()));
			} else {
				NoSuchFieldException e = new NoSuchFieldException("Column \"Type\" does not exist in DynamicData");
				throw e;
			}
			if (columnsDynData.containsKey(DynamicDataColumnHeader.LENGTH.toString())) {
				sLength = resultSetDynData.get(recordNumberDynData)
						.get(columnsDynData.get(DynamicDataColumnHeader.LENGTH.toString()));
			} else {
				NoSuchFieldException e = new NoSuchFieldException("Column \"Length\" does not exist in DynamicData");
				throw e;
			}

			if (sLength != null) // Mantis 0000337
			{
				iLength = Integer.parseInt(sLength);
			}

			if (columnsDynData.containsKey(DynamicDataColumnHeader.FORMAT.toString())) {
				sDateFormat = resultSetDynData.get(recordNumberDynData)
						.get(columnsDynData.get(DynamicDataColumnHeader.FORMAT.toString()));
				if (sDateFormat == null) {
					sDateFormat = "dd/MM/yyyy";
				}
			} else {
				NoSuchFieldException e = new NoSuchFieldException("Column \"Format\" does not exist in DynamicData");
				throw e;
			}
			/*------Mantis 0000942-----*/
			if (columnsDynData.containsKey(DynamicDataColumnHeader.COMMENT.toString())) {
				sComment = resultSetDynData.get(recordNumberDynData)
						.get(columnsDynData.get(DynamicDataColumnHeader.COMMENT.toString()));
			} else {
				NoSuchFieldException e = new NoSuchFieldException("Column \"Comment\" does not exist in DynamicData");
				throw e;
			}
			/*------Mantis 0000942-----*/
		} else {
			NoSuchFieldException e = new NoSuchFieldException("Element not found in the Name column list");
			throw e;
		}
		switch (sType.trim().toLowerCase()) {
		case "string":
			sRandomGenerated = AphaGeneration(iLength);
			break;

		case "number":
			sRandomGenerated = NumberGeneration(iLength);
			break;

		case "guid":
			sRandomGenerated = GUIDGeneration();
			savedGuid = sRandomGenerated;/// Mantis 0000458
			break;

		case "date":
			sRandomGenerated = DateGeneration(iDays, sDateFormat);
			break;

		case "constant":
			sRandomGenerated = sComment; // Mantis 0000942
			break;

		case "env_variable": // Mantis 0001079
			sRandomGenerated = System.getenv(sDateFormat.toUpperCase());
			break;

		default: {
			// Mantis 0000336
			debugLog("DynamicData",
					"The dynamic type provided does not exist in the DynamicData under Master_Data Folder");
			InvalidTypeException e = new InvalidTypeException("Entered Type '" + sType + "' is invalid");
			throw e;
		}

		}
		return sRandomGenerated;
	}

	/*
	 * --------------------------------------- START :
	 * GUIDGeneration---------------------------------------------- Function Name:
	 * GUIDGeneration Objective: A generic Function to dynamically generate a set of
	 * alphabets and symbols. Date Created: Input: Output: Revision History:
	 * Modified on: Comments:
	 * -----------------------------------------------------------------------------
	 * ----------------------------
	 */
	String GUIDGeneration() {
		UUID uuid = UUID.randomUUID();
		String randomUUIDString = uuid.toString().replace("-", "");
		return (randomUUIDString);
	}

	/*
	 * --------------------------------------- START :
	 * NumberGeneration---------------------------------------------- Function Name:
	 * NumberGeneration Objective: A generic Function to dynamically generate a set
	 * of numbers. Date Created: Input: iLength = Length of the set to be returned.
	 * Output: Revision History: Modified on: Comments:
	 * -----------------------------------------------------------------------------
	 * ----------------------------
	 */
	String NumberGeneration(int iLength) {
		Random random = new Random();
		int randomNumber = 0;
		boolean loop = true;
		while (loop) {
			randomNumber = random.nextInt();
			if (Integer.toString(randomNumber).length() == iLength && !Integer.toString(randomNumber).startsWith("-")) {
				loop = false;
			}
		}
		String sRandomNumber = Integer.toString(randomNumber);
		return (sRandomNumber);
	}

	/*
	 * --------------------------------------- START :
	 * AphaGeneration---------------------------------------------- Function Name:
	 * AphaGeneration Objective: A generic Function to dynamically generate a set of
	 * alphabets. Date Created: Input: iLength = Length of the set to be returned.
	 * Output: Revision History: Modified on: Comments:
	 * -----------------------------------------------------------------------------
	 * ----------------------------
	 */
	String AphaGeneration(int iLength) {
		StringBuffer buffer = new StringBuffer();
		String characters = "";
		characters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";
		int charactersLength = characters.length();
		for (int i = 0; i < iLength; i++) {
			double index = Math.random() * charactersLength;
			buffer.append(characters.charAt((int) index));
		}
		return (buffer.toString());
	}

	/*
	 * --------------------------------------- START :
	 * DateGeneration---------------------------------------------- Function Name:
	 * DateGeneration Objective: A generic Function to dynamically generate date.
	 * Date Created: Input: iDays = Number of days to be added to current date.
	 * Output: Revision History: Modified on: Comments:
	 * -----------------------------------------------------------------------------
	 * ----------------------------
	 */
	String DateGeneration(int iDays, String sTimeFormat) {
		Calendar cal = Calendar.getInstance();
		cal.add(Calendar.DATE, iDays);
		SimpleDateFormat sdf = new SimpleDateFormat(sTimeFormat);
		Date dt = cal.getTime();
		systemouts("Returning Date:" + dt);
		return (sdf.format(dt));
	}

	/*
	 * --------------------------------------- START :
	 * executeSQL---------------------------------------------- Function Name:
	 * executeSQL Objective: A generic Function to execute SQL Query Date Created:
	 * Input: sExcelPath= path of the excel file sQueryName= name of the SQL query
	 * sTestCaseIdentifier= Identifier that uniquely identifies an object on
	 * application; e.g xpath, id etc Output: Revision History: Modified By: Manoj
	 * Bamnawat (Mantis 0000843) Modified on: Comments: create the Excel Connection,
	 * get the sqlQuery with the QueryName, execute that and store in resultSet, if
	 * (resultSet) get Verification Sheet Name if (Verification Sheet Name is not
	 * Null) call getExcept Function to get the required column names for SqlQuery,
	 * ExecuteQuery and store in resultSet. if (ConnectionStringname is not null)
	 * create the SQLServerConnection if(ExecuteQuery is not Null) get Column Names,
	 * call dynamic set and executeQuery else Parameter Names not specified in
	 * ColumnNames Column , else Query Column does not exists , else connection
	 * String Name Not Specified , else Verification Sheet Name not Specified, else
	 * Query is not specified. Close the connection.
	 * -----------------------------------------------------------------------------
	 * ----------------------------
	 */
	/*
	 * void executeSQL(String sExcelPath,String sQueryName,String
	 * sTestCaseIdentifier) throws NoTempDataPresent,ArrayIndexOutOfBoundsException,
	 * CustomException, IllegalFormatException, IOException, NoSuchFieldException {
	 * Connection con,SQLCon,sDBExcelCon; con=null; try {
	 * con=ExcelConnection.getExcelConnection(sExcelPath); Statement st
	 * =con.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE,ResultSet.
	 * CONCUR_READ_ONLY); Statement stSQLData
	 * =con.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE,ResultSet.
	 * CONCUR_READ_ONLY); ResultSet SQL_rs; ResultSet rs1,rsDBExcel; Statement
	 * stDBExcel; String sDBuser = null,sDBpass=null; String
	 * sSQLQuery="Select * from [DB_Query$] where QueryName='"+sQueryName.trim()
	 * +"' and Test_Case='"+sTestCaseIdentifier+"'"; ResultSet
	 * rs=st.executeQuery(sSQLQuery);
	 * 
	 * if(rs.next()) { String
	 * sExecutionQuery,sColumnNames,sConnectionStringName,sConnectionString=null,
	 * sVerificationSheetName,sDataIdentifier;
	 * sDataIdentifier=rs.getString("Test_case");
	 * sVerificationSheetName=rs.getString("VerificationSheetName");
	 * if(sVerificationSheetName!=null) { try { String
	 * sTempColumnNames=getExcept(stSQLData,
	 * "Select * from ["+sVerificationSheetName.trim()+"$] where Test_Case='"
	 * +sDataIdentifier+"'", "Test_Case"); String
	 * sSQLGeneratedQuery="Select "+sTempColumnNames+" from ["
	 * +sVerificationSheetName.trim()+"$] where Test_Case='"+sDataIdentifier+"'";
	 * rs1=stSQLData.executeQuery(sSQLGeneratedQuery); } catch(SQLException e) {
	 * e.printStackTrace(); CustomException e1 = new
	 * CustomException("Data Sheet with name "
	 * +sVerificationSheetName+"does not exist"); throw e1; }
	 * sConnectionStringName=rs.getString("ConnectionString");
	 * if(sConnectionStringName!=null) { String sCurrentDir =
	 * System.getProperty("user.dir"); String sFileName
	 * =sCurrentDir+"/Master_Data/DatabaseConnections.xlsx"; //Mantis 0000796
	 * sDBExcelCon=ExcelConnection.getExcelConnection(sFileName);
	 * 
	 * stDBExcel =
	 * sDBExcelCon.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE,ResultSet.
	 * CONCUR_READ_ONLY); rsDBExcel=stDBExcel.
	 * executeQuery("Select * from [Connections$] where ConnectionName='"
	 * +sConnectionStringName+"'"); if (rsDBExcel.next()) {
	 * sConnectionString=rsDBExcel.getString("ConnectionString");
	 * sDBuser=rsDBExcel.getString("Username");
	 * sDBpass=rsDBExcel.getString("Password"); }
	 * sExecutionQuery=rs.getString("Query");
	 * //systemouts("Column Count:"+rs.getMetaData().getColumnCount());
	 * sColumnNames=rs.getString("Field_Names");
	 * SQLCon=ExcelConnection.getDatabaseConnection(sConnectionString,sDBuser,
	 * sDBpass); Statement SQLSt =
	 * SQLCon.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE,ResultSet.
	 * CONCUR_READ_ONLY); if(sExecutionQuery!=null) {
	 * if(sExecutionQuery.contains("##")) { if(sColumnNames!=null) { String
	 * sColumnData[]=sColumnNames.split(";"); String
	 * sHashData[]=sExecutionQuery.split("##"); if(sHashData.length ==
	 * sColumnData.length) { for(int
	 * iHashCount=0;sExecutionQuery.contains("##");iHashCount++) { String
	 * sSetDynamic=dynamicSet(sTestCaseIdentifier, sColumnData[iHashCount]);
	 * sExecutionQuery=sExecutionQuery.replaceFirst("##","\""+sSetDynamic+"\""); }
	 * SQL_rs = SQLSt.executeQuery(sExecutionQuery); } else { //Log that the no of
	 * ## and no of parameters does not match
	 * oFunctionLog.setTestStepDetails(sTestCaseData, "", "", "", "Fail",
	 * sUserAction,
	 * "No. Of Parameters for SQL query does not match the No. of parameters inside query"
	 * , ""); ArrayIndexOutOfBoundsException e1 = new
	 * ArrayIndexOutOfBoundsException("No. Of Parameters for SQL query does not match the No. of parameters inside query"
	 * ); throw e1; } } else { //sColumn data missing
	 * //oFunctionLog.setTestStepDetails(sTestCaseData, "", "", "", "Fail",
	 * sUserAction, "Parameter Names not specified in ColumnNames Column", "");
	 * CustomException e = new
	 * CustomException("Parameter Names not specified in ColumnNames Column"); throw
	 * e; } } else { //no parameters to query "Static Query" SQL_rs =
	 * SQLSt.executeQuery(sExecutionQuery); } } else { //Log that Query column does
	 * not Exist //oFunctionLog.setTestStepDetails(sTestCaseData, "", "", "",
	 * "Fail", sUserAction,"Query Column does not exists", ""); CustomException e =
	 * new CustomException("Query Column does not exists"); throw e; } } else {
	 * //Connection String Name not available
	 * //oFunctionLog.setTestStepDetails(sTestCaseData, "", "", "", "Fail",
	 * sUserAction, "Connection String Name Not Specified", ""); CustomException e =
	 * new CustomException("Connection String Name Not Specified"); throw e; } }
	 * else { //Verification Sheet name Specified
	 * //oFunctionLog.setTestStepDetails(sTestCaseData, "", "", "", "Fail",
	 * sUserAction,"Verification Sheet Name not Specified", ""); CustomException e =
	 * new CustomException("Verification Sheet Name not Specified"); throw e; } }
	 * else { //Query does not exist
	 * //oFunctionLog.setTestStepDetails(sTestCaseData, "", "", "", "Fail",
	 * sUserAction, "Query is not specified", ""); CustomException e = new
	 * CustomException("Query is not specified"); throw e; }
	 * compareResultSets(rs1,SQL_rs); rs.close(); } catch(Exception e) {
	 * oFunctionLog.setTestStepDetails(sTestCaseData, "", "", "", "Fail",
	 * sUserAction, "SQL Query failed", ""); } finally { try {
	 * 
	 * con.close(); con=null; } catch(Exception e) { } }
	 * 
	 * }
	 */

	String executeSQL(String sExcelPath, String sQueryName, String sTestCaseIdentifier) throws Exception {
		String sStatus = "Fail"; // Mantis 0000888
		try {
			Connection SQLCon;
			String sDBuser = null, sDBpass = null;
			Object JsonData;

			List<String> resultSet = null, rsDBExcel = null;
			List<List<String>> resultSet1 = null;
			Set<String> verificationKeys;
			Set<String> columnHeaderOfExpectedSheet = null;
			List<Integer> verificationTargetRows = null; // Mantis 0000868
			List<List<String>> verificationData = null; // Mantis 0000868
			Map<String, Integer> verificationColumnData = null; // Mantis 0000868
			int verificationTestCaseColIndex, verificationQueryNameColIndex; // Mantis 0000868
			ResultSet SQL_rs;

			JsonData = ExcelConnection.getdbFilefromJson(sExcelPath);
			List<List<String>> data = ExcelConnection.getSheetDataFromJSON(JsonData, "DB_Query");
			Map<String, Integer> columnData = ExcelConnection.getColumnNamesFromJson(JsonData, "DB_Query");

			int testCaseColIndex = ExcelConnection.funGetColumnIndex("Test_Case", columnData);
			int queryNameColIndex = ExcelConnection.funGetColumnIndex("QueryName", columnData);
			int taregtRow = ExcelConnection.funGetExecutionDataRecordNumber(testCaseColIndex, queryNameColIndex,
					sTestCaseIdentifier, sQueryName, data);
			if (taregtRow == -1) {
				throw new CustomDataBaseException("ExecuteSQL Could not find data for testcase :" + sTestCaseIdentifier
						+ " and for QueryName :" + sQueryName); // Mantis 0000868, 0001780
			}

			resultSet = new ArrayList<String>();

			for (int i = 0; i < columnData.size(); i++) {
				resultSet.add(data.get(taregtRow).get(i));
			}
			String sExecutionQuery, sColumnNames, sConnectionStringName, sDatabaseDriver = null,
					sConnectionString = null, sVerificationSheetName;

			sVerificationSheetName = resultSet
					.get(ExcelConnection.funGetColumnIndex("VerificationSheetName", columnData));
			if (sVerificationSheetName != null && !(sVerificationSheetName.trim().isEmpty())) // Mantis ID:0001227
			{
				try {
					verificationData = ExcelConnection.getSheetDataFromJSON(JsonData, sVerificationSheetName);
					verificationColumnData = ExcelConnection.getColumnNamesFromJson(JsonData, sVerificationSheetName);
					verificationColumnData = sortColumns(verificationColumnData);
					verificationKeys = verificationColumnData.keySet();
					verificationTestCaseColIndex = ExcelConnection.funGetColumnIndex("Test_Case",
							verificationColumnData);
					verificationQueryNameColIndex = ExcelConnection.funGetColumnIndex("QueryName",
							verificationColumnData);

					columnHeaderOfExpectedSheet = new LinkedHashSet<String>();

					verificationTargetRows = new ArrayList<Integer>();
					String sRunningTestCase = "", sRunningQueryName = "";
					for (int i = 0; i < verificationData.size(); i++) {
						String expectedTestCase = verificationData.get(i).get(verificationTestCaseColIndex);
						String queryName = verificationData.get(i).get(verificationQueryNameColIndex);
						if (expectedTestCase != null && !(expectedTestCase.trim().isEmpty())) // Mantis ID:0001227
						{
							sRunningTestCase = expectedTestCase;

							if (queryName != null && !(queryName.trim().isEmpty())) // Mantis ID:0001227
							{
								sRunningQueryName = queryName;

								if (sRunningTestCase.equalsIgnoreCase(sTestCaseIdentifier)
										&& sRunningQueryName.equalsIgnoreCase(sQueryName)) // Mantis 0000940
								{
									verificationTargetRows.add(i);
								}
							}
						} else {
							if (sRunningTestCase.equalsIgnoreCase(sTestCaseIdentifier)
									&& sRunningQueryName.equalsIgnoreCase(sQueryName)) // Mantis 0000940
							{
								verificationTargetRows.add(i);
							}
						}
					}
					resultSet1 = new ArrayList<List<String>>();
				} catch (Exception e) {
					e.printStackTrace();
					throw e;
				}
				sConnectionStringName = resultSet.get(ExcelConnection
						.funGetColumnIndex(DatabaseConnectionsColumnHeader.CONNECTIONNAME.toString(), columnData));
				if (sConnectionStringName != null && !(sConnectionStringName.trim().isEmpty())) // Mantis ID:0001227
				{
					List<List<String>> DBExcelData = ExcelConnection.readDatabaseConnections();
					Map<String, Integer> DBExcelColumnData = ExcelConnection
							.getMasterDataFileColumns("DatabaseConnections");
					int connectionNameColumnIndex = ExcelConnection.funGetColumnIndex(
							DatabaseConnectionsColumnHeader.CONNECTIONNAME.toString(), DBExcelColumnData);
					int connectionTargetRow = ExcelConnection.funGetTestDataRecordNumber(connectionNameColumnIndex,
							sConnectionStringName, DBExcelData);

					rsDBExcel = new ArrayList<String>();

					for (int i = 0; i < DBExcelColumnData.size(); i++) {
						rsDBExcel.add(DBExcelData.get(connectionTargetRow).get(i));
					}

					sDatabaseDriver = rsDBExcel.get(ExcelConnection.funGetColumnIndex(
							DatabaseConnectionsColumnHeader.DATABASEDRIVER.toString(), DBExcelColumnData));
					sConnectionString = rsDBExcel.get(ExcelConnection.funGetColumnIndex(
							DatabaseConnectionsColumnHeader.CONNECTIONSTRING.toString(), DBExcelColumnData));
					sDBuser = rsDBExcel.get(ExcelConnection
							.funGetColumnIndex(DatabaseConnectionsColumnHeader.USERNAME.toString(), DBExcelColumnData));
					sDBpass = rsDBExcel.get(ExcelConnection
							.funGetColumnIndex(DatabaseConnectionsColumnHeader.PASSWORD.toString(), DBExcelColumnData));

					sExecutionQuery = resultSet.get(ExcelConnection.funGetColumnIndex("Query", columnData));
					sColumnNames = resultSet.get(ExcelConnection.funGetColumnIndex("Field_Names", columnData));
					SQLCon = ExcelConnection.getDatabaseConnection(sDatabaseDriver, sConnectionString, sDBuser,
							sDBpass);
					Statement SQLSt = SQLCon.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE,
							ResultSet.CONCUR_READ_ONLY);

					if (sExecutionQuery != null && !(sExecutionQuery.trim().isEmpty())) // Mantis ID:0001227
					{
						if (sExecutionQuery.contains("#")) {
							List<String> sHashData = getDynamicValues(sExecutionQuery);

							for (int iHashCount = 0; iHashCount < sHashData.size(); iHashCount++) {
								String sSetDynamic = dynamicSet(sTestCaseIdentifier, sHashData.get(iHashCount)); // Mantis
								// 0000868
								sExecutionQuery = sExecutionQuery.replaceFirst("#" + sHashData.get(iHashCount) + "#",
										"\'" + sSetDynamic + "\'"); // Mantis 0000924
							}
							if ((!sExecutionQuery.toLowerCase().startsWith("select")) // Mantis 0001046,0001676,0001815
									|| (sExecutionQuery.toLowerCase().startsWith("update"))
									|| (sExecutionQuery.toLowerCase().startsWith("delete"))
									|| (sExecutionQuery.toLowerCase().startsWith("truncate"))
									|| (sExecutionQuery.toLowerCase().startsWith("alter"))
									|| (sExecutionQuery.toLowerCase().startsWith("insert")))
								throw new Exception("UnAuthorized action on Database [use only 'select' query");
							SQL_rs = SQLSt.executeQuery(sExecutionQuery);
						} else {
							// no parameters to query "Static Query"
							if ((!sExecutionQuery.toLowerCase().startsWith("select")) // Mantis 0001046,0001676,0001815
									|| (sExecutionQuery.toLowerCase().startsWith("update"))
									|| (sExecutionQuery.toLowerCase().startsWith("delete"))
									|| (sExecutionQuery.toLowerCase().startsWith("truncate"))
									|| (sExecutionQuery.toLowerCase().startsWith("alter"))
									|| (sExecutionQuery.toLowerCase().startsWith("insert")))
								throw new Exception("UnAuthorized action on Database [use only 'select' query");
							SQL_rs = SQLSt.executeQuery(sExecutionQuery);
						}
						System.out.println("SQL_rs : " + SQL_rs);
						/*-----Mantis 0000868-----*/
						List<Integer> columnIndexes = new ArrayList<Integer>();
						if (sColumnNames != null && !(sColumnNames.trim().isEmpty())) // Mantis ID:0001227
						{
							String sColumnData[] = sColumnNames.split(",");
							for (String keys : verificationKeys) {
								System.out.println("Keys : " + keys);
								if ((!keys.equals("Test_Case")) && (!keys.equals("QueryName"))) {
									boolean flag = false;

									for (String columnsVerify : sColumnData) {
										if (keys.equalsIgnoreCase(columnsVerify.trim())) {
											columnHeaderOfExpectedSheet.add(keys);
											columnIndexes.add(
													ExcelConnection.funGetColumnIndex(keys, verificationColumnData));
											flag = true;
										}
									}

									if (!flag)
										throw new CustomDataBaseException("VerifyDB failed: cannot find column " + keys
												+ " of " + sVerificationSheetName
												+ " sheet in Field_Names column of DB_Query at row " + (taregtRow + 2)); // Mantis
									// 0001780
								}
							}
							System.out.println(columnHeaderOfExpectedSheet);
							resultSet1 = expectedData(verificationTargetRows, verificationData, verificationColumnData,
									columnIndexes);
						} else {
							for (String keys : verificationKeys) {
								if ((!keys.equals("Test_Case")) && (!keys.equals("QueryName"))) {
									columnHeaderOfExpectedSheet.add(keys);
									columnIndexes.add(ExcelConnection.funGetColumnIndex(keys, verificationColumnData));
								}
							}

							resultSet1 = expectedData(verificationTargetRows, verificationData, verificationColumnData,
									columnIndexes);
							System.out.println("resultSet1 : " + resultSet1);
						}
						/*-----Mantis 0000868-----*/
					} else {
						// Log that Query column does not Exist
						// oFunctionLog.setTestStepDetails(sTestCaseData, "", "", "", "Fail",
						// sUserAction,"Query Column does not exists", "");
						// Exception e = new Exception("Query Column does not exists");

						throw new CustomDataBaseException("Query Column does not exists"); // Mantis 0001780

						// throw e;
					}
				} else {
					// Connection String Name not available
					// oFunctionLog.setTestStepDetails(sTestCaseData, "", "", "", "Fail",
					// sUserAction, "Connection String Name Not Specified", "");
					// Exception e = new Exception("Connection String Name Not Specified");

					throw new CustomDataBaseException("Connection String Name Not Specified"); // Mantis 0001780
				}
			} else {
				// Verification Sheet name Specified
				// oFunctionLog.setTestStepDetails(sTestCaseData, "", "", "", "Fail",
				// sUserAction,"Verification Sheet Name not Specified", "");
				// Exception e = new Exception("Verification Sheet Name not Specified");

				throw new CustomDataBaseException("Verification Sheet Name Not Specified"); // Mantis 0001780
			}
			sStatus = compareResultSets(columnHeaderOfExpectedSheet, resultSet1, SQL_rs); // Mantis 0000888
		} catch (Exception e) {
			e.printStackTrace();

			if (e instanceof CustomDataBaseException) // Mantis 0001780
				throw e;
			// oFunctionLog.setTestStepDetails(sTestCaseData, "", "", "", "Fail",
			// sUserAction, "SQL Query failed", "");
			sComments = e.getMessage();
			sStatus = "Fail"; // Mantis 0000888
		}
		return sStatus; // Mantis 0000888
	}

	/*----Mantis 0000868----*/
	private List<List<String>> expectedData(List<Integer> verificationTargetRows, List<List<String>> verificationData,
			Map<String, Integer> verificationColumnData, List<Integer> columnIndexes) throws Exception {
		List<List<String>> resultSetData = new ArrayList<List<String>>();
		List<String> listRow = null;

		int verificationTestCaseColIndex = ExcelConnection.funGetColumnIndex("Test_Case", verificationColumnData);
		int verificationQueryNameColIndex = ExcelConnection.funGetColumnIndex("QueryName", verificationColumnData);

		int startRow = verificationTargetRows.get(0);
		for (int i = startRow; i < (verificationTargetRows.size() + startRow); i++) {
			listRow = new ArrayList<String>();
			for (int j = 0; j < verificationColumnData.size(); j++) {
				if ((j != verificationTestCaseColIndex) && (j != verificationQueryNameColIndex)) {
					for (int k = 0; k < columnIndexes.size(); k++) {
						if (j == columnIndexes.get(k))
							listRow.add(verificationData.get(i).get(j));
					}
				}
			}

			resultSetData.add(listRow);
		}

		return resultSetData;
	}

	// Mantis 0000843
	Map<String, Integer> sortColumns(Map<String, Integer> columnHeader) throws Exception {
		Set<Entry<String, Integer>> entries = columnHeader.entrySet();

		Comparator<Entry<String, Integer>> valueComparator = new Comparator<Entry<String, Integer>>() {

			@Override
			public int compare(Entry<String, Integer> e1, Entry<String, Integer> e2) {
				Integer v1 = e1.getValue();
				Integer v2 = e2.getValue();
				return v1.compareTo(v2);
			}
		};

		// Sort method needs a List, so let's first convert Set to List in Java
		List<Entry<String, Integer>> listOfEntries = new ArrayList<Entry<String, Integer>>(entries);

		// sorting HashMap by values using comparator
		Collections.sort(listOfEntries, valueComparator);

		Map<String, Integer> sortedByValue = new LinkedHashMap<String, Integer>(listOfEntries.size());

		// copying entries from List to Map
		for (Entry<String, Integer> entry : listOfEntries) {
			sortedByValue.put(entry.getKey(), entry.getValue());
		}

		return sortedByValue;

	}

	// Mantis 0000843
	List<String> getDynamicValues(String sExecutionString) throws Exception {
		List<String> partOfString = new ArrayList<String>();
		int startPositon = 0, endPostion = 0;

		for (int i = 0; i < sExecutionString.length(); i++) {
			if (sExecutionString.charAt(i) == '#') {
				if (startPositon == 0)
					startPositon = i;
				else if (endPostion == 0) {
					endPostion = i;

					partOfString.add(sExecutionString.substring(startPositon + 1, endPostion));
					startPositon = 0;
					endPostion = 0;
				}
			}
		}

		return partOfString;
	}

	/*
	 * --------------------------------------- START :
	 * getExcept---------------------------------------------- Function Name:
	 * getExcept Objective: A generic Function to get SQL string excluding
	 * particular columns Date Created: Input: st= The object of java.sql.statement
	 * used for executing a static SQL statement and returning the results it
	 * produces sSqlCommand= Sql Query sExcludingColumnName= column to be excluded
	 * from the Select * query Output: Revision History: Modified on: Comments:
	 * if(column name in sSqlCommand not matches sExcludingColumnName) add in
	 * SQLString until column count. Check the length and return SQLString
	 * -----------------------------------------------------------------------------
	 * ----------------------------
	 */

	String getExcept(Statement st, String sSqlCommand, String sExcludingColumnName) {
		String sSQLString = "";
		int i;
		try {
			ResultSet rs = st.executeQuery(sSqlCommand);
			for (i = 1; i <= rs.getMetaData().getColumnCount(); i++) {
				if (!rs.getMetaData().getColumnName(i).equalsIgnoreCase(sExcludingColumnName)) {
					sSQLString = sSQLString + rs.getMetaData().getColumnName(i) + ",";
				}
			}
			if (sSQLString.length() > 0) {
				sSQLString = sSQLString.substring(0, sSQLString.length() - 1);
			}
		} catch (SQLException e) {
			e.printStackTrace();
		}
		return sSQLString;
	}

	/*
	 * --------------------------------------- START :
	 * compareResultSets---------------------------------------------- Function
	 * Name: compareResultSets Objective: A generic Function to execute SQL Query
	 * Date Created: Input: expectedRs= variable of ResultSet Type , which maintains
	 * a cursor pointing to its current row of expected data. actualRs= variable of
	 * ResultSet Type , which maintains a cursor pointing to its current row of
	 * Actual data. Output: Revision History: Modified By: Manoj Bamnawat(Mantis
	 * 0000843) Modified on: Comments: if(expectedcolum and row equals actualColumn
	 * and row) get the column name and data and compare the expected data and
	 * actual data if(equals) status- pass else fail. Log steps.
	 * -----------------------------------------------------------------------------
	 * ----------------------------
	 */

	String compareResultSets(Set<String> expectedSheetColumn, List<List<String>> expectedRs, ResultSet actualRs) {
		String status = "Fail"; // Mantis 0000888
		int iexpectedCoulmnCount, iexpectedRowCount, iactualCoulmnCount, iactualRowCount;
		try {
			int j;
			List<String> expectedColumns = new ArrayList<String>(expectedSheetColumn);
			iexpectedCoulmnCount = expectedRs.get(0).size();
			iactualCoulmnCount = actualRs.getMetaData().getColumnCount();
			actualRs.last();
			iexpectedRowCount = expectedRs.size();
			iactualRowCount = actualRs.getRow();
			ResultSetMetaData metaData = actualRs.getMetaData();
			List<String> allStatus = new LinkedList<String>(); // Mantis 0000888

			if (iexpectedCoulmnCount == iactualCoulmnCount || iexpectedRowCount == iactualRowCount) // Mantis 0000868
			{
				actualRs.first();
				for (int i = 0; i < iactualRowCount; i++) // Mantis 0000868
				{
					String sExpectedColumn, sActualColumn, ExpectedData, sStatus, sActualData, sExecutionDetails;
					sExecutionDetails = "";
					sExpectedColumn = "";
					sActualColumn = "";
					sActualData = "";
					sStatus = "";
					int sActualColumnIndex = 0;
					for (j = 0; j < iexpectedCoulmnCount; j++) {
						sExpectedColumn = expectedColumns.get(j);

						sActualColumnIndex = actualRs.findColumn(sExpectedColumn);
						sActualColumn = metaData.getColumnLabel(sActualColumnIndex);

						if (sActualColumn.equalsIgnoreCase(sExpectedColumn)) {
							ExpectedData = expectedRs.get(i).get(j);
							sActualData = actualRs.getString(sActualColumn);

							sExecutionDetails = "Expected data column :" + sExpectedColumn + " Actual data column : "
									+ sActualColumn;

							if (ExpectedData.equalsIgnoreCase(sActualData)) {
								sStatus = "Pass";
								allStatus.add(sStatus); // Mantis 0000888
							} else {
								sStatus = "Fail";
								allStatus.add(sStatus); // Mantis 0000888
							}

							if (sConditionalStart && sConditionalFileExist) // Mantis 0000929,0001836
							{
								oFunctionLog.setTestStepDetails(sTestCaseData, "", ExpectedData, sActualData, sStatus,
										sUserAction, sExecutionDetails, "", sWebPagePath); // Mantis 0001221
							} else {
								sActualValue = sActualValue.concat(sActualData).concat(","); // Mantis 0000929
								sExpectedData = sExpectedData.concat(ExpectedData).concat(","); // Mantis 0000929
							}
						}
					}
					actualRs.next();
				}
				if (!sConditionalStart) // Mantis 0000929
				{
					sActualValue.substring(0, sActualValue.length() - 1);
					sExpectedData.substring(0, sExpectedData.length() - 1);
				}
				if (!sConditionalFileExist) // Mantis 0001836
				{
					sActualValue.substring(0, sActualValue.length() - 1);
					sExpectedData.substring(0, sExpectedData.length() - 1);
				}
				// Mantis 0000888
				if (allStatus.contains("Fail"))
					status = "Fail";
				else
					status = "Pass";

			} else {
				String sExpected, sActual, sExecutionDetails;
				sExpected = "Expected Column count:" + iexpectedCoulmnCount + "Expected Row count:" + iexpectedRowCount;
				sActual = "Actual Column Count: " + iactualCoulmnCount + "Actual Row Count: " + iactualRowCount;
				if (iactualRowCount == 0)
					sExecutionDetails = "No Records Fetched by given query"; // Mantis 0000924
				else
					sExecutionDetails = "Actual And Expected Table structure does not match";
				if (sConditionalStart) // Mantis 0000929
					oFunctionLog.setTestStepDetails(sTestCaseData, "", sExpected, sActual, "Fail", sUserAction,
							sExecutionDetails, "", sWebPagePath); // MAntis 0001221
				// sComments="Expected Column count:"+iexpectedCoulmnCount+"\n Actual Column
				// Count: "+iactualCoulmnCount+"Expected Row count:"+iexpectedRowCount+"\n
				// Actual Row Count: "+iactualRowCount;
				status = "Fail"; // Mantis 0000888
			}
		} catch (Exception E) {
			E.printStackTrace();
			status = "Fail"; // Mantis 0000888
		}
		return status;
	}

	// Mantis 0000886
	String compareResultSets(Set<String> columnHeaderOfExpectedData, List<List<String>> expectedRs,
			Set<String> columnHeaderOfActualData, ResultSet actualRs) {
		String status = "Fail"; // Mantis 0000888
		int iexpectedCoulmnCount, iexpectedRowCount, iactualCoulmnCount, iactualRowCount;
		try {
			int j;
			List<String> expectedColumns = new ArrayList<String>(columnHeaderOfExpectedData);
			List<String> actualColumns = new ArrayList<String>(columnHeaderOfActualData);
			iexpectedCoulmnCount = expectedRs.get(0).size();
			iactualCoulmnCount = actualRs.getMetaData().getColumnCount();
			actualRs.last();
			iexpectedRowCount = expectedRs.size();
			iactualRowCount = actualRs.getRow();
			ResultSetMetaData metaData = actualRs.getMetaData();
			List<String> allStatus = new LinkedList<String>(); // Mantis 0000888

			if (iexpectedCoulmnCount == iactualCoulmnCount || iexpectedRowCount == iactualRowCount) {
				actualRs.first();
				for (int i = 0; i < iactualRowCount; i++) {
					String sExpectedColumn, sActualColumn, sExpectedData, sActualData, sStatus, sExecutionDetails;
					sExecutionDetails = "";
					sExpectedColumn = "";
					sActualColumn = "";
					sActualData = "";
					sStatus = "";
					int sActualColumnIndex = 0;
					for (j = 0; j < iexpectedCoulmnCount; j++) {
						sExpectedColumn = expectedColumns.get(j);

						sActualColumnIndex = actualRs.findColumn(actualColumns.get(j));
						sActualColumn = metaData.getColumnLabel(sActualColumnIndex);

						sExpectedData = expectedRs.get(i).get(j);
						sActualData = actualRs.getString(sActualColumn);

						sExecutionDetails = "Expected data column :" + sExpectedColumn + " Actual data column : "
								+ sActualColumn;

						if (sExpectedData.equalsIgnoreCase(sActualData)) {
							sStatus = "Pass";
							allStatus.add(sStatus); // Mantis 0000888
						} else {
							sStatus = "Fail";
							allStatus.add(sStatus); // Mantis 0000888
						}
						oFunctionLog.setTestStepDetails(sTestCaseData, "", sExpectedData, sActualData, sStatus,
								sUserAction, sExecutionDetails, "", sWebPagePath); // Mantis 0001221
					}
					actualRs.next();
				}
				// Mantis 0000888
				if (allStatus.contains("Fail"))
					status = "Fail";
				else
					status = "Pass";
			} else {
				String sExpected, sActual, sExecutionDetails;
				sExpected = "Expected Column count:" + iexpectedCoulmnCount + "Expected Row count:" + iexpectedRowCount;
				sActual = "Actual Column Count: " + iactualCoulmnCount + "Actual Row Count: " + iactualRowCount;
				if (iactualRowCount == 0)
					sExecutionDetails = "No Records Fetched by given Query"; // Mantis 0000924
				else
					sExecutionDetails = "Actual And Expected Table structure does not match";
				oFunctionLog.setTestStepDetails(sTestCaseData, "", sExpected, sActual, "Fail", sUserAction,
						sExecutionDetails, "", sWebPagePath); // Mantis 0001221
				// sComments="Expected Column count:"+iexpectedCoulmnCount+"\n Actual Column
				// Count: "+iactualCoulmnCount+"Expected Row count:"+iexpectedRowCount+"\n
				// Actual Row Count: "+iactualRowCount;
				status = "Fail"; // Mantis 0000888
			}
		} catch (Exception E) {
			E.printStackTrace();
			status = "Fail"; // Mantis 0000888
		}
		return status;
	}

	// Mantis 0000886
	String compareResultSets(List<List<String>> expectedRs, ResultSet actualRs) {
		String status = "Fail"; // Mantis 0000888
		int iexpectedCoulmnCount, iexpectedRowCount, iactualCoulmnCount, iactualRowCount;
		try {
			int j;
			iexpectedCoulmnCount = expectedRs.get(0).size();
			iactualCoulmnCount = actualRs.getMetaData().getColumnCount();
			actualRs.last();
			iexpectedRowCount = expectedRs.size();
			iactualRowCount = actualRs.getRow();
			ResultSetMetaData metaData = actualRs.getMetaData();
			List<String> allStatus = new LinkedList<String>(); // Mantis 0000888

			if (iexpectedCoulmnCount == iactualCoulmnCount && iexpectedRowCount == iactualRowCount) {
				actualRs.first();
				for (int i = 0; i < iactualRowCount; i++) {
					String sExpectedColumn, sActualColumn, sExpectedData, sActualData, sStatus, sExecutionDetails;
					sExecutionDetails = "";
					sExpectedColumn = "";
					sActualColumn = "";
					sActualData = "";
					sStatus = "";
					for (j = 0; j < iexpectedCoulmnCount; j++) {
						sExpectedData = expectedRs.get(i).get(j);
						sActualData = actualRs.getString(metaData.getColumnName(j + 1));

						sExecutionDetails = "Expected data column :" + sExpectedColumn + " Actual data column : "
								+ sActualColumn;

						if (sExpectedData.equalsIgnoreCase(sActualData)) {
							sStatus = "Pass";
							allStatus.add(sStatus); // Mantis 0000888
						} else {
							sStatus = "Fail";
							allStatus.add(sStatus); // Mantis 0000888
						}

						oFunctionLog.setTestStepDetails(sTestCaseData, "", sExpectedData, sActualData, sStatus,
								sUserAction, sExecutionDetails, "", sWebPagePath); // Mantis 0001221

					}
					actualRs.next();
				}
				// Mantis 0000888
				if (allStatus.contains("Fail"))
					status = "Fail";
				else
					status = "Pass";
			} else {
				String sExpected, sActual, sExecutionDetails;
				sExpected = "Expected Column count:" + iexpectedCoulmnCount + "Expected Row count:" + iexpectedRowCount;
				sActual = "Actual Column Count: " + iactualCoulmnCount + "Actual Row Count: " + iactualRowCount;
				if (iactualRowCount == 0)
					sExecutionDetails = "No Records Fetched by given Query"; // Mantis 0000924
				else
					sExecutionDetails = "Actual And Expected Table structure does not match";
				oFunctionLog.setTestStepDetails(sTestCaseData, "", sExpected, sActual, "Fail", sUserAction,
						sExecutionDetails, "", sWebPagePath); // Mantis 0001221
				// sComments="Expected Column count:"+iexpectedCoulmnCount+"\n Actual Column
				// Count: "+iactualCoulmnCount+"Expected Row count:"+iexpectedRowCount+"\n
				// Actual Row Count: "+iactualRowCount;
				status = "Fail"; // Mantis 0000888
			}
		} catch (Exception E) {
			E.printStackTrace();
			status = "Fail"; // Mantis 0000888
		}
		return status; // Mantis 0000888
	}

	/*
	 * --------------------------------------- START :
	 * verifySQLData---------------------------------------------- Function Name:
	 * verifySQLData Objective: A generic Function to execute SQL Query and verify
	 * sql query data with data which is fetched by previous query and store in
	 * Execution data excel file. Date Created: Input: sExcelPath= path of the excel
	 * file sQueryName= name of the SQL query sTestCaseIdentifier= Identifier that
	 * uniquely identifies an object on application; e.g xpath, id etc sExpectedData
	 * = Expected data which is fetched from previous query & stored it in
	 * Executiondata excel file. Output: Revision History: Modified By: Manoj
	 * Bamnawat (Mantis 0000886) Modified on: Comments: A generic Function to
	 * execute SQL Query and verify sql query data with data which is fetched by
	 * previous query and store in Execution data excel file.
	 * -----------------------------------------------------------------------------
	 * ----------------------------
	 */
	private String verifySQLData(String sQueryName, String sExcelPath, String sTestCaseIdentifier, String sExpectedData)
			throws Exception {
		sExcelPath = KeywordDrivenFramework.checkpath(sExcelPath, "Keywords_&_Data"); // Mantis 0001045
		String sStatus = "Fail";

		try {
			Workbook workBookData = null, DBExcelWorkBookData = null;
			Connection SQLCon;
			String sDBuser = null, sDBpass = null;
			Object JsonData;

			List<String> resultSet = null, rsDBExcel = null;
			List<List<String>> resultSet1 = null;
			Set<String> columnHeaderOfExpectedData = null, columnHeaderOfActualData = null;
			List<List<String>> verificationData = null;
			LinkedList<String> verificationColumnData = null;

			ResultSet SQL_rs;

			// workBookData = ExcelConnection.funExcelConnection(sExcelPath);
			// List<List<String>> data= ExcelConnection.funGetSheetData(workBookData,
			// "DB_Query");
			// Map<String, Integer>
			// columnData=ExcelConnection.funGetSheetColumns(workBookData,"DB_Query");

			JsonData = ExcelConnection.getdbFilefromJson(sExcelPath);
			List<List<String>> data = ExcelConnection.getSheetDataFromJSON(JsonData, "DB_Query");
			Map<String, Integer> columnData = ExcelConnection.getColumnNamesFromJson(JsonData, "DB_Query");

			int testCaseColIndex = ExcelConnection.funGetColumnIndex("Test_Case", columnData);
			int queryNameColIndex = ExcelConnection.funGetColumnIndex("QueryName", columnData);
			int taregtRow = ExcelConnection.funGetExecutionDataRecordNumber(testCaseColIndex, queryNameColIndex,
					sTestCaseIdentifier, sQueryName, data);
			if (taregtRow == -1) {
				// debugLog("verifySQLData", "Could not find data for testcase :" +
				// sTestCaseIdentifier + "and for QueryName :" + sQueryName);
				// throw new Exception("VerifySQLData Could not find data for testcase :" +
				// sTestCaseIdentifier + " and for QueryName :" + sQueryName);
				throw new CustomDataBaseException("VerifySQLData Could not find data for testcase :"
						+ sTestCaseIdentifier + " and for QueryName :" + sQueryName); // Mantis 0001780
			}

			resultSet = new ArrayList<String>();

			for (int i = 0; i < columnData.size(); i++) {
				resultSet.add(data.get(taregtRow).get(i));
			}

			String sExecutionQuery, sColumnNames, sConnectionStringName, sDatabaseDriver = null,
					sConnectionString = null;

			try {
				verificationData = funGetDataFromJSON(sExpectedData);
				verificationColumnData = funGetColumnsFromJSON(sExpectedData);

				columnHeaderOfExpectedData = new LinkedHashSet<String>();

				resultSet1 = new ArrayList<List<String>>();

			} catch (Exception e) {
				e.printStackTrace();
				// CustomException e1 = new CustomException("Data Sheet with name
				// "+sVerificationSheetName+"does not exist");
				// throw e1;
				throw e;
			}
			sConnectionStringName = resultSet.get(ExcelConnection
					.funGetColumnIndex(DatabaseConnectionsColumnHeader.CONNECTIONNAME.toString(), columnData));
			if (sConnectionStringName != null) {
				// String sCurrentDir = System.getProperty("user.dir");
				// String sFileName =sCurrentDir+"/Master_Data/DatabaseConnections.xlsx";
				// DBExcelWorkBookData = ExcelConnection.funExcelConnection(sFileName);
				// List<List<String>> DBExcelData=
				// ExcelConnection.funGetSheetData(DBExcelWorkBookData, "Connection");
				// Map<String, Integer>
				// DBExcelColumnData=ExcelConnection.funGetSheetColumns(DBExcelWorkBookData,"Connection");

				List<List<String>> DBExcelData = ExcelConnection.readDatabaseConnections();
				Map<String, Integer> DBExcelColumnData = ExcelConnection
						.getMasterDataFileColumns("DatabaseConnections");
				int connectionNameColumnIndex = ExcelConnection.funGetColumnIndex(
						DatabaseConnectionsColumnHeader.CONNECTIONNAME.toString(), DBExcelColumnData);
				int connectionTargetRow = ExcelConnection.funGetTestDataRecordNumber(connectionNameColumnIndex,
						sConnectionStringName, DBExcelData);

				rsDBExcel = new ArrayList<String>();

				for (int i = 0; i < DBExcelColumnData.size(); i++) {
					rsDBExcel.add(DBExcelData.get(connectionTargetRow).get(i));
				}

				sDatabaseDriver = rsDBExcel.get(ExcelConnection.funGetColumnIndex(
						DatabaseConnectionsColumnHeader.DATABASEDRIVER.toString(), DBExcelColumnData));
				sConnectionString = rsDBExcel.get(ExcelConnection.funGetColumnIndex(
						DatabaseConnectionsColumnHeader.CONNECTIONSTRING.toString(), DBExcelColumnData));
				sDBuser = rsDBExcel.get(ExcelConnection
						.funGetColumnIndex(DatabaseConnectionsColumnHeader.USERNAME.toString(), DBExcelColumnData));
				sDBpass = rsDBExcel.get(ExcelConnection
						.funGetColumnIndex(DatabaseConnectionsColumnHeader.PASSWORD.toString(), DBExcelColumnData));

				sExecutionQuery = resultSet.get(ExcelConnection.funGetColumnIndex("Query", columnData));
				sColumnNames = resultSet.get(ExcelConnection.funGetColumnIndex("Field_Names", columnData));
				SQLCon = ExcelConnection.getDatabaseConnection(sDatabaseDriver, sConnectionString, sDBuser, sDBpass);
				Statement SQLSt = SQLCon.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE, ResultSet.CONCUR_READ_ONLY);

				if (sExecutionQuery != null) {
					if (sExecutionQuery.contains("#")) {
						List<String> sHashData = getDynamicValues(sExecutionQuery);

						for (int iHashCount = 0; iHashCount < sHashData.size(); iHashCount++) {
							String sSetDynamic = dynamicSet(sTestCaseIdentifier, sHashData.get(iHashCount));
							sExecutionQuery = sExecutionQuery.replaceFirst("#" + sHashData.get(iHashCount) + "#",
									"\'" + sSetDynamic + "\'"); // Mantis 0000924
						}
						if ((!sExecutionQuery.toLowerCase().startsWith("select")) // Mantis 0001046,0001676,0001815
								|| (sExecutionQuery.toLowerCase().startsWith("update"))
								|| (sExecutionQuery.toLowerCase().startsWith("delete"))
								|| (sExecutionQuery.toLowerCase().startsWith("truncate"))
								|| (sExecutionQuery.toLowerCase().startsWith("alter"))
								|| (sExecutionQuery.toLowerCase().startsWith("insert")))
							throw new Exception("UnAuthorized action on Database [use only 'select' query");
						SQL_rs = SQLSt.executeQuery(sExecutionQuery);
					} else {
						// no parameters to query "Static Query"
						if ((!sExecutionQuery.toLowerCase().startsWith("select")) // Mantis 0001046,0001676,0001815
								|| (sExecutionQuery.toLowerCase().startsWith("update"))
								|| (sExecutionQuery.toLowerCase().startsWith("delete"))
								|| (sExecutionQuery.toLowerCase().startsWith("truncate"))
								|| (sExecutionQuery.toLowerCase().startsWith("alter"))
								|| (sExecutionQuery.toLowerCase().startsWith("insert")))
							throw new Exception("UnAuthorized action on Database [use only 'select' query");
						SQL_rs = SQLSt.executeQuery(sExecutionQuery);
					}

					if (sColumnNames != null) {
						if (sColumnNames.contains("|")) {
							String parts[] = sColumnNames.split("\\|");
							String sExpectedColumnsVerification = parts[0];
							String sActualColumnsVerification = parts[1];

							String sFirstDataParts[] = sExpectedColumnsVerification.split(",");
							List<String> sSecondDataParts = Arrays.asList(sActualColumnsVerification.split(","));
							columnHeaderOfActualData = new LinkedHashSet<String>(sSecondDataParts);

							for (String keys : verificationColumnData) {
								for (String columnsVerify : sFirstDataParts) {
									if (keys.equalsIgnoreCase(columnsVerify.trim())) {
										columnHeaderOfExpectedData.add(keys);
									}
								}

							}
							System.out.println(columnHeaderOfExpectedData);
							resultSet1 = expectedDatafromJSON(columnHeaderOfExpectedData, sExpectedData);
							System.out.println(resultSet1);
							sStatus = compareResultSets(columnHeaderOfExpectedData, resultSet1,
									columnHeaderOfActualData, SQL_rs); // Mantis 0000888
						} else {
							String sColumnData[] = sColumnNames.split(",");
							for (String keys : verificationColumnData) {
								for (String columnsVerify : sColumnData) {
									if (keys.equalsIgnoreCase(columnsVerify.trim())) {
										columnHeaderOfExpectedData.add(keys);
									}
								}

							}
							System.out.println(columnHeaderOfExpectedData);
							resultSet1 = expectedDatafromJSON(columnHeaderOfExpectedData, sExpectedData);
							System.out.println(resultSet1);
							sStatus = compareResultSets(columnHeaderOfExpectedData, resultSet1, SQL_rs); // Mantis
							// 0000888
						}
					} else {

						if (verificationColumnData.size() == SQL_rs.getMetaData().getColumnCount()) {
							resultSet1 = verificationData;
							sStatus = compareResultSets(resultSet1, SQL_rs); // Mantis 0000888
						} else {
							// oFunctionLog.setTestStepDetails(sTestCaseData, "", "", "", "Fail",
							// sUserAction,"Number of Columns of both query are different.", "");
							Exception e = new Exception("Number of Columns of both query are different.");
							throw e;
						}
					}
				} else {
					// Log that Query column does not Exist
					// oFunctionLog.setTestStepDetails(sTestCaseData, "", "", "", "Fail",
					// sUserAction,"Query Column does not exists", "");
					// Exception e = new Exception("Query Column does not exists");
					throw new CustomDataBaseException("Query Column does not exists"); // Mantis 0001780
				}
			} else {
				// Connection String Name not available
				// oFunctionLog.setTestStepDetails(sTestCaseData, "", "", "", "Fail",
				// sUserAction, "Connection String Name Not Specified", "");
				// Exception e = new Exception("Connection String Name Not Specified");
				throw new CustomDataBaseException("Connection String Name Not Specified"); // Mantis 0001780
			}
		} catch (Exception e) {
			e.printStackTrace();

			if (e instanceof CustomDataBaseException) // Mantis 0001780
				throw e;

			sComments = e.getMessage();
			sStatus = "Fail"; // Mantis 0000888
			// oFunctionLog.setTestStepDetails(sTestCaseData, "", "", "", "Fail",
			// sUserAction, "SQL Query failed", "");
			// debugLog("verifySQLData", e.getMessage());
		}
		return sStatus;
	}

	// Mantis 0000886
	private List<List<String>> expectedDatafromJSON(Set<String> columnHeaderOfExpectedData, String sExpectedData)
			throws Exception {
		List<String> columnHead = new ArrayList<>(columnHeaderOfExpectedData);
		List<List<String>> tableRS = new ArrayList<List<String>>();
		List<String> listRow;

		JSONArray jsonArray = new JSONArray(sExpectedData);
		JSONObject jsonData = null;
		JSONArray cols = new JSONArray();

		cols = jsonArray.getJSONObject(0).names();

		System.out.println(cols);

		for (int i = 0; i < jsonArray.length(); i++) {
			jsonData = jsonArray.getJSONObject(i);
			listRow = new ArrayList<String>();

			for (int j = 0; j < cols.length(); j++) {
				for (int k = 0; k < columnHead.size(); k++) {
					if (cols.getString(j).equalsIgnoreCase(columnHead.get(k))) {
						listRow.add(jsonData.get(cols.getString(j)).toString().trim());
						systemouts(jsonData.get(cols.getString(j)).toString());
					}
				}

			}
			tableRS.add(listRow);
		}
		System.out.println(tableRS);
		return tableRS;
	}

	// Mantis 0000886
	private LinkedList<String> funGetColumnsFromJSON(String sExpectedData) throws Exception {
		LinkedList<String> ExpectedColumns = new LinkedList<String>();
		JSONArray jsonArray = new JSONArray(sExpectedData);
		JSONArray cols = new JSONArray();

		cols = jsonArray.getJSONObject(0).names();

		for (int i = 0; i < cols.length(); i++) {
			ExpectedColumns.add(cols.getString(i).trim());
		}

		return ExpectedColumns;
	}

	// Mantis 0000886
	private List<List<String>> funGetDataFromJSON(String sExpectedData) throws Exception {
		List<List<String>> tableRS = new ArrayList<List<String>>();
		List<String> listRow;

		JSONArray jsonArray = new JSONArray(sExpectedData);
		JSONObject jsonData = null;
		JSONArray cols = new JSONArray();

		cols = jsonArray.getJSONObject(0).names();

		System.out.println(cols);

		for (int i = 0; i < jsonArray.length(); i++) {
			jsonData = jsonArray.getJSONObject(i);
			listRow = new ArrayList<String>();

			for (int j = 0; j < cols.length(); j++) {
				listRow.add(jsonData.get(cols.getString(j)).toString().trim());
				systemouts(jsonData.get(cols.getString(j)).toString());

			}
			tableRS.add(listRow);
		}
		System.out.println(tableRS);
		return tableRS;
	}

	/*
	 * --------------------------------------- START :
	 * getSQLData---------------------------------------------- Function Name:
	 * getSQLData Objective: A generic Function to execute SQL Query and store sql
	 * query data in Execution data excel file. Date Created: Input: sExcelPath=
	 * path of the excel file sQueryName= name of the SQL query sTestCaseIdentifier=
	 * Identifier that uniquely identifies an object on application; e.g xpath, id
	 * etc Output: Revision History: Modified By: Manoj Bamnawat (Mantis 0000885)
	 * Modified on: Comments: A generic Function to execute SQL Query and store sql
	 * query data in Execution data excel file.So that user can use the same data at
	 * run time in other user actions.
	 * -----------------------------------------------------------------------------
	 * ----------------------------
	 */
	private String getSQLData(String sExcelPath, String sQueryName, String sTestCaseIdentifier, String sFieldName)
			throws Exception {
		sExcelPath = KeywordDrivenFramework.checkpath(sExcelPath, "Keywords_&_Data"); // Mantis 0001045
		String sJSON = null;
		try {

			Workbook workBookData = null, DBExcelWorkBookData = null;
			Connection SQLCon;
			String sDBuser = null, sDBpass = null;
			Object JsonData;
			String sExecutionQuery, sColumnNames, sConnectionStringName, sDatabaseDriver = null,
					sConnectionString = null;
			List<String> resultSet = null, rsDBExcel = null;
			ResultSet SQL_rs;

			// workBookData = ExcelConnection.funExcelConnection(sExcelPath);
			// List<List<String>> data= ExcelConnection.funGetSheetData(workBookData,
			// "DB_Query");
			// Map<String, Integer>
			// columnData=ExcelConnection.funGetSheetColumns(workBookData,"DB_Query");

			JsonData = ExcelConnection.getdbFilefromJson(sExcelPath);
			List<List<String>> data = ExcelConnection.getSheetDataFromJSON(JsonData, "DB_Query");
			Map<String, Integer> columnData = ExcelConnection.getColumnNamesFromJson(JsonData, "DB_Query");

			int testCaseColIndex = ExcelConnection.funGetColumnIndex("Test_Case", columnData);
			int queryNameColIndex = ExcelConnection.funGetColumnIndex("QueryName", columnData);
			int taregtRow = ExcelConnection.funGetExecutionDataRecordNumber(testCaseColIndex, queryNameColIndex,
					sTestCaseIdentifier, sQueryName, data);
			if (taregtRow == -1) {
				// debugLog("GetSQLData", "Could not find data for testcase :" +
				// sTestCaseIdentifier + " and for QueryName :" + sQueryName);
				// throw new Exception("GetSQLData Could not find data for testcase :" +
				// sTestCaseIdentifier + " and for QueryName :" + sQueryName);
				throw new CustomDataBaseException("GetSQLData Could not find data for testcase :" + sTestCaseIdentifier
						+ " and for QueryName :" + sQueryName); // Mantis 0001780
			}

			resultSet = new ArrayList<String>();

			for (int i = 0; i < columnData.size(); i++) {
				resultSet.add(data.get(taregtRow).get(i));
			}

			sConnectionStringName = resultSet.get(ExcelConnection
					.funGetColumnIndex(DatabaseConnectionsColumnHeader.CONNECTIONNAME.toString(), columnData));
			if (sConnectionStringName != null) {
				// String sCurrentDir = System.getProperty("user.dir");
				// String sFileName =sCurrentDir+"/Master_Data/DatabaseConnections.xlsx";
				// DBExcelWorkBookData = ExcelConnection.funExcelConnection(sFileName);
				// List<List<String>> DBExcelData=
				// ExcelConnection.funGetSheetData(DBExcelWorkBookData, "Connection");
				// Map<String, Integer>
				// DBExcelColumnData=ExcelConnection.funGetSheetColumns(DBExcelWorkBookData,"Connection");

				List<List<String>> DBExcelData = ExcelConnection.readDatabaseConnections();
				Map<String, Integer> DBExcelColumnData = ExcelConnection
						.getMasterDataFileColumns("DatabaseConnections");
				int connectionNameColumnIndex = ExcelConnection.funGetColumnIndex(
						DatabaseConnectionsColumnHeader.CONNECTIONNAME.toString(), DBExcelColumnData);
				int connectionTargetRow = ExcelConnection.funGetTestDataRecordNumber(connectionNameColumnIndex,
						sConnectionStringName, DBExcelData);

				rsDBExcel = new ArrayList<String>();

				for (int i = 0; i < DBExcelColumnData.size(); i++) {
					rsDBExcel.add(DBExcelData.get(connectionTargetRow).get(i));
				}

				sDatabaseDriver = rsDBExcel.get(ExcelConnection.funGetColumnIndex(
						DatabaseConnectionsColumnHeader.DATABASEDRIVER.toString(), DBExcelColumnData));
				sConnectionString = rsDBExcel.get(ExcelConnection.funGetColumnIndex(
						DatabaseConnectionsColumnHeader.CONNECTIONSTRING.toString(), DBExcelColumnData));
				sDBuser = rsDBExcel.get(ExcelConnection
						.funGetColumnIndex(DatabaseConnectionsColumnHeader.USERNAME.toString(), DBExcelColumnData));
				sDBpass = rsDBExcel.get(ExcelConnection
						.funGetColumnIndex(DatabaseConnectionsColumnHeader.PASSWORD.toString(), DBExcelColumnData));

				sExecutionQuery = resultSet.get(ExcelConnection.funGetColumnIndex("Query", columnData));
				sColumnNames = resultSet.get(ExcelConnection.funGetColumnIndex("Field_Names", columnData)); // Need to
				// check
				// this code
				// whether
				// we can
				// use this
				// column
				// for
				// improving
				// this
				// code.
				SQLCon = ExcelConnection.getDatabaseConnection(sDatabaseDriver, sConnectionString, sDBuser, sDBpass);
				Statement SQLSt = SQLCon.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE, ResultSet.CONCUR_READ_ONLY);
				if (sExecutionQuery != null) {
					if (sExecutionQuery.contains("#")) {
						List<String> sHashData = getDynamicValues(sExecutionQuery);

						for (int iHashCount = 0; iHashCount < sHashData.size(); iHashCount++) {
							String sSetDynamic = dynamicSet(sTestCaseIdentifier, sHashData.get(iHashCount));
							sExecutionQuery = sExecutionQuery.replaceFirst("#" + sHashData.get(iHashCount) + "#",
									"\'" + sSetDynamic + "\'"); // Mantis 0000924
						}
						if ((!sExecutionQuery.toLowerCase().startsWith("select")) // Mantis 0001046,0001676,0001815
								|| (sExecutionQuery.toLowerCase().startsWith("update"))
								|| (sExecutionQuery.toLowerCase().startsWith("delete"))
								|| (sExecutionQuery.toLowerCase().startsWith("truncate"))
								|| (sExecutionQuery.toLowerCase().startsWith("alter"))
								|| (sExecutionQuery.toLowerCase().startsWith("insert")))
							throw new Exception("UnAuthorized action on Database [use only 'select' query");

						SQL_rs = SQLSt.executeQuery(sExecutionQuery);
					} else {
						// Static query
						if ((!sExecutionQuery.toLowerCase().startsWith("select")) // Mantis 0001046,0001676,0001815
								|| (sExecutionQuery.toLowerCase().startsWith("update"))
								|| (sExecutionQuery.toLowerCase().startsWith("delete"))
								|| (sExecutionQuery.toLowerCase().startsWith("truncate"))
								|| (sExecutionQuery.toLowerCase().startsWith("alter"))
								|| (sExecutionQuery.toLowerCase().startsWith("insert")))
							throw new Exception("UnAuthorized action on Database [use only 'select' query");
						SQL_rs = SQLSt.executeQuery(sExecutionQuery);
					}
					sJSON = funGetJSONString(SQL_rs);
				} else {
					// Exception e = new Exception("Query column does not exist");
					throw new CustomDataBaseException("Query column does not exist"); // Mantis 0001780
				}
			} else {
				// Exception e = new Exception("Connection String Name Not Specified");
				throw new CustomDataBaseException("Connection String Name Not Specified"); // Mantis 0001780
			}
		} catch (Exception e) {
			e.printStackTrace();

			if (e instanceof CustomDataBaseException) // Mantis 0001780
				throw e;
			// oFunctionLog.setTestStepDetails(sTestCaseData, "", "", "", "Fail",
			// sUserAction, "SQL Query failed", "");
			debugLog("GetSQLData", e.getMessage());
		}
		return sJSON;
	}

	// Mantis 0000885
	private String funGetJSONString(ResultSet rs) throws Exception {
		StringBuilder sJSON = null;
		String sJSONString = null;
		int rowCount, CoulmnCount;
		String columnName = null;

		if (rs != null) {
			rs.last();
			rowCount = rs.getRow();
			systemouts("Row Count:" + rowCount);

			CoulmnCount = rs.getMetaData().getColumnCount();
			systemouts("Column Count:" + CoulmnCount);

			sJSON = new StringBuilder();
			sJSON.append("[");

			ResultSetMetaData metaData = rs.getMetaData();
			rs.beforeFirst();

			while (rs.next()) {
				sJSON.append("{");

				for (int j = 1; j <= CoulmnCount; j++) {
					if (rs.getString(metaData.getColumnName(j)) != null) {
						columnName = metaData.getColumnName(j);
						sJSON.append("\"").append(columnName).append("\"").append(":").append("\"")
						.append(rs.getString(columnName)).append("\"").append(",");
					} else {
						sJSON.append("\"").append(columnName).append("\"").append(":").append("\"").append("")
						.append("\"").append(",");
					}

				}
				sJSON.deleteCharAt(sJSON.length() - 1).append("},");
			}
			sJSON.deleteCharAt(sJSON.length() - 1).append("]");
			sJSONString = sJSON.toString();
		}
		return sJSONString;
	}

	/*
	 * --------------------------------------- START :
	 * timeout---------------------------------------------- Function Name: timeout
	 * Objective: A Generic Function to Implicitly wait for an object on application
	 * Date Created: Input: sTime = Wait Time Output: Revision History: Modified on:
	 * Comments: Application is made implicitly wait for the given wait time.
	 * -----------------------------------------------------------------------------
	 * ----------------------------
	 */

	void timeout(String sTime) {
		oDriver.manage().timeouts().implicitlyWait(Integer.parseInt(sTime), TimeUnit.SECONDS);
	}

	/*
	 * --------------------------------------- START :
	 * thinkTime---------------------------------------------- Function Name:
	 * thinkTime Objective: A Generic Function to reset think time Date Created:
	 * Input: sTime = think time Output: Revision History: Modified on:
	 * Comments:ThinkTime is applied for rest of the test case
	 * -----------------------------------------------------------------------------
	 * ----------------------------
	 */

	// void thinkTime(String sTime)
	// {
	// int lTime=Integer.parseInt(sTime);
	// lThinkTime=lTime;
	// }

	/*
	 * --------------------------------------- START :
	 * executeJSAction---------------------------------------------- Function Name:
	 * executeJSAction Objective: A generic Function execute javascript event
	 * forcefully. Date Created: Input: sJSEvent = Name of javascript event which
	 * has to be performed. Output: Revision History: Modified by: Manoj
	 * Bamanwat(Mantis 0000844) Modified on: Comments:
	 * -----------------------------------------------------------------------------
	 * ----------------------------
	 */

	void executeJSAction(String sJSEvent) throws Exception {
		((JavascriptExecutor) oDriver).executeScript(sJSEvent);
	}

	// Mantis 0000850
	void executeJSAction(String sControlType, String sSearchCriteria, String sSearchText, int iInd, String stepData)
			throws Exception {
		int i = 0;
		if (waitForElement(sSearchCriteria, sSearchText, iInd)) // Mantis 0000879
		{
			if (stepData.isEmpty()) // Mantis 0000850
			{
				// systemouts("Inside executeJavaScript function");
				WebElement oCurrentElement = getElement(sControlType, sSearchCriteria, sSearchText, iInd);
				String js = "arguments[0].style.visibility='visible';";

				JavascriptExecutor jes = (JavascriptExecutor) oDriver;
				// ((JavascriptExecutor) oDriver).executeScript(js, oCurrentElement);
				jes.executeScript(js, oCurrentElement);
				jes.executeScript("arguments[0].click();", oCurrentElement);
				// jes.executeScript("arguments[0].onmouseover();", oCurrentElement);
				// Thread.sleep(1000);
				// jes.executeScript("arguments[0].onmouseout", oCurrentElement);

				// oCurrentElement.click();
			} else // Mantis 0000850
			{
				for (i = 0; i < Integer.parseInt(stepData); i++) {
					try {
						WebElement oCurrentElement = getElement(sControlType, sSearchCriteria, sSearchText, i);
						String js = "arguments[0].style.visibility='visible';";

						JavascriptExecutor jes = (JavascriptExecutor) oDriver;
						((JavascriptExecutor) oDriver).executeScript(js, oCurrentElement);
						jes.executeScript("arguments[0].click();", oCurrentElement);
						// oCurrentElement.click();
						break;
					} catch (Exception e) {
						systemouts("Exception " + i);
					}
				}

			}

		} else {
			NoSuchElementException e = new NoSuchElementException("Element search failed with method: \""
					+ sSearchCriteria + "\"  and search Criteria: \"" + sSearchText + "\"");
			throw e;
		}
	}

	// -----Anum-----//
	/*
	 * void clickJS(String sControlType,String sSearchCriteria,String
	 * sSearchText,int iInd) throws Exception {
	 * systemouts("Inside clickJS function..."); String js = null;
	 * JavascriptExecutor jes= (JavascriptExecutor)oDriver;
	 * 
	 * switch (sSearchCriteria.toLowerCase()) { case "id" : if(iInd==-1) {
	 * js="document.getElementById("+"'"+sSearchText+"'"+").click()"; } break; case
	 * "class" : if(iInd==-1) iInd=0; js=
	 * "document.getElementsByClassName("+"'"+sSearchText+"'"+")["+iInd+"].click()";
	 * break; case "name" : if(iInd==-1) iInd=0; js=
	 * "document.getElementsByName("+"'"+sSearchText+"'"+")["+iInd+"].click()";
	 * break; case "tag" : if(iInd==-1) iInd=0; js=
	 * "document.getElementsByTagName("+"'"+sSearchText+"'"+")["+iInd+"].click()";
	 * break;
	 * 
	 * case "xpath" : js= "document.evaluate('"+
	 * sSearchText+"', document,null, XPathResult.FIRST_ORDERED_NODE_TYPE, null).singleNodeValue.click()"
	 * ; break;
	 * 
	 * default : NoSuchTagException e = new NoSuchTagException(sSearchCriteria);
	 * throw e;
	 * 
	 * } jes.executeScript(js); }
	 */
	// -----Anum-----//

	/*
	 * --------------------------------------- START :
	 * attach---------------------------------------------- Function Name: attach
	 * Objective: A generic Function to attach to a newly opened web-browser. Date
	 * Created: Input: sTargetTitle = Title of the browser which has to be attached.
	 * Output: Revision History: Modified on: Comments: Mantis 0000867
	 * -----------------------------------------------------------------------------
	 * ----------------------------
	 */

	public void attach(String sTargetTitle, String comparison) // Mantis 0001816
	{
		String[] windows;
		if (sTargetTitle == null)
			sTargetTitle = "";
		debugLog("Object Sync", "Target Window Title is:" + sTargetTitle);

		long StartTime, EndTime, tillWaitTime; // Mantis 0000867

		StartTime = System.nanoTime() / 1000000000; // Mantis 0000867
		systemouts("Start Time :" + StartTime); // Mantis 0000867

		tillWaitTime = StartTime + lWindowTimeout; // Mantis 0000867

		while ((System.nanoTime() / 1000000000) < tillWaitTime) // Mantis 0000867
		{
			windows = oDriver.getWindowHandles().toArray(new String[oDriver.getWindowHandles().size()]); // Mantis
			// 0000851
			systemouts("Number of Windows:" + windows.length); // Mantis 0000851
			try {
				for (int i = windows.length - 1; i >= 0; i--) {
					Thread.sleep(1000); // Mantis 0000863
					oDriver.switchTo().window(windows[i]);
					if (comparison.equalsIgnoreCase("equals")) // MAntis 0001816
					{
						if (oDriver.getTitle().trim().toLowerCase()
								.equalsIgnoreCase(sTargetTitle.trim().toLowerCase())) {
							return;
						} else {
							systemouts("Searching for expected window...."); // Window which does not match
						}
					} else if (comparison.equalsIgnoreCase("contains")) // Mantis 0001816
					{
						if (oDriver.getTitle().trim().toLowerCase().contains(sTargetTitle.trim().toLowerCase())) {
							return;
						} else {
							systemouts("Searching for expected window...."); // Window which does not match
						}
					}
				}
			} catch (Exception e) {
			}
		}

		EndTime = System.nanoTime() / 1000000000;
		systemouts("End Time :" + EndTime);
		systemouts("Elapsed Time in Seconds:" + Math.round(EndTime - StartTime));
		NoSuchWindowException e = new NoSuchWindowException(
				"Browser Window with Title : " + sTargetTitle + " is not found");
		throw e;
	}

	private void attach(int windowNumber) throws IOException // Mantis 0000695 //Mantis 0000854
	{
		Boolean status = false;
		String[] windows;
		WebDriverWait wait = new WebDriverWait(oDriver, lWindowTimeout, 100);
		status = wait.until(ExpectedConditions.numberOfWindowsToBe(windowNumber + 1));
		if (status == true) {
			windows = oDriver.getWindowHandles().toArray(new String[oDriver.getWindowHandles().size()]);
			oDriver.switchTo().window(windows[windowNumber]);
			return;
		}
		NoSuchWindowException e = new NoSuchWindowException("Browser window is not found");
		throw e;
	}

	/*
	 * --------------------------------------- START :
	 * debugLog---------------------------------------------- Function Name:
	 * debugLog Objective: A generic function to log technical details of each
	 * execution step Date Created: Input: sOperation = Action to be performed on an
	 * object, e.g object sync, click etc sComments = Comments respective to the
	 * operation performed. e.g object found, object clicked etc Output: Revision
	 * History: Modified on: Comments: log the execution steps with all the
	 * values(e.g. testcasename, identifier, user action etc. ) and comments (e.g.
	 * object sync, object found etc. )at every step.
	 * -----------------------------------------------------------------------------
	 * ----------------------------
	 */

	void debugLog(String sOperation, String sComments) {
		Writer out = null;
		try {
			String sTestCaseFileName;
			// Mantis: 0000385
			out = new BufferedWriter(new OutputStreamWriter(new FileOutputStream(sDebugLogFileName, true), "UTF8"));
			sTestCaseFileName = sTestCaseExcelPath.substring(sTestCaseExcelPath.lastIndexOf("/") + 1); // Mantis 0000796
			String sCurObject = new String("Control Type:" + sControlType + ";Identifier:" + sIdentifier
					+ "; Identifier Value:" + sIdentifierValue + "; Test Data:" + sTestStepData);
			out.append(KeywordDrivenFramework.getCurrentScenario() + "," + sTestCaseFileName + "," + sTestCaseData + ","
					+ iStepNo + "," + sCurObject + "," + sOperation + "," + "\"" + sComments + "\"" + "\n");
			out.flush();
		} catch (IOException e) {

		} finally {
			try {
				out.close(); // Mantis: 0000385
			} catch (IOException e) {
				e.printStackTrace();
			}
		}
	}

	/*
	 * --------------------------------------- START :
	 * processDebugLog---------------------------------------------- Function Name:
	 * processDebugLog Objective: A generic function to log important field details
	 * in log text file. Date Created: Input: status = Based on blnError pass status
	 * to this method. exceptionMessage = Exception message generated if exception
	 * occur in any actions. Output: Revision History: Modified on: Comments:
	 * -----------------------------------------------------------------------------
	 * ----------------------------
	 */
	// -------Mantis 0000703-------//
	void processDebugLog(boolean blnError, String exceptionMessage, String sStepStatus) {
		// String appiumProcess = null;
		if (appiumProcess != null && appiumProcess.equalsIgnoreCase("Appium")) {
			String status;
			if (blnError)
				status = "Fail";
			else
				status = "Pass";

			Writer out = null;
			try {
				out = new BufferedWriter(
						new OutputStreamWriter(new FileOutputStream(sProcessDebugLogFileName, true), "UTF8"));

				if (status.equalsIgnoreCase("fail"))
					out.append("Status|" + status + System.getProperty("line.separator") + "Exception|"
							+ exceptionMessage + "\n");
				else {
					if (sStepStatus.equalsIgnoreCase("pass")) {
						// out.append("Status|"+status+System.getProperty("line.separator")+"\n");
						out.append("VerifyStatus|" + sStepStatus + System.getProperty("line.separator")
						+ "VerificationMessage|" + exceptionMessage + System.getProperty("line.separator")
						+ "\n");
					} else {
						if (sStepStatus.equalsIgnoreCase("fail")) {
							// out.append("Status|"+status+System.getProperty("line.separator")+"\n");
							out.append("VerifyStatus|" + sStepStatus + System.getProperty("line.separator")
							+ "VerificationMessage|" + exceptionMessage + System.getProperty("line.separator")
							+ "\n");
						} else {
							out.append("Status|" + status + "\n");
						}
					}

				}
				out.flush();

			} catch (IOException e) {

			} finally {
				try {
					out.close();
				} catch (IOException e) {
					e.printStackTrace();
				}
			}
		}
	}
	// -------Mantis 0000703-------//

	/*
	 * --------------------------------------- START :
	 * takeScreenShot---------------------------------------------- Function Name:
	 * takeScreenShot Objective: A generic Function to take screenshot. Date
	 * Created: Input: Output: Revision History: Modified on: Mantis 0000928
	 * Comments: Changed location of screenshot to Results folder.
	 * -----------------------------------------------------------------------------
	 * ----------------------------
	 */
	void captureImage(String folder, String name, String sTestStepData, String Driver_Json, String script_name,
			String testcase, String sIdentifier, String sIdentifierValue, int iIndex) throws Exception // Mantis
	// 0001911,0001924
	{
		WebElement oCurrentElement = null;
		Boolean wrongcoordinate = false; // Mantis id 0001948

		// Check if element is passed //Mantis 0001924
		if (sIdentifierValue != null && sIdentifier != null && !sIdentifierValue.isEmpty() && !sIdentifier.isEmpty()) {
			// element screenshot
			// do this for element
			String sStatus = "";
			if (waitForElement(sIdentifier, sIdentifierValue, iIndex)) // Mantis 0000879
			{
				oCurrentElement = getElement(sControlType, sIdentifier, sIdentifierValue, iIndex);
				int i = 0;
				while (oCurrentElement == null && i < iStaleMaxCount) // Mantis 0000855
				{
					oCurrentElement = getElement(sControlType, sIdentifier, sIdentifierValue, iIndex);
					i++;
				}
			} else // Mantis 0001928
			{
				NoSuchElementException e = new NoSuchElementException("Element search failed with method: \""
						+ sIdentifier + "\"  and search Criteria: \"" + sIdentifierValue + "\"");
				throw e;
			}
			// scroll to that element

			scrollTo("webelement", sIdentifier, sIdentifierValue, iIndex); // Mantis id 0001948

		}

		try {
			// Mantis 0001917
			int startfolderindex = -1;
			if (Webserver.startsWith("//")) {
				startfolderindex = Webserver.indexOf("."); // ipaddress
				startfolderindex = Webserver.indexOf("/", startfolderindex);
			} else if (Webserver.charAt(1) == ':') {
				startfolderindex = Webserver.indexOf("/");
			}
			// Mantis 0001917

			Boolean flag = false;
			String delimiter = "/|\\\\";
			String excelName;
			if (baselineImageFolder.isEmpty()) {
				baselineImageFolder = Webserver + "//BaseLineImageFolder"; // Mantis 0001913,0001917
				ImageVerificationFeature.baselineImageFolder = baselineImageFolder;
			}

			// {Driver:SFDCImageSuite,Project_Id:157,Machine_Id:9,Browser:Chrome,ProjectType:WEB,UnitTest:false,Exec_ID:7}
			JSONObject jObj = new JSONObject(Driver_Json);
			String driver_name = (String) jObj.get(ImageVerificationJsonKeys.DRIVER.toString());
			int exec_id = jObj.getInt(ImageVerificationJsonKeys.EXEC_ID.toString());
			String project_type = jObj.getString(ImageVerificationJsonKeys.PROJECTTYPE.toString());
			int project_id = jObj.getInt(ImageVerificationJsonKeys.PROJECT_ID.toString());
			String basebrowser = (String) jObj.get(ImageVerificationJsonKeys.BASELINE_BROWSER.toString()); // Mantis
			// 0001951,0001950
			String statusParts[];
			File scrFile = null;

			if (oCurrentElement != null) {
				scrFile = ((TakesScreenshot) oDriver).getScreenshotAs(OutputType.FILE);

				BufferedImage fullImg = ImageIO.read(scrFile); // Get the location of element on the page
				Point point = oCurrentElement.getLocation(); // Get width and height of the element
				int eleWidth = oCurrentElement.getSize().getWidth();
				int eleHeight = oCurrentElement.getSize().getHeight();
				// Crop the entire page screenshot to get only element screenshot

				// Mantis id 0001948
				System.out.println("Element location " + point.getX() + " " + point.getY());
				System.out.println("Image size " + fullImg.getWidth() + " " + fullImg.getHeight());

				int startx = point.getX();
				int starty = point.getY();
				int fullimgwidth = fullImg.getWidth();
				int fullimgheight = fullImg.getHeight();

				if (startx > fullimgwidth) {
					startx = fullimgwidth - eleWidth;
					wrongcoordinate = true;
				}
				if (starty > fullimgheight) {
					starty = fullimgheight - eleHeight;
					wrongcoordinate = true;
				}
				if (startx + eleWidth > fullimgwidth) {
					eleWidth = fullimgwidth - startx;
					wrongcoordinate = true;
				}
				if (starty + eleHeight > fullimgheight) {
					eleHeight = fullimgheight - starty;
					wrongcoordinate = true;
				}

				if (wrongcoordinate == true) {
					throw new ArithmeticException("Element position mismatched for cropped image");
				}

				BufferedImage eleScreenshot = fullImg.getSubimage(startx, starty, eleWidth, eleHeight);
				ImageIO.write(eleScreenshot, "png", scrFile);
			} else {
				scrFile = ((TakesScreenshot) oDriver).getScreenshotAs(OutputType.FILE);
			}

			excelName = sTestCaseExcelPath.split(delimiter, -1)[sTestCaseExcelPath.split(delimiter, -1).length - 1];

			File targetFile = null;
			if (excelName.contains("."))
				excelName += excelName.substring(0, excelName.lastIndexOf("."));// Mantis 0000796

			targetFile = new File(KeywordDrivenFramework.resultLogDirectory + "/" + folder + "/" + name + ".jpg");

			FileUtils.copyFile(scrFile, targetFile); // Mantis 0000796

			flag = true;
			if (flag == true) {
				FileUtils.forceDelete(scrFile);
			}
			String coordinatesvalues = "";
			if (sTestStepData != null && sTestStepData.length() != 0) {
				String colnames[] = sTestStepData.split(",");
				for (String col : colnames)
					coordinatesvalues += dynamicSet(testcase, col) + "~";
			}
			/*
			 * {"Driver":"acsis_view_mode","Machine_Id":"9","Browser":"Chrome","UnitTest":
			 * false, "Exec_ID":55,"Release_Id":233,"Project_Id":157,"ProjectType":"WEB",
			 * "Results_Id":999,
			 * "User_Id":77,"Base_Browser":"Chrome","Comparison_Mode":"Strict"}
			 */
			baselineScriptTestCaseFolder = _sBrowser + "/" + script_name + "/" + testcase; // Mantis 0001951,0001950
			baseBrowserScriptTestCaseFolder = basebrowser + "/" + script_name + "/" + testcase; // Mantis
			// 0001951,0001950
			HashMap<String, String> hmap = new HashMap<String, String>();

			String fullpath = Webserver.substring(startfolderindex) + "/BaseLineImageFolder/"
					+ baselineScriptTestCaseFolder + "/" + name + ".jpg"; // Mantis 0001917 //Mantis 0001951,0001950
			String basebrowserfullpath = Webserver.substring(startfolderindex) + "/BaseLineImageFolder/"
					+ baseBrowserScriptTestCaseFolder + "/" + name + ".jpg"; // Mantis 0001951,0001950
			System.out.println("Checkpoint " + name + " Full path" + fullpath);
			hmap.put(ImageVerificationJsonKeys.DRIVER.toString(), driver_name);
			hmap.put(ImageVerificationJsonKeys.SCRIPT.toString(), script_name);
			hmap.put(ImageVerificationJsonKeys.TEST_CASE.toString(), testcase);
			hmap.put(ImageVerificationJsonKeys.CHECKPOINT_NAME.toString(), name);
			hmap.put(ImageVerificationJsonKeys.BASELINE_IMAGE_PATH.toString(), fullpath); // Mantis 0001913,0001917
			hmap.put(ImageVerificationJsonKeys.ACTUAL_IMAGE_PATH.toString(), targetFile.toString());
			hmap.put(ImageVerificationJsonKeys.DYNAMIC_REGION.toString(), coordinatesvalues);
			hmap.put(ImageVerificationJsonKeys.BASE_BROWSER_IMG_PATH.toString(), basebrowserfullpath); // Mantis
			// 0001951,0001950
			hmap.put(ImageVerificationJsonKeys.BASELINE_BROWSER.toString(), basebrowser);
			imageCollection.add(hmap);
		} catch (Exception e) {
			e.printStackTrace();
			throw e;
		}

	}

	void takeScreenShot() {
		try {
			Boolean flag = false;
			String delimiter = "/|\\\\";
			String excelName;

			File scrFile = ((TakesScreenshot) oDriver).getScreenshotAs(OutputType.FILE);

			excelName = sTestCaseExcelPath.split(delimiter, -1)[sTestCaseExcelPath.split(delimiter, -1).length - 1];

			File targetFile = null;
			if (excelName.contains("."))
				excelName += excelName.substring(0, excelName.lastIndexOf("."));// Mantis 0000796

			targetFile = new File(KeywordDrivenFramework.resultLogDirectory + "/Screenshots/" + excelName + "_"
					+ sTestCaseData + "_" + iStepNo + ".jpg"); // Mantis 0000796
			FileUtils.copyFile(scrFile, targetFile); // Mantis 0000796

			flag = true;
			if (flag == true) {
				FileUtils.forceDelete(scrFile);
			}
			sScreenShotFilePath = targetFile.getAbsolutePath().toString();
		} catch (Exception e) {
			e.printStackTrace();
		}

	}

	/*
	 * --------------------------------------- START :
	 * highlight---------------------------------------------- Function Name:
	 * highlight Objective: A generic Function to highlight an object in
	 * application. Date Created: Input: sSearchCriteria = Identifier that uniquely
	 * identifies an object on application; e.g xpath, id etc sSearchText = Value of
	 * an Identifier iInd = Index of the object in case multiple objects have same
	 * text or id. Output: Revision History: Modified on: Comments:
	 * -----------------------------------------------------------------------------
	 * ----------------------------
	 */
	void highlight(String sIdentifier, String sIdentifierValue, int iIndex) throws Exception // Mantis 0000879
	{
		if (waitForElement(sIdentifier, sIdentifierValue, iIndex)) // Mantis 0000879
		{
			WebElement oCurrentElement = getElement(sControlType, sIdentifier, sIdentifierValue, iIndex);
			for (int i = 0; i < 2; i++) {

				JavascriptExecutor js = (JavascriptExecutor) oDriver;
				js.executeScript("arguments[0].setAttribute('style', arguments[1]);", oCurrentElement,
						"color: red; border: 3px solid red;");
				Thread.sleep(500);
				js.executeScript("arguments[0].setAttribute('style', arguments[1]);", oCurrentElement, "");
				Thread.sleep(500);
			}
		} else {
			/// Deepankar 0000459
			// NoSuchElementException e = new NoSuchElementException("Element search failed
			/// with method: \"" + sIdentifier + "\" and search Criteria: \"" +
			/// sIdentifierValue + "\"");
			// throw e;
		}

		// setDefaultContent();
	}

	/*
	 * --------------------------------------- START :
	 * getApiData---------------------------------------------- Function Name:
	 * getApiData Objective: A generic Function to get an API data from RESTAPI
	 * service. Date Created: Input: sTestCase = Test case ID sApiID = API ID to
	 * uniquely identifies input data to be select from API input excel. sTestData =
	 * File path of API input excel. Output: Created By: Manoj Bamnawat MOdified By:
	 * Mantis ID: 0001073 Revision History: Modified on: Comments:
	 * -----------------------------------------------------------------------------
	 * ----------------------------
	 */

	/*
	 * public String getApiData(String sTestCase, String sApiID, String sTestData)
	 * throws Exception { String sJSONOutput = ""; try { // Workbook
	 * apiWorkBookData=null; Workbook APIConnectionExcelWorkBookData=null; String
	 * sConnectionStringName=null,sURLName=null,sMethodName=null,sHeadersName=null,
	 * sParamName=null, sBody=null, sBaseURL = null, sUserName = null, sPassword =
	 * null; List<String> resultSet=null; List<String> rsDBExcel = null; APiService
	 * object = null;
	 * 
	 * // apiWorkBookData = ExcelConnection.funExcelConnection(sTestData); //
	 * List<List<String>> data= ExcelConnection.funGetSheetData(apiWorkBookData,
	 * "API_Details"); // Map<String, Integer>
	 * columnData=ExcelConnection.funGetSheetColumns(apiWorkBookData,"API_Details");
	 * 
	 * -------------Mantis: 0001172---------------
	 * 
	 * String JsonData = ExcelConnection.getApiDetailsJsonFromDB(sTestData);
	 * List<List<String>> data=
	 * ExcelConnection.getSheetDataFromJSON(JsonData,"API_Details"); Map<String,
	 * Integer>
	 * columnData=ExcelConnection.getColumnNamesFromJson(JsonData,"API_Details");
	 * 
	 * -------------Mantis: 0001172---------------
	 * 
	 * int testCaseColIndex=ExcelConnection.funGetColumnIndex("Test_Case",
	 * columnData); int apiIDColIndex=ExcelConnection.funGetColumnIndex("API_ID",
	 * columnData); int
	 * taregtRow=ExcelConnection.funGetExecutionDataRecordNumber(testCaseColIndex,
	 * apiIDColIndex,sTestCase,sApiID,data); if(taregtRow==-1) { throw new
	 * Exception("GetApiData Could not find data for testcase :" + sTestCase +
	 * " and for ApiID :" + sApiID); }
	 * 
	 * resultSet = new ArrayList<String>();
	 * 
	 * for(int i=0;i<columnData.size();i++) {
	 * resultSet.add(data.get(taregtRow).get(i)); }
	 * 
	 * sConnectionStringName=resultSet.get(ExcelConnection.funGetColumnIndex(
	 * APIConnectionsColumnHeader.CONNECTIONNAME.toString(), columnData));
	 * if(sConnectionStringName!=null) { // String sCurrentDir =
	 * System.getProperty("user.dir"); // String sFileName
	 * =sCurrentDir+"/Master_Data/APIConnections.xlsx"; //
	 * APIConnectionExcelWorkBookData =
	 * ExcelConnection.funExcelConnection(sFileName); // List<List<String>>
	 * DBExcelData= ExcelConnection.funGetSheetData(APIConnectionExcelWorkBookData,
	 * "connection"); // Map<String, Integer>
	 * DBExcelColumnData=ExcelConnection.funGetSheetColumns(
	 * APIConnectionExcelWorkBookData,"connection");
	 * 
	 * List<List<String>> DBExcelData= ExcelConnection.readAPIConnections();
	 * Map<String, Integer>
	 * DBExcelColumnData=ExcelConnection.getMasterDataFileColumns("APIConnections");
	 * int connectionNameColumnIndex=
	 * ExcelConnection.funGetColumnIndex(APIConnectionsColumnHeader.CONNECTIONNAME.
	 * toString(), DBExcelColumnData); int
	 * connectionTargetRow=ExcelConnection.funGetTestDataRecordNumber(
	 * connectionNameColumnIndex,sConnectionStringName,DBExcelData);
	 * 
	 * rsDBExcel = new ArrayList<String>();
	 * 
	 * for(int i=0;i<DBExcelColumnData.size();i++) {
	 * rsDBExcel.add(DBExcelData.get(connectionTargetRow).get(i)); }
	 * 
	 * sBaseURL=rsDBExcel.get(ExcelConnection.funGetColumnIndex(
	 * APIConnectionsColumnHeader.BASEURL.toString(), DBExcelColumnData));
	 * sUserName=rsDBExcel.get(ExcelConnection.funGetColumnIndex(
	 * APIConnectionsColumnHeader.USERNAME.toString(), DBExcelColumnData));
	 * sPassword=rsDBExcel.get(ExcelConnection.funGetColumnIndex(
	 * APIConnectionsColumnHeader.PASSWORD.toString(), DBExcelColumnData));
	 * 
	 * sURLName=resultSet.get(ExcelConnection.funGetColumnIndex("URL", columnData));
	 * 
	 * if(sURLName!=null) {
	 * sMethodName=resultSet.get(ExcelConnection.funGetColumnIndex("Method",
	 * columnData)); if(sMethodName!=null) {
	 * sHeadersName=resultSet.get(ExcelConnection.funGetColumnIndex("Headers",
	 * columnData)); if(sHeadersName!=null) {
	 * sParamName=resultSet.get(ExcelConnection.funGetColumnIndex("ParamName",
	 * columnData)); sBody=resultSet.get(ExcelConnection.funGetColumnIndex("Body",
	 * columnData)); if(sBody.contains("#")) //Mantis 0001149 { int
	 * startindex=sBody.indexOf("#"); int lastindex=sBody.lastIndexOf("#"); String
	 * colname=sBody.substring(startindex,lastindex+1).replaceAll("#", ""); String
	 * colvalue=dynamicSet(sTestCase, colname); sBody=sBody.replaceAll(colname,
	 * colvalue).replaceAll("#", ""); }
	 * apiparam=resultSet.get(ExcelConnection.funGetColumnIndex("API_Parameter",
	 * columnData)); testdataparam=resultSet.get(ExcelConnection.funGetColumnIndex(
	 * "TestData_Parameter", columnData));
	 * 
	 * 
	 * object = new APiService(); try { sJSONOutput = object.invokeApi(sURLName,
	 * sMethodName, sHeadersName, sParamName, sBody, sBaseURL, sUserName,
	 * sPassword); } catch (Throwable e) { e.printStackTrace(); throw new
	 * Exception("Unexpected exeption occures in JLL_GetAPI library."); }
	 * 
	 * } else { Exception e = new Exception("Headers should not be blank."); throw
	 * e; } } else { Exception e = new Exception("Method name not Provided."); throw
	 * e; } } else { Exception e = new Exception("Api URL not specified."); throw e;
	 * } } else { Exception e = new
	 * Exception("Connection String Name Not Specified"); throw e; } }
	 * catch(Exception e) { debugLog("GetApiData", e.getMessage());
	 * e.printStackTrace(); throw e; }
	 * 
	 * return sJSONOutput; }
	 */

	/*
	 * --------------------------------------- START :
	 * transformData---------------------------------------------- Function Name:
	 * transformData Objective: A custom Function for JLL to transform property API
	 * data in UI data format. Date Created: Input: sData = JSON Data which is
	 * getting from API sTestStepData = Data to uniquely identifies cusotmize data
	 * in "CustomizeData.xlsx" Output: Created By: Manoj Bamnawat MOdified By:
	 * Mantis ID: 0001073 Revision History: Modified on: Comments:
	 * -----------------------------------------------------------------------------
	 * ----------------------------
	 */

	public String transformData(String sData, String sTestStepData) throws Exception {
		String sJSONPropertyStrings = "";
		StringBuilder sJSON;
		String childParameters[] = null;
		List<List<String>> sJsonArrayList = null;
		List<String> sJsonObjectList = null;

		String sCurrentDir = System.getProperty("user.dir");
		// String sFileName =sCurrentDir+"/Master_Data/CustomizeData.xlsx";
		String sType = null, sCustParameter = null, sFormat = null;

		// File f = new File(sFileName);
		// Workbook workbookCustData = null;
		Map<String, Integer> columnsCustData;
		List<List<String>> resultSetCustData;
		// if(f.exists())
		// {
		// workbookCustData=ExcelConnection.funExcelConnection(sFileName);
		// columnsCustData=ExcelConnection.funGetSheetColumns(workbookCustData,
		// "Customize");
		// resultSetCustData=ExcelConnection.funGetSheetData(workbookCustData,
		// "Customize");

		columnsCustData = ExcelConnection.getMasterDataFileColumns("CustomizeData");
		resultSetCustData = ExcelConnection.readCustomizeData();

		int nameIndex = ExcelConnection.funGetColumnIndex(CustomizeDataColumnHeader.NAME.toString(), columnsCustData);
		int recordNumberDynData = ExcelConnection.funGetDynamicDataRecordNumber(nameIndex, sTestStepData,
				resultSetCustData);

		if (recordNumberDynData != -1) {
			if (columnsCustData.containsKey(CustomizeDataColumnHeader.TYPE.toString())) {
				sType = resultSetCustData.get(recordNumberDynData)
						.get(columnsCustData.get(CustomizeDataColumnHeader.TYPE.toString()));
			} else {
				NoSuchFieldException e = new NoSuchFieldException("Column \"Type\" does not exist in CustomizeData");
				throw e;
			}
			if (columnsCustData.containsKey(CustomizeDataColumnHeader.PARAMETER.toString())) {
				sCustParameter = resultSetCustData.get(recordNumberDynData)
						.get(columnsCustData.get(CustomizeDataColumnHeader.PARAMETER.toString()));
			} else {
				NoSuchFieldException e = new NoSuchFieldException(
						"Column \"Parameter\" does not exist in CustomizeData");
				throw e;
			}

			if (sCustParameter != null) {
				if (columnsCustData.containsKey(CustomizeDataColumnHeader.FORMAT.toString())) {
					sFormat = resultSetCustData.get(recordNumberDynData)
							.get(columnsCustData.get(CustomizeDataColumnHeader.FORMAT.toString()));
				} else {
					NoSuchFieldException e = new NoSuchFieldException(
							"Column \"Format\" does not exist in CustomizeData");
					throw e;
				}
			} else {
				throw new Exception("\"Parameter\" column should not be blank.");
			}
		} else {
			NoSuchFieldException e = new NoSuchFieldException("Element not found in the Name column list");
			throw e;
		}
		// }// if closes
		// else
		// {
		// NoSuchFileException e=new NoSuchFileException("File "+sFileName+" does not
		// exist");
		// throw e;
		// }
		// workbookCustData.close();

		if (sData != null && sData != "") {
			sJsonArrayList = getDataFromAPI(sData, sCustParameter);

			String sParameters[] = sCustParameter.split("\\|");
			String columnName = "";
			for (int i = 0; i < sParameters.length; i++) {
				if (sParameters[i].contains(",")) {
					childParameters = sParameters[i].split(",");
					for (int j = 0; j < childParameters.length; j++) {
						columnName = columnName + childParameters[j].trim();
					}
				}
			}

			List<LinkedHashMap<String, String>> sFinalJSON_ArrayList = new ArrayList<LinkedHashMap<String, String>>();
			LinkedHashMap<String, String> sFinalJSON_Object;

			for (int i = 0; i < sJsonArrayList.size(); i++) {
				sJsonObjectList = sJsonArrayList.get(i);

				if (childParameters.length == sJsonObjectList.size()) {
					sFinalJSON_Object = new LinkedHashMap<String, String>();
					for (int j = 0; j < sJsonObjectList.size(); j++) {
						sFinalJSON_Object.put(childParameters[j].trim(), sJsonObjectList.get(j));
					}
					sFinalJSON_ArrayList.add(sFinalJSON_Object);
				}
			}

			sJSON = new StringBuilder();
			sJSON.append("[");
			LinkedHashMap<String, String> sTempJSON_Object = null;
			List<String> keySet;

			String sFormatParts[] = sFormat.split("\\+");

			for (int i = 0; i < sFinalJSON_ArrayList.size(); i++) {
				String data = "";
				sJSON.append("{");
				sTempJSON_Object = sFinalJSON_ArrayList.get(i);
				keySet = new ArrayList<String>(sTempJSON_Object.keySet());

				for (int j = 0; j < sFormatParts.length; j++) {
					if (!sFormatParts[j].contains("\"")) {
						if (sFormatParts[j].contains("%SF%")) {
							String SF = sFormatParts[j].substring(0, sFormatParts[j].lastIndexOf("%") + 1);
							for (int k = 0; k < sTempJSON_Object.size(); k++) {
								if (keySet.get(k).equals(sFormatParts[j]
										.substring(sFormatParts[j].lastIndexOf("%") + 1, sFormatParts[j].length())
										.trim())) {
									data = data + getAbbreviation(SF + sTempJSON_Object.get(keySet.get(k)));
									break;
								}
							}
						} else {
							for (int k = 0; k < sTempJSON_Object.size(); k++) {
								String sAttributeValue = sTempJSON_Object.get(keySet.get(k));
								if (keySet.get(k).equals(sFormatParts[j].trim())) {
									if (keySet.get(k).trim().equalsIgnoreCase("propertyName")) // Mantis 0001101
									{
										if (sAttributeValue.contains("Boulevard"))
											sAttributeValue = sAttributeValue.replace("Boulevard", "Blvd");
										if (sAttributeValue.contains("East"))
											sAttributeValue = sAttributeValue.replace("East", "E");
										if (sAttributeValue.contains("Street"))
											sAttributeValue = sAttributeValue.replace("Street", "St");
									}

									data = data + sAttributeValue;
									break;
								}
							}
						}
					} else {
						data = data + sFormatParts[j].trim().substring(1, sFormatParts[j].length() - 1);
					}
				}

				sJSON.append("\"").append(columnName).append("\"").append(":").append("\"").append(data).append("\"")
				.append("},");
			}
			sJSON.deleteCharAt(sJSON.length() - 1).append("]");
			sJSONPropertyStrings = sJSON.toString();

		}
		System.out.println("Modified JSON Data:" + sJSONPropertyStrings);
		sPropertyTransFormStaus = true; // Mantis 0001098
		return sJSONPropertyStrings;
	}

	/*
	 * --------------------------------------- START :
	 * transformAvilabilityData----------------------------------------------
	 * Function Name: transformAvilabilityData Objective: A custom Function for JLL
	 * to transform Availability API data in UI data format. Date Created: Input:
	 * sData = JSON Data which is getting from API sTestStepData = Data to uniquely
	 * identifies cusotmize data in "CustomizeData.xlsx" Output: Created By: Manoj
	 * Bamnawat MOdified By: Mantis ID: 0001073 Revision History: Modified on:
	 * Comments:
	 * -----------------------------------------------------------------------------
	 * ----------------------------
	 */

	public String transformAvilabilityData(String sData, String sTestStepData) throws Exception {
		String sJSONPropertyStrings = "";
		StringBuilder sJSON;
		String childParameters[] = null;
		List<List<String>> sJsonArrayList = null;
		List<String> sJsonObjectList = null;

		// String sCurrentDir = System.getProperty("user.dir");
		// String sFileName =sCurrentDir+"/Master_Data/CustomizeData.xlsx";
		String sType = null, sCustParameter = null, sFormat = null;

		// File f = new File(sFileName);
		// Workbook workbookCustData = null;
		Map<String, Integer> columnsCustData;
		List<List<String>> resultSetCustData;
		// if(f.exists())
		// {
		// workbookCustData=ExcelConnection.funExcelConnection(sFileName);
		// columnsCustData=ExcelConnection.funGetSheetColumns(workbookCustData,
		// "Customize");
		// resultSetCustData=ExcelConnection.funGetSheetData(workbookCustData,
		// "Customize");

		columnsCustData = ExcelConnection.getMasterDataFileColumns("CustomizeData");
		resultSetCustData = ExcelConnection.readCustomizeData();
		int nameIndex = ExcelConnection.funGetColumnIndex(CustomizeDataColumnHeader.NAME.toString(), columnsCustData);
		int recordNumberDynData = ExcelConnection.funGetDynamicDataRecordNumber(nameIndex, sTestStepData,
				resultSetCustData);

		if (recordNumberDynData != -1) {
			if (columnsCustData.containsKey(CustomizeDataColumnHeader.TYPE.toString())) {
				sType = resultSetCustData.get(recordNumberDynData)
						.get(columnsCustData.get(CustomizeDataColumnHeader.TYPE.toString()));
			} else {
				NoSuchFieldException e = new NoSuchFieldException("Column \"Type\" does not exist in CustomizeData");
				throw e;
			}
			if (columnsCustData.containsKey(CustomizeDataColumnHeader.PARAMETER.toString())) {
				sCustParameter = resultSetCustData.get(recordNumberDynData)
						.get(columnsCustData.get(CustomizeDataColumnHeader.PARAMETER.toString()));
			} else {
				NoSuchFieldException e = new NoSuchFieldException(
						"Column \"Parameter\" does not exist in CustomizeData");
				throw e;
			}

			if (sCustParameter != null) {
				if (columnsCustData.containsKey(CustomizeDataColumnHeader.FORMAT.toString())) {
					sFormat = resultSetCustData.get(recordNumberDynData)
							.get(columnsCustData.get(CustomizeDataColumnHeader.FORMAT.toString()));
				} else {
					NoSuchFieldException e = new NoSuchFieldException(
							"Column \"Format\" does not exist in CustomizeData");
					throw e;
				}
			} else {
				throw new Exception("\"Parameter\" column should not be blank.");
			}
		} else {
			NoSuchFieldException e = new NoSuchFieldException("Element not found in the Name column list");
			throw e;
		}
		// }// if closes
		// else
		// {
		// NoSuchFileException e=new NoSuchFileException("File "+sFileName+" does not
		// exist");
		// throw e;
		// }
		// workbookCustData.close();

		if (sData != null && sData != "") {
			sJsonArrayList = getDataFromAPI(sData, sCustParameter);

			String sParameters[] = sCustParameter.split("\\|");
			String columnName = "";
			for (int i = 0; i < sParameters.length; i++) {
				if (sParameters[i].contains(",")) {
					childParameters = sParameters[i].split(",");
					for (int j = 0; j < childParameters.length; j++) {
						columnName = columnName + childParameters[j].trim();
					}
				}
			}

			List<LinkedHashMap<String, String>> sFinalJSON_ArrayList = new ArrayList<LinkedHashMap<String, String>>();
			LinkedHashMap<String, String> sFinalJSON_Object;

			for (int i = 0; i < sJsonArrayList.size(); i++) {
				sJsonObjectList = sJsonArrayList.get(i);

				if (childParameters.length == sJsonObjectList.size()) {
					sFinalJSON_Object = new LinkedHashMap<String, String>();
					for (int j = 0; j < sJsonObjectList.size(); j++) {
						if (sJsonObjectList.get(j).equals("") || sJsonObjectList.get(j).length() == 0) // Mantis 0001149
							sFinalJSON_Object.put(childParameters[j].trim(), nullapi);
						else
							sFinalJSON_Object.put(childParameters[j].trim(), sJsonObjectList.get(j));
					}
					sFinalJSON_ArrayList.add(sFinalJSON_Object);
				}
			}

			sJSON = new StringBuilder();
			sJSON.append("[");
			LinkedHashMap<String, String> sTempJSON_Object = null;
			List<String> keySet;
			String unitTextStatus = "false";
			String floorTextStatus = "false";

			String sFormatParts[] = sFormat.split("\\+");

			for (int i = 0; i < sFinalJSON_ArrayList.size(); i++) {
				unitTextStatus = "false";
				floorTextStatus = "false";
				String data = "";
				sJSON.append("{");
				sTempJSON_Object = sFinalJSON_ArrayList.get(i);
				keySet = new ArrayList<String>(sTempJSON_Object.keySet());

				for (int j = 0; j < sFormatParts.length; j++) {
					if (!sFormatParts[j].contains("\"")) {
						if (sFormatParts[j].contains("%SF%")) {
							String SF = sFormatParts[j].substring(0, sFormatParts[j].lastIndexOf("%") + 1);
							for (int k = 0; k < sTempJSON_Object.size(); k++) {
								if (keySet.get(k).equals(sFormatParts[j]
										.substring(sFormatParts[j].lastIndexOf("%") + 1, sFormatParts[j].length())
										.trim())) {
									data = data + getAbbreviation(SF + sTempJSON_Object.get(keySet.get(k)));
									break;
								}
							}
						} else if (sFormatParts[j].contains("$")) {
							for (int k = 0; k < sTempJSON_Object.size(); k++) {
								if (keySet.get(k).equals(sFormatParts[j]
										.substring(sFormatParts[j].lastIndexOf("$") + 1, sFormatParts[j].length())
										.trim())) {
									data = data + getNumberFormat(sFormatParts[j], sTempJSON_Object.get(keySet.get(k)));
									break;
								}
							}
						} else if (sFormatParts[j].contains("|")) {
							for (int k = 0; k < sTempJSON_Object.size(); k++) {
								if (keySet.get(k).equals("availabilityName")) {
									if (sTempJSON_Object.get(keySet.get(k)).contains("Ste")) {
										data = data + "Suite ";
										unitTextStatus = "true";
									} else {
										data = data + "Floor ";
										floorTextStatus = "true";
									}
									break;
								}
							}

							if (unitTextStatus.equalsIgnoreCase("true")) {
								data = data + sTempJSON_Object.get("unitText");
							} else if (floorTextStatus.equalsIgnoreCase("true")) {
								data = data + sTempJSON_Object.get("floorText");
							}
						} else {
							for (int k = 0; k < sTempJSON_Object.size(); k++) {
								if (keySet.get(k).equals(sFormatParts[j].trim())) {
									data = data + sTempJSON_Object.get(keySet.get(k));
									break;
								}
							}
						}
					} else {
						data = data + sFormatParts[j].trim().substring(1, sFormatParts[j].length() - 1);
					}
				}

				sJSON.append("\"").append(columnName).append("\"").append(":").append("\"").append(data).append("\"")
				.append("},");
			}
			sJSON.deleteCharAt(sJSON.length() - 1).append("]");
			sJSONPropertyStrings = sJSON.toString();
		}
		System.out.println("Modified JSON Data:" + sJSONPropertyStrings);
		sAvailabilityTransFormStaus = true;
		return sJSONPropertyStrings;
	}

	public String getDataFromElements(String sControlType, String sSearchCriteria, String sSearchText, int iInd)
			throws Exception // Mantis 0001098 ,0001073
	{
		String sData = new String();
		if (waitForElement(sSearchCriteria, sSearchText, iInd)) // Mantis 0000879
		{
			WebElement oCurrentElement = getElement(sControlType, sSearchCriteria, sSearchText, iInd);

			int i = 0;
			while (oCurrentElement == null && i < iStaleMaxCount) // Mantis 0000855
			{
				oCurrentElement = getElement(sControlType, sSearchCriteria, sSearchText, iInd);
				i++;
			}

			String CntlType = getControlType(oCurrentElement, sControlType); // Mantis 0000788

			if (oCurrentElement != null) {
				switch (CntlType.toLowerCase().trim()) // Mantis 0000788
				{
				case "webedit":
					sData = oCurrentElement.getAttribute("value");
					break;
				case "webradiogroup":
					if (oCurrentElement.isSelected())
						sData = "true";
					else
						sData = "false";
					break;
				case "weblist":
					Select clickThis = new Select(oCurrentElement);
					sData = clickThis.getFirstSelectedOption().getText();
					break;

				case "webbutton":
					sData = oCurrentElement.getText();
					if (sData == null) {
						sData = oCurrentElement.getAttribute("value");
					}
					break;

				case "webcheckbox":
					if (oCurrentElement.isSelected()) {
						sData = "True";
					} else {
						sData = "False";
					}
					break;

				default:
					systemouts("in default get function");
					sData = oCurrentElement.getText();
					break;
				}
			}

			return sData;
		} else {
			return null;
		}
	}

	/*
	 * --------------------------------------- START :
	 * verifyProperties---------------------------------------------- Function Name:
	 * verifyProperties Objective: A generic Function to verify a property which is
	 * appeard on UI with expected Property and generate custom report for the same.
	 * Date Created: Input: sControlType = Control Type of the object whose property
	 * has to be verified. sIdentifier = Identifier that uniquely identifies an
	 * object on application; e.g xpath, id etc sIdentifierValue = Value of an
	 * Identifier sVerifyProperty = Property of the object which has to be verified.
	 * iInd = Index of the object in case multiple objects have same text or id.
	 * Output: Created By: Manoj Bamnawat Modified By: Mantis ID : 0001097 Revision
	 * History: Modified on: Comments:
	 * -----------------------------------------------------------------------------
	 * ----------------------------------
	 */

	String verifyProperties(String sControlType, String sIdentifier, String sIdentifierValue, String sVerifyProperty,
			int iInd, String sData, String sFileName, String sSheetName) throws Exception {
		String sIdenVal = null;
		List<WebElement> oCurrentElements = null;
		String sStatus = "Fail";
		// JLL_Library Object = null;
		String sSuccessStatus = "No";
		int sDuplicateCount = 0, sRecordPosition = 0, sResultList = 0;

		// Object = new JLL_Library(oDriver,iCurrentContext,pageWait,frameWait);

		if (!sUIPropertyReportStatus) // Mantis 0001116
		{
			createReportExcelFile(sFileName, sSheetName,
					new ArrayList<String>(Arrays.asList("Property", "Property Address/Name", "Search Criteria",
							"Success on Aero", "Aero Results List(0/1/2/3)", "Aero results position(0,1,2,3)")));
			sUIPropertyReportStatus = true;
		}

		switch (sVerifyProperty.toLowerCase()) {
		case "text":

			if (waitForElements(lElementWait, sIdentifier, sIdentifierValue)) // Mantis 1758
			{
				oCurrentElements = getElements(sControlType, sIdentifier, sIdentifierValue);

				int i = 0;
				while (oCurrentElements == null && i < iStaleMaxCount) {
					oCurrentElements = getElements(sControlType, sIdentifier, sIdentifierValue);
					i++;
				}

				if (oCurrentElements != null && oCurrentElements.size() != 0) {
					/*
					 * if(!sUIPropertyReportStatus) { createReportExcelFile(sFileName,
					 * sSheetName,new
					 * ArrayList<String>(Arrays.asList("Property","Property Address/Name"
					 * ,"Search Criteria","Success on Aero","Aero Results List(0/1/2/3)"
					 * ,"Aero results position(0,1,2,3)"))); sUIPropertyReportStatus = true; }
					 */

					sResultList = oCurrentElements.size();

					for (int j = 0; j < oCurrentElements.size(); j++) {
						sIdenVal = oCurrentElements.get(j).getText();
						if (sIdenVal != null && sIdenVal.contains(sData)) {
							sStatus = "Pass";
							sActualValue = sIdenVal;
							sDuplicateCount++;

							if (sDuplicateCount == 1) {
								sRecordPosition = j + 1;

								if (sRecordPosition <= 3)
									sSuccessStatus = "Yes";
							} else
								sSuccessStatus = "No"; // Need to check this code again.
						}
					}

					if (sAeroPropertyFlag) {
						excelReportDebugLog(sFileName, sSheetName, Stream
								.concat(new ArrayList<String>(sSetData.values()).stream(), Stream.of(sForLoopVariable,
										sSuccessStatus, String.valueOf(sResultList), String.valueOf(sRecordPosition)))
								.collect(Collectors.toList()));
						sAeroPropertyFlag = false;
					} else {
						excelReportDebugLog(sFileName, sSheetName,
								Stream.concat(Stream.of("", ""), Stream.of(sForLoopVariable, sSuccessStatus,
										String.valueOf(sResultList), String.valueOf(sRecordPosition)))
								.collect(Collectors.toList()));
					}
					break;
				} else {
					sIdenVal = "";
					sActualValue = sIdenVal;

					if (sAeroPropertyFlag) {
						excelReportDebugLog(sFileName, sSheetName, Stream
								.concat(new ArrayList<String>(sSetData.values()).stream(), Stream.of(sForLoopVariable,
										sSuccessStatus, String.valueOf(sResultList), String.valueOf(sRecordPosition)))
								.collect(Collectors.toList()));
						sAeroPropertyFlag = false;
					} else {
						excelReportDebugLog(sFileName, sSheetName,
								Stream.concat(Stream.of("", ""), Stream.of(sForLoopVariable, sSuccessStatus,
										String.valueOf(sResultList), String.valueOf(sRecordPosition)))
								.collect(Collectors.toList()));
					}

				}
			} else {
				sIdenVal = "";
				sActualValue = sIdenVal;

				if (sAeroPropertyFlag) {
					excelReportDebugLog(sFileName, sSheetName,
							Stream.concat(new ArrayList<String>(sSetData.values()).stream(), Stream.of(sForLoopVariable,
									sSuccessStatus, String.valueOf(sResultList), String.valueOf(sRecordPosition)))
							.collect(Collectors.toList()));
					sAeroPropertyFlag = false;
				} else {
					excelReportDebugLog(sFileName, sSheetName,
							Stream.concat(Stream.of("", ""), Stream.of(sForLoopVariable, sSuccessStatus,
									String.valueOf(sResultList), String.valueOf(sRecordPosition)))
							.collect(Collectors.toList()));
				}
			}

			break;

		default:
			systemouts("Inside Default Property");
			/*
			 * if (waitForElement(sIdentifier,sIdentifierValue,iInd)) //Mantis 0000879 {
			 * oCurrentElement = getElement(sControlType,sIdentifier,sIdentifierValue,iInd);
			 * 
			 * sIdenVal=oCurrentElement.getAttribute(sVerifyProperty);
			 * 
			 * if(sIdenVal==null ) //Mantis 0000907 {
			 * if(sVerifyProperty.toLowerCase().equals("checked") ||
			 * sVerifyProperty.toLowerCase().equals("selected")) //For checkbox and radio
			 * button //Mantis 0000912 sIdenVal="false"; else sIdenVal=""; }
			 * 
			 * systemouts("Actual Property Value:"+sIdenVal);
			 * if(sIdenVal.equalsIgnoreCase(sData)) { sStatus="Pass"; }
			 * sActualValue=sIdenVal; } else { sStatus= "Fail"; }
			 */
			break;
		}

		return sStatus;
	}

	/*
	 * --------------------------------------- START :
	 * verifyAPIData---------------------------------------------- Function Name:
	 * verifyAPIData Objective: A generic Function to verify a particular property
	 * of an object with api data. Date Created: Input: sControlType = Control Type
	 * of the object whose property has to be verified. sIdentifier = Identifier
	 * that uniquely identifies an object on application; e.g xpath, id etc
	 * sIdentifierValue = Value of an Identifier sVerifyProperty = Property of the
	 * object which has to be verified. iInd = Index of the object in case multiple
	 * objects have same text or id. Output: Created By: Manoj Bamnawat Modified By:
	 * Mantis ID : 0001073 Revision History: Modified on: Comments:
	 * -----------------------------------------------------------------------------
	 * ----------------------------
	 */

	String verifyAPIData(String sTestCase, String sControlType, String sIdentifier, String sIdentifierValue, int iInd,
			String sVerifyProperty, String sData, String testStepData, String sheetName, String sFilename)
					throws Exception // Mantis 0001098
	{
		String sIdenVal = null;
		String sStatus = "Fail";
		boolean sReportFlag = true;
		List<List<String>> sJSONData = null;
		List<String> allStatus;
		int sExpectedAvailsCount; // Mantis 0001098

		// JLL_Library Object = null;

		if (sData != null && sData != "")
			sJSONData = funGetDataFromJSON(sData);

		System.out.println("-------JSON Data Before verification-------");
		System.out.println(sJSONData);

		List<WebElement> oCurrentElements = null;
		String status = "FAIL", expectedData = "", actualData = "", sAvailStatus = "FAIL", UI_AvailsCount = "0",
				API_AvailsCount = "0"; // Mantis 0001103

		// Object = new JLL_Library(oDriver,iCurrentContext,pageWait,frameWait);
		allStatus = new ArrayList<String>();

		if (sAvailabilityTransFormStaus) // This block for Availability
		{
			sExpectedAvailsCount = Integer.valueOf(sSetData.get("Expected")); // Mantis 0001098

			switch (sVerifyProperty.toLowerCase()) {
			case "text":

				if (waitForElements(lElementWait, sIdentifier, sIdentifierValue)) // Mantis 1758
				{
					oCurrentElements = getElements(sControlType, sIdentifier, sIdentifierValue);

					UI_AvailsCount = String.valueOf(oCurrentElements.size()); // Mantis 0001098

					if (oCurrentElements != null && oCurrentElements.size() != 0 && sJSONData != null) {
						API_AvailsCount = String.valueOf(sJSONData.size()); // Mantis 0001098

						if ((oCurrentElements.size() == sExpectedAvailsCount)
								&& (sJSONData.size() == sExpectedAvailsCount)) // Mantis 0001098
							sAvailStatus = "PASS";

						if (!sAvailabilityReportStatus) // Mantis 0001098
						{
							// createReportExcelFile(sFilename, sheetName,new
							// ArrayList<String>(Arrays.asList("TestCase","Input","ExpectedNumAvails","UI_AvailsCount","API_AvailsCount","Status","API_DATA","UI_DATA")));
							createReportExcelFile(sFilename, sheetName,
									new ArrayList<String>(Arrays.asList("TestCase", "Input",
											"DataTeam_InfoFile_AvailsPerMkt", "Aero_UI_AvailsCount",
											"ODS_API_AvailsCount", "Status", "ODS_API_DATA", "Aero_UI_DATA"))); // Mantis
							// 0001151
							sAvailabilityReportStatus = true;
						}

						if (oCurrentElements.size() >= sJSONData.size()) {
							if (oCurrentElements.size() == sJSONData.size()) {
								oFunctionLog.setTestStepDetails(sTestCase, "", String.valueOf(sJSONData.size()),
										String.valueOf(oCurrentElements.size()), "Pass", sUserAction,
										sStepDescription + "=>>Rows matched", "", sWebPagePath); // Mantis 0001221
							} else {
								oFunctionLog.setTestStepDetails(sTestCase, "", String.valueOf(sJSONData.size()),
										String.valueOf(oCurrentElements.size()), "Fail", sUserAction,
										sStepDescription + "=>>Rows mismatched", "", sWebPagePath); // Mantis 0001221
							}
							for (int i = 0; i < oCurrentElements.size(); i++) {
								actualData = "";
								expectedData = "";
								int k = -1;
								status = "Fail";
								sIdenVal = oCurrentElements.get(i).getText();
								actualData = sIdenVal;

								for (int j = 0; j < sJSONData.size(); j++) {
									if (sIdenVal.contains(sJSONData.get(j).get(0))) // Need to improve code here
									{
										k = j;
										status = "Pass";
										expectedData = sJSONData.get(j).get(0); // Need to improve code here
										sJSONData.remove(j);
										if (sReportFlag) // Mantis 0001098
										{
											excelReportDebugLog(sFilename, sheetName,
													Stream.concat(
															Stream.concat(Stream.of(sTestCase),
																	new ArrayList<String>(sSetData.values()).stream()),
															Stream.of(UI_AvailsCount, API_AvailsCount, sAvailStatus,
																	expectedData, actualData)) // Mantis 0001103
													.collect(Collectors.toList()));
											sReportFlag = false;
										} else {
											excelReportDebugLog(sFilename, sheetName,
													Stream.concat(
															Stream.concat(Stream.of(""),
																	new ArrayList<String>(
																			Arrays.asList("", "", "", "", ""))
																	.stream()),
															Stream.of(expectedData, actualData))
													.collect(Collectors.toList()));
										}
										break;
									}

								}
								if (k == -1) {
									if (!sAvailabilityReportStatus) // Mantis 0001098
									{
										// createReportExcelFile(sFilename, sheetName,new
										// ArrayList<String>(Arrays.asList("TestCase","Input","ExpectedNumAvails","UI_AvailsCount","API_AvailsCount","Status","API_DATA","UI_DATA")));
										createReportExcelFile(sFilename, sheetName,
												new ArrayList<String>(Arrays.asList("TestCase", "Input",
														"DataTeam_InfoFile_AvailsPerMkt", "Aero_UI_AvailsCount",
														"ODS_API_AvailsCount", "Status", "ODS_API_DATA",
														"Aero_UI_DATA"))); // Mantis 0001151
										sAvailabilityReportStatus = true;
									}
									if (sReportFlag) {
										excelReportDebugLog(sFilename, sheetName,
												Stream.concat(
														Stream.concat(Stream.of(sTestCase),
																new ArrayList<String>(sSetData.values()).stream()),
														Stream.of(UI_AvailsCount, API_AvailsCount, sAvailStatus,
																"Data not found in API", actualData))
												.collect(Collectors.toList()));
										sReportFlag = false;
									} else {
										excelReportDebugLog(sFilename, sheetName,
												Stream.concat(
														Stream.concat(Stream.of(""),
																new ArrayList<String>(Arrays.asList("", "", "", "", ""))
																.stream()),
														Stream.of("Data not found in API", actualData))
												.collect(Collectors.toList()));
									}

									oFunctionLog.setTestStepDetails(sTestCase, "", expectedData, actualData, status,
											sUserAction,
											sStepDescription + "=>Data found in UI at row number  "
													+ String.valueOf(i + 1) + " but same data is not found in API",
													"", sWebPagePath); // Mantis 0001221
								} else
									oFunctionLog.setTestStepDetails(sTestCase, "", expectedData, actualData, status,
											sUserAction,
											sStepDescription + "=>Row number " + String.valueOf(i + 1)
											+ " of UI matched with row number " + String.valueOf(k + 1)
											+ " of API output",
											"", sWebPagePath); // Mantis 0001221
								allStatus.add(status);
							}
							// This checks remaining mismatched data of API
							if (sJSONData.size() != 0) {
								for (int i = 0; i < sJSONData.size(); i++) {
									if (sReportFlag) {
										excelReportDebugLog(sFilename, sheetName,
												Stream.concat(
														Stream.concat(Stream.of(sTestCase),
																new ArrayList<String>(sSetData.values()).stream()),
														Stream.of(UI_AvailsCount, API_AvailsCount, sAvailStatus,
																sJSONData.get(i).get(0), "Data not found in UI"))
												.collect(Collectors.toList()));
										sReportFlag = false;
									} else {
										excelReportDebugLog(sFilename, sheetName,
												Stream.concat(
														Stream.concat(Stream.of(""),
																new ArrayList<String>(Arrays.asList("", "", "", "", ""))
																.stream()),
														Stream.of(sJSONData.get(i).get(0), "Data not found in UI"))
												.collect(Collectors.toList()));
									}
								}
							}
						} else {
							oFunctionLog.setTestStepDetails(sTestCase, "", String.valueOf(sJSONData.size()),
									String.valueOf(oCurrentElements.size()), "Fail", sUserAction,
									sStepDescription + "=>>Rows mismatched", "", sWebPagePath); // Mantis 0001221

							for (int i = 0; i < sJSONData.size(); i++) {
								actualData = "";
								expectedData = "";
								int k = -1;
								status = "Fail";
								expectedData = sJSONData.get(i).get(0);

								for (int j = 0; j < oCurrentElements.size(); j++) {
									sIdenVal = oCurrentElements.get(j).getText();

									if (sIdenVal.contains(expectedData)) {
										k = j;
										status = "Pass";
										actualData = sIdenVal;
										oCurrentElements.remove(j); // Added for Removing matched data of UI
										if (sReportFlag) {
											excelReportDebugLog(sFilename, sheetName,
													Stream.concat(
															Stream.concat(Stream.of(sTestCase),
																	new ArrayList<String>(sSetData.values()).stream()),
															Stream.of(UI_AvailsCount, API_AvailsCount, sAvailStatus,
																	expectedData, actualData))
													.collect(Collectors.toList()));
											sReportFlag = false;
										} else {
											excelReportDebugLog(sFilename, sheetName,
													Stream.concat(
															Stream.concat(Stream.of(""),
																	new ArrayList<String>(
																			Arrays.asList("", "", "", "", ""))
																	.stream()),
															Stream.of(expectedData, actualData))
													.collect(Collectors.toList()));
										}
										break;
									}
								}
								if (k == -1) {
									if (!sAvailabilityReportStatus) // Mantis 0001098
									{
										// createReportExcelFile(sFilename, sheetName,new
										// ArrayList<String>(Arrays.asList("TestCase","Input","ExpectedNumAvails","UI_AvailsCount","API_AvailsCount","Status","API_DATA","UI_DATA")));
										createReportExcelFile(sFilename, sheetName,
												new ArrayList<String>(Arrays.asList("TestCase", "Input",
														"DataTeam_InfoFile_AvailsPerMkt", "Aero_UI_AvailsCount",
														"ODS_API_AvailsCount", "Status", "ODS_API_DATA",
														"Aero_UI_DATA"))); // Mantis 0001151
										sAvailabilityReportStatus = true;
									}
									if (sReportFlag) // Mantis 0001098
									{
										excelReportDebugLog(sFilename, sheetName,
												Stream.concat(
														Stream.concat(Stream.of(sTestCase),
																new ArrayList<String>(sSetData.values()).stream()),
														Stream.of(UI_AvailsCount, API_AvailsCount, sAvailStatus,
																expectedData, "Data not found in UI"))
												.collect(Collectors.toList()));
										sReportFlag = false;
									} else {
										excelReportDebugLog(sFilename, sheetName,
												Stream.concat(
														Stream.concat(Stream.of(""),
																new ArrayList<String>(Arrays.asList("", "", "", "", ""))
																.stream()),
														Stream.of(expectedData, "Data not found in UI"))
												.collect(Collectors.toList()));
									}
									oFunctionLog.setTestStepDetails(sTestCase, "", expectedData, actualData, status,
											sUserAction,
											sStepDescription + "=>Data found in API at row number  "
													+ String.valueOf(i + 1) + " but same data is not found in UI",
													"", sWebPagePath); // MAntis 0001221
								} else
									oFunctionLog.setTestStepDetails(sTestCase, "", expectedData, actualData, status,
											sUserAction,
											sStepDescription + "=>Row number " + String.valueOf(k + 1)
											+ " of UI matched with row number " + String.valueOf(i + 1)
											+ " of API output",
											"", sWebPagePath); // MAntis 0001221
								allStatus.add(status);
							}
							// This checks remaining mismatched data of UI
							if (oCurrentElements.size() != 0) {
								for (int i = 0; i < oCurrentElements.size(); i++) {
									if (sReportFlag) // Mantis 0001098
									{
										excelReportDebugLog(sFilename, sheetName, Stream.concat(
												Stream.concat(Stream.of(sTestCase),
														new ArrayList<String>(sSetData.values()).stream()),
												Stream.of(UI_AvailsCount, API_AvailsCount, sAvailStatus,
														"Data not found in API", oCurrentElements.get(i).getText()))
												.collect(Collectors.toList()));
										sReportFlag = false;
									} else {
										excelReportDebugLog(sFilename, sheetName, Stream
												.concat(Stream.concat(Stream.of(""),
														new ArrayList<String>(Arrays.asList("", "", "", "", ""))
														.stream()),
														Stream.of("Data not found in API",
																oCurrentElements.get(i).getText()))
												.collect(Collectors.toList()));
									}
								}
							}
						}
					} else {
						if (sJSONData == null && (oCurrentElements == null || oCurrentElements.size() == 0)) {
							/*------Mantis 0001103------*/
							if ((Integer.parseInt(UI_AvailsCount) == sExpectedAvailsCount)
									&& (Integer.parseInt(API_AvailsCount) == sExpectedAvailsCount)) // Mantis 0001098
								sAvailStatus = "PASS";

							if (!sAvailabilityReportStatus) // Mantis 0001098
							{
								// createReportExcelFile(sFilename, sheetName,new
								// ArrayList<String>(Arrays.asList("TestCase","Input","ExpectedNumAvails","UI_AvailsCount","API_AvailsCount","Status","API_DATA","UI_DATA")));
								createReportExcelFile(sFilename, sheetName,
										new ArrayList<String>(Arrays.asList("TestCase", "Input",
												"DataTeam_InfoFile_AvailsPerMkt", "Aero_UI_AvailsCount",
												"ODS_API_AvailsCount", "Status", "ODS_API_DATA", "Aero_UI_DATA"))); // Mantis
								// 0001151
								sAvailabilityReportStatus = true;
							}
							if (sReportFlag) // Mantis 0001098
							{
								excelReportDebugLog(sFilename, sheetName,
										Stream.concat(
												Stream.concat(Stream.of(sTestCase),
														new ArrayList<String>(sSetData.values()).stream()),
												Stream.of(UI_AvailsCount, API_AvailsCount, sAvailStatus,
														"Data not found in API", "Data not found in UI"))
										.collect(Collectors.toList()));
								sReportFlag = false;
							} else {
								excelReportDebugLog(sFilename, sheetName,
										Stream.concat(
												Stream.concat(Stream.of(""),
														new ArrayList<String>(Arrays.asList("", "", "", "", ""))
														.stream()),
												Stream.of("Data not found in API", "Data not found in UI"))
										.collect(Collectors.toList()));
							}
							/*------Mantis 0001103------*/
							sStepDescription = sStepDescription
									+ "=>VerifyAPIData could not find Expected data from JSON Output as well as UI Data";
							status = "Pass";
						} else {
							if (sJSONData == null) {
								System.out.println("Inside if JSONDATA is null--------");

								if ((oCurrentElements.size() == sExpectedAvailsCount)
										&& (Integer.parseInt(API_AvailsCount) == sExpectedAvailsCount)) // Mantis
									// 0001098
									sAvailStatus = "PASS";

								if (!sAvailabilityReportStatus) // Mantis 0001098
								{
									// createReportExcelFile(sFilename, sheetName,new
									// ArrayList<String>(Arrays.asList("TestCase","Input","ExpectedNumAvails","UI_AvailsCount","API_AvailsCount","Status","API_DATA","UI_DATA")));
									createReportExcelFile(sFilename, sheetName,
											new ArrayList<String>(Arrays.asList("TestCase", "Input",
													"DataTeam_InfoFile_AvailsPerMkt", "Aero_UI_AvailsCount",
													"ODS_API_AvailsCount", "Status", "ODS_API_DATA", "Aero_UI_DATA"))); // Mantis
									// 0001151
									sAvailabilityReportStatus = true;
								}

								if (oCurrentElements.size() != 0) {
									for (int i = 0; i < oCurrentElements.size(); i++) {
										if (sReportFlag) // Mantis 0001098
										{
											excelReportDebugLog(sFilename, sheetName, Stream.concat(
													Stream.concat(Stream.of(sTestCase),
															new ArrayList<String>(sSetData.values()).stream()),
													Stream.of(UI_AvailsCount, API_AvailsCount, sAvailStatus,
															"Data not found in API", oCurrentElements.get(i).getText()))
													.collect(Collectors.toList()));
											sReportFlag = false;
										} else {
											excelReportDebugLog(sFilename, sheetName,
													Stream.concat(
															Stream.concat(Stream.of(""),
																	new ArrayList<String>(
																			Arrays.asList("", "", "", "", ""))
																	.stream()),
															Stream.of("Data not found in API",
																	oCurrentElements.get(i).getText()))
													.collect(Collectors.toList()));
										}
									}
								}
								sStepDescription = sStepDescription
										+ "=>VerifyAPIData could not find Expected data from JSON Output.";
							} else {
								System.out.println("Inside else if ObjectElement is null--------");

								if ((Integer.parseInt(UI_AvailsCount) == sExpectedAvailsCount)
										&& (sJSONData.size() == sExpectedAvailsCount)) // Mantis 0001103
									sAvailStatus = "PASS";

								API_AvailsCount = String.valueOf(sJSONData.size()); // Mantis 0001103

								if (!sAvailabilityReportStatus) // Mantis 0001098
								{
									// createReportExcelFile(sFilename, sheetName,new
									// ArrayList<String>(Arrays.asList("TestCase","Input","ExpectedNumAvails","UI_AvailsCount","API_AvailsCount","Status","API_DATA","UI_DATA")));
									createReportExcelFile(sFilename, sheetName,
											new ArrayList<String>(Arrays.asList("TestCase", "Input",
													"DataTeam_InfoFile_AvailsPerMkt", "Aero_UI_AvailsCount",
													"ODS_API_AvailsCount", "Status", "ODS_API_DATA", "Aero_UI_DATA"))); // Mantis
									// 0001151
									sAvailabilityReportStatus = true;
								}

								if (sJSONData.size() != 0) {
									for (int i = 0; i < sJSONData.size(); i++) {
										if (sReportFlag) // Mantis 0001098
										{
											excelReportDebugLog(sFilename, sheetName,
													Stream.concat(
															Stream.concat(Stream.of(sTestCase),
																	new ArrayList<String>(sSetData.values()).stream()),
															Stream.of(UI_AvailsCount, API_AvailsCount, sAvailStatus,
																	sJSONData.get(i).get(0), "Data not found in UI"))
													.collect(Collectors.toList()));
											sReportFlag = false;
										} else {
											excelReportDebugLog(sFilename, sheetName,
													Stream.concat(
															Stream.concat(Stream.of(""),
																	new ArrayList<String>(
																			Arrays.asList("", "", "", "", ""))
																	.stream()),
															Stream.of(sJSONData.get(i).get(0), "Data not found in UI"))
													.collect(Collectors.toList()));
										}
									}
								}
								sStepDescription = sStepDescription
										+ "=>VerifyAPIData could not find Actual data from UI.";
							}
							status = "Fail";
						}

						allStatus.add(status);
					}
				} else {
					/*------Mantis 0001103------*/
					if (sJSONData == null && oCurrentElements == null) {
						if ((Integer.parseInt(UI_AvailsCount) == sExpectedAvailsCount)
								&& (Integer.parseInt(API_AvailsCount) == sExpectedAvailsCount)) // Mantis 0001098
							sAvailStatus = "PASS";

						if (!sAvailabilityReportStatus) // Mantis 0001098
						{
							// createReportExcelFile(sFilename, sheetName,new
							// ArrayList<String>(Arrays.asList("TestCase","Input","ExpectedNumAvails","UI_AvailsCount","API_AvailsCount","Status","API_DATA","UI_DATA")));
							createReportExcelFile(sFilename, sheetName,
									new ArrayList<String>(Arrays.asList("TestCase", "Input",
											"DataTeam_InfoFile_AvailsPerMkt", "Aero_UI_AvailsCount",
											"ODS_API_AvailsCount", "Status", "ODS_API_DATA", "Aero_UI_DATA"))); // Mantis
							// 0001151
							sAvailabilityReportStatus = true;
						}
						if (sReportFlag) // Mantis 0001098
						{
							excelReportDebugLog(sFilename, sheetName,
									Stream.concat(
											Stream.concat(Stream.of(sTestCase),
													new ArrayList<String>(sSetData.values()).stream()),
											Stream.of(UI_AvailsCount, API_AvailsCount, sAvailStatus,
													"Data not found in API", "Data not found in UI"))
									.collect(Collectors.toList()));
							sReportFlag = false;
						} else {
							excelReportDebugLog(sFilename, sheetName,
									Stream.concat(
											Stream.concat(Stream.of(""),
													new ArrayList<String>(Arrays.asList("", "", "", "", "")).stream()),
											Stream.of("Data not found in API", "Data not found in UI"))
									.collect(Collectors.toList()));
						}

						sStepDescription = sStepDescription
								+ "=>VerifyAPIData could not find Expected data from JSON Output as well as UI Data";
						status = "Pass";
					} else {
						System.out.println("Inside else if waitForElements is failed--------");

						if ((Integer.parseInt(UI_AvailsCount) == sExpectedAvailsCount)
								&& (sJSONData.size() == sExpectedAvailsCount)) // Mantis 0001098
							sAvailStatus = "PASS";

						API_AvailsCount = String.valueOf(sJSONData.size());

						if (!sAvailabilityReportStatus) // Mantis 0001098
						{
							createReportExcelFile(sFilename, sheetName,
									new ArrayList<String>(Arrays.asList("TestCase", "Input",
											"DataTeam_InfoFile_AvailsPerMkt", "Aero_UI_AvailsCount",
											"ODS_API_AvailsCount", "Status", "ODS_API_DATA", "Aero_UI_DATA"))); // Mantis
							// 0001151
							// createReportExcelFile(sFilename, sheetName,new
							// ArrayList<String>(Arrays.asList("TestCase","Input","ExpectedNumAvails","UI_AvailsCount","API_AvailsCount","Status","API_DATA","UI_DATA")));
							sAvailabilityReportStatus = true;
						}

						if (sJSONData.size() != 0) {
							for (int i = 0; i < sJSONData.size(); i++) {
								if (sReportFlag) // Mantis 0001098
								{
									excelReportDebugLog(sFilename, sheetName,
											Stream.concat(
													Stream.concat(Stream.of(sTestCase),
															new ArrayList<String>(sSetData.values()).stream()),
													Stream.of(UI_AvailsCount, API_AvailsCount, sAvailStatus,
															sJSONData.get(i).get(0), "Data not found in UI"))
											.collect(Collectors.toList()));
									sReportFlag = false;
								} else {
									excelReportDebugLog(sFilename, sheetName,
											Stream.concat(
													Stream.concat(Stream.of(""),
															new ArrayList<String>(Arrays.asList("", "", "", "", ""))
															.stream()),
													Stream.of(sJSONData.get(i).get(0), "Data not found in UI"))
											.collect(Collectors.toList()));
								}
							}
						}
						sStepDescription = sStepDescription + "=>VerifyAPIData could not find Actual data from UI.";
					}
					/*------Mantis 0001103------*/

					status = "Fail";
					allStatus.add(status);
				}
				break;

			default:
				systemouts("Inside Default Property");
				break;
			}

			if (allStatus.contains("Fail"))
				sStatus = "Fail";
			else
				sStatus = "Pass";

			sAvailabilityTransFormStaus = false; // Mantis 0001098
		} else if (sPropertyTransFormStaus) // This else block for Property //Mantis 0001098
		{
			switch (sVerifyProperty.toLowerCase()) {
			case "text":

				if (waitForElements(lElementWait, sIdentifier, sIdentifierValue)) // Mantis 1758
				{
					oCurrentElements = getElements(sControlType, sIdentifier, sIdentifierValue);

					if (oCurrentElements != null && oCurrentElements.size() != 0 && sJSONData != null) {
						if (!sPropertyReportStatus) // Mantis 0001098
						{
							// createReportExcelFile(sFilename, sheetName,new
							// ArrayList<String>(Arrays.asList("TestCase","Input","API_DATA","UI_DATA")));
							createReportExcelFile(sFilename, sheetName, new ArrayList<String>(
									Arrays.asList("TestCase", "Input", "ODS_API_DATA", "Aero_UI_DATA"))); // Mantis
							// 0001151
							sPropertyReportStatus = true;
						}

						if (oCurrentElements.size() >= sJSONData.size()) {
							if (oCurrentElements.size() == sJSONData.size()) {
								oFunctionLog.setTestStepDetails(sTestCase, "", String.valueOf(sJSONData.size()),
										String.valueOf(oCurrentElements.size()), "Pass", sUserAction,
										sStepDescription + "=>>Rows matched", "", sWebPagePath); // Mantis 0001221
							} else {
								oFunctionLog.setTestStepDetails(sTestCase, "", String.valueOf(sJSONData.size()),
										String.valueOf(oCurrentElements.size()), "Fail", sUserAction,
										sStepDescription + "=>>Rows mismatched", "", sWebPagePath); // Mantis 0001221
							}
							for (int i = 0; i < oCurrentElements.size(); i++) {
								actualData = "";
								expectedData = "";
								int k = -1;
								status = "Fail";
								sIdenVal = oCurrentElements.get(i).getText();
								actualData = sIdenVal;

								for (int j = 0; j < sJSONData.size(); j++) {
									if (sIdenVal.equalsIgnoreCase(sJSONData.get(j).get(0))) // Need to improve code here
									{
										k = j;
										status = "Pass";
										expectedData = sJSONData.get(j).get(0); // Need to improve code here
										sJSONData.remove(j);
										if (sReportFlag) // Mantis 0001098
										{
											excelReportDebugLog(sFilename, sheetName,
													Stream.concat(
															Stream.concat(Stream.of(sTestCase),
																	new ArrayList<String>(sSetData.values()).stream()),
															Stream.of(expectedData, actualData))
													.collect(Collectors.toList()));
											sReportFlag = false;
										} else {
											excelReportDebugLog(sFilename, sheetName,
													Stream.concat(Stream.of("", ""),
															Stream.of(expectedData, actualData))
													.collect(Collectors.toList()));
										}
										break;
									}
								}
								if (k == -1) {
									if (!sPropertyReportStatus) // Mantis 0001098
									{
										createReportExcelFile(sFilename, sheetName, new ArrayList<String>(
												Arrays.asList("TestCase", "Input", "ODS_API_DATA", "Aero_UI_DATA"))); // Mantis
										// 0001151
										sPropertyReportStatus = true;
									}

									if (sReportFlag) // Mantis 0001098
									{
										excelReportDebugLog(sFilename, sheetName,
												Stream.concat(
														Stream.concat(Stream.of(sTestCase),
																new ArrayList<String>(sSetData.values()).stream()),
														Stream.of("Data not found in API", actualData))
												.collect(Collectors.toList()));
										sReportFlag = false;
									} else {
										excelReportDebugLog(sFilename, sheetName,
												Stream.concat(Stream.of("", ""),
														Stream.of("Data not found in API", actualData))
												.collect(Collectors.toList()));
									}

									oFunctionLog.setTestStepDetails(sTestCase, "", expectedData, actualData, status,
											sUserAction,
											sStepDescription + "=>Data found in UI at row number  "
													+ String.valueOf(i + 1) + " but same data is not found in API",
													"", sWebPagePath); // Mantis 0001221
								} else
									oFunctionLog.setTestStepDetails(sTestCase, "", expectedData, actualData, status,
											sUserAction,
											sStepDescription + "=>Row number " + String.valueOf(i + 1)
											+ " of UI matched with row number " + String.valueOf(k + 1)
											+ " of API output",
											"", sWebPagePath); // Mantis 0001221
								allStatus.add(status);
							}
							// This checks remaining mismatched data of API
							if (sJSONData.size() != 0) {
								for (int i = 0; i < sJSONData.size(); i++) {
									if (sReportFlag) // Mantis 0001098
									{
										excelReportDebugLog(sFilename, sheetName,
												Stream.concat(
														Stream.concat(Stream.of(sTestCase),
																new ArrayList<String>(sSetData.values()).stream()),
														Stream.of(sJSONData.get(i).get(0), "Data not found in UI"))
												.collect(Collectors.toList()));
										sReportFlag = false;
									} else {
										excelReportDebugLog(
												sFilename, sheetName, Stream
												.concat(Stream.of("", ""),
														Stream.of(sJSONData.get(i).get(0),
																"Data not found in UI"))
												.collect(Collectors.toList()));
									}
								}
							}
						} else {
							oFunctionLog.setTestStepDetails(sTestCase, "", String.valueOf(sJSONData.size()),
									String.valueOf(oCurrentElements.size()), "Fail", sUserAction,
									sStepDescription + "=>>Rows mismatched", "", sWebPagePath); // Mantis 0001221

							for (int i = 0; i < sJSONData.size(); i++) {
								actualData = "";
								expectedData = "";
								int k = -1;
								status = "Fail";
								expectedData = sJSONData.get(i).get(0);

								for (int j = 0; j < oCurrentElements.size(); j++) {
									sIdenVal = oCurrentElements.get(j).getText();

									if (sIdenVal.equalsIgnoreCase(expectedData)) {
										k = j;
										status = "Pass";
										actualData = sIdenVal;
										oCurrentElements.remove(j); // Added for Removing matched data of UI

										if (sReportFlag) // Mantis 0001098
										{
											excelReportDebugLog(sFilename, sheetName,
													Stream.concat(
															Stream.concat(Stream.of(sTestCase),
																	new ArrayList<String>(sSetData.values()).stream()),
															Stream.of(expectedData, actualData))
													.collect(Collectors.toList()));
											sReportFlag = false;
										} else {
											excelReportDebugLog(sFilename, sheetName,
													Stream.concat(Stream.of("", ""),
															Stream.of(expectedData, actualData))
													.collect(Collectors.toList()));
										}
										break;
									}
								}
								if (k == -1) {
									if (!sPropertyReportStatus) // Mantis 0001098
									{
										createReportExcelFile(sFilename, sheetName, new ArrayList<String>(
												Arrays.asList("TestCase", "Input", "ODS_API_DATA", "Aero_UI_DATA"))); // Mantis
										// 0001151
										sPropertyReportStatus = true;
									}
									if (sReportFlag) {
										excelReportDebugLog(sFilename, sheetName,
												Stream.concat(
														Stream.concat(Stream.of(sTestCase),
																new ArrayList<String>(sSetData.values()).stream()),
														Stream.of(expectedData, "Data not found in UI"))
												.collect(Collectors.toList()));
										sReportFlag = false;
									} else {
										excelReportDebugLog(sFilename, sheetName,
												Stream.concat(Stream.of("", ""),
														Stream.of(expectedData, "Data not found in UI"))
												.collect(Collectors.toList()));
									}
									oFunctionLog.setTestStepDetails(sTestCase, "", expectedData, actualData, status,
											sUserAction,
											sStepDescription + "=>Data found in API at row number  "
													+ String.valueOf(i + 1) + " but same data is not found in UI",
													"", sWebPagePath); // Mantis 0001221
								} else
									oFunctionLog.setTestStepDetails(sTestCase, "", expectedData, actualData, status,
											sUserAction,
											sStepDescription + "=>Row number " + String.valueOf(k + 1)
											+ " of UI matched with row number " + String.valueOf(i + 1)
											+ " of API output",
											"", sWebPagePath); // Mantis 0001221
								allStatus.add(status);
							}
							// This checks remaining mismatched data of UI
							if (oCurrentElements.size() != 0) {
								for (int i = 0; i < oCurrentElements.size(); i++) {
									if (sReportFlag) // Mantis 0001098
									{
										excelReportDebugLog(sFilename, sheetName, Stream.concat(
												Stream.concat(Stream.of(sTestCase),
														new ArrayList<String>(sSetData.values()).stream()),
												Stream.of("Data not found in API", oCurrentElements.get(i).getText()))
												.collect(Collectors.toList()));
										sReportFlag = false;
									} else {
										excelReportDebugLog(sFilename, sheetName, Stream
												.concat(Stream.of("", ""),
														Stream.of("Data not found in API",
																oCurrentElements.get(i).getText()))
												.collect(Collectors.toList()));
									}
								}
							}
						}
					} else {
						if (sJSONData == null && (oCurrentElements == null || oCurrentElements.size() == 0)) {
							/*------Mantis 0001103------*/
							if (!sPropertyReportStatus) // Mantis 0001098
							{
								createReportExcelFile(sFilename, sheetName, new ArrayList<String>(
										Arrays.asList("TestCase", "Input", "ODS_API_DATA", "Aero_UI_DATA"))); // Mantis
								// 0001151
								sPropertyReportStatus = true;
							}

							if (sReportFlag) // Mantis 0001098
							{
								excelReportDebugLog(sFilename, sheetName,
										Stream.concat(
												Stream.concat(Stream.of(sTestCase),
														new ArrayList<String>(sSetData.values()).stream()),
												Stream.of("Data not found in API", "Data not found in UI"))
										.collect(Collectors.toList()));
								sReportFlag = false;
							} else {
								excelReportDebugLog(sFilename, sheetName,
										Stream.concat(Stream.of("", ""),
												Stream.of("Data not found in API", "Data not found in UI"))
										.collect(Collectors.toList()));
							}
							/*------Mantis 0001103------*/

							sStepDescription = sStepDescription
									+ "=>VerifyAPIData could not find Expected data from JSON Output as well as UI Data";
							status = "Pass";
						} else {
							if (sJSONData == null) {
								System.out.println("Inside if JSONDATA is null--------");

								if (!sPropertyReportStatus) // Mantis 0001098
								{
									createReportExcelFile(sFilename, sheetName, new ArrayList<String>(
											Arrays.asList("TestCase", "Input", "ODS_API_DATA", "Aero_UI_DATA"))); // Mantis
									// 0001151
									sPropertyReportStatus = true;
								}

								if (oCurrentElements.size() != 0) {
									for (int i = 0; i < oCurrentElements.size(); i++) {
										if (sReportFlag) // Mantis 0001098
										{
											excelReportDebugLog(sFilename, sheetName,
													Stream.concat(
															Stream.concat(Stream.of(sTestCase),
																	new ArrayList<String>(sSetData.values()).stream()),
															Stream.of("Data not found in API",
																	oCurrentElements.get(i).getText()))
													.collect(Collectors.toList()));
											sReportFlag = false;
										} else {
											excelReportDebugLog(sFilename, sheetName, Stream
													.concat(Stream.of("", ""),
															Stream.of("Data not found in API",
																	oCurrentElements.get(i).getText()))
													.collect(Collectors.toList()));
										}
									}
								}
								sStepDescription = sStepDescription
										+ "=>VerifyAPIData could not find Expected data from JSON Output.";
							} else {
								System.out.println("Inside else if ObjectElement is null--------");

								if (!sPropertyReportStatus) // Mantis 0001098
								{
									createReportExcelFile(sFilename, sheetName, new ArrayList<String>(
											Arrays.asList("TestCase", "Input", "ODS_API_DATA", "Aero_UI_DATA"))); // Mantis
									// 0001151
									sPropertyReportStatus = true;
								}

								if (sJSONData.size() != 0) {
									for (int i = 0; i < sJSONData.size(); i++) {
										if (sReportFlag) // Mantis 0001098
										{
											excelReportDebugLog(sFilename, sheetName,
													Stream.concat(
															Stream.concat(Stream.of(sTestCase),
																	new ArrayList<String>(sSetData.values()).stream()),
															Stream.of(sJSONData.get(i).get(0), "Data not found in UI"))
													.collect(Collectors.toList()));
											sReportFlag = false;
										} else {
											excelReportDebugLog(
													sFilename, sheetName, Stream
													.concat(Stream.of("", ""),
															Stream.of(sJSONData.get(i).get(0),
																	"Data not found in UI"))
													.collect(Collectors.toList()));
										}
									}
								}
								sStepDescription = sStepDescription
										+ "=>VerifyAPIData could not find Actual data from UI.";
							}
							status = "Fail";
						}

						allStatus.add(status);
					}
				} else {
					/*------Mantis 0001103------*/
					if (sJSONData == null && oCurrentElements == null) {

						if (!sPropertyReportStatus) // Mantis 0001098
						{
							createReportExcelFile(sFilename, sheetName, new ArrayList<String>(
									Arrays.asList("TestCase", "Input", "ODS_API_DATA", "Aero_UI_DATA"))); // Mantis
							// 0001151
							sPropertyReportStatus = true;
						}

						if (sReportFlag) // Mantis 0001098
						{
							excelReportDebugLog(sFilename, sheetName,
									Stream.concat(
											Stream.concat(Stream.of(sTestCase),
													new ArrayList<String>(sSetData.values()).stream()),
											Stream.of("Data not found in API", "Data not found in UI"))
									.collect(Collectors.toList()));
							sReportFlag = false;
						} else {
							excelReportDebugLog(sFilename, sheetName,
									Stream.concat(Stream.of("", ""),
											Stream.of("Data not found in API", "Data not found in UI"))
									.collect(Collectors.toList()));
						}

						sStepDescription = sStepDescription
								+ "=>VerifyAPIData could not find Expected data from JSON Output as well as UI Data";
						status = "Pass";
					} else {
						System.out.println("Inside else if waitForElements failed--------");

						if (!sPropertyReportStatus) // Mantis 0001098
						{
							createReportExcelFile(sFilename, sheetName, new ArrayList<String>(
									Arrays.asList("TestCase", "Input", "ODS_API_DATA", "Aero_UI_DATA"))); // Mantis
							// 0001151
							sPropertyReportStatus = true;
						}

						if (sJSONData.size() != 0) {
							for (int i = 0; i < sJSONData.size(); i++) {
								if (sReportFlag) // Mantis 0001098
								{
									excelReportDebugLog(sFilename, sheetName,
											Stream.concat(
													Stream.concat(Stream.of(sTestCase),
															new ArrayList<String>(sSetData.values()).stream()),
													Stream.of(sJSONData.get(i).get(0), "Data not found in UI"))
											.collect(Collectors.toList()));
									sReportFlag = false;
								} else {
									excelReportDebugLog(sFilename, sheetName,
											Stream.concat(Stream.of("", ""),
													Stream.of(sJSONData.get(i).get(0), "Data not found in UI"))
											.collect(Collectors.toList()));
								}
							}
						}
						sStepDescription = sStepDescription + "=>VerifyAPIData could not find Actual data from UI.";
					}
					/*------Mantis 0001103------*/

					status = "Fail";
					allStatus.add(status);
				}
				break;

			default:
				systemouts("Inside Default Property");
				break;
			}

			if (allStatus.contains("Fail"))
				sStatus = "Fail";
			else
				sStatus = "Pass";

			sPropertyTransFormStaus = false; // Mantis 0001098
		}

		/*-------MainCode--------*/
		/*
		 * if(iInd == -1) { List<WebElement> oCurrentElements = null; String status =
		 * "FAIL", expectedData = "", actualData = "" , UI_AvailsCount = "",
		 * API_AvailsCount = "", sAvailStatus = "";
		 * 
		 * Object = new JLL_Library(oDriver,iCurrentContext,pageWait,frameWait);
		 * allStatus = new ArrayList<String>();
		 * 
		 * switch(sVerifyProperty.toLowerCase()) { case "text":
		 * 
		 * if(Object.waitForElements(lElementWait, sIdentifier, sIdentifierValue)) {
		 * oCurrentElements = getElements(sControlType, sIdentifier, sIdentifierValue);
		 * 
		 * UI_AvailsCount = String.valueOf(oCurrentElements.size()); //Manoj xxx
		 * 
		 * if(oCurrentElements!=null && oCurrentElements.size()!=0 && sJSONData!=null) {
		 * API_AvailsCount = String.valueOf(sJSONData.size()); //Manoj xxx
		 * 
		 * if((oCurrentElements.size()==sExpectedAvailsCount) && (sJSONData.size() ==
		 * sExpectedAvailsCount)) //Manoj xxx status = "PASS";
		 * 
		 * if(!sAvailabilityReportStatus && sAvailabilityTransFormStaus) //Manoj xxx {
		 * createReportExcelFile(sFilename, sheetName,new
		 * ArrayList<String>(Arrays.asList("TestCase","Input","ExpectedNumAvails",
		 * "UI_AvailsCount","API_AvailsCount","Status","API_DATA","UI_DATA")));
		 * sAvailabilityReportStatus = true; } else if(!sPropertyReportStatus &&
		 * !sAvailabilityTransFormStaus) //Manoj xxx { createReportExcelFile(sFilename,
		 * sheetName,new
		 * ArrayList<String>(Arrays.asList("TestCase","Input","API_DATA","UI_DATA")));
		 * sPropertyReportStatus = true; }
		 * 
		 * if(oCurrentElements.size()>=sJSONData.size()) {
		 * if(oCurrentElements.size()==sJSONData.size()) {
		 * oFunctionLog.setTestStepDetails(sTestCase, "",
		 * String.valueOf(sJSONData.size()), String.valueOf(oCurrentElements.size()),
		 * "Pass", sUserAction, sStepDescription+"=>>Rows matched", ""); } else {
		 * oFunctionLog.setTestStepDetails(sTestCase, "",
		 * String.valueOf(sJSONData.size()), String.valueOf(oCurrentElements.size()),
		 * "Fail", sUserAction, sStepDescription+"=>>Rows mismatched", ""); } for(int
		 * i=0;i<oCurrentElements.size();i++) { actualData=""; expectedData=""; int
		 * k=-1; status = "Fail"; sIdenVal = oCurrentElements.get(i).getText();
		 * actualData = sIdenVal;
		 * 
		 * for(int j=0;j<sJSONData.size();j++) { if(sAvailabilityTransFormStaus) {
		 * if(sIdenVal.contains(sJSONData.get(j).get(0))) //Need to improve code here {
		 * k=j; status="Pass"; expectedData = sJSONData.get(j).get(0); //Need to improve
		 * code here sJSONData.remove(j);
		 * //excelReportDebugLog(sPropertyReportFileName,sPropertyReportSheetName,new
		 * ArrayList<String>(Arrays.asList(sTestCase,sSetData,expectedData,actualData)))
		 * ; if(sReportFlag) //new code adding for reporting Manoj xxx {
		 * excelReportDebugLog(sFilename,sheetName,
		 * Stream.concat(Stream.concat(Stream.of(sTestCase), new
		 * ArrayList<String>(sSetData.values()).stream()),
		 * Stream.of(String.valueOf(oCurrentElements.size()),String.valueOf(sJSONData.
		 * size()),expectedData,actualData)) .collect(Collectors.toList())); } else {
		 * excelReportDebugLog(sFilename,sheetName,
		 * Stream.concat(Stream.concat(Stream.of(""), new ArrayList<String>().stream()),
		 * Stream.of(expectedData,actualData)) .collect(Collectors.toList())); } break;
		 * }
		 * 
		 * } else { if(sIdenVal.equalsIgnoreCase(sJSONData.get(j).get(0))) //Need to
		 * improve code here { k=j; status="Pass"; expectedData =
		 * sJSONData.get(j).get(0); //Need to improve code here sJSONData.remove(j);
		 * //excelReportDebugLog(sPropertyReportFileName,sPropertyReportSheetName,new
		 * ArrayList<String>(Arrays.asList(sTestCase,sSetData,expectedData,actualData)))
		 * ; excelReportDebugLog(sFilename,sheetName,
		 * Stream.concat(Stream.concat(Stream.of(sTestCase), new
		 * ArrayList<String>(sSetData.values()).stream()),
		 * Stream.of(expectedData,actualData)) .collect(Collectors.toList())); break; }
		 * } } if(k==-1) {
		 * 
		 * if(!sPropertyReportStatus) { createReportExcelFile(); sPropertyReportStatus =
		 * true; }
		 * 
		 * if(sAvailabilityTransFormStaus) //Manoj xxx { if(!sAvailabilityReportStatus)
		 * //Manoj xxx { createReportExcelFile(sFilename, sheetName,new
		 * ArrayList<String>(Arrays.asList("TestCase","Input","ExpectedNumAvails",
		 * "UI_AvailsCount","API_AvailsCount","Status","API_DATA","UI_DATA")));
		 * sAvailabilityReportStatus = true; } excelReportDebugLog(sFilename,sheetName,
		 * Stream.concat(Stream.concat(Stream.of(sTestCase), new
		 * ArrayList<String>(sSetData.values()).stream()),
		 * Stream.of("Data not found in API",actualData))
		 * .collect(Collectors.toList())); //excelReportDebugLog(sFilename,sheetName,new
		 * ArrayList<String>(Arrays.asList(sTestCase,sSetData,"Data not found in API"
		 * ,actualData))); } else { if(!sPropertyReportStatus) //Manoj xxx {
		 * createReportExcelFile(sFilename, sheetName,new
		 * ArrayList<String>(Arrays.asList("TestCase","Input","API_DATA","UI_DATA")));
		 * sPropertyReportStatus = true; } excelReportDebugLog(sFilename,sheetName,
		 * Stream.concat(Stream.concat(Stream.of(sTestCase), new
		 * ArrayList<String>(sSetData.values()).stream()),
		 * Stream.of("Data not found in API",actualData))
		 * .collect(Collectors.toList())); }
		 * //excelReportDebugLog(sPropertyReportFileName,sPropertyReportSheetName,new
		 * ArrayList<String>(Arrays.asList(sTestCase,sSetData,"Data not found in API"
		 * ,actualData))); oFunctionLog.setTestStepDetails(sTestCase, "", expectedData,
		 * actualData, status, sUserAction,
		 * sStepDescription+"=>Data found in UI at row number  "+String.valueOf(i+1)
		 * +" but same data is not found in API", ""); } else
		 * oFunctionLog.setTestStepDetails(sTestCase, "", expectedData, actualData,
		 * status, sUserAction, sStepDescription+"=>Row number "+String.valueOf(i+1)
		 * +" of UI matched with row number "+String.valueOf(k+1)+" of API output", "");
		 * allStatus.add(status); } //This checks remaining mismatched data of API
		 * if(sJSONData.size()!=0) { for(int i=0;i<sJSONData.size();i++) {
		 * //excelReportDebugLog(sPropertyReportFileName,sPropertyReportSheetName,new
		 * ArrayList<String>(Arrays.asList(sTestCase,sSetData,sJSONData.get(i).get(0)
		 * ,"Data not found in UI"))); if(sAvailabilityTransFormStaus) {
		 * //excelReportDebugLog(sFilename,sheetName,new
		 * ArrayList<String>(Arrays.asList(sTestCase,sSetData,sJSONData.get(i).get(0)
		 * ,"Data not found in UI"))); excelReportDebugLog(sFilename,sheetName,
		 * Stream.concat(Stream.concat(Stream.of(sTestCase), new
		 * ArrayList<String>(sSetData.values()).stream()),
		 * Stream.of(sJSONData.get(i).get(0),"Data not found in UI"))
		 * .collect(Collectors.toList())); } else {
		 * excelReportDebugLog(sFilename,sheetName,
		 * Stream.concat(Stream.concat(Stream.of(sTestCase), new
		 * ArrayList<String>(sSetData.values()).stream()),
		 * Stream.of(sJSONData.get(i).get(0),"Data not found in UI"))
		 * .collect(Collectors.toList())); } } } } else {
		 * oFunctionLog.setTestStepDetails(sTestCase, "",
		 * String.valueOf(sJSONData.size()), String.valueOf(oCurrentElements.size()),
		 * "Fail", sUserAction, sStepDescription+"=>>Rows mismatched", "");
		 * 
		 * for(int i=0;i<sJSONData.size();i++) { actualData=""; expectedData=""; int
		 * k=-1; status = "Fail"; expectedData=sJSONData.get(i).get(0);
		 * 
		 * for(int j=0;j<oCurrentElements.size();j++) { sIdenVal =
		 * oCurrentElements.get(j).getText(); if(sAvailabilityTransFormStaus) {
		 * if(sIdenVal.contains(expectedData)) { k=j; status="Pass"; actualData =
		 * sIdenVal; oCurrentElements.remove(j); //Added for Removing matched data of UI
		 * //expectedData = sJSONData.get(j).get(0); //Need to improve code here
		 * //excelReportDebugLog(sPropertyReportFileName,sPropertyReportSheetName,new
		 * ArrayList<String>(Arrays.asList(sTestCase,sSetData,expectedData,actualData)))
		 * ; //excelReportDebugLog(sFilename,sheetName,new
		 * ArrayList<String>(Arrays.asList(sTestCase,sSetData,expectedData,actualData)))
		 * ; excelReportDebugLog(sFilename,sheetName,
		 * Stream.concat(Stream.concat(Stream.of(sTestCase), new
		 * ArrayList<String>(sSetData.values()).stream()),
		 * Stream.of(expectedData,actualData)) .collect(Collectors.toList())); break; }
		 * } else { if(sIdenVal.equalsIgnoreCase(expectedData)) { k=j; status="Pass";
		 * actualData = sIdenVal; oCurrentElements.remove(j); //Added for Removing
		 * matched data of UI //expectedData = sJSONData.get(j).get(0); //Need to
		 * improve code here
		 * //excelReportDebugLog(sPropertyReportFileName,sPropertyReportSheetName,new
		 * ArrayList<String>(Arrays.asList(sTestCase,sSetData,expectedData,actualData)))
		 * ; excelReportDebugLog(sFilename,sheetName,
		 * Stream.concat(Stream.concat(Stream.of(sTestCase), new
		 * ArrayList<String>(sSetData.values()).stream()),
		 * Stream.of(expectedData,actualData)) .collect(Collectors.toList())); break; }
		 * } } if(k==-1) {
		 * 
		 * if(!sPropertyReportStatus) { createReportExcelFile(); sPropertyReportStatus =
		 * true; }
		 * 
		 * if(sAvailabilityTransFormStaus) { if(!sAvailabilityReportStatus) //Manoj xxx
		 * { createReportExcelFile(sFilename, sheetName,new
		 * ArrayList<String>(Arrays.asList("TestCase","Input","ExpectedNumAvails",
		 * "UI_AvailsCount","API_AvailsCount","Status","API_DATA","UI_DATA")));
		 * sAvailabilityReportStatus = true; }
		 * //excelReportDebugLog(sFilename,sheetName,new
		 * ArrayList<String>(Arrays.asList(sTestCase,sSetData,
		 * expectedData,"Data not found in UI")));
		 * excelReportDebugLog(sFilename,sheetName,
		 * Stream.concat(Stream.concat(Stream.of(sTestCase), new
		 * ArrayList<String>(sSetData.values()).stream()),
		 * Stream.of(expectedData,"Data not found in UI"))
		 * .collect(Collectors.toList())); } else { if(!sPropertyReportStatus) //Manoj
		 * xxx { createReportExcelFile(sFilename, sheetName,new
		 * ArrayList<String>(Arrays.asList("TestCase","Input","API_DATA","UI_DATA")));
		 * sPropertyReportStatus = true; } excelReportDebugLog(sFilename,sheetName,
		 * Stream.concat(Stream.concat(Stream.of(sTestCase), new
		 * ArrayList<String>(sSetData.values()).stream()),
		 * Stream.of(expectedData,"Data not found in UI"))
		 * .collect(Collectors.toList()));
		 * 
		 * } //excelReportDebugLog(sPropertyReportFileName,sPropertyReportSheetName,new
		 * ArrayList<String>(Arrays.asList(sTestCase,sSetData,
		 * expectedData,"Data not found in UI")));
		 * oFunctionLog.setTestStepDetails(sTestCase, "", expectedData, actualData,
		 * status, sUserAction,
		 * sStepDescription+"=>Data found in API at row number  "+String.valueOf(i+1)
		 * +" but same data is not found in UI", ""); } else
		 * oFunctionLog.setTestStepDetails(sTestCase, "", expectedData, actualData,
		 * status, sUserAction, sStepDescription+"=>Row number "+String.valueOf(k+1)
		 * +" of UI matched with row number "+String.valueOf(i+1)+" of API output", "");
		 * allStatus.add(status); } //This checks remaining mismatched data of UI
		 * if(oCurrentElements.size()!=0) { for(int i=0;i<oCurrentElements.size();i++) {
		 * //excelReportDebugLog(sPropertyReportFileName,sPropertyReportSheetName,new
		 * ArrayList<String>(Arrays.asList(sTestCase,sSetData,"Data not found in API"
		 * ,oCurrentElements.get(i).getText()))); if(sAvailabilityTransFormStaus) {
		 * //excelReportDebugLog(sFilename,sheetName,new
		 * ArrayList<String>(Arrays.asList(sTestCase,sSetData,"Data not found in API"
		 * ,oCurrentElements.get(i).getText())));
		 * excelReportDebugLog(sFilename,sheetName,
		 * Stream.concat(Stream.concat(Stream.of(sTestCase), new
		 * ArrayList<String>(sSetData.values()).stream()),
		 * Stream.of("Data not found in API", oCurrentElements.get(i).getText()))
		 * .collect(Collectors.toList())); } else {
		 * excelReportDebugLog(sFilename,sheetName,
		 * Stream.concat(Stream.concat(Stream.of(sTestCase), new
		 * ArrayList<String>(sSetData.values()).stream()),
		 * Stream.of("Data not found in API", oCurrentElements.get(i).getText()))
		 * .collect(Collectors.toList())); } } } } } else { if(sJSONData==null &&
		 * oCurrentElements==null) { sStepDescription =
		 * sStepDescription+"=>VerifyAPIData could not find Expected data from JSON Output as well as UI Data"
		 * ; status = "Pass"; } else { if(sJSONData==null) {
		 * System.out.println("Inside if JSONDATA is null--------");
		 * 
		 * if(!sPropertyReportStatus) { createReportExcelFile(); sPropertyReportStatus =
		 * true; }
		 * 
		 * if(!sAvailabilityReportStatus && sAvailabilityTransFormStaus) //Manoj xxx {
		 * createReportExcelFile(sFilename, sheetName,new
		 * ArrayList<String>(Arrays.asList("TestCase","Input","ExpectedNumAvails",
		 * "UI_AvailsCount","API_AvailsCount","Status","API_DATA","UI_DATA")));
		 * sAvailabilityReportStatus = true; } else if(!sPropertyReportStatus &&
		 * !sAvailabilityTransFormStaus) //Manoj xxx { createReportExcelFile(sFilename,
		 * sheetName,new
		 * ArrayList<String>(Arrays.asList("TestCase","Input","API_DATA","UI_DATA")));
		 * sPropertyReportStatus = true; }
		 * 
		 * if(oCurrentElements.size()!=0) { for(int i=0;i<oCurrentElements.size();i++) {
		 * //excelReportDebugLog(sPropertyReportFileName,sPropertyReportSheetName,new
		 * ArrayList<String>(Arrays.asList(sTestCase,sSetData,"Data not found in API"
		 * ,oCurrentElements.get(i).getText()))); if(sAvailabilityTransFormStaus) {
		 * //excelReportDebugLog(sFilename,sheetName,new
		 * ArrayList<String>(Arrays.asList(sTestCase,sSetData,"Data not found in API"
		 * ,oCurrentElements.get(i).getText())));
		 * excelReportDebugLog(sFilename,sheetName,
		 * Stream.concat(Stream.concat(Stream.of(sTestCase), new
		 * ArrayList<String>(sSetData.values()).stream()),
		 * Stream.of("Data not found in API", oCurrentElements.get(i).getText()))
		 * .collect(Collectors.toList())); } else {
		 * excelReportDebugLog(sFilename,sheetName,
		 * Stream.concat(Stream.concat(Stream.of(sTestCase), new
		 * ArrayList<String>(sSetData.values()).stream()),
		 * Stream.of("Data not found in API", oCurrentElements.get(i).getText()))
		 * .collect(Collectors.toList())); }
		 * 
		 * } } sStepDescription =
		 * sStepDescription+"=>VerifyAPIData could not find Expected data from JSON Output."
		 * ; } else {
		 * System.out.println("Inside else if ObjectElement is null--------");
		 * 
		 * if(!sPropertyReportStatus) { createReportExcelFile(); sPropertyReportStatus =
		 * true; }
		 * 
		 * if(!sAvailabilityReportStatus && sAvailabilityTransFormStaus) //Manoj xxx {
		 * createReportExcelFile(sFilename, sheetName,new
		 * ArrayList<String>(Arrays.asList("TestCase","Input","ExpectedNumAvails",
		 * "UI_AvailsCount","API_AvailsCount","Status","API_DATA","UI_DATA")));
		 * sAvailabilityReportStatus = true; } else if(!sPropertyReportStatus &&
		 * !sAvailabilityTransFormStaus) //Manoj xxx { createReportExcelFile(sFilename,
		 * sheetName,new
		 * ArrayList<String>(Arrays.asList("TestCase","Input","API_DATA","UI_DATA")));
		 * sPropertyReportStatus = true; }
		 * 
		 * if(sJSONData.size()!=0) { for(int i=0;i<sJSONData.size();i++) {
		 * //excelReportDebugLog(sPropertyReportFileName,sPropertyReportSheetName,new
		 * ArrayList<String>(Arrays.asList(sTestCase,sSetData,sJSONData.get(i).get(0)
		 * ,"Data not found in UI"))); if(sAvailabilityTransFormStaus) {
		 * //excelReportDebugLog(sFilename,sheetName,new
		 * ArrayList<String>(Arrays.asList(sTestCase,sSetData,sJSONData.get(i).get(0)
		 * ,"Data not found in UI"))); excelReportDebugLog(sFilename,sheetName,
		 * Stream.concat(Stream.concat(Stream.of(sTestCase), new
		 * ArrayList<String>(sSetData.values()).stream()),
		 * Stream.of(sJSONData.get(i).get(0),"Data not found in UI"))
		 * .collect(Collectors.toList())); } else {
		 * excelReportDebugLog(sFilename,sheetName,
		 * Stream.concat(Stream.concat(Stream.of(sTestCase), new
		 * ArrayList<String>(sSetData.values()).stream()),
		 * Stream.of(sJSONData.get(i).get(0),"Data not found in UI"))
		 * .collect(Collectors.toList())); } } } sStepDescription =
		 * sStepDescription+"=>VerifyAPIData could not find Actual data from UI."; }
		 * status= "Fail"; }
		 * 
		 * allStatus.add(status); } } else { status= "Fail"; allStatus.add(status); }
		 * break;
		 * 
		 * default: systemouts("Inside Default Property");
		 * 
		 * if(Object.waitForElements(lElementWait, sIdentifier, sIdentifierValue)) {
		 * oCurrentElements = getElements(sControlType, sIdentifier, sIdentifierValue);
		 * 
		 * if(oCurrentElements!=null && oCurrentElements.size()!=0 && sJSONData!=null) {
		 * 
		 * if(!sPropertyReportStatus) { createReportExcelFile(); sPropertyReportStatus =
		 * true; }
		 * 
		 * if(!sAvailabilityReportStatus && sAvailabilityTransFormStaus) //Manoj xxx {
		 * createReportExcelFile(sFilename, sheetName,new
		 * ArrayList<String>(Arrays.asList("TestCase","Input","ExpectedNumAvails",
		 * "UI_AvailsCount","API_AvailsCount","Status","API_DATA","UI_DATA")));
		 * sAvailabilityReportStatus = true; } else if(!sPropertyReportStatus &&
		 * !sAvailabilityTransFormStaus) //Manoj xxx { createReportExcelFile(sFilename,
		 * sheetName,new
		 * ArrayList<String>(Arrays.asList("TestCase","Input","API_DATA","UI_DATA")));
		 * sPropertyReportStatus = true; }
		 * 
		 * 
		 * if(oCurrentElements.size()>=sJSONData.size()) {
		 * if(oCurrentElements.size()==sJSONData.size()) {
		 * oFunctionLog.setTestStepDetails(sTestCase, "",
		 * String.valueOf(sJSONData.size()), String.valueOf(oCurrentElements.size()),
		 * "Pass", sUserAction, sStepDescription+"=>>Rows matched", ""); } else {
		 * oFunctionLog.setTestStepDetails(sTestCase, "",
		 * String.valueOf(sJSONData.size()), String.valueOf(oCurrentElements.size()),
		 * "Fail", sUserAction, sStepDescription+"=>>Rows mismatched", ""); } for(int
		 * i=0;i<oCurrentElements.size();i++) { actualData=""; expectedData=""; int
		 * k=-1; status = "Fail"; sIdenVal = oCurrentElements.get(i).getText();
		 * actualData = sIdenVal;
		 * 
		 * for(int j=0;j<sJSONData.size();j++) { if(sAvailabilityTransFormStaus) {
		 * if(sIdenVal.contains(sJSONData.get(j).get(0))) //Need to improve code here {
		 * k=j; status="Pass"; expectedData = sJSONData.get(j).get(0); //Need to improve
		 * code here sJSONData.remove(j); excelReportDebugLog(sFilename,sheetName,new
		 * ArrayList<String>(Arrays.asList(sTestCase,sSetData,expectedData,actualData)))
		 * ; //excelReportDebugLog(sPropertyReportFileName,sPropertyReportSheetName,new
		 * ArrayList<String>(Arrays.asList(sTestCase,sSetData,expectedData,actualData)))
		 * ; break; }
		 * 
		 * } else { if(sIdenVal.equalsIgnoreCase(sJSONData.get(j).get(0))) //Need to
		 * improve code here { k=j; status="Pass"; expectedData =
		 * sJSONData.get(j).get(0); //Need to improve code here sJSONData.remove(j);
		 * excelReportDebugLog(sFilename,sheetName,new
		 * ArrayList<String>(Arrays.asList(sTestCase,sSetData,expectedData,actualData)))
		 * ; //excelReportDebugLog(sPropertyReportFileName,sPropertyReportSheetName,new
		 * ArrayList<String>(Arrays.asList(sTestCase,sSetData,expectedData,actualData)))
		 * ; break; } } } if(k==-1) {
		 * 
		 * if(!sPropertyReportStatus) { createReportExcelFile(); sPropertyReportStatus =
		 * true; }
		 * 
		 * if(!sAvailabilityReportStatus && sAvailabilityTransFormStaus) //Manoj xxx {
		 * createReportExcelFile(sFilename, sheetName,new
		 * ArrayList<String>(Arrays.asList("TestCase","Input","ExpectedNumAvails",
		 * "UI_AvailsCount","API_AvailsCount","Status","API_DATA","UI_DATA")));
		 * sAvailabilityReportStatus = true; } else if(!sPropertyReportStatus &&
		 * !sAvailabilityTransFormStaus) //Manoj xxx { createReportExcelFile(sFilename,
		 * sheetName,new
		 * ArrayList<String>(Arrays.asList("TestCase","Input","API_DATA","UI_DATA")));
		 * sPropertyReportStatus = true; }
		 * 
		 * //excelReportDebugLog(sPropertyReportFileName,sPropertyReportSheetName,new
		 * ArrayList<String>(Arrays.asList(sTestCase,sSetData,"Data not found in API"
		 * ,actualData))); excelReportDebugLog(sFilename,sheetName,new
		 * ArrayList<String>(Arrays.asList(sTestCase,sSetData,"Data not found in API"
		 * ,actualData))); oFunctionLog.setTestStepDetails(sTestCase, "", expectedData,
		 * actualData, status, sUserAction,
		 * sStepDescription+"=>Data found in UI at row number  "+String.valueOf(i+1)
		 * +" but same data is not found in API", ""); } else
		 * oFunctionLog.setTestStepDetails(sTestCase, "", expectedData, actualData,
		 * status, sUserAction, sStepDescription+"=>Row number "+String.valueOf(i+1)
		 * +" of UI matched with row number "+String.valueOf(k+1)+" of API output", "");
		 * allStatus.add(status); } //This checks remaining mismatched data of API
		 * if(sJSONData.size()!=0) { for(int i=0;i<sJSONData.size();i++) {
		 * //excelReportDebugLog(sPropertyReportFileName,sPropertyReportSheetName,new
		 * ArrayList<String>(Arrays.asList(sTestCase,sSetData,sJSONData.get(i).get(0)
		 * ,"Data not found in UI"))); excelReportDebugLog(sFilename,sheetName,new
		 * ArrayList<String>(Arrays.asList(sTestCase,sSetData,sJSONData.get(i).get(0)
		 * ,"Data not found in UI"))); } } } else {
		 * oFunctionLog.setTestStepDetails(sTestCase, "",
		 * String.valueOf(sJSONData.size()), String.valueOf(oCurrentElements.size()),
		 * "Fail", sUserAction, sStepDescription+"=>>Rows mismatched", "");
		 * 
		 * for(int i=0;i<sJSONData.size();i++) { actualData=""; expectedData=""; int
		 * k=-1; status = "Fail"; expectedData=sJSONData.get(i).get(0);
		 * 
		 * for(int j=0;j<oCurrentElements.size();j++) { sIdenVal =
		 * oCurrentElements.get(j).getText(); if(sAvailabilityTransFormStaus) {
		 * if(sIdenVal.contains(expectedData)) { k=j; status="Pass"; actualData =
		 * sIdenVal; oCurrentElements.remove(j); //Added for Removing matched data of UI
		 * //expectedData = sJSONData.get(j).get(0); //Need to improve code here
		 * //excelReportDebugLog(sPropertyReportFileName,sPropertyReportSheetName,new
		 * ArrayList<String>(Arrays.asList(sTestCase,sSetData,expectedData,actualData)))
		 * ; excelReportDebugLog(sFilename,sheetName,new
		 * ArrayList<String>(Arrays.asList(sTestCase,sSetData,expectedData,actualData)))
		 * ; break; } } else { if(sIdenVal.equalsIgnoreCase(expectedData)) { k=j;
		 * status="Pass"; actualData = sIdenVal; oCurrentElements.remove(j); //Added for
		 * Removing matched data of UI //expectedData = sJSONData.get(j).get(0); //Need
		 * to improve code here
		 * //excelReportDebugLog(sPropertyReportFileName,sPropertyReportSheetName,new
		 * ArrayList<String>(Arrays.asList(sTestCase,sSetData,expectedData,actualData)))
		 * ; excelReportDebugLog(sFilename,sheetName,new
		 * ArrayList<String>(Arrays.asList(sTestCase,sSetData,expectedData,actualData)))
		 * ; break; } } } if(k==-1) {
		 * 
		 * if(!sPropertyReportStatus) { createReportExcelFile(); sPropertyReportStatus =
		 * true; }
		 * 
		 * if(!sAvailabilityReportStatus && sAvailabilityTransFormStaus) //Manoj xxx {
		 * createReportExcelFile(sFilename, sheetName,new
		 * ArrayList<String>(Arrays.asList("TestCase","Input","ExpectedNumAvails",
		 * "UI_AvailsCount","API_AvailsCount","Status","API_DATA","UI_DATA")));
		 * sAvailabilityReportStatus = true; } else if(!sPropertyReportStatus &&
		 * !sAvailabilityTransFormStaus) //Manoj xxx { createReportExcelFile(sFilename,
		 * sheetName,new
		 * ArrayList<String>(Arrays.asList("TestCase","Input","API_DATA","UI_DATA")));
		 * sPropertyReportStatus = true; }
		 * 
		 * //excelReportDebugLog(sPropertyReportFileName,sPropertyReportSheetName,new
		 * ArrayList<String>(Arrays.asList(sTestCase,sSetData,
		 * expectedData,"Data not found in UI")));
		 * excelReportDebugLog(sFilename,sheetName,new
		 * ArrayList<String>(Arrays.asList(sTestCase,sSetData,
		 * expectedData,"Data not found in UI")));
		 * oFunctionLog.setTestStepDetails(sTestCase, "", expectedData, actualData,
		 * status, sUserAction,
		 * sStepDescription+"=>Data found in API at row number  "+String.valueOf(i+1)
		 * +" but same data is not found in UI", ""); } else
		 * oFunctionLog.setTestStepDetails(sTestCase, "", expectedData, actualData,
		 * status, sUserAction, sStepDescription+"=>Row number "+String.valueOf(k+1)
		 * +" of UI matched with row number "+String.valueOf(i+1)+" of API output", "");
		 * allStatus.add(status); } //This checks remaining mismatched data of UI
		 * if(oCurrentElements.size()!=0) { for(int i=0;i<oCurrentElements.size();i++) {
		 * //excelReportDebugLog(sPropertyReportFileName,sPropertyReportSheetName,new
		 * ArrayList<String>(Arrays.asList(sTestCase,sSetData,"Data not found in API"
		 * ,oCurrentElements.get(i).getText())));
		 * excelReportDebugLog(sFilename,sheetName,new
		 * ArrayList<String>(Arrays.asList(sTestCase,sSetData,"Data not found in API"
		 * ,oCurrentElements.get(i).getText())));
		 * 
		 * } } } } else { if(sJSONData==null && oCurrentElements==null) {
		 * sStepDescription =
		 * sStepDescription+"=>VerifyAPIData could not find Expected data from JSON Output as well as UI Data"
		 * ; status = "Pass"; } else { if(sJSONData==null) {
		 * System.out.println("Inside if JSONDATA is null--------");
		 * 
		 * if(!sPropertyReportStatus) { createReportExcelFile(); sPropertyReportStatus =
		 * true; }
		 * 
		 * if(!sAvailabilityReportStatus && sAvailabilityTransFormStaus) //Manoj xxx {
		 * createReportExcelFile(sFilename, sheetName,new
		 * ArrayList<String>(Arrays.asList("TestCase","Input","ExpectedNumAvails",
		 * "UI_AvailsCount","API_AvailsCount","Status","API_DATA","UI_DATA")));
		 * sAvailabilityReportStatus = true; } else if(!sPropertyReportStatus &&
		 * !sAvailabilityTransFormStaus) //Manoj xxx { createReportExcelFile(sFilename,
		 * sheetName,new
		 * ArrayList<String>(Arrays.asList("TestCase","Input","API_DATA","UI_DATA")));
		 * sPropertyReportStatus = true; }
		 * 
		 * if(oCurrentElements.size()!=0) { for(int i=0;i<oCurrentElements.size();i++) {
		 * //excelReportDebugLog(sPropertyReportFileName,sPropertyReportSheetName,new
		 * ArrayList<String>(Arrays.asList(sTestCase,sSetData,"Data not found in API"
		 * ,oCurrentElements.get(i).getText())));
		 * excelReportDebugLog(sFilename,sheetName,new
		 * ArrayList<String>(Arrays.asList(sTestCase,sSetData,"Data not found in API"
		 * ,oCurrentElements.get(i).getText()))); } } sStepDescription =
		 * sStepDescription+"=>VerifyAPIData could not find Expected data from JSON Output."
		 * ; } else {
		 * System.out.println("Inside else if ObjectElement is null--------");
		 * 
		 * if(!sPropertyReportStatus) { createReportExcelFile(); sPropertyReportStatus =
		 * true; }
		 * 
		 * if(!sAvailabilityReportStatus && sAvailabilityTransFormStaus) //Manoj xxx {
		 * createReportExcelFile(sFilename, sheetName, new
		 * ArrayList<String>(Arrays.asList("TestCase","Input","ExpectedNumAvails",
		 * "UI_AvailsCount","API_AvailsCount","Status","API_DATA","UI_DATA")));
		 * sAvailabilityReportStatus = true; } else if(!sPropertyReportStatus &&
		 * !sAvailabilityTransFormStaus) //Manoj xxx { createReportExcelFile(sFilename,
		 * sheetName, new
		 * ArrayList<String>(Arrays.asList("TestCase","Input","API_DATA","UI_DATA")));
		 * sPropertyReportStatus = true; }
		 * 
		 * if(sJSONData.size()!=0) { for(int i=0;i<sJSONData.size();i++) {
		 * //excelReportDebugLog(sPropertyReportFileName,sPropertyReportSheetName,new
		 * ArrayList<String>(Arrays.asList(sTestCase,sSetData,sJSONData.get(i).get(0)
		 * ,"Data not found in UI"))); excelReportDebugLog(sFilename,sheetName,new
		 * ArrayList<String>(Arrays.asList(sTestCase,sSetData,sJSONData.get(i).get(0)
		 * ,"Data not found in UI")));
		 * 
		 * } } sStepDescription =
		 * sStepDescription+"=>VerifyAPIData could not find Actual data from UI."; }
		 * status= "Fail"; }
		 * 
		 * allStatus.add(status); } } else { status = "Fail"; allStatus.add(status); }
		 * break; }
		 * 
		 * if(allStatus.contains("Fail")) sStatus = "Fail"; else sStatus = "Pass"; }
		 * 
		 * else //Now this part is not required. { WebElement oCurrentElement = null;
		 * 
		 * switch(sVerifyProperty.toLowerCase()) { case "text":
		 * 
		 * sIdenVal = get(sControlType, sIdentifier, sIdentifierValue, iInd);
		 * 
		 * if(sIdenVal!=null && sJSONData.size()==1) { if
		 * (sIdenVal.equalsIgnoreCase(sJSONData.get(0).get(0).trim())) { sStatus =
		 * "Pass"; } else { sStatus = "Fail"; } } else { sIdenVal=""; sStatus= "Fail"; }
		 * sActualValue = sIdenVal;
		 * 
		 * break;
		 * 
		 * default: systemouts("Inside Default Property"); if
		 * (waitForElement(sIdentifier,sIdentifierValue,iInd)) { oCurrentElement =
		 * getElement(sControlType,sIdentifier,sIdentifierValue,iInd);
		 * 
		 * sIdenVal=oCurrentElement.getAttribute(sVerifyProperty);
		 * 
		 * if(sIdenVal==null) { if(sVerifyProperty.toLowerCase().equals("checked") ||
		 * sVerifyProperty.toLowerCase().equals("selected")) //For checkbox and radio
		 * button //Mantis 0000912 sIdenVal="false"; else sIdenVal=""; }
		 * 
		 * systemouts("Actual Property Value:"+sIdenVal);
		 * if(sIdenVal.equalsIgnoreCase(sJSONData.get(0).get(0).trim())) {
		 * sStatus="Pass"; } sActualValue = sIdenVal; } else { sStatus= "Fail"; } break;
		 * } }
		 */

		/*-------MainCode--------*/

		System.out.println("--------JSON DATA after verification--------");
		System.out.println(sJSONData);
		return sStatus;
	}

	List<List<String>> getDataFromAPI(String sAPIData, String testStepData) throws Exception {
		List<List<String>> sJSONData = null;
		if (sAPIData != null & sAPIData != "") {
			JSONObject jsonObject = new JSONObject(sAPIData);
			sJSONData = readObject(jsonObject, testStepData.trim());
		}
		return sJSONData;
	}

	static List<List<String>> readObject(JSONObject object, String jsonPath) throws Exception {
		List<List<String>> jsonOutput = new ArrayList<List<String>>();
		List<String> attributesValue = null;
		String key;
		Object value;
		if (jsonPath.contains("|")) {
			try // Mantis 0001117
			{
				key = jsonPath.substring(0, jsonPath.indexOf("|")).trim();

				value = object.get(key);

				if (value instanceof JSONObject) {
					jsonOutput.addAll(readObject((JSONObject) value,
							jsonPath.substring(jsonPath.indexOf("|") + 1, jsonPath.length()).trim()));
				} else if (value instanceof JSONArray) {
					jsonOutput.addAll(readArray((JSONArray) value,
							jsonPath.substring(jsonPath.indexOf("|") + 1, jsonPath.length()).trim()));
				}
			} catch (JSONException e) {
				System.err.println(e.getMessage());
			}
		} else if (jsonPath.contains(",")) {
			attributesValue = new ArrayList<String>();
			String parameters[] = jsonPath.split(",");
			for (int i = 0; i < parameters.length; i++) {
				try // Mantis 0001099
				{
					String sParamValue = object.get(parameters[i].trim()).toString();
					attributesValue.add(sParamValue);
				} catch (JSONException e) {
					attributesValue.add("");
				}
			}
			jsonOutput.add(attributesValue);
		} else {
			attributesValue = new ArrayList<String>();
			String output = "";
			try // Mantis 0001117
			{
				output = object.get(jsonPath.trim()).toString();
				attributesValue.add(output);
			} catch (JSONException e) {
				attributesValue.add("");
			}

			jsonOutput.add(attributesValue);
			System.out.println("JSON output : " + output);
		}

		return jsonOutput;
	}

	static List<List<String>> readArray(JSONArray array, String jsonPath) throws Exception {
		List<List<String>> jsonOutput = new ArrayList<List<String>>();
		Object value;

		for (int i = 0; i < array.length(); i++) {
			value = array.get(i);

			if (value instanceof JSONArray) {
				readArray((JSONArray) value, jsonPath);
			} else if (value instanceof JSONObject) {
				jsonOutput.addAll(readObject((JSONObject) value, jsonPath));
			}
		}
		return jsonOutput;
	}

	public List<WebElement> getElements(String sControlType, String sSearchCriteria, String sSearchText)
			throws NoSuchTagException {
		List<WebElement> oCurrentElements = null;

		switch (sSearchCriteria.toLowerCase()) {
		case "xpath":
			oCurrentElements = oDriver.findElements(By.xpath(sSearchText));
			break;

		case "id":
			oCurrentElements = oDriver.findElements(By.id(sSearchText));
			break;

		case "class":
			oCurrentElements = oDriver.findElements(By.className(sSearchText));
			break;

		case "linktext":
			oCurrentElements = oDriver.findElements(By.linkText(sSearchText));
			break;

		case "partiallink":
			oCurrentElements = oDriver.findElements(By.partialLinkText(sSearchText));
			break;

		case "name":
			oCurrentElements = oDriver.findElements(By.name(sSearchText));
			break;

		case "css":
			oCurrentElements = oDriver.findElements(By.cssSelector(sSearchText));
			break;

		case "tag":
			oCurrentElements = oDriver.findElements(By.tagName(sSearchText));
			break;

		case "span":

			oCurrentElements = oDriver.findElements(By.tagName("SPAN"));
			break;

		default:
			NoSuchTagException e = new NoSuchTagException(sSearchCriteria);
			throw e;
		}
		return oCurrentElements;
	}

	String getNewExcelFileName(String sDirectory, String fileName) throws Exception // Mantis 0001097, 0001098
	{
		String sReportFileName = "";

		File file = new File(sDirectory);

		if (!file.exists()) {
			file.mkdir();
		}
		sReportFileName = new String(sDirectory + "/" + fileName + ".xlsx");

		return sReportFileName;
	}

	HashMap<String, String> SetReportExcelFileName(String sFileName) throws Exception // Mantis 0001097
	{
		HashMap<String, String> sFileDetails = new HashMap<String, String>();
		String sReportFile;

		if (sAvailabilityTransFormStaus) {
			if (sAvailabilityReportFileName.isEmpty() && sAvailabilityReportSheetName.isEmpty()) {
				String sCurrentDir = System.getProperty("user.dir").concat("/Report");
				sReportFile = sFileName;
				sReportFile = sReportFile.concat(new SimpleDateFormat("dd_MM_yyyy_hh_mm_ss_a").format(new Date()));
				sReportFile = getNewExcelFileName(sCurrentDir, sReportFile);
				sAvailabilityReportSheetName = "Report";
				sAvailabilityReportFileName = sReportFile;
			}

			sFileDetails.put("FileName", sAvailabilityReportFileName);
			sFileDetails.put("SheetName", sAvailabilityReportSheetName);
		} else if (sPropertyTransFormStaus) {
			if (sPropertyReportFileName.isEmpty() && sPropertyReportSheetName.isEmpty()) {
				String sCurrentDir = System.getProperty("user.dir").concat("/Report");
				sReportFile = sFileName;
				sReportFile = sReportFile.concat(new SimpleDateFormat("dd_MM_yyyy_hh_mm_ss_a").format(new Date()));
				sReportFile = getNewExcelFileName(sCurrentDir, sReportFile);
				sPropertyReportSheetName = "Report";
				sPropertyReportFileName = sReportFile;
			}

			sFileDetails.put("FileName", sPropertyReportFileName);
			sFileDetails.put("SheetName", sPropertyReportSheetName);
		} else if (sPropertyDetailTransformStatus) // Mantis 0001149
		{
			if (sPropertyDetailFileName.isEmpty() && sPropertyDetailsheetName.isEmpty()) {
				String sCurrentDir = System.getProperty("user.dir").concat("/Report");
				sReportFile = sFileName;
				sReportFile = sReportFile.concat(new SimpleDateFormat("dd_MM_yyyy_hh_mm_ss_a").format(new Date()));
				sReportFile = getNewExcelFileName(sCurrentDir, sReportFile);
				sPropertyDetailsheetName = "Report";
				sPropertyDetailFileName = sReportFile;
			}

			sFileDetails.put("FileName", sPropertyDetailFileName);
			sFileDetails.put("SheetName", sPropertyDetailsheetName);
		} else {
			if (sCustomPropertyFileName.isEmpty() && sCustomePropertySheetName.isEmpty()) {
				String sCurrentDir = System.getProperty("user.dir").concat("/Report");
				sReportFile = sFileName;
				sReportFile = sReportFile.concat(new SimpleDateFormat("dd_MM_yyyy_hh_mm_ss_a").format(new Date()));
				sReportFile = getNewExcelFileName(sCurrentDir, sReportFile);
				sCustomePropertySheetName = "Report";
				sCustomPropertyFileName = sReportFile;
			}

			sFileDetails.put("FileName", sCustomPropertyFileName);
			sFileDetails.put("SheetName", sCustomePropertySheetName);
		}
		return sFileDetails;
	}

	void createReportExcelFile(String sFileName, String sSheetName, List<String> sColHeaders) // Mantis 0001097, 0001098
	{
		try {
			ExcelConnection.createExcelConnection(sFileName, sSheetName);
			ExcelConnection.createHeaders(sFileName, sSheetName, sColHeaders);

		} catch (IOException e) {

		} catch (Exception e) {

		}
	}

	void excelReportDebugLog(String sFilePath, String sSheetName, List<String> dataRS) {
		Workbook wb = null;
		Map<String, Integer> sColumns = null;
		List<String> keys = null;
		try {
			wb = ExcelConnection.funExcelConnection(sFilePath);
			sColumns = ExcelConnection.funGetSheetColumns(wb, sSheetName);
			keys = new ArrayList<String>(sColumns.keySet());

			if (keys.size() == dataRS.size()) {
				ExcelConnection.funPutDataRecord(wb, sFilePath, sSheetName, dataRS);
			} else {
				System.out.println("Column structure dismatch");
				throw new Exception("Column structure dismatch");
			}
		} catch (Exception e) {

		}
	}

	String writeJSON(String sData) throws Exception {
		String sFilePath = "";
		String sCurrentDir = System.getProperty("user.dir");
		sCurrentDir = sCurrentDir.concat("/JSON_Data");
		File file = new File(sCurrentDir);
		String sCurDate = KeywordDrivenFramework.getCurrentScenario().concat("_" + sTestCaseData + "_");
		Thread.sleep(1000);
		sCurDate = sCurDate.concat(new SimpleDateFormat("dd_MM_yyyy_hh_mm_ss_a").format(new Date()));

		if (!file.exists()) {
			file.mkdir();
		}

		FileWriter oFileWriter = null;
		sFilePath = new String(sCurrentDir + "/" + sCurDate + ".json");
		oFileWriter = new FileWriter(sFilePath);
		oFileWriter.write(sData);
		oFileWriter.flush();
		oFileWriter.close();
		System.out.println("-----------Done---------");
		return sFilePath;
	}

	String readJSON(String sJSONFilePath) throws Exception {
		String sJSONData = "";

		JSONParser jsonParser = new JSONParser();

		try {
			if (new File(sJSONFilePath).exists()) {
				FileReader reader = new FileReader(sJSONFilePath);
				// Object obj = new JSONObject(reader);
				Object obj = jsonParser.parse(reader);
				sJSONData = obj.toString();
			} else
				throw new FileNotFoundException("File : " + sJSONFilePath + " not found");

			System.out.println("-----------Done---------");
		} catch (Exception e) {
			if (e instanceof org.json.simple.parser.ParseException)
				e.printStackTrace();
			else
				throw new Exception(e.getMessage());
		}

		return sJSONData;
	}

	String getAbbreviation(String sTestStepData) throws Exception {
		sTestStepData = sTestStepData.replaceFirst("%SF%", "");
		// String sCurrentDir = System.getProperty("user.dir");
		// String sFileName =sCurrentDir+"/Master_Data/Abbreviation.xlsx";
		String sAbbreviation = sTestStepData.trim();
		// File f = new File(sFileName);
		// Workbook workbookAbbreviationData=null;
		Map<String, Integer> columnsAbbreviationData;
		List<List<String>> resultSetAbbreviationData;
		// if(f.exists())
		// {
		// workbookAbbreviationData=ExcelConnection.funExcelConnection(sFileName);
		// columnsAbbreviationData=ExcelConnection.funGetSheetColumns(workbookAbbreviationData,
		// "Master");
		// resultSetAbbreviationData=ExcelConnection.funGetSheetData(workbookAbbreviationData,
		// "Master");

		columnsAbbreviationData = ExcelConnection.getMasterDataFileColumns("Abbreviation");
		resultSetAbbreviationData = ExcelConnection.readAbbreviation();
		int nameIndex = ExcelConnection.funGetColumnIndex(AbbreviationColumnHeader.NAME.toString(),
				columnsAbbreviationData);
		int recordNumberDynData = ExcelConnection.funGetDynamicDataRecordNumber(nameIndex, sTestStepData.trim(),
				resultSetAbbreviationData);

		if (recordNumberDynData != -1) {
			if (columnsAbbreviationData.containsKey(AbbreviationColumnHeader.ABBREVIATION.toString())) {
				sAbbreviation = resultSetAbbreviationData.get(recordNumberDynData)
						.get(columnsAbbreviationData.get(AbbreviationColumnHeader.ABBREVIATION.toString()));
			} else {
				NoSuchFieldException e = new NoSuchFieldException(
						"Column \"Abbreviation\" does not exist in AbbreviationData");
				throw e;
			}
		} else {
			System.out.println("Element not found in the Name column list");
		}
		// }
		// else
		// {
		// NoSuchFileException e=new NoSuchFileException("File "+sFileName+" does not
		// exist");
		// throw e;
		// }
		// workbookAbbreviationData.close();
		return sAbbreviation;
	}

	String getNumberFormat(String sFieldName, String sTestStepData) throws Exception {
		sFieldName = sFieldName.replace("$$", "");
		// String sCurrentDir = System.getProperty("user.dir");
		// String sFileName =sCurrentDir+"/Master_Data/DataFormat.xlsx";
		String sDataFormat = sTestStepData.trim();
		// File f = new File(sFileName);
		Locale local = null;
		String sType = null, sLocale = null;
		String[] localeParameters = null;
		NumberFormat numberFormat = null;

		// Workbook workbookDataFormat=null;
		Map<String, Integer> columnsDataFormat;
		List<List<String>> resultSetDataFormat;
		// if(f.exists())
		// {
		// workbookDataFormat=ExcelConnection.funExcelConnection(sFileName);
		// columnsDataFormat=ExcelConnection.funGetSheetColumns(workbookDataFormat,
		// "Master");
		// resultSetDataFormat=ExcelConnection.funGetSheetData(workbookDataFormat,
		// "Master");

		columnsDataFormat = ExcelConnection.getMasterDataFileColumns("DataFormat");
		resultSetDataFormat = ExcelConnection.readDataFormat();
		int nameIndex = ExcelConnection.funGetColumnIndex(DataFormatColumnHeader.NAME.toString(), columnsDataFormat);
		int recordNumberDataFormat = ExcelConnection.funGetDynamicDataRecordNumber(nameIndex, sFieldName.trim(),
				resultSetDataFormat);

		if (recordNumberDataFormat != -1) {
			if (columnsDataFormat.containsKey(DataFormatColumnHeader.TYPE.toString())) {
				sType = resultSetDataFormat.get(recordNumberDataFormat)
						.get(columnsDataFormat.get(DataFormatColumnHeader.TYPE.toString()));
			} else {
				NoSuchFieldException e = new NoSuchFieldException("Column \"Type\" does not exist in DataFormat.xlsx");
				throw e;
			}

			if (columnsDataFormat.containsKey(DataFormatColumnHeader.LOCALE.toString())) {
				sLocale = resultSetDataFormat.get(recordNumberDataFormat)
						.get(columnsDataFormat.get(DataFormatColumnHeader.LOCALE.toString()));
			} else {
				NoSuchFieldException e = new NoSuchFieldException(
						"Column \"Locale\" does not exist in DataFormat.xlsx");
				throw e;
			}

			if (sLocale != null) {
				localeParameters = sLocale.split(",");
				local = new Locale(localeParameters[0], localeParameters[1]);
			} else {
				local = new Locale("en", "US");
			}

			switch (sType.trim().toLowerCase()) {
			case "number":
				if (sTestStepData.isEmpty() || sTestStepData == "" || sTestStepData.equals(nullapi)) // Mantis 0001148
					// 0001149
					sTestStepData = "0.00";

				numberFormat = NumberFormat.getInstance(local);
				sDataFormat = numberFormat.format(getDataType(sTestStepData));
				break;

			case "currency":
				if (sTestStepData.isEmpty() || sTestStepData == "" || sTestStepData.equals(nullapi)) // Mantis 0001099
					// 0001149
					sTestStepData = "0.00";

				numberFormat = NumberFormat.getCurrencyInstance(local);
				sDataFormat = numberFormat.format(getDataType(sTestStepData));

				break;

			default: {
				debugLog("DataFormat",
						"The type provided does not exist in the DataFormat.xlsx under Master_Data Folder");
				InvalidTypeException e = new InvalidTypeException("Entered Type '" + sType + "' is invalid");
				throw e;
			}
			}
		} else {
			System.out.println("Name " + sFieldName + " not found in the Name column list");
			debugLog("DataFormat", "Name " + sFieldName + " not found in the Name column list");
		}
		// }
		// else
		// {
		// NoSuchFileException e=new NoSuchFileException("File "+sFileName+" does not
		// exist");
		// throw e;
		// }

		// workbookDataFormat.close();
		return sDataFormat;
	}

	Object getDataType(String inputData) throws Exception {
		Object sTyepData = null;
		String input = inputData.trim();
		java.util.regex.Pattern pat = null;
		java.util.regex.Matcher mat = null;

		String regexOfInt = "[+-]?[0-9][0-9]*";
		String regexOfFloat = "[+-]?[0-9]+(\\.[0-9]+)?([Ee][+-]?[0-9]+)?";
		HashMap<String, String> regexmap = new HashMap<String, String>() {
			{
				put("Integer", regexOfInt);
				put("Float", regexOfFloat);
			}
		};

		List<String> Header = new ArrayList<String>(regexmap.keySet());

		for (int i = 0; i < Header.size(); i++) {
			pat = java.util.regex.Pattern.compile(regexmap.get(Header.get(i)));

			mat = pat.matcher(input);

			if (mat.find() && mat.group().equals(input)) {
				if (Header.get(i).equals("Integer")) {
					System.out.println("Given data is Integer Type");
					sTyepData = Integer.valueOf(input);
				} else if (Header.get(i).equals("Float")) {
					System.out.println("Given data is Float Type");
					sTyepData = Float.valueOf(input);
				}
				break;
			}
		}
		return sTyepData;
	}

	private Map<String, String> getVariables(String sTestStepData, String sTestCaseExcelPath) throws Exception // Mantis
	// 0001098
	{
		LinkedHashMap<String, String> variables = new LinkedHashMap<String, String>();

		if (sTestStepData.contains("|")) {
			ListIterator<String> sDataColumns = new ArrayList<String>(Arrays.asList(sTestStepData.split("\\|")))
					.listIterator();
			while (sDataColumns.hasNext()) {
				String sData = sDataColumns.next();
				if (sData.contains(":")) {
					String[] sParts = sData.split(":");
					if (sParts[1].contains("##")) // Mantis 0001136
					{
						sParts[1] = dynamicSet(sTestCaseData, sParts[1].replaceAll("##", ""));
						variables.put(sParts[0], sParts[1]);
					} else
						variables.put(sParts[0], getDataFromTestSheet(sParts[1].trim(), sTestCaseExcelPath));
				}
			}
		} else {
			if (sTestStepData.contains(":")) {
				String[] sParts = sTestStepData.split(":");
				if (sParts[1].contains("##")) // Mantis 0001136
				{
					sParts[1] = dynamicSet(sTestCaseData, sParts[1].replaceAll("##", ""));
					variables.put(sParts[0], sParts[1]);
				} else
					variables.put(sParts[0], getDataFromTestSheet(sParts[1].trim(), sTestCaseExcelPath));
			}
		}

		return variables;
	}

	String getDataFromTestSheet(String sDataColumn, String sTestCaseExcelPath) throws Exception {
		String sTestData = "";
		sDataColumn = sDataColumn.trim();
		/*-------------Mantis: 0001172---------------*/

		Object JsonData = ExcelConnection.getScriptJsonfromDB(sTestCaseExcelPath);
		Map<String, Integer> dataColumns = ExcelConnection.getColumnNamesFromJson(JsonData, "Data");
		List<List<String>> dataResultSet = ExcelConnection.getSheetDataFromJSON(JsonData, "Data");

		/*-------------Mantis: 0001172---------------*/

		int testCaseColumnIndex = 0;
		if (dataColumns.containsKey(ExecutionDataColumnHeader.TEST_CASE.toString())) {
			testCaseColumnIndex = ExcelConnection.funGetColumnIndex(ExecutionDataColumnHeader.TEST_CASE.toString(),
					dataColumns);
		} else {
			NoSuchFieldException e = new NoSuchFieldException(" Test_Case Column Does Not Exist");
			throw e;
		}

		int testDataRecordNumber = ExcelConnection.funGetTestDataRecordNumber(testCaseColumnIndex, sTestCaseData,
				dataResultSet);
		if (testDataRecordNumber != -1) {
			if (dataColumns.containsKey(sDataColumn)) {
				sTestData = dataResultSet.get(testDataRecordNumber).get(dataColumns.get(sDataColumn));

			} else {
				NoSuchFieldException e = new NoSuchFieldException(
						"Can not find column " + sDataColumn + " inside Data Sheet");
				throw e;
			}
		} else {
			NoSuchFieldException e = new NoSuchFieldException(
					"Can not find Test Case " + sTestCaseData + " inside Data Sheet");
			throw e;
		}

		return sTestData;
	}

	/*
	 * --------------------------------------- START : verifyProperty---------------------------------------------- 
	 * Function Name: verifyProperty 
	 * Objective: A generic Function to verify a particular property
	 * Date Created: 
	 * Input: sControlType = Control Type of the object 
	 * whose property has to be verified. sSearchCriteria = Identifier that uniquely
	 * identifies an object on application; e.g xpath, id etc sSearchText = Value of
	 * an Identifier sVerifyProperty = Property of the object which has to be
	 * verified. iInd = Index of the object in case multiple objects have same text
	 * or id. Output: Revision History: Modified on: Comments:
	 * ---------------------------------------------------------------------------------------------------------
	 */
	String verifyProperty(String sControlType, String sIdentifier, String sIdentifierValue, String sVerifyProperty,
			int iInd, String sData) throws Exception {
		String sIdenVal = null;
		WebElement oCurrentElement;
		String sStatus = "Fail";
		if (sVerifyProperty == null) {

		}
		switch (sVerifyProperty.toLowerCase()) {
		case "text":
			sIdenVal = get(sControlType, sIdentifier, sIdentifierValue, iInd);

			if (sIdenVal != null) {
				if (sIdenVal.equalsIgnoreCase(sData)) {
					sStatus = "Pass";
				} else {
					sStatus = "Fail";
				}
			} else {
				sIdenVal = "";
				sStatus = "Fail";
			}
			sActualValue = sIdenVal;
			break;

		case "list":
			systemouts("Verify List Property");
			if (waitForElement(sIdentifier, sIdentifierValue, iInd)) // Mantis 0000879
			{
				oCurrentElement = getElement(sControlType, sIdentifier, sIdentifierValue, iInd);
				List<WebElement> listElements = oCurrentElement.findElements(By.cssSelector("li"));
				for (int i = 0; i < listElements.size(); i++) {
					systemouts("Inside List");
					String listText = listElements.get(i).getText();
					systemouts("Text in list:" + listText);
					systemouts("Expected Data:" + sData);
					if (listText.equalsIgnoreCase(sData)) {
						sStatus = "Pass";
						sActualValue = listText;
					}
				}
			} else {
				sStatus = "Fail";
				/*
				 * NoSuchElementException e = new
				 * NoSuchElementException("Element search failed with method: \"" + sIdentifier
				 * + "\"  and search Criteria: \"" + sIdentifierValue + "\""); throw e;
				 */
			}
			break;

		default:
			systemouts("Inside Default Property");
			if (waitForElement(sIdentifier, sIdentifierValue, iInd)) // Mantis 0000879
			{
				oCurrentElement = getElement(sControlType, sIdentifier, sIdentifierValue, iInd);
				// TODO add Try catch observer
				sIdenVal = oCurrentElement.getAttribute(sVerifyProperty);

				if (sIdenVal == null) // Mantis 0000907
				{
					if (sVerifyProperty.toLowerCase().equals("checked")
							|| sVerifyProperty.toLowerCase().equals("selected")) // For checkbox and radio button
						// //Mantis 0000912
						sIdenVal = "false";
					else
						sIdenVal = "";
				}

				systemouts("Actual Property Value:" + sIdenVal);
				if (sIdenVal.equalsIgnoreCase(sData)) {
					sStatus = "Pass";
				}
				sActualValue = sIdenVal;
			} else {
				sStatus = "Fail";
				/*
				 * NoSuchElementException e = new
				 * NoSuchElementException("Element search failed with method: \"" + sIdentifier
				 * + "\"  and search Criteria: \"" + sIdentifierValue + "\""); throw e;
				 */
			}
			break;
		}
		// setDefaultContent();
		return sStatus;

	}

	// TODO what is this ???
	void HandleDialogBox() {
		oDriver.switchTo().activeElement();
	}

	/*
	 * --------------------------------------- START :
	 * Startswith---------------------------------------------- Function Name:
	 * startswith Objective: A generic Function to compare start of the string. Date
	 * Created: Input: Output: Revision History: Modified on: Comments:
	 * -----------------------------------------------------------------------------
	 * ----------------------------
	 */
	String startswith(String sControlType, String sIdentifier, String sIdentifierValue, String sVerifyProperty,
			int iInd, String sData) throws Exception // Mantis 0000910
	{
		String sIdenVal = null;
		WebElement oCurrentElement;
		String sStatus = "Fail";
		if (sVerifyProperty == null) {

		}
		switch (sVerifyProperty.toLowerCase()) {
		case "text":
			sIdenVal = get(sControlType, sIdentifier, sIdentifierValue, iInd);

			if (sIdenVal != null) {
				if (sIdenVal.startsWith(sData)) {
					sStatus = "Pass";
				} else {
					sStatus = "Fail";
				}
			} else {
				sIdenVal = "";
				sStatus = "Fail";
			}
			sActualValue = sIdenVal;
			break;
		case "list":
			systemouts("Verify List Property");
			if (waitForElement(sIdentifier, sIdentifierValue, iInd)) // Mantis 0000879
			{
				oCurrentElement = getElement(sControlType, sIdentifier, sIdentifierValue, iInd);
				List<WebElement> listElements = oCurrentElement.findElements(By.cssSelector("li"));
				for (int i = 0; i < listElements.size(); i++) {
					systemouts("Inside List");
					String listText = listElements.get(i).getText();
					systemouts("Text in list:" + listText);
					systemouts("Expected Data:" + sData);
					if (listText.startsWith(sData)) {
						sStatus = "Pass";
						sActualValue = listText;
					}
				}
			} else {
				sStatus = "Fail";
				/*
				 * NoSuchElementException e = new
				 * NoSuchElementException("Element search failed with method: \"" + sIdentifier
				 * + "\"  and search Criteria: \"" + sIdentifierValue + "\""); throw e;
				 */
			}
			break;

		default:
			systemouts("Inside Default Property");
			if (waitForElement(sIdentifier, sIdentifierValue, iInd)) // Mantis 0000879
			{
				oCurrentElement = getElement(sControlType, sIdentifier, sIdentifierValue, iInd);
				// TODO add Try catch observer
				sIdenVal = oCurrentElement.getAttribute(sVerifyProperty);

				if (sIdenVal == null) // Mantis 0000907
				{
					if (sVerifyProperty.toLowerCase().equals("checked")
							|| sVerifyProperty.toLowerCase().equals("selected")) // For checkbox and radio button
						// //Mantis 0000912
						sIdenVal = "false";
					else
						sIdenVal = "";
				}

				systemouts("Actual Property Value:" + sIdenVal);
				if (sIdenVal.startsWith(sData)) {
					sStatus = "Pass";
				}
				sActualValue = sIdenVal;
			} else {
				sStatus = "Fail";
				/*
				 * NoSuchElementException e = new
				 * NoSuchElementException("Element search failed with method: \"" + sIdentifier
				 * + "\"  and search Criteria: \"" + sIdentifierValue + "\""); throw e;
				 */
			}
			break;
		}
		// setDefaultContent();
		return sStatus;

	}

	/*
	 * --------------------------------------- START :
	 * Endswith---------------------------------------------- Function Name:
	 * endswith Objective: A generic Function to compare end of the string. Date
	 * Created: Input: Output: Revision History: Modified on: Comments:
	 * -----------------------------------------------------------------------------
	 * ----------------------------
	 */
	String endswith(String sControlType, String sIdentifier, String sIdentifierValue, String sVerifyProperty, int iInd,
			String sData) throws Exception // Mantis 0000910
	{
		String sIdenVal = null;
		WebElement oCurrentElement;
		String sStatus = "Fail";
		if (sVerifyProperty == null) {

		}
		switch (sVerifyProperty.toLowerCase()) {
		case "text":
			sIdenVal = get(sControlType, sIdentifier, sIdentifierValue, iInd);

			if (sIdenVal != null) {
				if (sIdenVal.endsWith(sData)) {
					sStatus = "Pass";
				} else {
					sStatus = "Fail";
				}
			} else {
				sIdenVal = "";
				sStatus = "Fail";
			}
			sActualValue = sIdenVal;
			break;
		case "list":
			systemouts("Verify List Property");
			if (waitForElement(sIdentifier, sIdentifierValue, iInd)) // Mantis 0000879
			{
				oCurrentElement = getElement(sControlType, sIdentifier, sIdentifierValue, iInd);
				List<WebElement> listElements = oCurrentElement.findElements(By.cssSelector("li"));
				for (int i = 0; i < listElements.size(); i++) {
					systemouts("Inside List");
					String listText = listElements.get(i).getText();
					systemouts("Text in list:" + listText);
					systemouts("Expected Data:" + sData);
					if (listText.endsWith(sData)) {
						sStatus = "Pass";
						sActualValue = listText;
					}
				}
			} else {
				sStatus = "Fail";
				/*
				 * NoSuchElementException e = new
				 * NoSuchElementException("Element search failed with method: \"" + sIdentifier
				 * + "\"  and search Criteria: \"" + sIdentifierValue + "\""); throw e;
				 */
			}
			break;

		default:
			systemouts("Inside Default Property");
			if (waitForElement(sIdentifier, sIdentifierValue, iInd)) // Mantis 0000879
			{
				oCurrentElement = getElement(sControlType, sIdentifier, sIdentifierValue, iInd);
				// TODO add Try catch observer
				sIdenVal = oCurrentElement.getAttribute(sVerifyProperty);

				if (sIdenVal == null) // Mantis 0000907
				{
					if (sVerifyProperty.toLowerCase().equals("checked")
							|| sVerifyProperty.toLowerCase().equals("selected")) // For checkbox and radio button
						// //Mantis 0000912
						sIdenVal = "false";
					else
						sIdenVal = "";
				}

				systemouts("Actual Property Value:" + sIdenVal);
				if (sIdenVal.endsWith(sData)) {
					sStatus = "Pass";
				}
				sActualValue = sIdenVal;
			} else {
				sStatus = "Fail";
				/*
				 * NoSuchElementException e = new
				 * NoSuchElementException("Element search failed with method: \"" + sIdentifier
				 * + "\"  and search Criteria: \"" + sIdentifierValue + "\""); throw e;
				 */
			}
			break;
		}
		// setDefaultContent();
		return sStatus;

	}
	/*
	 * --------------------------------------- START :
	 * Contains---------------------------------------------- Function Name:
	 * contains Objective: A generic Function to check whether substring is present
	 * in main text of element Date Created: Input: Output: Revision History:
	 * Modified on: Comments:
	 * -----------------------------------------------------------------------------
	 * ----------------------------
	 */

	String contains(String sControlType, String sIdentifier, String sIdentifierValue, String sVerifyProperty, int iInd,
			String sData) throws Exception // Mantis 0000910
	{
		String sIdenVal = null;
		WebElement oCurrentElement;
		String sStatus = "Fail";
		if (sVerifyProperty == null) {

		}
		switch (sVerifyProperty.toLowerCase()) {
		case "text":
			sIdenVal = get(sControlType, sIdentifier, sIdentifierValue, iInd);

			if (sIdenVal != null) {
				if (sIdenVal.contains(sData)) {
					sStatus = "Pass";
				} else {
					sStatus = "Fail";
				}
			} else {
				sIdenVal = "";
				sStatus = "Fail";
			}
			sActualValue = sIdenVal;
			break;
		case "list":
			systemouts("Verify List Property");
			if (waitForElement(sIdentifier, sIdentifierValue, iInd)) // Mantis 0000879
			{
				oCurrentElement = getElement(sControlType, sIdentifier, sIdentifierValue, iInd);
				List<WebElement> listElements = oCurrentElement.findElements(By.cssSelector("li"));
				for (int i = 0; i < listElements.size(); i++) {
					systemouts("Inside List");
					String listText = listElements.get(i).getText();
					systemouts("Text in list:" + listText);
					systemouts("Expected Data:" + sData);
					if (listText.contains(sData)) {
						sStatus = "Pass";
						sActualValue = listText;
					}
				}
			} else {
				sStatus = "Fail";
				/*
				 * NoSuchElementException e = new
				 * NoSuchElementException("Element search failed with method: \"" + sIdentifier
				 * + "\"  and search Criteria: \"" + sIdentifierValue + "\""); throw e;
				 */
			}
			break;

		default:
			systemouts("Inside Default Property");
			if (waitForElement(sIdentifier, sIdentifierValue, iInd)) // Mantis 0000879
			{
				oCurrentElement = getElement(sControlType, sIdentifier, sIdentifierValue, iInd);
				// TODO add Try catch observer
				sIdenVal = oCurrentElement.getAttribute(sVerifyProperty);

				if (sIdenVal == null) // Mantis 0000907
				{
					if (sVerifyProperty.toLowerCase().equals("checked")
							|| sVerifyProperty.toLowerCase().equals("selected")) // For checkbox and radio button
						// //Mantis 0000912
						sIdenVal = "false";
					else
						sIdenVal = "";
				}

				systemouts("Actual Property Value:" + sIdenVal);
				if (sIdenVal.contains(sData)) {
					sStatus = "Pass";
				}
				sActualValue = sIdenVal;
			} else {
				sStatus = "Fail";
				/*
				 * NoSuchElementException e = new
				 * NoSuchElementException("Element search failed with method: \"" + sIdentifier
				 * + "\"  and search Criteria: \"" + sIdentifierValue + "\""); throw e;
				 */
			}
			break;
		}
		// setDefaultContent();
		return sStatus;

	}

	/*
	 * --------------------------------------- START :
	 * fileUpload---------------------------------------------- Function Name:
	 * fileUpload Objective: A generic Function to upload a particular file. Date
	 * Created: Input: sFilePath = Path of the file which has to be uploaded.
	 * Output: Revision History: Modified on: Comments:
	 * -----------------------------------------------------------------------------
	 * ----------------------------
	 */
	void fileUpload(String sFilePath) throws InterruptedException, AWTException {
		Thread.sleep(2000);
		StringSelection stringSelection = new StringSelection(sFilePath);
		Toolkit.getDefaultToolkit().getSystemClipboard().setContents(stringSelection, null);
		Thread.sleep(3000);
		Robot robot1 = new Robot();
		robot1.keyPress(KeyEvent.VK_CONTROL);
		robot1.keyPress(KeyEvent.VK_V);
		robot1.keyRelease(KeyEvent.VK_V);
		robot1.keyRelease(KeyEvent.VK_CONTROL);
		robot1.keyPress(KeyEvent.VK_ENTER);
		robot1.keyRelease(KeyEvent.VK_ENTER);
		setDefaultContent();
	}

	/*
	 * --------------------------------------- START :
	 * getExecutionTime---------------------------------------------- Function Name:
	 * getExecutionTime Objective: A Generic Function to get Execution Time Date
	 * Created: Input: dStartDate = Start Time of a test case Output: Revision
	 * History: Modified on: Comments: Calculate the execution time of a scenario
	 * -----------------------------------------------------------------------------
	 * ----------------------------
	 */
	public static String getExecutionTime(Date dStartDate) {
		String sExecutionTime = "";
		SimpleDateFormat d1 = new SimpleDateFormat("dd_MM_yyyy_hh_mm_ss_a");
		try {

			Date sEndDate = d1.parse(new SimpleDateFormat("dd_MM_yyyy_hh_mm_ss_a").format(new Date()));
			// in milliseconds
			long diff = sEndDate.getTime() - dStartDate.getTime();
			long lDiffSeconds = diff / 1000 % 60;
			long lDiffMinutes = diff / (60 * 1000) % 60;
			long lDiffHours = diff / (60 * 60 * 1000) % 24;
			long lDiffDays = diff / (24 * 60 * 60 * 1000);
			if (lDiffDays != 0)
				sExecutionTime = sExecutionTime + lDiffDays + " days ";
			/*
			 * if(lDiffHours!=0) sExecutionTime=sExecutionTime + lDiffHours + ":";
			 */
			sExecutionTime = sExecutionTime + lDiffHours + ":" + lDiffMinutes + ":" + lDiffSeconds;
		} catch (ParseException e) {
			e.printStackTrace();
		}
		return sExecutionTime;
	}

	/*
	 * --------------------------------------- START :
	 * FindTable---------------------------------------------- Function Name: Find
	 * table Objective: A generic Function to find Table from the collection of
	 * tables . Date Created: Input: sSearchCriteria = Identifier that uniquely
	 * identifies a table out of collection of tables on application; e.g xpath, id
	 * etc sSearchText = Value of an Identifier sTestCaseExcelPath = Path of the
	 * webTable excel iInd = Index of the object in case multiple objects have same
	 * text or id. Output: Revision History: Modified by:Heramb Modified
	 * on:03/12/2015 Comments: Modification Comments: Routed Table Identification
	 * through Set Driver thereby applying wait conditions on Table Identification.
	 * -----------------------------------------------------------------------------
	 * ----------------------------
	 */

	public WebElement findTable(String sIdentifier, String sIdentifierValue, String sTestCaseExcelPath, int iInd)
			throws Exception {
		List<WebElement> tables = null;
		WebElement CurTable = null;
		systemouts("Identifier..." + sIdentifier);
		systemouts("Identifier Value..." + sIdentifierValue);
		if (waitForElement("tag", "Table", 0)) // Mantis 0000879
		{
			tables = oDriver.findElements(By.tagName("table"));
			systemouts("Got table collections");
			systemouts("number of tables" + tables.size());
			for (int i = tables.size() - 1; i >= 0; i--) {
				if (tables.get(i).getText().toString().contains(sIdentifierValue)) {
					systemouts("table is found is at location" + i);
					CurTable = tables.get(i);
					systemouts("Found Table..." + CurTable);
					systemouts("Table Text...." + CurTable.getText());
					break;
				}
			}
		}
		return CurTable;
	}

	/*
	 * --------------------------------------- START :
	 * verifyWebTable---------------------------------------------- Function Name:
	 * verifyWebTable Objective: A generic Function to verify the contents of the
	 * table. Date Created: Input: sSearchCriteria = Identifier that uniquely
	 * identifies an object on application; e.g xpath, id etc sSearchText = Value of
	 * an Identifier sTestCaseExcelPath = Path of the webTable excel iInd = Index of
	 * the object in case multiple objects have same text or id. Output: Revision
	 * History: Modified by:Heramb Modified on:03/12/2015, 22/12/2015, 28/01/2016
	 * Comments: Modification Comments: Routed Table Identification through Set
	 * Driver thereby applying wait conditions on Table Identification. -Condition
	 * for searching Table by using its text or content is added -Extra column added
	 * in DataSheet named "ColumnName" to specify cell name in the table.If it is
	 * blank then default description will be useraction
	 * -----------------------------------------------------------------------------
	 * ----------------------------
	 */
	void verifyWebTable(String sIdentifier, String sIdentifierValue, String sTestCaseExcelPath, int iInd,
			String sTestCase) throws Exception // Mantis 0000879
	{
		String sExpectedData = null, sRow = null, sColumn = null, cellData = null, sDescription = null;
		String scurrentTestCase = null; // Mantis 522
		int iStepNo = 0, iRow = 0, iColumn = 0;
		WebElement table = null;
		systemouts("In VerifyWebTable");

		if (sIdentifier.toLowerCase().contains("text") || sIdentifier.toLowerCase().contains("bycontent"))
			table = findTable(sIdentifier, sIdentifierValue, sTestCaseExcelPath, iInd);
		if (table == null) {
			if (waitForElement(sIdentifier, sIdentifierValue, iInd)) // Mantis 0000879
				table = getElement(sControlType, sIdentifier, sIdentifierValue, iInd);
		}

		if (table != null) {
			systemouts("Table Object:" + table);
			Workbook tableWorkbook = ExcelConnection.funExcelConnection(sTestCaseExcelPath);
			Map<String, Integer> tableColumns = ExcelConnection.funGetSheetColumns(tableWorkbook, "Data");
			List<List<String>> tableDataResultSet = ExcelConnection.funGetSheetData(tableWorkbook, "Data");
			ListIterator<List<String>> tableDataIterator = tableDataResultSet.listIterator();
			while (tableDataIterator.hasNext()) {
				try {
					List<String> tableDataRecord = tableDataIterator.next();

					if (tableColumns.containsKey(TableColumnHeader.TEST_CASE.toString())) // Mantis 522
					{
						scurrentTestCase = tableDataRecord
								.get(tableColumns.get(TableColumnHeader.TEST_CASE.toString()));
					}

					if (tableColumns.containsKey(TableColumnHeader.COLUMN_NAME.toString())) {
						sDescription = tableDataRecord.get(tableColumns.get(TableColumnHeader.COLUMN_NAME.toString()));
						if (sDescription == null)
							sDescription = sUserAction;
						systemouts("Step Description before checking null:" + sStepDescription);
						sStepDescription = sDescription;
					} else {
						NoSuchFieldException e = new NoSuchFieldException(
								"Column \"Column_Name\" does not exist in Data Sheet");
						throw e;
					}
					iStepNo++;

					// get row from excel
					if (tableColumns.containsKey(TableColumnHeader.ROW.toString())) {
						sRow = tableDataRecord.get(tableColumns.get(TableColumnHeader.ROW.toString()));
						iRow = Integer.parseInt(sRow);
						systemouts("row :" + iRow);
					} else {
						NoSuchFieldException e = new NoSuchFieldException(
								"Column \"Row\" does not exist in Data Sheet");
						throw e;
					}
					// get column from excel
					if (tableColumns.containsKey(TableColumnHeader.COLUMN.toString())) {
						sColumn = tableDataRecord.get(tableColumns.get(TableColumnHeader.COLUMN.toString()));
						iColumn = Integer.parseInt(sColumn);
						systemouts("column :" + iColumn);
					} else {

						NoSuchFieldException e = new NoSuchFieldException(
								"Column \"Column\" does not exist in Data Sheet");
						throw e;
					}
					// get data to be compared from excel
					if (tableColumns.containsKey(TableColumnHeader.DATA.toString())) {
						sExpectedData = tableDataRecord.get(tableColumns.get(TableColumnHeader.DATA.toString()));
						systemouts("expected data :" + sExpectedData);
					} else {
						NoSuchFieldException e = new NoSuchFieldException(
								"Column \"Data\" does not exist in Data Sheet");
						throw e;
					}

					// if (sExpectedData != null)
					if (sExpectedData != null && sTestCase.equals(scurrentTestCase)) // Mantis 522
					{
						// Get all the tr elements from the table
						List<WebElement> allRows = table.findElements(By.tagName("tr"));
						// systemouts(allRows);

						// Get all the th/td elements from the table
						cellData = allRows.get(iRow).findElements(By.xpath("./th | ./td")).get(iColumn).getText();
						systemouts("actual data: " + cellData);

						// Remove blank spaces from the actual data retrieved
						cellData = cellData.trim();
						cellData = cellData.replaceAll("\\n", " ");

						// Compare obtained WebTable element with element in excel
						if (sExpectedData.equalsIgnoreCase(cellData)) {
							sStepStatus = "Pass";
						} else {
							sStepStatus = "Fail";
						}
						oFunctionLog.setTestStepDetails(sTestCaseData, // Mantis 522
								Integer.toString(iStepNo), sExpectedData, cellData, sStepStatus, sDescription,
								sStepDescription, sScreenShotFilePath, sWebPagePath); // Mantis 0001221
						String sComments = "Expected value :" + sExpectedData + " Actual value :" + cellData; // Mantis
						// 0000703
						processDebugLog(KeywordDrivenFramework.blnError, sComments, sStepStatus); // Mantis 0000703
					} // if closes
				} // try ends
				catch (IndexOutOfBoundsException e1) {
					systemouts("Inside Index out of bound exception");
					sStepStatus = "Fail";
					cellData = "";
					sStepDescription = sDescription = "Invalid Row-Column combination entered (Row:" + iRow + " Column:"
							+ iColumn + ")";
				} finally {
					tableWorkbook.close();
				}
				// oFunctionLog.setTestStepDetails(sTestCaseData, //Mantis 522
				// Integer.toString(iStepNo), sExpectedData, cellData,
				// sStepStatus, sDescription, sStepDescription,sScreenShotFilePath);
			} // while closes
		} else {
			NoSuchElementException e = new NoSuchElementException("Element search failed with method: \"" + sIdentifier
					+ "\"  and search Criteria: \"" + sIdentifierValue + "\"");
			throw e;
		}
		try {
			// setDefaultContent();
		} catch (NoSuchWindowException e) {

		}
	}

	/*
	 * --------------------------------------- START : getData
	 * ---------------------------------------------- Function Name: getData
	 * Objective: A generic Function to get the all the data values present in web
	 * table. Date Created: 07/12/2015 Input: sSearchCriteria = Identifier that
	 * uniquely identifies an object on application; e.g xpath, id etc sSearchText =
	 * Value of an Identifier iInd = Index of the object in case multiple objects
	 * have same text or id. Output: Table data along with row number and column
	 * number. Revision History: Modified by: Modified on: Comments: Modification
	 * Comments:
	 * -----------------------------------------------------------------------------
	 * ----------------------------
	 */
	void getData(String sIdentifier, String sIdentifierValue, int iInd, String sTableName) throws Exception // Mantis
	// 0000879
	{
		char iRow = 0, iColumn = 0;
		WebElement table = null;
		FileWriter fileWriter = null;
		// Mantis 0000443
		String webTableFile = new String("WebTable_");
		webTableFile = webTableFile.concat(sIdentifier + "_" + sIdentifierValue + "_" + iInd);

		if (waitForElement(sIdentifier, sIdentifierValue, iInd)) // Mantis 0000879
		{
			systemouts("Table Name: " + sTableName);
			table = getElement(sControlType, sIdentifier, sIdentifierValue, iInd);

			try {
				// Mantis 0000443
				fileWriter = new FileWriter(System.getProperty("user.dir") + "/WebTables/" + webTableFile + ".csv"); // Mantis
				// 0000796
				systemouts("Connected to csv");
			} catch (IOException e1) {
				e1.printStackTrace();
			}

			// Delimiter used in CSV file
			final String COMMA_DELIMITER = ",";
			final String NEW_LINE_SEPARATOR = "\n";
			final String FILE_HEADER = "Row,Column,Data";
			try {
				fileWriter.append(FILE_HEADER);
				fileWriter.append(NEW_LINE_SEPARATOR);
			} catch (IOException e1) {
				e1.printStackTrace();
			}
			// Add a new line separator after the header
			// Write a table data to the CSV file
			List<WebElement> allRows = table.findElements(By.tagName("tr"));
			try {
				for (WebElement row : allRows) {
					iColumn = 0;
					List<WebElement> cells = row.findElements(By.xpath("./th | ./td"));
					for (WebElement cell : cells) {
						fileWriter.append(new Integer(iRow).toString());
						fileWriter.append(COMMA_DELIMITER);
						fileWriter.append(new Integer(iColumn).toString());
						fileWriter.append(COMMA_DELIMITER);
						WebElement chkele = null; // Mantis 0000727
						if (cell.getText() == null || cell.getText().trim().length() == 0) // Mantis 729
						{
							try {
								chkele = cell.findElement(By.tagName("input"));
							} catch (Exception ex) {

							}
							if (chkele != null) {
								fileWriter.append("\"" + chkele.getAttribute("value") + "\"");
							}

						} else {
							fileWriter.append("\"" + cell.getText() + "\"");
						}
						fileWriter.append(COMMA_DELIMITER);
						fileWriter.append(NEW_LINE_SEPARATOR);
						iColumn++;
					}
					fileWriter.append(NEW_LINE_SEPARATOR);
					iRow++;
				}
			} catch (IOException e) {
				e.printStackTrace();
			}

			try {
				// fileWriter.flush();
				fileWriter.close();
			} catch (IOException e) {
				systemouts("Error while flushing/closing fileWriter !!!");
				e.printStackTrace();
			}
		} else {
			systemouts("Webtable:" + webTableFile + " Not found");
			/// Mantis 0000443
			// NoSuchElementException e = new NoSuchElementException("Element search failed
			/// with method: \"" + sIdentifier + "\" and search Criteria: \"" +
			/// sIdentifierValue + "\"");
			// throw e;
		}
		try {
			// setDefaultContent();
		} catch (NoSuchWindowException e) {

		}
	}

	/*
	 * --------------------------------------- START : getScrollableData
	 * ---------------------------------------------- Matis ID: 0000802 Function
	 * Name: getScrollableData Objective: A generic Function to get the all the
	 * dynamic data values present in web table. Date Created: 02/02/2018 Input:
	 * sSearchCriteria = Identifier that uniquely identifies an object on
	 * application; e.g xpath, id etc sSearchText = Value of an Identifier iInd =
	 * Index of the object in case multiple objects have same text or id.
	 * columnnumber = index of column which containing unique data in web table.
	 * Output: Table data along with row number and column number. Revision History:
	 * Modified by: Modified on: Comments: Modification Comments:
	 * -----------------------------------------------------------------------------
	 * ----------------------------
	 */
	void getScrollableData(String sIdentifier, String sIdentifierValue, int iInd, String columnnumber)
			throws NumberFormatException, Exception // Mantis 0000879
	{
		char iRow = 0, iColumn = 0;
		WebElement table = null;
		FileWriter fileWriter = null;

		String webTableFile = new String("WebTable_");
		String dateFormat = "dd_MM_yyyy_hh_mm_ss_a";
		String newSubDirectory = new SimpleDateFormat(dateFormat).format(new Date());
		webTableFile = webTableFile.concat(sIdentifier + "_" + sIdentifierValue + "_" + iInd + "_");
		webTableFile = webTableFile.concat(newSubDirectory);
		List<String> uniqueColumnData = null;
		uniqueColumnData = new ArrayList<String>();

		if (waitForElement(sIdentifier, sIdentifierValue, iInd)) // Mantis 0000879
		{
			try {
				fileWriter = new FileWriter(System.getProperty("user.dir") + "/WebTables/" + webTableFile + ".csv");
				systemouts("Connected to csv");
			} catch (IOException e1) {
				e1.printStackTrace();
			}

			// Delimiter used in CSV file
			final String COMMA_DELIMITER = ",";
			final String NEW_LINE_SEPARATOR = "\n";
			final String FILE_HEADER = "Row,Column,Data";
			try {
				fileWriter.append(FILE_HEADER);
				fileWriter.append(NEW_LINE_SEPARATOR);
			} catch (IOException e1) {
				e1.printStackTrace();
			}
			// Add a new line separator after the header
			// Write a table data to the CSV file
			int l = 0;
			List<WebElement> allRows = null;
			while ((table == null && allRows == null) && l < iStaleMaxCount) {
				try {
					Thread.sleep(500);
					table = getElement(sControlType, sIdentifier, sIdentifierValue, iInd);
					Thread.sleep(1000);
					allRows = table.findElements(By.tagName("tr"));
				} catch (Exception e) {
					Thread.sleep(100);
					table = getElement(sControlType, sIdentifier, sIdentifierValue, iInd);
					systemouts("1234");
					Thread.sleep(100);
					allRows = table.findElements(By.tagName("tr"));
				}
				l++;
			}
			JavascriptExecutor je = (JavascriptExecutor) oDriver;

			try {
				// for (WebElement row : allRows)
				for (int k = 0; k < allRows.size(); k++) {
					int i = 0;
					List<WebElement> cells = null;
					iColumn = 0;
					while (cells == null && i < iStaleMaxCount) {
						try {
							Thread.sleep(50);
							cells = allRows.get(k).findElements(By.xpath("./th | ./td"));
						} catch (Exception e) {
							Thread.sleep(50);
							table = getElement(sControlType, sIdentifier, sIdentifierValue, iInd);
							Thread.sleep(50);
							allRows = table.findElements(By.tagName("tr"));
							Thread.sleep(50);
							k = 1;
						}
						i++;
					}

					if (!uniqueColumnData.contains(cells.get(Integer.parseInt(columnnumber) - 1).getText())) {
						uniqueColumnData.add(String.valueOf(cells.get(Integer.parseInt(columnnumber) - 1).getText()));

						for (int m = 0; m < cells.size(); m++) {
							fileWriter.append(new Integer(iRow).toString());
							fileWriter.append(COMMA_DELIMITER);
							fileWriter.append(new Integer(iColumn).toString());
							fileWriter.append(COMMA_DELIMITER);
							WebElement chkele = null; // Mantis 0000727
							if (cells.get(m).getText() == null || cells.get(m).getText().trim().length() == 0) // Mantis
								// 729
							{
								try {
									chkele = cells.get(m).findElement(By.tagName("input"));
								} catch (Exception ex) {

								}
								if (chkele != null) {
									fileWriter.append("\"" + chkele.getAttribute("value") + "\"");
								}

							} else {
								fileWriter.append("\"" + cells.get(m).getText() + "\"");
							}
							fileWriter.append(COMMA_DELIMITER);
							fileWriter.append(NEW_LINE_SEPARATOR);
							iColumn++;
						}
						fileWriter.append(NEW_LINE_SEPARATOR);
						iRow++;
					}

					je.executeScript("arguments[0].scrollIntoView(true);", allRows.get(k));

				}
			} catch (IOException e) {
				e.printStackTrace();
			}

			try {
				fileWriter.close();
			} catch (IOException e) {
				systemouts("Error while flushing/closing fileWriter !!!");
				e.printStackTrace();
			}
		} else {
			systemouts("Webtable:" + webTableFile + " Not found");
		}
	}

	/*
	 * --------------------------------------- START :
	 * getImageRowNumber---------------------------------------------- Function
	 * Name: getCellValue Objective: A generic Function to get a row number
	 * containing image in a unique cell Date Created:5/3/2016 Created By: Heramb
	 * Input: sTestCase = Test Case which has to be executed. sIdentifier =
	 * Identifier that uniquely identifies an object on application; e.g xpath, id
	 * etc sIdentifierValue = Value of an Identifier sTestStepData = Column Name
	 * inside Table under which Image is to be searched (Only one unique cell will
	 * contain Image) Output: Revision History: Modified on: Modified By: Comments:
	 * -----------------------------------------------------------------------------
	 * ----------------------------
	 */

	int getImageRowNumber(String sTestCase, String sIdentifier, String sIdentifierValue, String sTestStepData, int iInd)
			throws NoSuchTagException {
		int rowCount, columnCount, column;
		int actualcolumnNumber = 0;
		String columnName = null, actualColumnName;

		table_getRowNo = getElement(sControlType, sIdentifier, sIdentifierValue, iInd);

		// Getting Row Count
		rowCount = table_getRowNo.findElements(By.tagName("tr")).size();
		List<WebElement> allRows = table_getRowNo.findElements(By.tagName("tr"));

		// Getting Column Count
		columnCount = allRows.get(0).findElements(By.xpath("./th | ./td")).size();
		columnName = sTestStepData;

		for (column = 0; column < columnCount; column++) // for finding column number
		{
			actualColumnName = allRows.get(0).findElements(By.xpath("./th | ./td")).get(column).getText();
			if (columnName.equals(actualColumnName)) {
				actualcolumnNumber = column;
				break;
			}
		}
		debugLog("Columns", "Column Count:" + columnCount);
		debugLog("Rows", "Row Count:" + rowCount);
		try {
			for (int i = 1; i < rowCount; i++) {
				// debugLog("Image Opertation", "Inside For Row:"+allRows.get(i));
				List<WebElement> columnData = allRows.get(i).findElements(By.xpath("./th | ./td"));
				// debugLog("Image Opertation", "Inside For
				// Column:"+columnData.get(actualcolumnNumber));
				WebElement image = columnData.get(actualcolumnNumber).findElement(By.tagName("img"));
				systemouts("Image Object:" + image);
				if (image != null) {
					systemouts("Inside Column");
					iObtained_RowNo = i + 1;
					debugLog("RowNumber", "Row:" + iObtained_RowNo);
					break;
				}
			}
		} catch (NoSuchElementException e) {

		}
		// debugLog("Image Opertation", "Out of For");
		systemouts("Found in Row Number:" + iObtained_RowNo);
		if (iObtained_RowNo == 0) {
			NoSuchElementException e = new NoSuchElementException("Element search failed with method: \"" + sIdentifier
					+ "\"  and search Criteria: \"" + sIdentifierValue + "\"");
			throw e;
		}
		return iObtained_RowNo;
	}

	/*
	 * --------------------------------------- START :
	 * getCellValue---------------------------------------------- Function Name:
	 * getCellValue Objective: A generic Function to get value of a cell for a
	 * table. Date Created: Input: sTestCase = Test Case which has to be executed.
	 * sIdentifier = Identifier that uniquely identifies an object on application;
	 * e.g xpath, id etc/ColumnName sIdentifierValue = Value of an Identifier/Name
	 * of Column inside Table sTestStepData = Row Column pair whose value has to be
	 * obtained.(eg. 1,2) sDataColumn= Field_Name with which Cell Value will be
	 * stored in the Execution_Data.xlsx file. iInd = Index of the object in case
	 * multiple objects have same text or id. Output: Revision History: Modified
	 * on:21/12/2015 Modified By: Heramb Comments: Obtained Cell Value is stored in
	 * Execution_Data.xlsx file with Field_Name given under Data Column inside Page
	 * Sheet
	 * -----------------------------------------------------------------------------
	 * ----------------------------
	 */
	String getCellValue(String sTestCase, String sIdentifier, String sIdentifierValue, String sTestStepData, int iInd,
			String sDataColumn, String sRemoveWordsColumn) throws NumberFormatException, Exception // Mantis 0000879
	{
		String sRow, sColumn, cellData = null;
		int iRow, iColumn;
		systemouts("Row Column Combination:" + sDataColumn);
		try {

			if (waitForElement(sIdentifier, sIdentifierValue, iInd)) // Mantis 0000879
			{
				/*
				 * If Row Number and Column Number are provided as part of Test Data inside Data
				 * Sheet e.g. 1,2
				 */
				if (sDataColumn != null) {
					// Mantis 0000466
					if (sPreviousUserAction == "getLastRow") {
						systemouts("inside getLastRow case");
						iRow = iObtained_RowNo;
						sColumn = sTestStepData;
						sPreviousUserAction = "";
					} else {
						systemouts("inside else getcellvalue");
						String[] parts = new String[20];

						parts = sTestStepData.split("\\,");

						sRow = parts[0];
						sColumn = parts[1];

						iRow = Integer.parseInt(sRow);

					}

					iColumn = Integer.parseInt(sColumn);

					systemouts("row col pair: " + iRow + " " + iColumn);

					WebElement table = getElement(sControlType, sIdentifier, sIdentifierValue, iInd);

					// Get all the tr elements from the table
					List<WebElement> allRows = table.findElements(By.tagName("tr"));

					cellData = allRows.get(iRow).findElements(By.xpath("./th | ./td")).get(iColumn).getText();
					systemouts("actual data in cell: " + cellData);
				}

				/*
				 * Row Number is fetched using GetRowNumber or GetImageRowNumber Function and
				 * Column Number will be derived from ColumnName which is provided as
				 * IdentifierValue
				 */
				else {
					cellData = getElement(sControlType, sIdentifier, sIdentifierValue, iInd).getText();
					sDataColumn = sIdentifierValue;
				}

				// Mantis 0000471 & 0000478
				if (cellData != null && sRemoveWordsColumn != null) {
					systemouts("Table Data:" + cellData);
					sTestStepData = sTestStepData.replace(",", ";");
					String sFieldName = sRemoveWordsColumn, sFieldValue = cellData;
					// dynamicGet(sTestCase, sFieldName, sFieldValue);
					dynamicGet(sTestCase, sFieldName, sFieldValue, ""); // Mantis 0000713
					sStepDescription = "GetCellValue";
				} else {
					sTestStepData = sTestStepData.replace(",", ";");
					String sFieldName = sDataColumn, sFieldValue = cellData;
					// dynamicGet(sTestCase, sFieldName, sFieldValue);
					dynamicGet(sTestCase, sFieldName, sFieldValue, "");// Mantis 0000713
					sStepDescription = "GetCellValue";
				}
			}
		} catch (IndexOutOfBoundsException e1) {
			sStepStatus = "Fail";
			sExpectedData = "";
			sStepDescription = "Invalid Row-Column combination entered";
		}
		return cellData;
	}

	/*
	 * --------------------------------------- START :
	 * clickrownumberbyscroll---------------------------------------------- Function
	 * Name: clickrownumberbyscroll Objective: A generic Function to get a row
	 * number which has a unique text value and this function automatically scrolls
	 * down if required value is not available in current context. Date Created:
	 * Created By: Manoj Bamnawat(//Mantis 0000836) Input: sInd = Index
	 * sTestStepData = Combination of Column Name inside Table and unique text value
	 * which is to be searched under the Column Output: Revision History: Modified
	 * on: Modified By: Comments:
	 * -----------------------------------------------------------------------------
	 * ----------------------------
	 */

	void clickrownumberbyscroll(String sIdentifier, String sIdentifierValue, int iIndex, String controlType,
			String sTestStepData) throws Exception {
		int pagedownCounter = 0, actualRowNumber = -1;

		pagedownCounter = 0;
		for (int j = 0; j <= pagedownCounter; j++) {
			actualRowNumber = getRowNumber(sTestStepData, iIndex, 0);
			if (actualRowNumber == -1) {
				sendKeys("page-down");
				Thread.sleep(10);
				pagedownCounter++;
			} else {
				ClickRowControl(sIdentifier, sIdentifierValue, iIndex, controlType, "Y");
			}

		}
	}

	/*
	 * --------------------------------------- START :
	 * getRowNumber---------------------------------------------- Function Name:
	 * getRowNumber Objective: A generic Function to get a row number which has a
	 * unique text value Date Created: Input: sInd = Index sTestStepData =
	 * Combination of Column Name inside Table and unique text value which is to be
	 * searched under the Column Output: Revision History: Modified on: Modified By:
	 * Comments:
	 * -----------------------------------------------------------------------------
	 * ----------------------------
	 */

	int getRowNumber(String sTestStepData, int iInd, int columnIndex) throws Exception {
		int rowCount, columnCount = 0, row;
		int actualcolumnNumber = 0, actualRowNumber = 0;
		String cellValue = null, columnName = null, actualColumnName;
		String actualCellValue, checkValue;
		if (iInd == -1) {
			iInd = 0;
		}
		int colsInRow = 0;
		Map<Integer, String> mapColumns = new HashMap<Integer, String>();

		// Deepankar 13-Sep 16 If last character is not a semicolon add it
		if (sTestStepData.charAt(sTestStepData.length() - 1) != ';') {
			sTestStepData = sTestStepData + ";";
		}

		systemouts("Before getting Row count for active table:"); /// Mantis 0000423

		List<WebElement> allRows = null; // Mantis 0000423 ;
		for (int k = 0; k < 7000; k++) {
			try {
				allRows = activeElement.findElements(By.tagName("tr")); // Active element set by useraction iDentify
				break;
			} catch (Exception ex) {
				systemouts("Stale element found for active table");
				Identify(sTestCaseData, sPreviousIdentifier, sPreviousIdentifierValue, sPreviousTestStepData,
						iPreviousInd);
			}
		} // Mantis 0000423
		rowCount = allRows.size();
		systemouts("Row count:" + rowCount);

		// Getting Column Count from the first row of teh table hence 0
		columnCount = allRows.get(0).findElements(By.xpath("./th | ./td")).size();
		systemouts("Column count:" + columnCount);
		int occurrence = StringUtils.countMatches(sTestStepData, ";");
		String[] checkValues = sTestStepData.split("\\;");

		systemouts("Occurences" + occurrence);

		// Loop the occurrences to create collection of columns with their ordinal
		// position and their values to be searched in grid
		for (int i = 0; i < occurrence; i++) {
			checkValue = checkValues[i];
			int occurrence1 = StringUtils.countMatches(checkValue, "=");
			if (occurrence1 == 0) {
				actualRowNumber = 0;
				break;
			} else {
				String[] parts = checkValue.split("\\=");
				columnName = parts[0];
				cellValue = parts[1];

				for (int column = 0; column < columnCount; column++) // Create a Map of Column values and their column
					// Position
				{
					if (columnIndex >= 0) // Mantis 0000424
					{
						actualcolumnNumber = Integer.parseInt(columnName);
						mapColumns.put(actualcolumnNumber, cellValue);
						break;
					} // Mantis 0000424
					actualColumnName = allRows.get(0).findElements(By.xpath("./th | ./td")).get(column).getText();
					if (columnName.trim().equals(actualColumnName.trim())) {
						actualcolumnNumber = column;
						mapColumns.put(actualcolumnNumber, cellValue);
						break;
					}
				}
			}
		}
		// End Loop the occurrences

		// Create a collection of keys for mapColumns created above
		Set<Integer> mapKeys = mapColumns.keySet();
		int matchesFound = 0, instances = 0; // Initialize to -1 instead of zero mantis-0000374

		for (row = 0; row < rowCount; row++) {

			colsInRow = allRows.get(row).findElements(By.xpath("./th | ./td")).size();
			systemouts("Total columns in Row " + row + " "
					+ allRows.get(row).findElements(By.xpath("./th | ./td")).size());
			if (instances == iInd + 1 && matchesFound > 0) // If Instance is == Index +1 as Index is 0 based
			{
				systemouts("Total " + matchesFound + " columns matched hence not searching further rows");
				break;
			}
			matchesFound = 0; // Initialized after if block to avoid exit of loop
			Iterator<Integer> itr = mapKeys.iterator();

			// Loop the mapKeyset and for each row get column position and then check if
			// value is matching
			while (itr.hasNext() && matchesFound < occurrence) {
				actualcolumnNumber = (int) itr.next();

				if (colsInRow - 1 >= actualcolumnNumber) // Deepankar: Added as column count may be different in
					// different rows
				{
					cellValue = mapColumns.get(actualcolumnNumber);

					// Mantis 729
					actualCellValue = allRows.get(row).findElements(By.xpath("./th | ./td")).get(actualcolumnNumber)
							.getText();
					if (actualCellValue == null || actualCellValue.trim().length() == 0) {
						WebElement chkele = null;
						try {
							chkele = allRows.get(row).findElements(By.xpath("./th | ./td")).get(actualcolumnNumber)
									.findElement(By.tagName("input"));
						} catch (Exception ex) {

						}
						if (chkele != null) {
							systemouts("Input textbox found reading from value property");
							actualCellValue = chkele.getAttribute("value");
						}

					} else {
						systemouts("Value was read from table cell");
					}

					// Mantis 729

					// Mantis 0000728
					/*
					 * WebElement chkele= null; try { chkele=
					 * allRows.get(row).findElements(By.xpath("./th | ./td")).get(actualcolumnNumber
					 * ).findElement(By.tagName("input")); } catch(Exception ex) {
					 * 
					 * } if(chkele==null) { systemouts("No input textbox found reading from cell");
					 * actualCellValue=allRows.get(row).findElements(By.xpath("./th | ./td")).get(
					 * actualcolumnNumber).getText(); //Mantis 0000444 if(actualCellValue==null ||
					 * actualCellValue.length()==0) { actualCellValue=
					 * allRows.get(row).findElements(By.xpath("./th | ./td")).get(actualcolumnNumber
					 * ).getAttribute("innerText"); } //Mantis 0000444 } else {
					 * systemouts("Input textbox found reading from value property");
					 * actualCellValue=chkele.getAttribute("value");
					 * 
					 * }
					 * 
					 */
					systemouts("Actual value:" + actualCellValue);
					if (actualCellValue.trim().equalsIgnoreCase(cellValue.trim())) {
						systemouts("Column:" + actualcolumnNumber + " matched");
						actualRowNumber = row;
						matchesFound++;
						if (matchesFound == occurrence) // If no. of column matches equals to what is asked then
							// increase instance
						{
							instances++;
						}

					} else {
						actualRowNumber = 0;
						break;
					}
				}
			}

		}
		if (instances == iInd + 1) // If Instance is == Index +1 as Index is 0 based
		{
			iObtained_RowNo = actualRowNumber;
			systemouts("Final Row Number: " + iObtained_RowNo);
			return iObtained_RowNo;

		} else {
			iObtained_RowNo = -1;
			return iObtained_RowNo;

		}

	}

	/*
	 * --------------------------------------- START :
	 * getRowNumber---------------------------------------------- Function Name:
	 * getDynamicRowNumber Objective: A generic Function to get a row number which
	 * has a unique text value Date Created: Input: sTestStepData: The data passed
	 * from the the data column sTestCase = Test Case which has to be executed. This
	 * is required to read from the dynamic data sheet sInd = Index Output: Revision
	 * History: Modified on: Modified By: Comments:
	 * -----------------------------------------------------------------------------
	 * ----------------------------
	 */
	int GetDynamicRowNumber(String sTestStepData, String sTestCase, String sDataColumn, int iInd) throws Exception {
		//// Mantis 0000461
		int rowCount, columnNumberInt;
		int actualRowNumber = 0;
		String valueFromExecutionData = null;
		String cellContent = null;

		if (iInd == -1) {
			iInd = 0;
		}

		// Reading data from ExecutionData file
		// Workbook workBookExecutionData =
		// ExcelConnection.funExcelConnection("ExecutionData.xlsx");
		// List<List<String>> data=
		// ExcelConnection.funGetSheetData(workBookExecutionData, "TempStorage");

		Object JsonData = ExcelConnection.getExecutionDatafromDb(); // Mantis: 0001169
		List<List<String>> data = ExcelConnection.getSheetDataFromJSON(JsonData, "TempStorage");
		systemouts("Execution sheet data: " + data);

		for (int i = 0; i < data.size(); i++) {
			// systemouts("row "+i+" from execution data: "+data.get(i)); //Mantis 0000694
			for (int j = 0; j < data.get(i).size(); j++) {
				if (data.get(i).get(0).equalsIgnoreCase(sTestCase)
						&& data.get(i).get(1).equalsIgnoreCase(sDataColumn)) {
					systemouts("Message is: " + data.get(i).get(2));
					valueFromExecutionData = data.get(i).get(2);
					break;
				}
			}
		}
		// End Reading data from ExecutionData file

		List<WebElement> allRows = activeElement.findElements(By.tagName("tr")); // Active element set by useraction
		// iDentify
		rowCount = allRows.size();
		systemouts("row count: " + rowCount);

		String columnNumber = sTestStepData;
		columnNumberInt = Integer.parseInt(columnNumber);
		// columnNumberIndex=columnNumberInt-1; Mantis 0000694

		for (int i = 0; i < rowCount; i++) {
			systemouts("curent row: " + i);
			try {
				// cellContent = allRows.get(i).findElements(By.xpath("./th |
				// ./td")).get(columnNumberIndex).getText();
				cellContent = allRows.get(i).findElements(By.xpath("./th | ./td")).get(columnNumberInt).getText(); // Mantis
				// 0000694

				systemouts("cellContent: " + cellContent + " valueFromExecutionData:" + valueFromExecutionData);

				if (cellContent.trim().equalsIgnoreCase(valueFromExecutionData.trim())) // Mantis 0000694
				{
					systemouts("we got the match");
					iObtained_RowNo = i;
					systemouts("actualRowNumber: " + actualRowNumber);
					break;
				} else {
					// systemouts("did not match"); //Mantis 0000694
				}

			} catch (Exception x) {

				systemouts("Exception occured: " + i);
			}
		}
		systemouts("iObtained_RowNo in dynamic row number: " + iObtained_RowNo);
		return iObtained_RowNo;
	}

	/*
	 * --------------------------------------- START :
	 * getRowNumber---------------------------------------------- Function Name:
	 * Identify Objective: A generic Function to Identify a object and store the
	 * same in memory to perform any further operation. Date Created: 13th September
	 * 2016 Input: sTestCase = Test Case which has to be executed. sIdentifier =
	 * Identifier that uniquely identifies an object on application; e.g xpath, id
	 * etc sIdentifierValue = Value of an Identifier sTestStepData = Combination of
	 * Column Name inside Table and unique text value which is to be searched under
	 * the Column Output: Revision History: Modified on: Modified By: Comments:
	 * -----------------------------------------------------------------------------
	 * ----------------------------
	 */
	void Identify(String sTestCase, String sIdentifier, String sIdentifierValue, String sTestStepData, int iInd)
			throws Exception // Mantis 0000879
	{
		// Mantis 0000423
		sPreviousIdentifier = sIdentifier;
		sPreviousIdentifierValue = sIdentifierValue;
		sPreviousTestStepData = sTestStepData;
		iPreviousInd = iInd;
		//// Mantis 0000423
		WebElement localElement = null;
		int i = 0;
		if (waitForElement(sIdentifier, sIdentifierValue, iInd)) // Mantis 0000879
		{
			while (localElement == null && i < 5000) // Mantis 0000428
			{
				systemouts("Stale count for Identify:" + i);
				localElement = getElement(sControlType, sIdentifier, sIdentifierValue, iInd);
				i++;
				try {
					Thread.sleep(100);
				} catch (InterruptedException e) {
					e.printStackTrace();
				}
			}
			activeElement = localElement;
			systemouts("No of rows in this table: " + activeElement.findElements(By.tagName("tr")).size()); // MANTIS
			// 730
			systemouts("Found: object");
		} else {

			NoSuchElementException e = new NoSuchElementException("Element search failed with method: \"" + sIdentifier
					+ "\"  and search Criteria: \"" + sIdentifierValue + "\"");
			throw e;

		}

	}

	/*
	 * --------------------------------------- START :
	 * getLastRow---------------------------------------------- Function Name:
	 * getLastRow Objective: A generic Function to Identify a table and get the last
	 * row for performing further operations. Date Created: 3rd November 2016 Input:
	 * Output: Revision History: Modified on: Modified By: Comments:
	 * -----------------------------------------------------------------------------
	 * ----------------------------
	 */

	// Mantis 0000466
	int getLastRow() {
		int rowCount;

		sPreviousUserAction = "getLastRow";
		List<WebElement> allRows = activeElement.findElements(By.tagName("tr")); // Active element set by useraction
		// iDentify
		rowCount = allRows.size();
		/*
		 * systemouts("row count: "+rowCount); systemouts("last row: "+(rowCount-1));
		 */

		iObtained_RowNo = rowCount - 1;
		systemouts("iObtained_RowNo in getLastRow: " + iObtained_RowNo);
		return iObtained_RowNo;

	}

	/*
	 * --------------------------------------- START :
	 * dynamicSet---------------------------------------------- Function Name:
	 * dynamicSet Objective: A Generic Function to extract dynamic value from file
	 * and set to the object Date Created: Input: sTestCase = Name of the Test case
	 * sFieldName = Name of the field Output: Revision History: Modified on:
	 * Comments: create an excel connection to ExecutionData.xlsx , if (row exists )
	 * execute a query to get the data by providing test case identifier and
	 * fieldname , close the connection. Else close the connection and throw
	 * exception test case identifier and fieldname does not exist. Return Data.
	 * -----------------------------------------------------------------------------
	 * ----------------------------
	 */

	String dynamicSet(String sTestCase, String sFieldName) throws Exception {
		String sCurrentDir = System.getProperty("user.dir");
		String sData = "";
		Object JsonData = null;
		Workbook exeData = null;
		Map<String, Integer> columnsExeData;
		List<List<String>> resultSetExeData;
		int testCaseColumnIndex = 0, fieldNameColumnIndex = 0;

		JsonData = ExcelConnection.getExecutionDatafromDb(); // Mantis: 0001169
		columnsExeData = ExcelConnection.getColumnNamesFromJson(JsonData, "TempStorage");
		resultSetExeData = ExcelConnection.getSheetDataFromJSON(JsonData, "TempStorage");
		if (columnsExeData.containsKey(ExecutionDataColumnHeader.TEST_CASE.toString())) {
			testCaseColumnIndex = columnsExeData.get(ExecutionDataColumnHeader.TEST_CASE.toString());
		} else {
			NoSuchFieldException e = new NoSuchFieldException("Test_Case column does not exist inside ExecutionData");
			throw e;
		}
		if (columnsExeData.containsKey(ExecutionDataColumnHeader.FIELD_NAME.toString())) {
			fieldNameColumnIndex = columnsExeData.get(ExecutionDataColumnHeader.FIELD_NAME.toString());
		} else {
			NoSuchFieldException e = new NoSuchFieldException("Field_Name column does not exist inside ExecutionData");
			throw e;
		}
		if (columnsExeData.containsKey(ExecutionDataColumnHeader.FIELD_VALUE.toString())) {
			int recordNumber = ExcelConnection.funGetExecutionDataRecordNumber(testCaseColumnIndex,
					fieldNameColumnIndex, sTestCase, sFieldName, resultSetExeData);
			systemouts("Record Number from Execution Data:" + recordNumber);
			if (recordNumber != -1) {
				sData = resultSetExeData.get(recordNumber)
						.get(columnsExeData.get(ExecutionDataColumnHeader.FIELD_VALUE.toString()));
			} else {
				System.out.println("Data with Test case identifier : " + sTestCase	+ " and Field Name : " + sFieldName + " does not exists.");
				NoTempDataPresent e = new NoTempDataPresent("Data with Test case identifier : " + sTestCase	+ " and Field Name : " + sFieldName + " does not exists.");
				throw e;
			}
		} else {
			System.out.println("Field_Value column does not exist inside ExecutionData");
			NoSuchFieldException e = new NoSuchFieldException("Field_Value column does not exist inside ExecutionData");
			throw e;
		}
		return sData;
	}

	// Mantis 0000713
	String dynamicSetComment(String sTestCase, String sFieldName) throws Exception {
		String sCurrentDir = System.getProperty("user.dir");
		// String sFileName =sCurrentDir+"/ExecutionData.xlsx"; //Mantis 0000796
		String sData = "";
		Object JsonData = null;
		Workbook exeData = null;
		Map<String, Integer> columnsExeData;
		List<List<String>> resultSetExeData;
		int testCaseColumnIndex = 0, fieldNameColumnIndex = 0;
		// File file=new File(sFileName);
		// if(file.exists())
		// {
		// exeData=ExcelConnection.funExcelConnection(sFileName);
		// columnsExeData=ExcelConnection.funGetSheetColumns(exeData,"TempStorage");
		// resultSetExeData=ExcelConnection.funGetSheetData(exeData, "TempStorage");

		JsonData = ExcelConnection.getExecutionDatafromDb(); // Mantis: 0001169
		columnsExeData = ExcelConnection.getColumnNamesFromJson(JsonData, "TempStorage");
		resultSetExeData = ExcelConnection.getSheetDataFromJSON(JsonData, "TempStorage");
		if (columnsExeData.containsKey(ExecutionDataColumnHeader.TEST_CASE.toString())) {
			testCaseColumnIndex = columnsExeData.get(ExecutionDataColumnHeader.TEST_CASE.toString());
		} else {
			NoSuchFieldException e = new NoSuchFieldException("Test_Case column does not exist inside ExecutionData");
			throw e;
		}
		if (columnsExeData.containsKey(ExecutionDataColumnHeader.FIELD_NAME.toString())) {
			fieldNameColumnIndex = columnsExeData.get(ExecutionDataColumnHeader.FIELD_NAME.toString());
		} else {
			NoSuchFieldException e = new NoSuchFieldException("Field_Name column does not exist inside ExecutionData");
			throw e;
		}
		if (columnsExeData.containsKey(ExecutionDataColumnHeader.COMMENTS.toString())) {
			int recordNumber = ExcelConnection.funGetExecutionDataRecordNumber(testCaseColumnIndex,
					fieldNameColumnIndex, sTestCase, sFieldName, resultSetExeData);
			systemouts("Record Number from Execution Data:" + recordNumber);
			if (recordNumber != -1) {
				sData = resultSetExeData.get(recordNumber)
						.get(columnsExeData.get(ExecutionDataColumnHeader.COMMENTS.toString()));
			} else {
				NoTempDataPresent e = new NoTempDataPresent("Data with Test case identifier : " + sTestCase
						+ " and Field Name : " + sFieldName + " does not exists.");
				throw e;
			}
		} else {
			NoSuchFieldException e = new NoSuchFieldException("Field_Value column does not exist inside ExecutionData");
			throw e;
		}
		// }
		// else
		// {
		// NoSuchFieldException e=new NoSuchFieldException("File "+sFileName+" does not
		// exist");
		// throw e;
		// }
		// exeData.close();
		return sData;
	}

	/*
	 * 
	 * 
	 * /* --------------------------------------- START :
	 * SendKeys---------------------------------------------- Function Name:
	 * SendKeys Objective: A generic Function to pass a collection of keys to be
	 * pressed at run-time. Date Created: Input: sTestStepData: Set of keys to
	 * pressed separated by "+" Output: Revision History: Modified by: Aboli
	 * Modified on:27/7/15 Comments:
	 * -----------------------------------------------------------------------------
	 * ----------------------------
	 */
	// TODO review
	void sendKeys(String sTestStepData) throws Exception {
		String part = null;
		List<Integer> list = new ArrayList<Integer>();

		try {
			Robot robot = new Robot();
			// TODO IF not required
			int occurrence = StringUtils.countMatches(sTestStepData, "+");
			String[] parts = new String[20];
			// TODO Why \\+
			parts = sTestStepData.split("\\+");
			// Create a stack
			for (int i = 0; i <= occurrence; i++) {
				Thread.sleep(500); // Mantis 0000804
				part = parts[i];
				switch (part.trim().toLowerCase()) {
				case "alt":
					robot.keyPress(KeyEvent.VK_ALT);
					list.add(KeyEvent.VK_ALT);
					break;

				case "ctrl":
					robot.keyPress(KeyEvent.VK_CONTROL);
					list.add(KeyEvent.VK_CONTROL);
					break;

				case "shift":
					robot.keyPress(KeyEvent.VK_SHIFT);
					list.add(KeyEvent.VK_SHIFT);
					break;

				case "enter":
					robot.keyPress(KeyEvent.VK_ENTER);
					list.add(KeyEvent.VK_ENTER);
					break;

				case "f4":
					robot.keyPress(KeyEvent.VK_F4);
					robot.keyRelease(KeyEvent.VK_F4);
					break;

				case "f1":
					robot.keyPress(KeyEvent.VK_F1); // Mantis 712
					robot.keyRelease(KeyEvent.VK_F1);
					break;

				case "f7":
					robot.keyPress(KeyEvent.VK_F7); // Mantis 712
					robot.keyRelease(KeyEvent.VK_F7);
					break;

				case "f8":
					robot.keyPress(KeyEvent.VK_F8); // Mantis 712
					robot.keyRelease(KeyEvent.VK_F8);
					break;

				case "f9":
					robot.keyPress(KeyEvent.VK_F9); // Mantis 712
					robot.keyRelease(KeyEvent.VK_F9);
					break;
				case "delete":
					robot.keyPress(KeyEvent.VK_DELETE);
					list.add(KeyEvent.VK_DELETE);
					break;

				case "esc":
					robot.keyPress(KeyEvent.VK_ESCAPE);
					list.add(KeyEvent.VK_ESCAPE);
					break;

				case "tab":
					robot.keyPress(KeyEvent.VK_TAB);
					list.add(KeyEvent.VK_TAB);
					break;

				case "a":
					robot.keyPress(KeyEvent.VK_A);
					list.add(KeyEvent.VK_A);
					break;

				case "b":
					robot.keyPress(KeyEvent.VK_B);
					list.add(KeyEvent.VK_B);
					break;

				case "c":
					robot.keyPress(KeyEvent.VK_C);
					list.add(KeyEvent.VK_C);
					break;

				case "d":
					robot.keyPress(KeyEvent.VK_D);
					list.add(KeyEvent.VK_D);
					break;

				case "e":
					robot.keyPress(KeyEvent.VK_E);
					list.add(KeyEvent.VK_E);
					break;

				case "f":
					robot.keyPress(KeyEvent.VK_F);
					list.add(KeyEvent.VK_F);
					break;

				case "g":
					robot.keyPress(KeyEvent.VK_G);
					list.add(KeyEvent.VK_G);
					break;

				case "h":
					robot.keyPress(KeyEvent.VK_H);
					list.add(KeyEvent.VK_H);
					break;

				case "i":
					robot.keyPress(KeyEvent.VK_I);
					list.add(KeyEvent.VK_I);
					break;

				case "j":
					robot.keyPress(KeyEvent.VK_J);
					list.add(KeyEvent.VK_J);
					break;

				case "k":
					robot.keyPress(KeyEvent.VK_K);
					list.add(KeyEvent.VK_K);
					break;

				case "l":
					robot.keyPress(KeyEvent.VK_L);
					list.add(KeyEvent.VK_L);
					break;

				case "m":
					robot.keyPress(KeyEvent.VK_M);
					list.add(KeyEvent.VK_M);
					break;

				case "n":
					robot.keyPress(KeyEvent.VK_N);
					list.add(KeyEvent.VK_N);
					break;

				case "o":
					robot.keyPress(KeyEvent.VK_O);
					list.add(KeyEvent.VK_O);
					break;

				case "p":
					robot.keyPress(KeyEvent.VK_P);
					list.add(KeyEvent.VK_P);
					break;

				case "q":
					robot.keyPress(KeyEvent.VK_Q);
					list.add(KeyEvent.VK_Q);
					break;

				case "r":
					robot.keyPress(KeyEvent.VK_R);
					list.add(KeyEvent.VK_R);
					break;

				case "s":
					robot.keyPress(KeyEvent.VK_S);
					list.add(KeyEvent.VK_S);
					break;

				case "t":
					robot.keyPress(KeyEvent.VK_T);
					list.add(KeyEvent.VK_T);
					break;

				case "u":
					robot.keyPress(KeyEvent.VK_U);
					list.add(KeyEvent.VK_U);
					break;

				case "v":
					robot.keyPress(KeyEvent.VK_V);
					list.add(KeyEvent.VK_V);
					break;

				case "w":
					robot.keyPress(KeyEvent.VK_W);
					list.add(KeyEvent.VK_W);
					break;

				case "x":
					robot.keyPress(KeyEvent.VK_X);
					list.add(KeyEvent.VK_X);
					break;

				case "y":
					robot.keyPress(KeyEvent.VK_Y);
					list.add(KeyEvent.VK_Y);
					break;

				case "z":
					robot.keyPress(KeyEvent.VK_Z);
					list.add(KeyEvent.VK_Z);
					break;
				case "windows":
					robot.keyPress(KeyEvent.VK_WINDOWS);
					list.add(KeyEvent.VK_WINDOWS);
					break;

				case "up":
					robot.keyPress(KeyEvent.VK_UP);
					list.add(KeyEvent.VK_UP);
					break;

				case "down":
					robot.keyPress(KeyEvent.VK_DOWN);
					list.add(KeyEvent.VK_DOWN);
					break;

				case "right":
					robot.keyPress(KeyEvent.VK_RIGHT);
					list.add(KeyEvent.VK_RIGHT);
					break;

				case "left":
					robot.keyPress(KeyEvent.VK_LEFT);
					list.add(KeyEvent.VK_LEFT);
					break;

					// Mantis 0000762
				case "page-up":
					robot.keyPress(KeyEvent.VK_PAGE_UP);
					list.add(KeyEvent.VK_PAGE_UP);
					break;
				case "page-down":
					robot.keyPress(KeyEvent.VK_PAGE_DOWN);
					list.add(KeyEvent.VK_PAGE_DOWN);
					break;
				case "-":
					robot.keyPress(KeyEvent.VK_MINUS); // Mantis 0001147
					list.add(KeyEvent.VK_MINUS);
					break;
				}// switch ends
			} // for ends

			if (!list.isEmpty()) {
				for (int i = (list.size() - 1); i >= 0; i--) {
					// systemouts(i);
					robot.keyRelease(list.get(i));
				}
			}

		}

		catch (AWTException e) {
			e.printStackTrace();
		}
	}

	/*
	 * --------------------------------------- START :
	 * dynamicGet---------------------------------------------- Function Name:
	 * dynamicGet Objective: A Generic Function to extract dynamic value and store
	 * into external file Date Created: Input: sTestCase = Name of the Test case
	 * sFieldName = Name of the field sFieldValue = Value of the field Output:
	 * Revision History: Modified on: Comments: create an excel connection to
	 * ExecutionData.xlsx , Run executeUpdate to insert the values(e.g. test case
	 * identifier, fieldname, fieldname value ) in the excel. Close the connection.
	 * -----------------------------------------------------------------------------
	 * ----------------------------
	 */
	// void dynamicGet(String sTestCase,String sFieldName,String sFieldValue) throws
	// IllegalFormatException, IOException, NoSuchFieldException
	// Mantis 0000713
	void dynamicGet(String sTestCase, String sFieldName, String sFieldValue, String comments) throws Exception {
		int testCaseColumnIndex = 0, fieldNameColumnIndex = 0, fieldValueColumnIndex = 0;
		int commentColumnIndex = -1; // Mantis 0000713
		Map<String, Integer> columnsExeData;
		List<List<String>> resultSetExeData;

		Object JsonData = ExcelConnection.getExecutionDatafromDb(); // Mantis: 0001169
		columnsExeData = ExcelConnection.getColumnNamesFromJson(JsonData, "TempStorage");
		resultSetExeData = ExcelConnection.getSheetDataFromJSON(JsonData, "TempStorage");
		if (columnsExeData.containsKey(ExecutionDataColumnHeader.TEST_CASE.toString())) {
			testCaseColumnIndex = columnsExeData.get(ExecutionDataColumnHeader.TEST_CASE.toString());
		} else {
			NoSuchFieldException e = new NoSuchFieldException("Test_Case column does not exist inside ExecutionData");
			throw e;
		}
		if (columnsExeData.containsKey(ExecutionDataColumnHeader.FIELD_NAME.toString())) {
			fieldNameColumnIndex = columnsExeData.get(ExecutionDataColumnHeader.FIELD_NAME.toString());
		} else {
			NoSuchFieldException e = new NoSuchFieldException("Field_Name column does not exist inside ExecutionData");
			throw e;
		}
		if (columnsExeData.containsKey(ExecutionDataColumnHeader.FIELD_VALUE.toString())) {
			fieldValueColumnIndex = columnsExeData.get(ExecutionDataColumnHeader.FIELD_VALUE.toString());
		} else {
			NoSuchFieldException e = new NoSuchFieldException("Field_Value column does not exist inside ExecutionData");
			throw e;
		}
		// Mantis 0000713
		if (comments.trim().length() > 0) {
			systemouts("Comments found");

			if (columnsExeData.containsKey(ExecutionDataColumnHeader.COMMENTS.toString())) {
				commentColumnIndex = columnsExeData.get(ExecutionDataColumnHeader.COMMENTS.toString());
				int recordNumber = ExcelConnection.funGetExecutionDataRecordNumber(testCaseColumnIndex,
						fieldNameColumnIndex, sTestCase, sFieldName, resultSetExeData);
				systemouts("Record Number:" + recordNumber);
				ExcelConnection.putExecutionDataJson(columnsExeData, resultSetExeData, testCaseColumnIndex,
						fieldNameColumnIndex, fieldValueColumnIndex, sTestCase, sFieldName, sFieldValue, recordNumber,
						comments); // Mantis: 0001169
			} else {
				NoSuchFieldException e = new NoSuchFieldException(
						"Comments column does not exist inside ExecutionData");
				throw e;
			}
		} else {
			int recordNumber = ExcelConnection.funGetExecutionDataRecordNumber(testCaseColumnIndex,
					fieldNameColumnIndex, sTestCase, sFieldName, resultSetExeData);
			ExcelConnection.putExecutionDataJson(columnsExeData, resultSetExeData, testCaseColumnIndex,
					fieldNameColumnIndex, fieldValueColumnIndex, sTestCase, sFieldName, sFieldValue, recordNumber,
					comments); // Mantis: 0001169
		}
	}

	/*
	 * --------------------------------------- START :
	 * clickSearch---------------------------------------------- Function Name:
	 * clickSearch Objective: A Specific Function to click on search tab for Waste
	 * management Date Created:25/08/2015 Input: Output: Revision History: Modified
	 * on: Comments:
	 * -----------------------------------------------------------------------------
	 * ----------------------------
	 */
	void clickSearch() throws NoSuchElementException {
		try {
			Robot robot = new Robot();
			WebElement e = oDriver.findElement(By.partialLinkText("Add"));
			robot.mouseMove(e.getLocation().x + 20, e.getLocation().y + 170);
			Thread.sleep(2000);
			robot.mousePress(InputEvent.BUTTON1_DOWN_MASK);
			robot.mouseRelease(InputEvent.BUTTON1_DOWN_MASK);
		} catch (AWTException e) {

		} catch (NoSuchElementException e) {
			NoSuchElementException e1 = new NoSuchElementException(
					"Element search failed with method: \"PartialLink\"  and search Criteria: \"Add\"");
			throw e1;
		} catch (Exception e) {
			NoSuchElementException e1 = new NoSuchElementException(e.getMessage());
			throw e1;
		}
	}

	/*
	 * --------------------------------------- START :
	 * clickSearch---------------------------------------------- Function Name:
	 * ClickRowControl Objective: This function is used to click a control inside a
	 * particular column for a particular table row The target row is set by the
	 * function GetRowNumber Date Created:13/Sept/2016 Input: Output: Revision
	 * History: Modified on: Comments:
	 * -----------------------------------------------------------------------------
	 * ----------------------------
	 */
	void ClickRowControl(String sIdentifier, String sIdentifierValue, int iIndex, String controlType,
			String sTestStepData) throws Exception // Mantis 0000806
	{
		WebElement oCurrentElement = null;
		int iRow = iObtained_RowNo;
		String actualColumnName;

		int columnCount = 0, actualcolumnNumber = -1; // Mantis :374 Initialize to -1 iinsted of 0
		systemouts("Target row:" + iObtained_RowNo);

		// iRow=iRow-1; //This is because of column Header
		sIdentifier = sIdentifier.toLowerCase();
		List<WebElement> allRows = activeElement.findElements(By.tagName("tr")); // table_getRowNo is found un function
		// GetRowNumber

		if ((sIdentifier.toLowerCase()).equalsIgnoreCase("columnname")) {
			String sColumnName = sIdentifierValue;
			systemouts("Column Name is:" + sColumnName);
			columnCount = allRows.get(0).findElements(By.xpath("./th | ./td")).size();

			for (int column = 0; column < columnCount; column++) // for finding column number
			{
				actualColumnName = allRows.get(0).findElements(By.xpath("./th | ./td")).get(column).getText();

				if (sColumnName.equals(actualColumnName)) {
					systemouts("Column number is:" + column);
					actualcolumnNumber = column;
					break;
				}
			}
		} else {
			/// actualcolumnNumber=(Integer.parseInt(sIdentifierValue))-1;//Mantis 0000426
			actualcolumnNumber = (Integer.parseInt(sIdentifierValue));// Mantis 0000426
		}

		if (actualcolumnNumber == -1) // Mantis :374
		{
			sStepStatus = "Fail";
			NoSuchElementException e = new NoSuchElementException("Element search failed with method: \"" + sIdentifier
					+ "\"  and search Criteria: \"" + sIdentifierValue + "\"");
			throw e;
		}
		if (sTestStepData.equalsIgnoreCase("y")) // Mantis 0000805
		{
			if (controlType.toLowerCase().equals("link")) {
				oCurrentElement = allRows.get(iRow).findElements(By.xpath("./th | ./td")).get(actualcolumnNumber)
						.findElement(By.tagName("a"));
				debugLog("Object Sync", "Object Found");
				oCurrentElement.click();
				debugLog("Click", "Link was clicked");
			} else if (controlType.toLowerCase().equals("checkbox")) {
				oCurrentElement = allRows.get(iRow).findElements(By.xpath("./th | ./td")).get(actualcolumnNumber)
						.findElement(By.tagName("input"));
				debugLog("Object Sync", "Object Found");
				oCurrentElement.click();
				debugLog("Click", "Check box  was clicked");

			} else if (controlType.toLowerCase().equals("radio")) // Mantis:0000386
			{
				oCurrentElement = allRows.get(iRow).findElements(By.xpath("./th | ./td")).get(actualcolumnNumber)
						.findElement(By.tagName("input"));
				debugLog("Object Sync", "Object Found");
				oCurrentElement.click();
				debugLog("Click", "Radio button  was clicked");

			} else if (controlType.toLowerCase().equals("div")) // Mantis:0000416
			{
				oCurrentElement = allRows.get(iRow).findElements(By.xpath("./th | ./td")).get(actualcolumnNumber)
						.findElement(By.tagName("div"));
				// Mantis 0000445
				if (oCurrentElement.isDisplayed() == false) {

					Actions actions = new Actions(oDriver);
					actions.moveToElement(oCurrentElement);
					actions.perform();
				}
				//// Mantis 0000445
				debugLog("Object Sync", "Object Found");

				oCurrentElement.click();
				debugLog("Click", "Div  was clicked");

			} else if (controlType.toLowerCase().equals("span")) // Mantis 0000726
			{
				oCurrentElement = allRows.get(iRow).findElements(By.xpath("./th | ./td")).get(actualcolumnNumber)
						.findElement(By.tagName("span"));

				if (oCurrentElement.isDisplayed() == false) {

					Actions actions = new Actions(oDriver);
					actions.moveToElement(oCurrentElement);
					actions.perform();
				}

				debugLog("Object Sync Span", "Object Found");

				oCurrentElement.click();
				debugLog("Click", "Span  was clicked");

			} else if (controlType.toLowerCase().equals("doublespan")) // Mantis 0000724
			{
				oCurrentElement = allRows.get(iRow).findElements(By.xpath("./th | ./td")).get(actualcolumnNumber)
						.findElement(By.tagName("span"));

				if (oCurrentElement.isDisplayed() == false) {
					Actions actions = new Actions(oDriver);
					actions.moveToElement(oCurrentElement);
					actions.perform();
				}
				Actions actionsDouble = new Actions(oDriver);
				actionsDouble.doubleClick(oCurrentElement);
				actionsDouble.perform();

				debugLog("Object Sync Span", "Object Found");

				debugLog("Double Click", "Span  was Double clicked");

			} else if (controlType.toLowerCase().equals("image")) // Mantis 0000801
			{
				if (iRow != -1) // Mantis 0000805
				{
					oCurrentElement = allRows.get(iRow).findElements(By.xpath("./th | ./td")).get(actualcolumnNumber)
							.findElement(By.tagName("img"));

					if (oCurrentElement.isDisplayed() == false) {
						Actions actions = new Actions(oDriver);
						actions.moveToElement(oCurrentElement);
						actions.perform();
					}
					Actions actionsDouble = new Actions(oDriver);
					actionsDouble.doubleClick(oCurrentElement);
					actionsDouble.perform();

					debugLog("Image Click", "Image was clicked");
				}

			}
			// else if(controlType.toLowerCase().equals("textboxverify")) //Mantis 0000721
			else if (controlType.toLowerCase().equals("verifycell")) //// Mantis 729
			{
				oCurrentElement = allRows.get(iRow).findElements(By.xpath("./th | ./td")).get(actualcolumnNumber);

				if (oCurrentElement.getText() == null || oCurrentElement.getText().trim().length() == 0) {

					WebElement chkele = null;
					try {
						chkele = allRows.get(iRow).findElements(By.xpath("./th | ./td")).get(actualcolumnNumber)
								.findElement(By.tagName("input"));
					} catch (Exception ex) {

					}
					if (chkele != null) {
						sActualValue = chkele.getAttribute("value");
						systemouts("Read value from input control");
					}
				} else {
					sActualValue = oCurrentElement.getText();
					systemouts("Read value from table cell");
				}

				if (sActualValue.trim().equals(sTestStepData.trim())) {
					sStepStatus = "Pass";
				} else {
					sStepStatus = "Fail";
				}

			}
		}

	}

	/*
	 * --------------------------------------- START :
	 * closeWindow---------------------------------------------- Function Name:
	 * closeWindow Objective: This function is used to close a new window after
	 * clicking on a link Date Created:2nd Dec 2016 Input: Output: Revision History:
	 * Modified on: Comments:
	 * -----------------------------------------------------------------------------
	 * ----------------------------
	 */
	void closeWindow() {
		// mantis 0000514

		systemouts("inside close window");
		// Mantis 0000515
		try {
			String[] windows = oDriver.getWindowHandles().toArray(new String[oDriver.getWindowHandles().size()]);
			systemouts("Windows length : " + windows);

			oDriver.switchTo().window(windows[(windows.length) - 1]);
			systemouts("Closing current window");
			oDriver.close();
			systemouts("Previous window closed successfully.");
			// oDriver.switchTo().window(windows[0]);
		} catch (NoSuchWindowException e) {

		}
	}

	/*
	 * Region findImage(String sSearchText) throws Exception{ //mantis 0000772,1758
	 * 
	 * Screen s = new Screen();
	 * 
	 * Rectangle rect =null; String rootPath= System.getProperty("user.dir");
	 * systemouts("Searching in folder:" +
	 * rootPath.concat("/images/").concat(sSearchText)); File f = new
	 * File(rootPath.concat("/images/").concat(sSearchText));
	 * 
	 * File[] matchingFiles = f.listFiles();
	 * 
	 * Match mat=null; for(int k=0;k<matchingFiles.length;k++) { try { Pattern pat =
	 * new Pattern(matchingFiles[k].getAbsoluteFile().getPath());
	 * 
	 * if(currentRegion==null) { systemouts("Finding pattern  in the screen: " +
	 * matchingFiles[k].getAbsoluteFile().getPath()); //mat= s.find(pat); // Mantis
	 * 0000780 mat= s.exists(pat, regionTimeout); } else {
	 * systemouts("Finding pattern  in the region:" +
	 * matchingFiles[k].getAbsoluteFile().getPath()); mat= currentRegion.exists(pat,
	 * imageTimeout); //Mantis 0000780 //mat = currentRegion.find(pat); } }
	 * catch(Exception e) {
	 * 
	 * 
	 * } if(mat!=null){ systemouts("Rectangle was found: " +
	 * rootPath.concat("/images/").concat(sSearchText)); rect=mat.getRect(); break;
	 * }
	 * 
	 * 
	 * } if(rect!=null){ //Mantis 0000780 return new Region(rect);
	 * 
	 * } else return null; }
	 */

	public void scrollTo(String sControlType, String sSearchCriteria, String sSearchText, int iInd) throws Exception {
		WebElement oCurrentElement = null;
		int i = 0;
		if (waitForElement(sSearchCriteria, sSearchText, iInd)) // Mantis 0000879
		{
			while (oCurrentElement == null && i < iStaleMaxCount) {
				oCurrentElement = funScrollTo(sSearchCriteria, sSearchText, iInd);
				i++;
			}

			if (i == iStaleMaxCount) {
				NoSuchElementException e = new NoSuchElementException("Element search failed with method: \""
						+ sSearchCriteria + "\"  and search Criteria: \"" + sSearchText + "\"");
				throw e;
			}
		} else {
			systemouts("Click Element Not Found");
			NoSuchElementException e = new NoSuchElementException("Element search failed with method: \""
					+ sSearchCriteria + "\"  and search Criteria: \"" + sSearchText + "\"");
			throw e;
		}

	}

	public WebElement funScrollTo(String sSearchCriteria, String sSearchText, int iInd) throws NoSuchTagException // Mantis
	// 0000786
	{
		WebElement oCurrentElement = null;
		try {

			oCurrentElement = getElement(sControlType, sSearchCriteria, sSearchText, iInd);

			if (oCurrentElement != null) // Mantis:0000375
			{
				JavascriptExecutor je = (JavascriptExecutor) oDriver;
				je.executeScript("arguments[0].scrollIntoView(true);", oCurrentElement);

			}

			return oCurrentElement;
		} catch (Exception e) {

			return null;
		}
	}

	/*
	 * --------------------------------------- START :
	 * systemouts---------------------------------------------- Function Name:
	 * systemouts Objective: This function is used to print message on console
	 * window. Date Created: 06/08/2018 Input: Output: Revision History: Modified
	 * on: Comments: Added as a part of Mantis ID 0000925
	 * -----------------------------------------------------------------------------
	 * ----------------------------
	 */
	private void systemouts(String message) {
		if (allowSysOuts == true)
			System.out.println(message);
	}
	/*
	 * --------------------------------------- START :
	 * checkcountmorethan---------------------------------------------- Function
	 * Name: checkcountmorethan Objective: this function is used to compare the
	 * elements present in the screen by given identifier. the result will be pass
	 * if count of elements are greater than or equal to expected count else the
	 * result will be fail. Date Created: 15/01/2019 Input: Output: Revision
	 * History: Modified on: Comments:
	 * -----------------------------------------------------------------------------
	 * ----------------------------
	 */

	String checkCountMoreThan(String sControlType, String sIdentifier, String sIdentifierValue, String property,
			int iInd, String sData) throws Exception // Mantis 0001077
	{
		String sStatus = "Fail";
		List<WebElement> oCurrentElements = null;
		// JLL_Library Object = null;
		int count;
		// Object = new JLL_Library(oDriver,iCurrentContext,pageWait,frameWait);
		if (waitForElements(lElementWait, sIdentifier, sIdentifierValue)) // Mantis 1758
		{
			oCurrentElements = getElements(sControlType, sIdentifier, sIdentifierValue);
		} else {
			count = 0;
		}
		count = oCurrentElements.size();
		System.err.println("count - " + count);
		if (count >= Integer.parseInt(sData))
			sStatus = "Pass";
		else
			sStatus = "Fail";
		sActualValue = count + "";
		return sStatus;
	}

	public boolean filewait(String sStepData, String sTime) throws Exception // Mantis 0001079
	{
		long StartTime, EndTime, tillWaitTime;
		boolean flag = false;
		StartTime = System.nanoTime() / 1000000000;
		systemouts("Start Time :" + StartTime);
		tillWaitTime = StartTime + Long.parseLong(sTime);
		while ((System.nanoTime() / 1000000000) < tillWaitTime) {
			if (new File(sStepData).exists()) {
				flag = true;
				break;
			}
		}
		EndTime = System.nanoTime() / 1000000000;
		systemouts("End Time :" + EndTime);
		systemouts("Elapsed Time in Seconds:" + Math.round(EndTime - StartTime));
		return flag;
	}

	public void sourceElement(String sControlType, String sSearchCriteria, String sSearchText, int iInd)
			throws Exception // Deepankar
	{
		WebElement oCurrentElement = null;
		int i = 0;
		if (waitForElement(sSearchCriteria, sSearchText, iInd)) // Mantis 0000879
		{
			while (oCurrentElement == null && i < iStaleMaxCount) {
				oCurrentElement = funScrollTo(sSearchCriteria, sSearchText, iInd);
				startElement = oCurrentElement;
				i++;
			}

			if (i == iStaleMaxCount) {
				NoSuchElementException e = new NoSuchElementException("Element search failed with method: \""
						+ sSearchCriteria + "\"  and search Criteria: \"" + sSearchText + "\"");
				throw e;
			}
		} else {
			systemouts("Click Element Not Found");
			NoSuchElementException e = new NoSuchElementException("Element search failed with method: \""
					+ sSearchCriteria + "\"  and search Criteria: \"" + sSearchText + "\"");
			throw e;
		}
	}

	public void targetElement(String sControlType, String sSearchCriteria, String sSearchText, int iInd)
			throws Exception // Deepankar
	{
		WebElement oCurrentElement = null;
		int i = 0;
		if (waitForElement(sSearchCriteria, sSearchText, iInd)) // Mantis 0000879
		{
			while (oCurrentElement == null && i < iStaleMaxCount) {
				oCurrentElement = funScrollTo(sSearchCriteria, sSearchText, iInd);
				endElement = oCurrentElement;
				i++;
			}

			if (i == iStaleMaxCount) {
				NoSuchElementException e = new NoSuchElementException("Element search failed with method: \""
						+ sSearchCriteria + "\"  and search Criteria: \"" + sSearchText + "\"");
				throw e;
			}
		} else {
			systemouts("Click Element Not Found");
			NoSuchElementException e = new NoSuchElementException("Element search failed with method: \""
					+ sSearchCriteria + "\"  and search Criteria: \"" + sSearchText + "\"");
			throw e;
		}
	}

	public void checkSortingOrder(String sControlType, String sIdentifier, String sIdentifierValue,
			String sVerifyProperty, int iIndex, String sExpectedData, String Order) throws Exception // Mantis 0001132
	{
		List<WebElement> elements = null;
		boolean result = true;

		elements = getElements(sControlType, sIdentifier, sIdentifierValue);
		systemouts("No of Elements for Sorting " + elements.size());
		int noOfElements = elements.size();

		String[] arrayoftext = new String[noOfElements];
		String[] aftersort = new String[noOfElements];

		for (int i = 0; i < noOfElements; i++) {
			arrayoftext[i] = elements.get(i).getText();
			aftersort[i] = elements.get(i).getText();
			System.err.println("Before Sort " + aftersort[i]);
		}
		Arrays.sort(aftersort, String.CASE_INSENSITIVE_ORDER);
		if (Order.equals("asc")) {
			result = true;
			for (int i = 0; i < noOfElements; i++) {
				System.err.println("After sort " + aftersort[i]);
				sActualValue = arrayoftext[i];
				sExpectedData = aftersort[i];

				if (!(arrayoftext[i].equals(aftersort[i]))) {
					result = false;
					sStepStatus = "FAIL";
					oFunctionLog.setTestStepDetails(sTestCaseData, Integer.toString(iStepNo), sExpectedData,
							sActualValue, sStepStatus, sDescription, sStepDescription, sScreenShotFilePath,
							sWebPagePath); // Mantis 0001221
				} else {
					sStepStatus = "PASS";
					oFunctionLog.setTestStepDetails(sTestCaseData, Integer.toString(iStepNo), sExpectedData,
							sActualValue, sStepStatus, sDescription, sStepDescription, sScreenShotFilePath,
							sWebPagePath); // Mantis 0001221
				}
			}
			if (result == true) {
				sStepStatus = "PASS";
				sActualValue = "Elements are present in Ascending Order";
			}
			if (result == false) {
				sStepStatus = "FAIL";
				sActualValue = "Elements are Not present in Ascending Order";
			}
		}

		else if (Order.equals("desc")) {
			ArrayList<String> elementlist = new ArrayList<String>(Arrays.asList(aftersort));
			Collections.reverse(elementlist);

			result = true;
			for (int i = 0; i < noOfElements; i++) {
				System.err.println("After sort " + aftersort[i]);
				sActualValue = arrayoftext[i];
				sExpectedData = elementlist.get(i);

				if (!(sActualValue.equals(sExpectedData))) {
					result = false;
					sStepStatus = "FAIL";
					oFunctionLog.setTestStepDetails(sTestCaseData, Integer.toString(iStepNo), sExpectedData,
							sActualValue, sStepStatus, sDescription, sStepDescription, sScreenShotFilePath,
							sWebPagePath); // Mantis 0001221
				} else {
					sStepStatus = "PASS";
					oFunctionLog.setTestStepDetails(sTestCaseData, Integer.toString(iStepNo), sExpectedData,
							sActualValue, sStepStatus, sDescription, sStepDescription, sScreenShotFilePath,
							sWebPagePath); // Mantis 0001221
				}
			}
			if (result == true) {
				sStepStatus = "PASS";
				sActualValue = "Elements are present in Descending Order";
			}
			if (result == false) {
				sStepStatus = "FAIL";
				sActualValue = "Elements are Not present in Descending Order";
			}
		}
	}

	public void checkSortingOrderNumeric(String sControlType, String sIdentifier, String sIdentifierValue,
			String sVerifyProperty, int iIndex, String sExpectedData, String Order) throws Exception // Mantis 0001133
	{

		String reGex = "[\\p{Ps}\\p{Pe}]";
		List<WebElement> elements = null;
		boolean result = true;

		elements = getElements(sControlType, sIdentifier, sIdentifierValue);
		systemouts("No of Elements for Sorting " + elements.size());
		int noOfElements = elements.size();

		String[] arrayoftext = new String[noOfElements];
		Integer[] aftersort = new Integer[noOfElements];

		for (int i = 0; i < noOfElements; i++) {
			arrayoftext[i] = elements.get(i).getText();
			arrayoftext[i] = arrayoftext[i].replaceAll(reGex, "");
			aftersort[i] = Integer.parseInt(elements.get(i).getText().replaceAll(reGex, ""));
			// aftersort[i] = aftersort[i];
			System.err.println("Before Sort " + aftersort[i]);
		}
		Arrays.sort(aftersort);
		if (Order.equals("asc")) {
			result = true;
			for (int i = 0; i < noOfElements; i++) {
				System.err.println("After sort " + aftersort[i]);
				sActualValue = arrayoftext[i];
				sExpectedData = Integer.toString(aftersort[i]);

				if (!(sActualValue.equals(sExpectedData))) {
					result = false;
					sStepStatus = "FAIL";
					oFunctionLog.setTestStepDetails(sTestCaseData, Integer.toString(iStepNo), sExpectedData,
							sActualValue, sStepStatus, sDescription, sStepDescription, sScreenShotFilePath,
							sWebPagePath); // Mantis 0001221
				} else {
					sStepStatus = "PASS";
					oFunctionLog.setTestStepDetails(sTestCaseData, Integer.toString(iStepNo), sExpectedData,
							sActualValue, sStepStatus, sDescription, sStepDescription, sScreenShotFilePath,
							sWebPagePath); // Mantis 0001221
				}
			}
			if (result == true) {
				sStepStatus = "PASS";
				sActualValue = "Elements are present in Ascending Order";
			}
			if (result == false) {
				sStepStatus = "FAIL";
				sActualValue = "Elements are Not present in Ascending Order";
			}
		}

		else if (Order.equals("desc")) {
			// ArrayList<String> elementlist=new
			// ArrayList<String>(Arrays.asList(aftersort));
			Arrays.sort(aftersort, Collections.reverseOrder());
			// Collections.reverse(elementlist);

			result = true;
			for (int i = 0; i < noOfElements; i++) {
				System.err.println("After sort " + aftersort[i]);
				sActualValue = arrayoftext[i];
				sExpectedData = Integer.toString(aftersort[i]);

				if (!(sActualValue.equals(sExpectedData))) {
					result = false;
					sStepStatus = "FAIL";
					oFunctionLog.setTestStepDetails(sTestCaseData, Integer.toString(iStepNo), sExpectedData,
							sActualValue, sStepStatus, sDescription, sStepDescription, sScreenShotFilePath,
							sWebPagePath); // Mantis 0001221
				} else {
					sStepStatus = "PASS";
					oFunctionLog.setTestStepDetails(sTestCaseData, Integer.toString(iStepNo), sExpectedData,
							sActualValue, sStepStatus, sDescription, sStepDescription, sScreenShotFilePath,
							sWebPagePath); // Mantis 0001221
				}
			}
			if (result == true) {
				sStepStatus = "PASS";
				sActualValue = "Elements are present in Descending Order";
			}
			if (result == false) {
				sStepStatus = "FAIL";
				sActualValue = "Elements are Not present in Descending Order";
			}
		}
	}

	public List<List<String>> getApiFieldData(String sTestStepData, String sDataColumn) throws Exception // Mantis
	// 0001136
	{
		String jsonpath = sSetData.get("Input");
		String jsondata = readJSON(jsonpath);
		if (jsondata.length() == 0) {
			throw new Exception("API didnt return any value");
		}
		System.err.print("testdata -> " + sTestStepData);
		List<List<String>> sJSONData = getDataFromAPI(jsondata, sTestStepData);
		return sJSONData;

	}

	public void verifyApiFieldData(String sTestStepData, String sDataColumn) throws Exception // Mantis 0001136
	{
		List<List<String>> sjsondata = getApiFieldData(sTestStepData, sDataColumn);
		if (jsonfieldindex == -1) // Mantis 0001138
		{
			sExpectedData = "No Data in API";
			sStepDescription = "JSON Data is not Present for particular Suite/Floor."; // Mantis 0001138
		} else // Mantis 0001138
		{
			sExpectedData = sjsondata.get(jsonfieldindex).get(0).toString();
			if (sExpectedData.length() == 0) {
				sExpectedData = "No Data in API";
			}
		}
	}

	public void checkallavailability(String sControlType, String sSearchCriteria, String sSearchText) throws Exception // Mantis
	// 0001136
	{
		List<WebElement> oCurrentElements = null;
		// JLL_Library Object = null;
		int count;
		// Object = new JLL_Library(oDriver,iCurrentContext,pageWait,frameWait);
		if (waitForElements(lElementWait, sSearchCriteria, sSearchText)) // Mantis 1758
		{
			oCurrentElements = getElements(sControlType, sSearchCriteria, sSearchText);
		} else {
			count = 0;
		}
		count = oCurrentElements.size();
		System.err.println("Count " + count);
		for (int i = 0; i < count; i++) {
			Thread.sleep(1000);
			System.out.println(" value of i" + i);
			click(sControlType, sSearchCriteria, sSearchText, i);
		}
	}

	public void getallavailability(String sControlType, String sSearchCriteria, String sSearchText) throws Exception // Mantis
	// 0001136
	{
		List<WebElement> oCurrentElements = null;
		// JLL_Library Object = null;
		int count;
		String textelement = "";
		// Object = new JLL_Library(oDriver,iCurrentContext,pageWait,frameWait);
		if (waitForElements(lElementWait, sSearchCriteria, sSearchText)) // Mantis 1758
		{
			oCurrentElements = getElements(sControlType, sSearchCriteria, sSearchText);
		} else {
			count = 0;
		}
		count = oCurrentElements.size();
		System.err.println("Count " + count);
		for (int i = 0; i < count; i++) {
			textelement = textelement + oCurrentElements.get(i).getText() + "~";
		}
		System.err.println("Text Element " + textelement);
		dynamicGet(sTestCaseData, sDataColumn, textelement, "");
	}

	public String[] checksuites(String sControlType, String sIdentifier, String sIdentifierValue) throws Exception // Mantis
	// 0001136
	{
		sStepStatus = "PASS"; // Mantis 0001137
		if (sForLoopCounter == 0) {
			listOfSuit = getElements(sControlType, sIdentifier, sIdentifierValue);
			System.err.println("List of Elements " + listOfSuit.size());
		}
		String selectedvalues[] = sSetData.get("Expected").split("~");
		int suitearraycount = selectedvalues.length;
		String screenvalue = "";
		Boolean foundflag = false;
		// Comparing whether all selected availability are present from matching
		// availability & selected availability

		try // Mantis 0001137
		{
			screenvalue = listOfSuit.get(sForLoopCounter).getText();
		} catch (IndexOutOfBoundsException | NullPointerException e) {
			e.printStackTrace();
			sStepStatus = "FAIL";
			sStepDescription = "Availability selected in Matching Availability screen is not present in Selected Availability screen";
			oFunctionLog.setTestStepDetails(sTestCaseData, Integer.toString(iStepNo), sExpectedData, sActualValue,
					sStepStatus, sDescription, sStepDescription, sScreenShotFilePath, sWebPagePath); // Mantis 0001221
			throw e;
		}
		foundflag = false;
		for (int j = 0; j < suitearraycount; j++) {
			if (screenvalue.contains(selectedvalues[j])) {
				foundflag = true;
				break;
			}
		}
		if (foundflag == false) {
			sStepStatus = "FAIL"; // Mantis 0001137
			sStepDescription = "Availability selected in Matching Availability is not present in Selected Availability";
			oFunctionLog.setTestStepDetails(sTestCaseData, Integer.toString(iStepNo), sExpectedData, sActualValue,
					sStepStatus, sDescription, sStepDescription, sScreenShotFilePath, sWebPagePath); // Mantis 0001221
		}

		// Comparing availability present in selected availability is present in API
		List<List<String>> sjsondata = getApiFieldData(sTestStepData, sDataColumn);
		System.err.println(sjsondata);
		String suitevalues[];
		sStepStatus = "PASS";
		foundflag = false;

		suitevalues = screenvalue.split(" ");
		if (suitevalues[0].compareToIgnoreCase("Suite") == 0) // Mantis 0001138
		{
			System.err.print("data is suite \t");
			for (int j = 0; j < sjsondata.size(); j++) {
				if (sjsondata.get(j).get(0).toString().contains("Ste " + suitevalues[1])) {
					foundflag = true;
					jsonfieldindex = j;
					break;
				}
			}
		} else if (suitevalues[0].compareToIgnoreCase("Floor") == 0) // Mantis 0001138
		{
			System.err.print("data is floor \t " + suitevalues[1]);
			for (int j = 0; j < sjsondata.size(); j++) {
				if (sjsondata.get(j).get(1).toString().contains(suitevalues[1])) {
					foundflag = true;
					jsonfieldindex = j;
					break;
				}
			}
		}
		System.err.println("JSON index " + jsonfieldindex);
		if (foundflag == false) {
			jsonfieldindex = -1; // Mantis 0001138
			sStepStatus = "FAIL"; // Mantis 0001137
			sStepDescription = "Floor / Suite " + suitevalues[1] + " is present on screen but not in API(JSON File)";
			oFunctionLog.setTestStepDetails(sTestCaseData, Integer.toString(iStepNo), sExpectedData, sActualValue,
					sStepStatus, sDescription, sStepDescription, sScreenShotFilePath, sWebPagePath); // Mantis 0001221
		}
		return selectedvalues;
	}

	public void addAllElements(String sControlType, String sSearchCriteria, String sSearchText) throws Exception // Mantis
	// 0001139
	{
		List<WebElement> oCurrentElements = null;
		// JLL_Library Object = null;
		int count;
		int sum = 0;
		// Object = new JLL_Library(oDriver,iCurrentContext,pageWait,frameWait);
		if (waitForElements(lElementWait, sSearchCriteria, sSearchText)) // Mantis 1758
		{
			oCurrentElements = getElements(sControlType, sSearchCriteria, sSearchText);
		} else {
			count = 0;
		}
		count = oCurrentElements.size();
		for (int i = 0; i < count; i++) {
			sum = sum + Integer.parseInt(oCurrentElements.get(i).getText().replaceAll("\\p{P}", ""));
		}
		dynamicGet(sTestCaseData, sDataColumn, "" + sum, "");
		sActualValue = "" + sum;
	}

	String checkPropertyDetails(String sTestCase, String sControlType, String sIdentifier, String sIdentifierValue,
			int iInd, String sVerifyProperty, String sData, String testStepData, String sheetName, String sFilename)
					throws Exception // Mantis 0001098,0001149
	{
		List<WebElement> elements = getElements(sControlType, sIdentifier, sIdentifierValue);
		List<List<String>> sJSONData = null;
		List<String> reportData = new ArrayList<String>();
		List<String> rowdata = new ArrayList<String>();
		String apidata[] = null;

		if (!new File(sFilename).exists()) {
			createReportExcelFile(sFilename, sheetName,
					new ArrayList<String>(Arrays.asList("TestCase", "AddressLine1", "Aero_UI_SubMarket",
							"ODS_API_SubMarket", "Aero_UI_BuildingClass", "ODS_API_BuildingClass",
							"Aero_UI_BuildingStatus", "ODS_API_BuildingStatus", "Aero_UI_YearBuilt/Renov",
							"ODS_API_YearBuilt/Renov", "Aero_UI_Owner", "ODS_API_Owner"))); // Mantis 0001157
		}

		Workbook workBook = ExcelConnection.funExcelConnection(sFilename);
		Map<String, Integer> columData = ExcelConnection.funGetSheetColumns(workBook, sheetName);

		reportData.add(sTestCase);
		reportData.add(sSetData.get("Data"));

		if (sData != null && sData != "") {
			sJSONData = funGetDataFromJSON(sData);
			for (int i = 0; i < sJSONData.size(); i++) {
				rowdata = sJSONData.get(i);
				apidata = rowdata.get(0).toString().split(",");
			}
		}
		if (apidata == null) {
			if (elements.size() > 0) {
				for (int i = 0; i < elements.size(); i++) {
					reportData.add(elements.get(i).getText());
					reportData.add(nullapi);
				}
			} else {
				for (int i = 2; i < columData.size(); i = i + 2) // Mantis 0001158
				{
					reportData.add("Data not found in UI");
					reportData.add(nullapi);
				}
			}
		} else {
			if (elements.size() <= 0) {
				for (int i = 0, j = 0; (i < columData.size() - 2) && j < apidata.length; i++, j++) {
					reportData.add("Data not found in UI");
					if (apidata[j].equals("") || apidata[j].length() == 0) {
						reportData.add(nullapi);
					} else {
						reportData.add(apidata[j]);
					}
				}
			} else {
				for (int i = 0, j = 0; i < elements.size() && j < apidata.length; i++, j++) {
					reportData.add(elements.get(i).getText());
					if (apidata[j].equals("") || apidata[j].length() == 0) {
						reportData.add(nullapi);
					} else {
						reportData.add(apidata[j]);
					}
				}
			}
		}

		excelReportDebugLog(sFilename, sheetName, reportData);
		return "PASS";
	}

	public String modifyteststep(String sTestData, String sTestCaseExcelPath) throws Exception // Mantis 0001097
	{
		String sData = "";
		String sDataParts[] = sTestData.split("\\+");
		for (int i = 0; i < sDataParts.length; i++) {
			if (!sDataParts[i].contains("\"")) {
				sData = sData.concat(getDataFromTestSheet(sDataParts[i].trim(), sTestCaseExcelPath));
			} else {
				sDataParts[i] = sDataParts[i].trim().substring(1, sDataParts[i].length() - 1);
				sData = sData + sDataParts[i];
			}
		}
		return sData;
	}

	public static String decryptpasssword(String encryptedString)
			throws UnsupportedEncodingException, InvalidKeyException, NoSuchAlgorithmException, NoSuchPaddingException,
			InvalidKeySpecException, IllegalBlockSizeException, BadPaddingException // Mantis 0001155
	{
		String UNICODE_FORMAT = "UTF8";
		String DESEDE_ENCRYPTION_SCHEME = "DESede";
		KeySpec myKeySpec;
		SecretKeyFactory mySecretKeyFactory;

		String myEncryptionKey = "neverUnderEstimatePowerOfCom0n@Man";
		String myEncryptionScheme = DESEDE_ENCRYPTION_SCHEME;
		byte[] keyAsBytes = myEncryptionKey.getBytes(UNICODE_FORMAT);
		myKeySpec = new DESedeKeySpec(keyAsBytes);
		mySecretKeyFactory = SecretKeyFactory.getInstance(myEncryptionScheme);
		Cipher cipher = Cipher.getInstance(myEncryptionScheme);
		SecretKey key = mySecretKeyFactory.generateSecret(myKeySpec);

		String decryptedText = null;
		cipher.init(Cipher.DECRYPT_MODE, key);
		Decoder base64decoder = java.util.Base64.getDecoder();
		byte[] encryptedText = base64decoder.decode(encryptedString);
		byte[] plainText = cipher.doFinal(encryptedText);
		decryptedText = bytes2String(plainText);

		return decryptedText;
	}

	private static String bytes2String(byte[] bytes) {
		StringBuffer stringBuffer = new StringBuffer();
		for (int i = 0; i < bytes.length; i++) {
			stringBuffer.append((char) bytes[i]);
		}
		return stringBuffer.toString();
	}

	void cleariecachevbs() throws IOException, InterruptedException // Mantis 0001219
	{
		File vbsfolder = new File(System.getProperty("user.dir") + "\\VBScript");
		if (!vbsfolder.exists()) {
			boolean flag = vbsfolder.mkdir();
			System.err.println("created folder VBScript " + flag);
		}
		if (!new File(System.getProperty("user.dir") + "\\VBScript" + "\\cleariecache.vbs").exists()) {
			System.out
			.println("File not found: " + System.getProperty("user.dir") + "\\VBScript" + "\\cleariecache.vbs"); // 0001450
			throw new NoSuchFileException(
					"File not found: " + System.getProperty("user.dir") + "\\VBScript" + "\\cleariecache.vbs"); // 0001450
			// throw new FileNotFoundException();
		}
		Process proc = null, pq = null;
		int executionstatus;
		List<String> cmds = Arrays.asList("cmd.exe", "/C", "start", "/wait", "cscript", "cleariecache.vbs");
		ProcessBuilder builder = new ProcessBuilder(cmds);
		builder.directory(vbsfolder);
		proc = builder.start();
		proc.waitFor();
		String line = "";
		Boolean simple = true;
		int nprocess = 0;
		// tasklist | find /I /C "rundll32.exe"
		// TASKLIST /FI \"IMAGENAME eq rundll32.exe\"
		while (simple) {
			nprocess = 0;
			proc = Runtime.getRuntime().exec("TASKLIST /FI \"IMAGENAME eq rundll32.exe\"");
			Thread.sleep(5000);
			proc.waitFor();
			BufferedReader reader = new BufferedReader(new InputStreamReader(proc.getInputStream()));
			while ((line = reader.readLine()) != null) {
				if (!line.trim().equals(""))
					nprocess++;
			}
			System.err.print("number of process " + nprocess + " ");
			if (nprocess > 3) {
				System.err.println("Waiting to delete history");
			} else {
				System.err.println("continuing execution");
				break;
			}
		}
	}

	/*
	public static void runvbscript(String testcaseNo, String TestcaseExcelPath, String resultFilepath) throws Exception // Mantis
	// 0001140
	{
		List<List<String>> resultSetPage, resultSetData;
		Map<String, Integer> columnsPage, columnsData;

		String JsonData = ExcelConnection.getScriptJsonfromDB(TestcaseExcelPath);
		columnsPage = ExcelConnection.getColumnNamesFromJson(JsonData, "Page");
		resultSetPage = ExcelConnection.getSheetDataFromJSON(JsonData, "Page");

		columnsData = ExcelConnection.getColumnNamesFromJson(JsonData, "Data");
		resultSetData = ExcelConnection.getSheetDataFromJSON(JsonData, "Data");

		CreateSAPScript cs = new CreateSAPScript(); // Mantis 0001168
		String vbsScript = null;
		vbsScript = cs.CreateSAPScripts(testcaseNo, TestcaseExcelPath, columnsPage, resultSetPage, columnsData,
				resultSetData);

		System.out.println(resultFilepath);
		System.out.println("Executing vbScripts");

		if (vbsScript.equalsIgnoreCase("Failed") == false) {
			System.out.println("Script File Name: " + vbsScript);
			Process vbs = null;
			File vbsFile = new File(vbsScript);
			boolean tmp = vbsFile.exists();
			System.out.println("vbs file exists : " + tmp);
			String str = vbsFile.getAbsolutePath().replaceAll("&", "^&");
			str = str.replaceAll("\\\\", "/");
			System.out.println("file path: " + str);
			resultFilepath = resultFilepath.replaceAll("\\\\", "/");
			try {
				if (vbsFile.exists()) {
					System.out.println("resultFile Path: " + resultFilepath);
					String scenario = KeywordDrivenFramework.getCurrentScenario();
					String[] cscriptCommand = { "cmd.exe", "/c", "start", "/wait", "cscript", vbsScript, testcaseNo,
							scenario, resultFilepath };

					List<String> cmds = Arrays.asList(cscriptCommand);
					ProcessBuilder builder = new ProcessBuilder(cmds);
					builder.directory(new File("c:\\Windows\\SysWOW64\\"));
					vbs = builder.start();
					vbs.waitFor();
				}
			} catch (Exception e) {
				System.out.println("Failed to Execute AS400 script");
				e.printStackTrace();
			} finally {
				vbs.destroy();
			}
		} else {
			System.err.println("Failed to create vbscript file");
		}
	}
	*/

	public boolean toInteger(String testCase, String columnName) // Mantis 0001477
	{
		try {
			if (columnName.trim().length() == 0) {
				debugLog("ToInteger", "Columname has not been provided");
				return false;
			}
			// Reading data from ExecutionData file
			Object JsonData = ExcelConnection.getExecutionDatafromDb(); // Mantis: 0001169
			List<List<String>> data = ExcelConnection.getSheetDataFromJSON(JsonData, "TempStorage");
			Map<String, Integer> columData = ExcelConnection.getColumnNamesFromJson(JsonData, "TempStorage");

			int fieldColumnIndex = ExcelConnection.funGetColumnIndex(ExecutionDataColumnHeader.FIELD_NAME.toString(),
					columData);
			int testCaseColumnIndex = ExcelConnection.funGetColumnIndex(ExecutionDataColumnHeader.TEST_CASE.toString(),
					columData);
			int fieldValueIndex = ExcelConnection.funGetColumnIndex(ExecutionDataColumnHeader.FIELD_VALUE.toString(),
					columData);
			int targetRow = ExcelConnection.funGetExecutionDataRecordNumber(testCaseColumnIndex, fieldColumnIndex,
					testCase, columnName, data);
			if (targetRow == -1) {
				debugLog("ToInteger", "Could not find data for testcase :" + testCase + " Column:" + sDataColumn);
				return false;
			}
			String cellValue = data.get(targetRow).get(fieldValueIndex);
			cellValue = (int) Double.parseDouble(cellValue) + "";
			sActualValue = cellValue;

			// ExcelConnection.funPutExecutionDataRecord(workBookExecutionData,
			// "TempStorage", targetRow, testCaseColumnIndex, fieldColumnIndex,
			// fieldValueIndex, testCase, columnName, cellValue.trim(),
			// "ExecutionData.xlsx");
			// Mantis 0000713
			ExcelConnection.putExecutionDataJson(columData, data, testCaseColumnIndex, fieldColumnIndex,
					fieldValueIndex, testCase, columnName, cellValue, targetRow, ""); // Mantis: 0001169
			return true;
		} catch (Exception e) {
			return false;
		}
	}

	public boolean waitForElements(long lElementWait, String sSearchCriteria, String sSearchText) throws Exception // Mantis
	// 1758
	{
		long StartTime, EndTime, tillWaitTime;
		boolean flag = false;

		StartTime = System.nanoTime() / 1000000000;
		System.out.println("Start Time :" + StartTime);

		tillWaitTime = StartTime + lElementWait;

		while ((System.nanoTime() / 1000000000) < tillWaitTime) {
			if (setDriver(sSearchCriteria, sSearchText)) {
				flag = true;
				break;
			} else
				System.out.println("Continue");
		}

		EndTime = System.nanoTime() / 1000000000;
		System.out.println("End Time :" + EndTime);
		System.out.println("Elapsed Time in Seconds:" + Math.round(EndTime - StartTime));

		return flag;
	}

	public boolean setDriver(String sSearchCriteria, final String sSearchText) throws Exception // Mantis 1758
	{
		boolean flag = false;
		// List <WebElement> lElement;
		FluentWait<WebDriver> wait;

		if (iCurrentContext == 0) {
			wait = pageWait;
		} else {
			wait = frameWait;
		}

		switch (sSearchCriteria.toLowerCase()) {
		case "xpath":
			try {
				wait.until(new Function<WebDriver, List<WebElement>>() {
					public List<WebElement> apply(WebDriver oDriver) {
						if (oDriver.findElements(By.xpath(sSearchText)).size() == 0) // Mantis 0001755
							throw new NoSuchElementException("Element not found ");
						return oDriver.findElements(By.xpath(sSearchText));
					}
				});

				flag = true;
				return true;
			} catch (NoSuchElementException e) {
				System.out.println("Searching for elements with xpath " + sSearchText);
				flag = false;
			} catch (TimeoutException t) {
				System.out.println("Searching for elements with xpath " + sSearchText);
				flag = false;
			}
			break;

		case "id":
			try {
				wait.until(new Function<WebDriver, List<WebElement>>() {
					public List<WebElement> apply(WebDriver oDriver) {
						if (oDriver.findElements(By.id(sSearchText)).size() == 0) // Mantis 0001755
							throw new NoSuchElementException("Element not found ");
						return oDriver.findElements(By.id(sSearchText));
					}
				});

				flag = true;
				return true;
			} catch (NoSuchElementException e) {
				System.out.println("Searching for elements with id " + sSearchText);
				flag = false;
			} catch (TimeoutException t) {
				System.out.println("Searching for elements with id " + sSearchText);
				flag = false;
			}
			break;

		case "class":
			try {
				wait.until(new Function<WebDriver, List<WebElement>>() {
					public List<WebElement> apply(WebDriver oDriver) {
						if (oDriver.findElements(By.className(sSearchText)).size() == 0) // Mantis 0001755
							throw new NoSuchElementException("Element not found ");
						return oDriver.findElements(By.className(sSearchText));
					}
				});

				flag = true;
				return true;
			} catch (NoSuchElementException e) {
				System.out.println("Searching for elements with class " + sSearchText);
				flag = false;
			} catch (TimeoutException t) {
				System.out.println("Searching for elements with class " + sSearchText);
				flag = false;
			}
			break;

		case "linktext":
			try {
				wait.until(new Function<WebDriver, List<WebElement>>() {
					public List<WebElement> apply(WebDriver oDriver) {
						if (oDriver.findElements(By.linkText(sSearchText)).size() == 0) // Mantis 0001755
							throw new NoSuchElementException("Element not found ");
						return oDriver.findElements(By.linkText(sSearchText));
					}
				});

				flag = true;
				return true;
			} catch (NoSuchElementException e) {
				System.out.println("Searching for elements with linktext " + sSearchText);
				flag = false;
			} catch (TimeoutException t) {
				System.out.println("Searching for elements with linktext " + sSearchText);
				flag = false;
			}
			break;

		case "partiallink":

			try {
				wait.until(new Function<WebDriver, List<WebElement>>() {
					public List<WebElement> apply(WebDriver oDriver) {
						if (oDriver.findElements(By.partialLinkText(sSearchText)).size() == 0) // Mantis 0001755
							throw new NoSuchElementException("Element not found ");
						return oDriver.findElements(By.partialLinkText(sSearchText));
					}
				});

				flag = true;
				return true;
			} catch (NoSuchElementException e) {
				System.out.println("Searching for elements with partiallink " + sSearchText);
				flag = false;
			} catch (TimeoutException t) {
				System.out.println("Searching for elements with partiallink " + sSearchText);
				flag = false;
			}
			break;

		case "name":
			try {
				wait.until(new Function<WebDriver, List<WebElement>>() {
					public List<WebElement> apply(WebDriver oDriver) {
						if (oDriver.findElements(By.name(sSearchText)).size() == 0) // Mantis 0001755
							throw new NoSuchElementException("Element not found ");
						return oDriver.findElements(By.name(sSearchText));
					}
				});

				flag = true;
				return true;
			} catch (NoSuchElementException e) {
				System.out.println("Searching for elements with name " + sSearchText);
				flag = false;
			} catch (TimeoutException t) {
				System.out.println("Searching for elements with name " + sSearchText);
				flag = false;
			}
			break;
		case "css":
			try {
				wait.until(new Function<WebDriver, List<WebElement>>() {
					public List<WebElement> apply(WebDriver oDriver) {
						if (oDriver.findElements(By.cssSelector(sSearchText)).size() == 0) // Mantis 0001755
							throw new NoSuchElementException("Element not found ");
						return oDriver.findElements(By.cssSelector(sSearchText));
					}
				});

				flag = true;
				return true;
			} catch (NoSuchElementException e) {
				System.out.println("Searching for elements with css " + sSearchText);
				flag = false;
			} catch (TimeoutException t) {
				System.out.println("Searching for elements with css " + sSearchText);
				flag = false;
			}
			break;

		case "tag":
			try {
				wait.until(new Function<WebDriver, List<WebElement>>() {
					public List<WebElement> apply(WebDriver oDriver) {
						if (oDriver.findElements(By.tagName(sSearchText)).size() == 0) // Mantis 0001755
							throw new NoSuchElementException("Element not found ");
						return oDriver.findElements(By.tagName(sSearchText));
					}
				});

				flag = true;
				return true;
			} catch (NoSuchElementException e) {
				System.out.println("Searching for elements with tag " + sSearchText);
				flag = false;
			} catch (TimeoutException t) {
				System.out.println("Searching for elements with tag " + sSearchText);
				flag = false;
			}
			break;

		case "span":
			try {
				wait.until(new Function<WebDriver, List<WebElement>>() {
					public List<WebElement> apply(WebDriver oDriver) {
						if (oDriver.findElements(By.tagName("span")).size() == 0) // Mantis 0001755
							throw new NoSuchElementException("Element not found ");
						return oDriver.findElements(By.tagName("span"));
					}
				});

				flag = true;
				return true;
			} catch (NoSuchElementException e) {
				System.out.println("Searching for elements with span");
				flag = false;
			} catch (TimeoutException t) {
				System.out.println("Searching for elements with span");
				flag = false;
			}
			break;

		case "label":
			try {
				wait.until(new Function<WebDriver, List<WebElement>>() {
					public List<WebElement> apply(WebDriver oDriver) {
						if (oDriver.findElements(By.tagName("label")).size() == 0) // Mantis 0001755
							throw new NoSuchElementException("Element not found ");
						return oDriver.findElements(By.tagName("label"));
					}
				});

				flag = true;
				return true;
			} catch (NoSuchElementException e) {
				System.out.println("Searching for elements with label ");
				flag = false;
			} catch (TimeoutException t) {
				System.out.println("Searching for elements with label ");
				flag = false;
			}
			break;

		default:
			Exception e = new Exception("Given" + sSearchCriteria + "is invalid...!!!");
			throw e;
		}
		iCurrentContext++;

		if (flag == false) {
			try {
				if (iCurrentContext == 1) {
					setDefaultContent(oDriver);
					flag = setDriver(sSearchCriteria, sSearchText);
				} else {
					int frameSize = oDriver.findElements(By.tagName("frame")).size();
					int iframeSize = oDriver.findElements(By.tagName("iframe")).size();
					int totalframes = frameSize + iframeSize;
					System.out.println("Total Frames: " + totalframes);
					for (int i = 0; i < totalframes; i++) {
						oDriver.switchTo().frame(i);
						flag = setDriver(sSearchCriteria, sSearchText);
						if (flag == true) {
							break;
						} else {
							oDriver.switchTo().parentFrame();
						}
					}
				}
			} catch (NoSuchFrameException e) {
				oDriver.switchTo().parentFrame();
				return false;
			}
		}

		if (flag == false) {
			return false;
		} else
			return true;

	}

	void setDefaultContent(WebDriver oDriver) // Mantis 1758
	{
		try {
			oDriver.switchTo().defaultContent();
		} catch (NoSuchWindowException e) {
		} catch (UnhandledAlertException e) {
		}
	}

	private String getJSONValue(String sTestCaseData, String sDataColumn) throws IllegalFormatException, JSONException,
	NoSuchFieldException, NoTempDataPresent, IOException, CustomException, Exception { // Mantis 0001331,0001815

		JSONArray jsonArray = null;
		JSONObject jsonData = null;
		JSONArray cols = null;
		String value = "";
		String jsonString = dynamicSet(sTestCaseData, sDataColumn);
		jsonArray = new JSONArray(jsonString);
		cols = jsonArray.getJSONObject(0).names();

		try {
			if (jsonArray.length() > 0) {
				jsonData = jsonArray.getJSONObject(0);
				value = jsonData.get(cols.getString(0)).toString();
				dynamicGet(sTestCaseData, sDataColumn, value, "");
			}
		} catch (Exception e) {
			throw new CustomException("Data does not exist in JSON " + jsonString);
		}
		return value;
	}

	public String storeCoordinateValue(String sControlType, String sSearchCriteria, String sSearchText, int iInd) // Mantis
	// 0001812,0001816
			throws Exception {
		String sData = new String();
		int x, y, w, h;
		WebElement oCurrentElement = null; // Mantis 0001928
		if (waitForElement(sSearchCriteria, sSearchText, iInd)) // Mantis 0000879
		{
			oCurrentElement = getElement(sControlType, sSearchCriteria, sSearchText, iInd);
			int i = 0;
			while (oCurrentElement == null && i < iStaleMaxCount) // Mantis 0000855
			{
				oCurrentElement = getElement(sControlType, sSearchCriteria, sSearchText, iInd);
				i++;
			}
			String CntlType = getControlType(oCurrentElement, sControlType); // Mantis 0000788
		} else // Mantis 0001928
		{
			NoSuchElementException e = new NoSuchElementException(
					"Element not found with locator " + sSearchCriteria + " - " + sSearchText);
			throw e;
		}
		if (oCurrentElement != null) {
			x = oCurrentElement.getLocation().x;
			y = oCurrentElement.getLocation().y;
			w = oCurrentElement.getSize().width;
			h = oCurrentElement.getSize().height;
			sData = x + "," + y + "," + (x + w) + "," + (y + h);
			return sData;
		} else // Mantis 0001928
		{
			NoSuchElementException e = new NoSuchElementException(
					"Element not found with locator " + sSearchCriteria + " - " + sSearchText);
			throw e;
		}
	}

	void storeDataInReport() {

		if (customReport == false) {

			System.out.println("No Data to generate Custom Report, check useraction 'storedatainreport' for detail");
			return;

		}
		try {

			FileWriter oFileWriter = null;
			if (customReportFilename.trim().length() == 0) // Report file is not generated
			{
				String sCurDate = new String("ReportData"); // Mantis 0000928 ,0001823
				// sCurDate = sCurDate.concat(new
				// SimpleDateFormat(KeywordDrivenFramework.sTimeStampFormat).format(new
				// Date()));
				customReportFilename = KeywordDrivenFramework.resultLogDirectory.concat("/" + sCurDate) + ".xlsx";
				ExcelConnection.WriteDataInExcel(customReportFilename, customReportDataHeader, customReportData, "new");
				customReportData.clear();
			} else // Report file is generated
			{
				ExcelConnection.WriteDataInExcel(customReportFilename, customReportDataHeader, customReportData,
						"exist");
				customReportData.clear();
			}

		} catch (Exception e) {
			e.printStackTrace();
		}
		System.out.println("CustomReport file name " + customReportFilename);
		System.out.println("row heading " + customReportDataHeader.size());
		System.out.println("Full DAta " + customReportData);

	}

	public String checkcustomfile(String name) // Mantis 0001836
	{
		for (String extension : fileextension) {
			String filename = filelocation + "\\" + name + "." + extension;
			// System.err.println(filename);
			if (new File(filename).exists()) {
				System.out.println("File " + filename + " found.");
				return filename;
			}
		}
		return "fail";
	}

	public void saveDataReturnForNaukri(String sTestStepData, JSONArray returnDataCustom) // Mantis 0001894
	{
		String sData = "";
		System.out.println("Data returned from custom " + returnDataCustom);
		if (sTestStepData.toLowerCase().contains("saveexperiencedetails"))
			sTestStepData = "Experience_Details";
		else
			sTestStepData = "Project_Details";
		customReport = true;
		if (customReportDataHeader.size() == 0) {
			customReportDataHeader.put(customReportDataHeader.size(), "Sr.No.");
			customReportDataHeader.put(customReportDataHeader.size(), "Test_Case");
		}
		if (!customReportDataHeader.containsValue(sTestStepData))
			customReportDataHeader.put(customReportDataHeader.size(), sTestStepData);

		if (returnDataCustom == null || returnDataCustom.length() == 0)
			sData = "-";
		else
			sData = returnDataCustom.toString();

		rowdata.add(sData); // storedatainreport
	}

	public void executeImageVerification(String Driver) throws Exception // Mantis 0001911
	{
		if (imageCollection == null || imageCollection.size() == 0)
			return;
		JSONArray array = new JSONArray();
		JSONObject jsonObject = new JSONObject();
		String pythoninput = KeywordDrivenFramework.resultLogDirectory + "\\PythonInput.txt";
		try {
			ImageVerificationFeature.webserver = ExcelConnection.getPollerConfiguration("WebServer"); // Mantis 0001917
		} catch (Exception e2) {
			// TODO Auto-generated catch block
			e2.printStackTrace();
			throw e2;
		}
		try {
			// for baseline images
			imageCollection = ImageVerificationFeature.updateDatabase(Driver, imageCollection, scriptTestCase);
		} catch (Exception e1) {
			System.out.println("Error while updating Base line image");
			e1.printStackTrace();
			throw e1;
		}
		try {
			ImageVerificationFeature.generatePythonInputFile(imageCollection, pythoninput);
		} catch (Exception e) {
			System.out.println("Error while writing into PythonInput.txt file");
			throw e;
		}
		// calling python program
		try {
			// Mantis 0001917
			String webServerPath = Webserver.replaceAll("\\\\", "/");
			int startfolderindex = -1;
			if (webServerPath.startsWith("//")) {
				startfolderindex = webServerPath.indexOf("."); // ipaddress
				startfolderindex = webServerPath.indexOf("/", startfolderindex);
			} else if (webServerPath.charAt(1) == ':') {
				startfolderindex = webServerPath.indexOf("/");
			}
			webServerPath = webServerPath.substring(0, startfolderindex);
			System.err.println(webServerPath);

			String programpath = System.getProperty("user.dir") + "/VisualVerification";
			if (!new File(programpath).exists())
				throw new Exception("Folder VisualVerification is not present");
			if (!new File(programpath + "/HighlightImage.py").exists())
				throw new Exception("File HighlightImage.py is not present at location " + programpath);
			// Mantis 0001917
			Process proc = null;
			List<String> cmds = Arrays.asList("cmd.exe", "/C", "start", "/wait", "python", "HighlightImage.py",
					pythoninput, webServerPath); // Mantis 0001913
			ProcessBuilder builder = new ProcessBuilder(cmds);
			builder.directory(new File(programpath));
			proc = builder.start();
			proc.waitFor();
		} catch (IOException | InterruptedException e) {
			System.out.println("Error occured while processing image comparison");
			e.printStackTrace();
			throw e;
		} catch (Exception e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
			System.out.println("Error occured while processing image comparison");
			throw e;
		}
		// writing to database
		try {
			ImageVerificationFeature.UpdateImageResults(Driver);
			imageCollection.clear();
		} catch (Exception e) {
			System.out.println("Error while writing data into ImageVerificationResults Daa");
			e.printStackTrace();
			throw e;
		}

	}

	public String getValueFromDataSheet(String Driver, String sTestCaseExcelPath, String sTestCaseData,
			String sDataColumn) throws Exception // Mantis 0001911
	{
		Workbook dataWorkbook = null;
		Map<String, Integer> dataColumns = null;
		List<List<String>> dataResultSet = null;
		String returnValue = "";

		if (Driver.startsWith("{")) {
			Object JsonData = ExcelConnection.getScriptJsonfromDB(sTestCaseExcelPath);
			dataColumns = ExcelConnection.getColumnNamesFromJson(JsonData, "Data");
			dataResultSet = ExcelConnection.getSheetDataFromJSON(JsonData, "Data");
		} else {
			dataWorkbook = ExcelConnection.funExcelConnection(sTestCaseExcelPath);
			dataColumns = ExcelConnection.funGetSheetColumns(dataWorkbook, "Data");
			dataResultSet = ExcelConnection.funGetSheetData(dataWorkbook, "Data");
		}
		// Mantis 0000677
		int testCaseColumnIndex = 0;
		if (dataColumns.containsKey(ExecutionDataColumnHeader.TEST_CASE.toString())) {
			testCaseColumnIndex = ExcelConnection.funGetColumnIndex(ExecutionDataColumnHeader.TEST_CASE.toString(),
					dataColumns);

		} else {
			NoSuchFieldException e = new NoSuchFieldException(" Test_Case Column Does Not Exist");
			throw e;
		}
		// Mantis 0000677

		int testDataRecordNumber = ExcelConnection.funGetTestDataRecordNumber(testCaseColumnIndex, sTestCaseData,
				dataResultSet);
		if (testDataRecordNumber != -1) {
			if (dataColumns.containsKey(sDataColumn)) {
				returnValue = dataResultSet.get(testDataRecordNumber).get(dataColumns.get(sDataColumn));
				if (returnValue.trim().isEmpty()) // Mantis 0001211
					returnValue = null;
			} else {
				NoSuchFieldException e = new NoSuchFieldException(
						"Can not find column " + sDataColumn + " inside Data Sheet");
				throw e;
			}
		} else {
			NoSuchFieldException e = new NoSuchFieldException(
					"Can not find Test Case " + sTestCaseData + " inside Data Sheet");
			throw e;
		}
		return returnValue;
	}

	/*
	public String extricateJson(String sTestCaseData, String sDataColumn, String sIdentifierValue) throws Exception 	// Mantis 0002019, 0002027
	{
		String value = "", key="";
		String jsonString = dynamicSet(sTestCaseData, sDataColumn);
		apitesting apiTest = new apitesting();
		try 
		{
			value = apiTest.jsonPathExtractor(jsonString, sIdentifierValue);
			dynamicGet(sTestCaseData, sDataColumn + "_"  + sVerifyProperty , value, "");
		} 
		catch (Exception e) 
		{
			sStepStatus = "Fail";
			sStepDescription ="No record was found. Please check the syntax of your JsonPath";	
		}
		return value;
	}
	*/
}